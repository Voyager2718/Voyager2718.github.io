(function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};window.UE={plugins:{},commands:{},instants:{},I18N:{},version:"mini1.0.0.0"};var g=UE.dom={};var j=UE.browser=function(){var u=navigator.userAgent.toLowerCase(),s=window.opera,t={ie:!!window.ActiveXObject,opera:(!!s&&s.version),webkit:(u.indexOf(" applewebkit/")>-1),mac:(u.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};t.gecko=(navigator.product=="Gecko"&&!t.webkit&&!t.opera);var r=0;if(t.ie){r=parseFloat(u.match(/msie (\d+)/)[1]);t.ie9Compat=document.documentMode==9;t.ie8=!!document.documentMode;t.ie8Compat=document.documentMode==8;t.ie7Compat=((r==7&&!document.documentMode)||document.documentMode==7);t.ie6Compat=(r<7||t.quirks);t.ie9above=r>8;t.ie9below=r<9}if(t.gecko){var v=u.match(/rv:([\d\.]+)/);if(v){v=v[1].split(".");r=v[0]*10000+(v[1]||0)*100+(v[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(u)){t.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(u)&&!/chrome/i.test(u)){t.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(t.opera){r=parseFloat(s.version())}if(t.webkit){r=parseFloat(u.match(/ applewebkit\/(\d+)/)[1])}t.version=r;t.isCompatible=!t.mobile&&((t.ie&&r>=6)||(t.gecko&&r>=10801)||(t.opera&&r>=9.5)||(t.air&&r>=1)||(t.webkit&&r>=522)||false);return t}();var c=j.ie,o=j.webkit,d=j.gecko,e=j.opera;var p=UE.utils={each:function(w,v,u){if(w==null){return}if(w.length===+w.length){for(var t=0,r=w.length;t<r;t++){if(v.call(u,w[t],t,w)===false){return false}}}else{for(var s in w){if(w.hasOwnProperty(s)){if(v.call(u,w[s],s,w)===false){return false}}}}},makeInstance:function(s){var r=new Function();r.prototype=s;s=new r;r.prototype=null;return s},extend:function(v,w,r){if(w){for(var u in w){if(!r||!v.hasOwnProperty(u)){v[u]=w[u]}}}return v},extend2:function(w){var s=arguments;for(var v=1;v<s.length;v++){var r=s[v];for(var u in r){if(!w.hasOwnProperty(u)){w[u]=r[u]}}}return w},inherits:function(u,s){var r=u.prototype,t=p.makeInstance(s.prototype);p.extend(t,r,true);u.prototype=t;return(t.constructor=u)},bind:function(s,r){return function(){return s.apply(r,arguments)}},defer:function(s,r,t){var u;return function(){if(t){clearTimeout(u)}u=setTimeout(s,r)}},indexOf:function(u,s,t){var r=-1;t=this.isNumber(t)?t:0;this.each(u,function(w,x){if(x>=t&&w===s){r=x;return false}});return r},removeItem:function(u,t){for(var s=0,r=u.length;s<r;s++){if(u[s]===t){u.splice(s,1);s--}}},trim:function(r){return r.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(t){if(!t){return{}}t=p.isArray(t)?t:t.split(",");for(var s=0,r,u={};r=t[s++];){u[r.toUpperCase()]=u[r]=1}return u},unhtml:function(s,r){return s?s.replace(r||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(u,t){if(t){return u}else{return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[u]}}):""},html:function(r){return r?r.replace(/&((g|l|quo)t|amp|#39);/g,function(s){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[s]}):""},cssStyleToDomStyle:function(){var s=document.createElement("div").style,r={"float":s.cssFloat!=undefined?"cssFloat":s.styleFloat!=undefined?"styleFloat":"float"};return function(t){return r[t]||(r[t]=t.toLowerCase().replace(/-./g,function(u){return u.charAt(1).toUpperCase()}))}}(),loadFile:function(){var r=[];function s(x,w){try{for(var u=0,t;t=r[u++];){if(t.doc===x&&t.url==(w.src||w.href)){return t}}}catch(v){return null}}return function(z,y,v){var w=s(z,y);if(w){if(w.ready){v&&v()}else{w.funs.push(v)}return}r.push({doc:z,url:y.src||y.href,funs:[v]});if(!z.body){var u=[];for(var x in y){if(x=="tag"){continue}u.push(x+'="'+y[x]+'"')}z.write("<"+y.tag+" "+u.join(" ")+" ></"+y.tag+">");return}if(y.id&&z.getElementById(y.id)){return}var t=z.createElement(y.tag);delete y.tag;for(var x in y){t.setAttribute(x,y[x])}t.onload=t.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){w=s(z,y);if(w.funs.length>0){w.ready=1;for(var A;A=w.funs.pop();){A()}}t.onload=t.onreadystatechange=null}};t.onerror=function(){throw Error("The load "+(y.href||y.src)+" fails,check the url settings of file ueditor.config.js ")};z.getElementsByTagName("head")[0].appendChild(t)}}(),isEmptyObject:function(s){if(s==null){return true}if(this.isArray(s)||this.isString(s)){return s.length===0}for(var r in s){if(s.hasOwnProperty(r)){return false}}return true},fixColor:function(s,u){if(/color/i.test(s)&&/rgba?/.test(u)){var v=u.split(",");if(v.length>3){return""}u="#";for(var t=0,r;r=v[t++];){r=parseInt(r.replace(/[^\d]/gi,""),10).toString(16);u+=r.length==1?"0"+r:r}u=u.toUpperCase()}return u},clone:function(t,u){var s;u=u||{};for(var r in t){if(t.hasOwnProperty(r)){s=t[r];if(typeof s=="object"){u[r]=p.isArray(s)?[]:{};p.clone(t[r],u[r])}else{u[r]=s}}}return u},transUnitToPx:function(s){if(!/(pt|cm)/.test(s)){return s}var r;s.replace(/([\d.]+)(\w+)/,function(x,t,w){s=t;r=w});switch(r){case"cm":s=parseFloat(s)*25;break;case"pt":s=Math.round(parseFloat(s)*96/72)}return s+(s?"px":"")},domReady:function(){var r=[];function s(u){u.isReady=true;for(var t;t=r.pop();t()){}}return function(t,v){v=v||window;var u=v.document;t&&r.push(t);if(u.readyState==="complete"){s(u)}else{u.isReady&&s(u);if(j.ie){(function(){if(u.isReady){return}try{u.documentElement.doScroll("left")}catch(w){setTimeout(arguments.callee,0);return}s(u)})();v.attachEvent("onload",function(){s(u)})}else{u.addEventListener("DOMContentLoaded",function(){u.removeEventListener("DOMContentLoaded",arguments.callee,false);s(u)},false);v.addEventListener("load",function(){s(u)},false)}}}}(),cssRule:j.ie?function(u,v,w){var r,t;w=w||document;if(w.indexList){r=w.indexList}else{r=w.indexList={}}var s;if(!r[u]){if(v===undefined){return""}s=w.createStyleSheet("",t=w.styleSheets.length);r[u]=t}else{s=w.styleSheets[r[u]]}if(v===undefined){return s.cssText}s.cssText=v||""}:function(s,t,v){v=v||document;var r=v.getElementsByTagName("head")[0],u;if(!(u=v.getElementById(s))){if(t===undefined){return""}u=v.createElement("style");u.id=s;r.appendChild(u)}if(t===undefined){return u.innerHTML}if(t!==""){u.innerHTML=t}else{r.removeChild(u)}}};p.each(["String","Function","Array","Number","RegExp","Object"],function(r){UE.utils["is"+r]=function(s){return Object.prototype.toString.apply(s)=="[object "+r+"]"}});var i=UE.EventBase=function(){};i.prototype={addListener:function(s,u){s=p.trim(s).split(" ");for(var r=0,t;t=s[r++];){m(this,t,true).push(u)}},removeListener:function(s,u){s=p.trim(s).split(" ");for(var r=0,t;t=s[r++];){p.removeItem(m(this,t)||[],u)}},fireEvent:function(){var w=arguments[0];w=p.trim(w).split(" ");for(var v=0,y;y=w[v++];){var x=m(this,y),z,u,s;if(x){s=x.length;while(s--){if(!x[s]){continue}u=x[s].apply(this,arguments);if(u===true){return u}if(u!==undefined){z=u}}}if(u=this["on"+y.toLowerCase()]){z=u.apply(this,arguments)}}return z}};function m(u,s,t){var r;s=s.toLowerCase();return((r=(u.__allListeners||t&&(u.__allListeners={})))&&(r[s]||t&&(r[s]=[])))}var b=g.dtd=(function(){function an(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}var r=p.extend2;var am=an({isindex:1,fieldset:1}),al=an({input:1,button:1,select:1,textarea:1,label:1}),ak=r(an({a:1}),al),aj=r({iframe:1},ak),ai=an({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),ah=an({ins:1,del:1,script:1,style:1}),ag=r(an({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),ah),af=r(an({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),ag),ae=r(an({p:1}),af),ad=r(an({iframe:1}),af,al),ab=an({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),aa=r(an({a:0}),ad),Y=an({tr:1}),W=an({"#":1}),z=r(an({param:1}),ab),y=r(an({form:1}),am,aj,ai,ae),x=an({li:1,ol:1,ul:1}),w=an({style:1,script:1}),v=an({base:1,link:1,meta:1,title:1}),u=r(v,w),t=an({head:1,body:1}),s=an({html:1});var Z=an({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),ac=an({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return an({$nonBodyContent:r(s,t,v),$block:Z,$inline:aa,$inlineWithA:r(an({a:1}),aa),$body:r(an({script:1,style:1}),Z),$cdata:an({script:1,style:1}),$empty:ac,$nonChild:an({iframe:1,textarea:1}),$listItem:an({dd:1,dt:1,li:1}),$list:an({ul:1,ol:1,dl:1}),$isNotEmpty:an({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:an({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:an({p:1,div:1}),$tableContent:an({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:an({pre:1,script:1,style:1,textarea:1}),p:r(an({a:1}),aa)})})();var n=c&&j.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},k=p.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var f=g.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:c&&j.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},breakParent:function(v,t){var s,x=v,w=v,r,u;do{x=x.parentNode;if(r){s=x.cloneNode(false);s.appendChild(r);r=s;s=x.cloneNode(false);s.appendChild(u);u=s}else{r=x.cloneNode(false);u=r.cloneNode(false)}while(s=w.previousSibling){r.insertBefore(s,r.firstChild)}while(s=w.nextSibling){u.appendChild(s)}w=x}while(t!==x);s=t.parentNode;s.insertBefore(r,t);s.insertBefore(u,t);s.insertBefore(v,u);f.remove(t);return v},trimWhiteTextNode:function(s){function r(t){var u;while((u=s[t])&&u.nodeType==3&&f.isWhitespace(u)){s.removeChild(u)}}r("firstChild");r("lastChild")},getPosition:function(w,u){if(w===u){return 0}var s,v=[w],t=[u];s=w;while(s=s.parentNode){if(s===u){return 10}v.push(s)}s=u;while(s=s.parentNode){if(s===w){return 20}t.push(s)}v.reverse();t.reverse();if(v[0]!==t[0]){return 1}var r=-1;while(r++,v[r]===t[r]){}w=v[r];u=t[r];while(w=w.nextSibling){if(w===u){return 4}}return 2},getNodeIndex:function(t,s){var u=t,r=0;while(u=u.previousSibling){if(s&&u.nodeType==3){if(u.nodeType!=u.nextSibling.nodeType){r++}continue}r++}return r},inDoc:function(r,s){return f.getPosition(r,s)==10},findParent:function(s,t,r){if(s&&!f.isBody(s)){s=r?s:s.parentNode;while(s){if(!t||t(s)||f.isBody(s)){return t&&!t(s)&&f.isBody(s)?null:s}s=s.parentNode}}return null},findParentByTagName:function(t,r,s,u){r=p.listToMap(p.isArray(r)?r:[r]);return f.findParent(t,function(v){return r[v.tagName]&&!(u&&u(v))},s)},findParents:function(u,t,v,s){var r=t&&(v&&v(u)||!v)?[u]:[];while(u=f.findParent(u,v)){r.push(u)}return s?r:r.reverse()},insertAfter:function(s,r){return s.parentNode.insertBefore(r,s.nextSibling)},remove:function(s,t){var r=s.parentNode,u;if(r){if(t&&s.hasChildNodes()){while(u=s.firstChild){r.insertBefore(u,s)}}r.removeChild(s)}return s},isBookmarkNode:function(r){return r.nodeType==1&&r.id&&/^_baidu_bookmark_/i.test(r.id)},getWindow:function(r){var s=r.ownerDocument||r;return s.defaultView||s.parentWindow},split:function(u,w){var v=u.ownerDocument;if(j.ie&&w==u.nodeValue.length){var t=v.createTextNode("");return f.insertAfter(u,t)}var r=u.splitText(w);if(j.ie8){var s=v.createTextNode("");f.insertAfter(r,s);f.remove(s)}return r},isWhitespace:function(r){return !new RegExp("[^ \t\n\r"+f.fillChar+"]").test(r.nodeValue)},getXY:function(s){var r=0,t=0;while(s.offsetParent){t+=s.offsetTop;r+=s.offsetLeft;s=s.offsetParent}return{x:r,y:t}},on:function(v,x,w){var u=p.isArray(x)?x:[x],r=u.length;if(r){while(r--){x=u[r];if(v.addEventListener){v.addEventListener(x,w,false)}else{if(!w._d){w._d={els:[]}}var t=x+w.toString(),s=p.indexOf(w._d.els,v);if(!w._d[t]||s==-1){if(s==-1){w._d.els.push(v)}if(!w._d[t]){w._d[t]=function(y){return w.call(y.srcElement,y||window.event)}}v.attachEvent("on"+x,w._d[t])}}}}v=null},un:function(v,x,w){var u=p.isArray(x)?x:[x],r=u.length;if(r){while(r--){x=u[r];if(v.removeEventListener){v.removeEventListener(x,w,false)}else{var t=x+w.toString();try{v.detachEvent("on"+x,w._d?w._d[t]:w)}catch(y){}if(w._d&&w._d[t]){var s=p.indexOf(w._d.els,v);if(s!=-1){w._d.els.splice(s,1)}w._d.els.length==0&&delete w._d[t]}}}}},isEmptyInlineElement:function(r){if(r.nodeType!=1||!b.$removeEmpty[r.tagName]){return 0}r=r.firstChild;while(r){if(f.isBookmarkNode(r)){return 0}if(r.nodeType==1&&!f.isEmptyInlineElement(r)||r.nodeType==3&&!f.isWhitespace(r)){return 0}r=r.nextSibling}return 1},isBlockElm:function(r){return r.nodeType==1&&(b.$block[r.tagName]||k[f.getComputedStyle(r,"display")])&&!b.$nonChild[r.tagName]},getElementsByTagName:function(v,r,s){if(s&&p.isString(s)){var z=s;s=function(C){var B=false;$.each(p.trim(z).replace(/[ ]{2,}/g," ").split(" "),function(E,D){if($(C).hasClass(D)){B=true;return false}});return B}}r=p.trim(r).replace(/[ ]{2,}/g," ").split(" ");var x=[];for(var u=0,t;t=r[u++];){var y=v.getElementsByTagName(t);for(var w=0,A;A=y[w++];){if(!s||s(A)){x.push(A)}}}return x},unSelectable:c||j.opera?function(t){t.onselectstart=function(){return false};t.onclick=t.onkeyup=t.onkeydown=function(){return false};t.unselectable="on";t.setAttribute("unselectable","on");for(var s=0,r;r=t.all[s++];){switch(r.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:r.unselectable="on";t.setAttribute("unselectable","on")}}}:function(r){r.style.MozUserSelect=r.style.webkitUserSelect=r.style.KhtmlUserSelect="none"},removeAttributes:function(t,u){u=p.isArray(u)?u:p.trim(u).replace(/[ ]{2,}/g," ").split(" ");for(var s=0,r;r=u[s++];){r=n[r]||r;switch(r){case"className":t[r]="";break;case"style":t.style.cssText="";!j.ie&&t.removeAttributeNode(t.getAttributeNode("style"))}t.removeAttribute(r)}},createElement:function(t,r,s){return f.setAttributes(t.createElement(r),s)},setAttributes:function(t,s){for(var r in s){if(s.hasOwnProperty(r)){var u=s[r];switch(r){case"class":t.className=u;break;case"style":t.style.cssText=t.style.cssText+";"+u;break;case"innerHTML":t[r]=u;break;case"value":t.value=u;break;default:t.setAttribute(n[r]||r,u)}}}return t},getComputedStyle:function(s,r){return p.transUnitToPx(p.fixColor(r,$(s).css(r)))},preventDefault:function(r){r.preventDefault?r.preventDefault():(r.returnValue=false)},getStyle:function(s,r){var t=s.style[p.cssStyleToDomStyle(r)];return p.fixColor(r,t)},setStyle:function(s,r,t){s.style[p.cssStyleToDomStyle(r)]=t;if(!p.trim(s.style.cssText)){this.removeAttributes(s,"style")}},removeDirtyAttr:function(u){for(var t=0,s,r=u.getElementsByTagName("*");s=r[t++];){s.removeAttribute("_moz_dirty")}u.removeAttribute("_moz_dirty")},getChildCount:function(t,r){var s=0,u=t.firstChild;r=r||function(){return 1};while(u){if(r(u)){s++}u=u.nextSibling}return s},isEmptyNode:function(r){return !r.firstChild||f.getChildCount(r,function(s){return !f.isBr(s)&&!f.isBookmarkNode(s)&&!f.isWhitespace(s)})==0},isBr:function(r){return r.nodeType==1&&r.tagName=="BR"},isFillChar:function(r,s){return r.nodeType==3&&!r.nodeValue.replace(new RegExp((s?"^":"")+f.fillChar),"").length},isEmptyBlock:function(s,r){if(s.nodeType!=1){return 0}r=r||new RegExp("[ \t\r\n"+f.fillChar+"]","g");if(s[j.ie?"innerText":"textContent"].replace(r,"").length>0){return 0}for(var t in b.$isNotEmpty){if(s.getElementsByTagName(t).length){return 0}}return 1},isCustomeNode:function(r){return r.nodeType==1&&r.getAttribute("_ue_custom_node_")},fillNode:function(t,s){var r=j.ie?t.createTextNode(f.fillChar):t.createElement("br");s.innerHTML="";s.appendChild(r)},isBoundaryNode:function(t,r){var s;while(!f.isBody(t)){s=t;t=t.parentNode;if(s!==t[r]){return false}}return true},isFillChar:function(r,s){return r.nodeType==3&&!r.nodeValue.replace(new RegExp((s?"^":"")+f.fillChar),"").length}};var q=new RegExp(f.fillChar,"g");(function(){var w=0,x=f.fillChar,t;function s(B){B.collapsed=B.startContainer&&B.endContainer&&B.startContainer===B.endContainer&&B.startOffset==B.endOffset}function A(B){return !B.collapsed&&B.startContainer.nodeType==1&&B.startContainer===B.endContainer&&B.endOffset-B.startOffset==1}function r(C,D,E,B){if(D.nodeType==1&&(b.$empty[D.tagName]||b.$nonChild[D.tagName])){E=f.getNodeIndex(D)+(C?0:1);D=D.parentNode}if(C){B.startContainer=D;B.startOffset=E;if(!B.endContainer){B.collapse(true)}}else{B.endContainer=D;B.endOffset=E;if(!B.startContainer){B.collapse(false)}}s(B);return B}var u=g.Range=function(C,B){var D=this;D.startContainer=D.startOffset=D.endContainer=D.endOffset=null;D.document=C;D.collapsed=true;D.body=B};function v(E,B){try{if(t&&f.inDoc(t,E)){if(!t.nodeValue.replace(q,"").length){var C=t.parentNode;f.remove(t);while(C&&f.isEmptyInlineElement(C)&&(j.safari?!(f.getPosition(C,B)&f.POSITION_CONTAINS):!C.contains(B))){t=C.parentNode;f.remove(C);C=t}}else{t.nodeValue=t.nodeValue.replace(q,"")}}}catch(D){}}function z(D,B){var C;D=D[B];while(D&&f.isFillChar(D)){C=D[B];f.remove(D);D=C}}function y(H,L){var F=H.startContainer,E=H.endContainer,N=H.startOffset,G=H.endOffset,T=H.document,B=T.createDocumentFragment(),I,K;if(F.nodeType==1){F=F.childNodes[N]||(I=F.appendChild(T.createTextNode("")))}if(E.nodeType==1){E=E.childNodes[G]||(K=E.appendChild(T.createTextNode("")))}if(F===E&&F.nodeType==3){B.appendChild(T.createTextNode(F.substringData(N,G-N)));if(L){F.deleteData(N,G-N);H.collapse(true)}return B}var J,P,R=B,Q=f.findParents(F,true),C=f.findParents(E,true);for(var O=0;Q[O]==C[O];){O++}for(var M=O,S;S=Q[M];M++){J=S.nextSibling;if(S==F){if(!I){if(H.startContainer.nodeType==3){R.appendChild(T.createTextNode(F.nodeValue.slice(N)));if(L){F.deleteData(N,F.nodeValue.length-N)}}else{R.appendChild(!L?F.cloneNode(true):F)}}}else{P=S.cloneNode(false);R.appendChild(P)}while(J){if(J===E||J===C[M]){break}S=J.nextSibling;R.appendChild(!L?J.cloneNode(true):J);J=S}R=P}R=B;if(!Q[O]){R.appendChild(Q[O-1].cloneNode(false));R=R.firstChild}for(var M=O,D;D=C[M];M++){J=D.previousSibling;if(D==E){if(!K&&H.endContainer.nodeType==3){R.appendChild(T.createTextNode(E.substringData(0,G)));if(L){E.deleteData(0,G)}}}else{P=D.cloneNode(false);R.appendChild(P)}if(M!=O||!Q[O]){while(J){if(J===F){break}D=J.previousSibling;R.insertBefore(!L?J.cloneNode(true):J,R.firstChild);J=D}}R=P}if(L){H.setStartBefore(!C[O]?C[O-1]:!Q[O]?Q[O-1]:C[O]).collapse(true)}I&&f.remove(I);K&&f.remove(K);return B}u.prototype={deleteContents:function(){var B;if(!this.collapsed){y(this,1)}if(j.webkit){B=this.startContainer;if(B.nodeType==3&&!B.nodeValue.length){this.setStartBefore(B).collapse(true);f.remove(B)}}return this},inFillChar:function(){var B=this.startContainer;if(this.collapsed&&B.nodeType==3&&B.nodeValue.replace(new RegExp("^"+f.fillChar),"").length+1==B.nodeValue.length){return true}return false},setStart:function(B,C){return r(true,B,C,this)},setEnd:function(B,C){return r(false,B,C,this)},setStartAfter:function(B){return this.setStart(B.parentNode,f.getNodeIndex(B)+1)},setStartBefore:function(B){return this.setStart(B.parentNode,f.getNodeIndex(B))},setEndAfter:function(B){return this.setEnd(B.parentNode,f.getNodeIndex(B)+1)},setEndBefore:function(B){return this.setEnd(B.parentNode,f.getNodeIndex(B))},setStartAtFirst:function(B){return this.setStart(B,0)},setStartAtLast:function(B){return this.setStart(B,B.nodeType==3?B.nodeValue.length:B.childNodes.length)},setEndAtFirst:function(B){return this.setEnd(B,0)},setEndAtLast:function(B){return this.setEnd(B,B.nodeType==3?B.nodeValue.length:B.childNodes.length)},selectNode:function(B){return this.setStartBefore(B).setEndAfter(B)},selectNodeContents:function(B){return this.setStart(B,0).setEndAtLast(B)},cloneRange:function(){var B=this;return new u(B.document).setStart(B.startContainer,B.startOffset).setEnd(B.endContainer,B.endOffset)},collapse:function(B){var C=this;if(B){C.endContainer=C.startContainer;C.endOffset=C.startOffset}else{C.startContainer=C.endContainer;C.startOffset=C.endOffset}C.collapsed=true;return C},shrinkBoundary:function(D){var C=this,F,E=C.collapsed;function B(G){return G.nodeType==1&&!f.isBookmarkNode(G)&&!b.$empty[G.tagName]&&!b.$nonChild[G.tagName]}while(C.startContainer.nodeType==1&&(F=C.startContainer.childNodes[C.startOffset])&&B(F)){C.setStart(F,0)}if(E){return C.collapse(true)}if(!D){while(C.endContainer.nodeType==1&&C.endOffset>0&&(F=C.endContainer.childNodes[C.endOffset-1])&&B(F)){C.setEnd(F,F.childNodes.length)}}return C},trimBoundary:function(C){this.txtToElmBoundary();var G=this.startContainer,F=this.startOffset,E=this.collapsed,B=this.endContainer;if(G.nodeType==3){if(F==0){this.setStartBefore(G)}else{if(F>=G.nodeValue.length){this.setStartAfter(G)}else{var D=f.split(G,F);if(G===B){this.setEnd(D,this.endOffset-F)}else{if(G.parentNode===B){this.endOffset+=1}}this.setStartBefore(D)}}if(E){return this.collapse(true)}}if(!C){F=this.endOffset;B=this.endContainer;if(B.nodeType==3){if(F==0){this.setEndBefore(B)}else{F<B.nodeValue.length&&f.split(B,F);this.setEndAfter(B)}}}return this},txtToElmBoundary:function(B){function C(E,G){var D=E[G+"Container"],F=E[G+"Offset"];if(D.nodeType==3){if(!F){E["set"+G.replace(/(\w)/,function(H){return H.toUpperCase()})+"Before"](D)}else{if(F>=D.nodeValue.length){E["set"+G.replace(/(\w)/,function(H){return H.toUpperCase()})+"After"](D)}}}}if(B||!this.collapsed){C(this,"start");C(this,"end")}return this},insertNode:function(D){var F=D,C=1;if(D.nodeType==11){F=D.firstChild;C=D.childNodes.length}this.trimBoundary(true);var G=this.startContainer,E=this.startOffset;var B=G.childNodes[E];if(B){G.insertBefore(D,B)}else{G.appendChild(D)}if(F.parentNode===this.endContainer){this.endOffset=this.endOffset+C}return this.setStartBefore(F)},setCursor:function(C,B){return this.collapse(!C).select(B)},createBookmark:function(D,E){var B,C=this.document.createElement("span");C.style.cssText="display:none;line-height:0px;";C.appendChild(this.document.createTextNode("\u200D"));C.id="_baidu_bookmark_start_"+(E?"":w++);if(!this.collapsed){B=C.cloneNode(true);B.id="_baidu_bookmark_end_"+(E?"":w++)}this.insertNode(C);if(B){this.collapse().insertNode(B).setEndBefore(B)}this.setStartAfter(C);return{start:D?C.id:C,end:B?D?B.id:B:null,id:D}},moveToBookmark:function(C){var D=C.id?this.document.getElementById(C.start):C.start,B=C.end&&C.id?this.document.getElementById(C.end):C.end;this.setStartBefore(D);f.remove(D);if(B){this.setEndBefore(B);f.remove(B)}else{this.collapse(true)}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!f.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!f.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setEndBefore(this.endContainer)}}return this},getClosedNode:function(){var C;if(!this.collapsed){var B=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(A(B)){var D=B.startContainer.childNodes[B.startOffset];if(D&&D.nodeType==1&&(b.$empty[D.tagName]||b.$nonChild[D.tagName])){C=D}}}return C},select:j.ie?function(C,L){var H;if(!this.collapsed){this.shrinkBoundary()}var D=this.getClosedNode();if(D&&!L){try{H=this.document.body.createControlRange();H.addElement(D);H.select()}catch(I){}return this}var J=this.createBookmark(),B=J.start,E;H=this.document.body.createTextRange();H.moveToElementText(B);H.moveStart("character",1);if(!this.collapsed){var G=this.document.body.createTextRange();E=J.end;G.moveToElementText(E);H.setEndPoint("EndToEnd",G)}else{if(!C&&this.startContainer.nodeType!=3){var K=this.document.createTextNode(x),F=this.document.createElement("span");F.appendChild(this.document.createTextNode(x));B.parentNode.insertBefore(F,B);B.parentNode.insertBefore(K,B);v(this.document,K);t=K;z(F,"previousSibling");z(B,"nextSibling");H.moveStart("character",-1);H.collapse(true)}}this.moveToBookmark(J);F&&f.remove(F);try{H.select()}catch(I){}return this}:function(B){function C(K){function J(M,N,L){if(M.nodeType==3&&M.nodeValue.length<N){K[L+"Offset"]=M.nodeValue.length}}J(K.startContainer,K.startOffset,"start");J(K.endContainer,K.endOffset,"end")}var G=f.getWindow(this.document),F=G.getSelection(),E;j.gecko?this.body.focus():G.focus();if(F){F.removeAllRanges();if(this.collapsed&&!B){var I=this.startContainer,H=I;if(I.nodeType==1){H=I.childNodes[this.startOffset]}if(!(I.nodeType==3&&this.startOffset)&&(H?(!H.previousSibling||H.previousSibling.nodeType!=3):(!I.lastChild||I.lastChild.nodeType!=3))){E=this.document.createTextNode(x);this.insertNode(E);v(this.document,E);z(E,"previousSibling");z(E,"nextSibling");t=E;this.setStart(E,j.webkit?1:0).collapse(true)}}var D=this.document.createRange();if(this.collapsed&&j.opera&&this.startContainer.nodeType==1){var H=this.startContainer.childNodes[this.startOffset];if(!H){H=this.startContainer.lastChild;if(H&&f.isBr(H)){this.setStartBefore(H).collapse(true)}}else{while(H&&f.isBlockElm(H)){if(H.nodeType==1&&H.childNodes[0]){H=H.childNodes[0]}else{break}}H&&this.setStartBefore(H).collapse(true)}}C(this);D.setStart(this.startContainer,this.startOffset);D.setEnd(this.endContainer,this.endOffset);F.addRange(D)}return this},createAddress:function(E,D){var F={},C=this;function B(G){var I=G?C.startContainer:C.endContainer;var N=f.findParents(I,true,function(P){return !f.isBody(P)}),M=[];for(var K=0,O;O=N[K++];){M.push(f.getNodeIndex(O,D))}var H=0;if(D){if(I.nodeType==3){var J=I.previousSibling;while(J&&J.nodeType==3){H+=J.nodeValue.replace(q,"").length;J=J.previousSibling}H+=(G?C.startOffset:C.endOffset)}else{I=I.childNodes[G?C.startOffset:C.endOffset];if(I){H=f.getNodeIndex(I,D)}else{I=G?C.startContainer:C.endContainer;var L=I.firstChild;while(L){if(f.isFillChar(L)){L=L.nextSibling;continue}H++;if(L.nodeType==3){while(L&&L.nodeType==3){L=L.nextSibling}}else{L=L.nextSibling}}}}}else{H=G?f.isFillChar(I)?0:C.startOffset:C.endOffset}if(H<0){H=0}M.push(H);return M}F.startAddress=B(true);if(!E){F.endAddress=C.collapsed?[].concat(F.startAddress):B()}return F},moveToAddress:function(E,C){var B=this;function D(I,H){var L=B.body,F,M;for(var K=0,J,G=I.length;K<G;K++){J=I[K];F=L;L=L.childNodes[J];if(!L){M=J;break}}if(H){if(L){B.setStartBefore(L)}else{B.setStart(F,M)}}else{if(L){B.setEndBefore(L)}else{B.setEnd(F,M)}}}D(E.startAddress,true);!C&&E.endAddress&&D(E.endAddress);return B},equals:function(B){for(var C in this){if(this.hasOwnProperty(C)){if(this[C]!==B[C]){return false}}}return true},scrollIntoView:function(){var C=$('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(C.get(0));var D=$(window).scrollTop(),B=$(window).height(),E=C.offset().top;if(E<D-B||E>D+B){if(E>D+B){window.scrollTo(0,E-B+C.height())}else{window.scrollTo(0,D-E)}}C.remove()}}})();(function(){function u(E,w){var x=f.getNodeIndex;E=E.duplicate();E.collapse(w);var I=E.parentElement();if(!I.hasChildNodes()){return{container:I,offset:0}}var H=I.children,y,A=E.duplicate(),J=0,D=H.length-1,F=-1,v;while(J<=D){F=Math.floor((J+D)/2);y=H[F];A.moveToElementText(y);var C=A.compareEndPoints("StartToStart",E);if(C>0){D=F-1}else{if(C<0){J=F+1}else{return{container:I,offset:x(y)}}}}if(F==-1){A.moveToElementText(I);A.setEndPoint("StartToStart",E);v=A.text.replace(/(\r\n|\r)/g,"\n").length;H=I.childNodes;if(!v){y=H[H.length-1];return{container:y,offset:y.nodeValue.length}}var B=H.length;while(v>0){v-=H[--B].nodeValue.length}return{container:H[B],offset:-v}}A.collapse(C>0);A.setEndPoint(C>0?"StartToStart":"EndToStart",E);v=A.text.replace(/(\r\n|\r)/g,"\n").length;if(!v){return b.$empty[y.tagName]||b.$nonChild[y.tagName]?{container:I,offset:x(y)+(C>0?0:1)}:{container:y,offset:C>0?0:y.childNodes.length}}while(v>0){try{var z=y;y=y[C>0?"previousSibling":"nextSibling"];v-=y.nodeValue.length}catch(G){return{container:I,offset:x(z)}}}return{container:y,offset:C>0?-v:y.nodeValue.length+v}}function t(x,w){if(x.item){w.selectNode(x.item(0))}else{var v=u(x,true);w.setStart(v.container,v.offset);if(x.compareEndPoints("StartToEnd",x)!=0){v=u(x,false);w.setEnd(v.container,v.offset)}}return w}function s(y,v){var x;try{x=y.getNative(v).createRange()}catch(z){return null}var w=x.item?x.item(0):x.parentElement();if((w.ownerDocument||w)===y.document){return x}return null}var r=g.Selection=function(x,v){var w=this;w.document=x;w.body=v;if(j.ie9below){f.on(v,"beforedeactivate",function(){w._bakIERange=w.getIERange()});f.on(v,"activate",function(){try{var y=s(w);if((!y||!w.rangeInBody(y))&&w._bakIERange){w._bakIERange.select()}}catch(z){}w._bakIERange=null})}};r.prototype={hasNativeRange:function(){if(!j.ie||j.ie9above){return this.getNative().rangeCount}else{var w=this.getIERange(),v=w.parentElement();return v===this.body||f.inDoc(w.parentElement(),this.body)}},getNative:function(v){var x=this.document;try{return !x?null:j.ie9below||v?x.selection:f.getWindow(x).getSelection()}catch(w){return null}},getIERange:function(v){var w=s(this,v);if(!w||!this.rangeInBody(w,v)){if(this._bakIERange){return this._bakIERange}}return w},rangeInBody:function(v,w){var x=j.ie9below||w?v.item?v.item():v.parentElement():v.startContainer;return x===this.body||f.inDoc(x,this.body)},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var v=this.getStart();if(v){return f.findParents(v,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return j.ie&&s(this)||!j.ie&&this.getNative().rangeCount?true:false}catch(v){return false}},getRange:function(){var y=this;function x(D){var F=y.body.firstChild,E=D.collapsed;while(F&&F.firstChild){D.setStart(F,0);F=F.firstChild}if(!D.startContainer){D.setStart(y.body,0)}if(E){D.collapse(true)}}if(y._cachedRange!=null){return this._cachedRange}var w=new g.Range(y.document,y.body);if(j.ie9below){var A=y.getIERange();if(A){try{t(A,w)}catch(B){x(w)}}else{x(w)}}else{var z=y.getNative();if(z&&z.rangeCount&&y.rangeInBody(z.getRangeAt(0))){var v=z.getRangeAt(0);var C=z.getRangeAt(z.rangeCount-1);w.setStart(v.startContainer,v.startOffset).setEnd(C.endContainer,C.endOffset);if(w.collapsed&&f.isBody(w.startContainer)&&!w.startOffset){x(w)}}else{if(this._bakRange&&f.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}x(w)}}return this._bakRange=w},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var v=j.ie9below?this.getIERange():this.getRange(),y,z,w,x;if(j.ie9below){if(!v){return this.document.body.firstChild}if(v.item){return v.item(0)}y=v.duplicate();y.text.length>0&&y.moveStart("character",1);y.collapse(1);z=y.parentElement();x=w=v.parentElement();while(w=w.parentNode){if(w==z){z=x;break}}}else{z=v.startContainer;if(z.nodeType==1&&z.hasChildNodes()){z=z.childNodes[Math.min(z.childNodes.length-1,v.startOffset)]}if(z.nodeType==3){return z.parentNode}}return z},getText:function(){var v,w;if(this.isFocus()&&(v=this.getNative())){w=j.ie9below?v.createRange():v.getRangeAt(0);return j.ie9below?w.text:w.toString()}return""}}})();(function(){var u=0,s;function w(C,B){var x;if(B.textarea){if(p.isString(B.textarea)){for(var z=0,A,y=f.getElementsByTagName(C,"textarea");A=y[z++];){if(A.id=="ueditor_textarea_"+B.options.textarea){x=A;break}}}else{x=B.textarea}}if(!x){C.appendChild(x=f.createElement(document,"textarea",{name:B.options.textarea,id:"ueditor_textarea_"+B.options.textarea,style:"display:none"}));B.textarea=x}x.value=B.hasContents()?(B.options.allHtmlEnabled?B.getAllHtml():B.getContent(null,null,true)):""}function t(x){for(var y in UE.plugins){x.options.excludePlugins=$.isArray(x.options.excludePlugins)?x.options.excludePlugins:[x.options.excludePlugins];if($.inArray(y,x.options.excludePlugins)==-1){UE.plugins[y].call(x)}}x.langIsReady=true;x.fireEvent("langReady")}function v(x){for(var y in x){return y}}var r=UE.Editor=function(x){var y=this;y.uid=u++;i.call(y);y.commands={};y.options=p.extend(p.clone(x||{}),UEDITOR_CONFIG,true);y.shortcutkeys={};y.inputRules=[];y.outputRules=[];y.setOpt({isShow:true,initialContent:"",initialStyle:".edui-editor-body .edui-body-container p{margin:5px 0;} .edui-editor-body .edui-body-container{border:0;outline:none;cursor:text;padding:0 10px 0;word-wrap:break-word;font-size:16px;font-family:sans-serif;}.edui-editor-body.focus{border:1px solid #5c9dff}",autoClearinitialContent:false,iframeCssUrl:y.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:false,focusInEnd:true,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",customDomain:false,lang:"zh-cn",langPath:y.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:y.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false,autoSyncData:true,excludePlugins:""});if(!p.isEmptyObject(UE.I18N)){y.options.lang=v(UE.I18N);t(y)}else{p.loadFile(document,{src:y.options.langPath+y.options.lang+"/"+y.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){t(y)})}UE.instants["ueditorInstant"+y.uid]=y};r.prototype={ready:function(x){var y=this;if(x){y.isReady?x.apply(y):y.addListener("ready",x)}},setOpt:function(x,z){var y={};if(p.isString(x)){y[x]=z}else{y=x}p.extend(this.options,y,true)},getOpt:function(x){return this.options[x]||""},destroy:function(){var A=this;A.fireEvent("destroy");var y=A.container.parentNode;if(y===document.body){y=A.container}var x=A.textarea;if(!x){x=document.createElement("textarea");y.parentNode.insertBefore(x,y)}else{x.style.display=""}x.style.width=A.body.offsetWidth+"px";x.style.height=A.body.offsetHeight+"px";x.value=A.getContent();x.id=A.key;y.innerHTML="";f.remove(y);var z=A.key;for(var B in A){if(A.hasOwnProperty(B)){delete this[B]}}UE.clearCache(z)},initialCont:function(y){if(y){y.getAttribute("name")&&(this.options.textarea=y.getAttribute("name"));if(y&&/script|textarea/ig.test(y.tagName)){var x=document.createElement("div");y.parentNode.insertBefore(x,y);this.options.initialContent=UE.htmlparser(y.value||y.innerHTML||this.options.initialContent).toHtml();y.className&&(x.className=y.className);y.style.cssText&&(x.style.cssText=y.style.cssText);if(/textarea/i.test(y.tagName)){this.textarea=y;this.textarea.style.display="none"}else{y.parentNode.removeChild(y);y.id&&(x.id=y.id)}y=x;y.innerHTML=""}return y}else{return null}},render:function(y){var B=this,z=B.options,A=function(C){var D=parseInt($(y).css(C));if(isNaN(D)){D=0}return D};if(p.isString(y)){y=document.getElementById(y)}if(y){p.cssRule("ueditor_body_css"+y.id,B.options.initialStyle,document);y=this.initialCont(y);y.className+=" edui-body-container";if(z.initialFrameWidth){z.minFrameWidth=z.initialFrameWidth}else{z.minFrameWidth=z.initialFrameWidth=$(y).width()}if(z.initialFrameHeight){z.minFrameHeight=z.initialFrameHeight}else{z.initialFrameHeight=z.minFrameHeight=$(y).height()}y.style.width=/%$/.test(z.initialFrameWidth)?"100%":z.initialFrameWidth-A("border-left")-A("border-right")-A("padding-left")-A("padding-right")+"px";var x=/%$/.test(z.initialFrameHeight)?"100%":(z.initialFrameHeight-A("padding-top")-A("padding-bottom"));y.style.minHeight=x+"px";y.style.height="";y.style.zIndex=z.zIndex;if(j.ie&&j.version<=6){y.style.height=x;y.style.setExpression("height","this.scrollHeight <= "+x+' ? "'+x+'px" : "auto"')}this._setup(y)}},_setup:function(x){var B=this,y=B.options;x.contentEditable=true;document.body.spellcheck=false;B.document=document;B.window=document.defaultView||document.parentWindow;B.body=x;B.$body=$(x);f.isBody=function(D){return D===x};B.selection=new g.Selection(document,B.body);var C;if(j.gecko&&(C=this.selection.getNative())){C.removeAllRanges()}this._initEvents();for(var A=x.parentNode;A&&!f.isBody(A);A=A.parentNode){if(A.tagName=="FORM"){B.form=A;if(B.options.autoSyncData){f.on(x,"blur",function(){w(A,B)})}else{f.on(A,"submit",function(){w(this,B)})}break}}if(y.initialContent){if(y.autoClearinitialContent){var z=B.execCommand;B.execCommand=function(){B.fireEvent("firstBeforeExecCommand");return z.apply(B,arguments)};this._setDefaultContent(y.initialContent)}else{this.setContent(y.initialContent,false,true)}}if(f.isEmptyNode(B.body)){B.body.innerHTML="<p>"+(j.ie?"":"<br/>")+"</p>"}if(y.focus){setTimeout(function(){B.focus(B.options.focusInEnd);!B.options.autoClearinitialContent&&B._selectionChange()},0)}if(!B.container){B.container=x.parentNode}B._bindshortcutKeys();B.isReady=1;B.fireEvent("ready");y.onready&&y.onready.call(B);if(!j.ie||j.ie9above){f.on(B.body,["blur","focus"],function(E){var D=B.selection.getNative();if(E.type=="blur"){if(D.rangeCount>0){B._bakRange=D.getRangeAt(0)}}else{try{B._bakRange&&D.addRange(B._bakRange)}catch(E){}B._bakRange=null}})}!y.isShow&&B.setHide();y.readonly&&B.setDisabled()},sync:function(z){var y=this,x=z?document.getElementById(z):f.findParent(y.iframe.parentNode,function(A){return A.tagName=="FORM"},true);x&&w(x,y)},setHeight:function(x,y){!y&&(this.options.initialFrameHeight=x);this.body.style.height=x+"px"},addshortcutkey:function(y,x){var z={};if(x){z[y]=x}else{z=y}p.extend(this.shortcutkeys,z)},_bindshortcutKeys:function(){var y=this,x=this.shortcutkeys;y.addListener("keydown",function(E,D){var G=D.keyCode||D.which;for(var B in x){var C=x[B].split(",");for(var H=0,z;z=C[H++];){z=z.split(":");var F=z[0],A=z[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(F.toLowerCase())||/^(\d+)$/.test(F)){if(((RegExp.$1=="ctrl"?(D.ctrlKey||D.metaKey):0)&&(RegExp.$2!=""?D[RegExp.$2.slice(1)+"Key"]:1)&&G==RegExp.$3)||G==RegExp.$1){if(y.queryCommandState(B,A)!=-1){y.execCommand(B,A)}f.preventDefault(D)}}}}})},getContent:function(D,B,y,A,z){var C=this;if(D&&p.isFunction(D)){B=D;D=""}if(B?!B():!this.hasContents()){return""}C.fireEvent("beforegetcontent");var x=UE.htmlparser(C.body.innerHTML,A);C.filterOutputRule(x);C.fireEvent("aftergetcontent",x);return x.toHtml(z)},getAllHtml:function(){var z=this,y=[],x="";z.fireEvent("getAllHtml",y);if(j.ie&&j.version>8){var A="";p.each(z.document.styleSheets,function(B){A+=(B.href?'<link rel="stylesheet" type="text/css" href="'+B.href+'" />':"<style>"+B.cssText+"</style>")});p.each(z.document.getElementsByTagName("script"),function(B){A+=B.outerHTML})}return"<html><head>"+(z.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+z.options.charset+'"/>':"")+(A||z.document.getElementsByTagName("head")[0].innerHTML)+y.join("\n")+"</head><body "+(c&&j.version<9?'class="view"':"")+">"+z.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var y=new RegExp(f.fillChar,"g"),x=this.body.innerHTML.replace(/[\n\r]/g,"");x=x.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(A,z,B){return b.$block[B]?"\n":z?z:""});return x.replace(y,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var x=new RegExp(f.fillChar,"g");return this.body[j.ie?"innerText":"textContent"].replace(x,"").replace(/\u00a0/g," ")},setContent:function(B,E,A){var F=this;F.fireEvent("beforesetcontent",B);var G=UE.htmlparser(B);F.filterInputRule(G);B=G.toHtml();F.body.innerHTML=(E?F.body.innerHTML:"")+B;function D(H){return H.tagName=="DIV"&&H.getAttribute("cdata_tag")}if(F.options.enterTag=="p"){var y=this.body.firstChild,z;if(!y||y.nodeType==1&&(b.$cdata[y.tagName]||D(y)||f.isCustomeNode(y))&&y===this.body.lastChild){this.body.innerHTML="<p>"+(j.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML}else{var x=F.document.createElement("p");while(y){while(y&&(y.nodeType==3||y.nodeType==1&&b.p[y.tagName]&&!b.$cdata[y.tagName])){z=y.nextSibling;x.appendChild(y);y=z}if(x.firstChild){if(!y){F.body.appendChild(x);break}else{y.parentNode.insertBefore(x,y);x=F.document.createElement("p")}}y=y.nextSibling}}}F.fireEvent("aftersetcontent");F.fireEvent("contentchange");!A&&F._selectionChange();F._bakRange=F._bakIERange=F._bakNativeRange=null;var C;if(j.gecko&&(C=this.selection.getNative())){C.removeAllRanges()}if(F.options.autoSyncData){F.form&&w(F.form,F)}},focus:function(A){try{var y=this,x=y.selection.getRange();if(A){x.setStartAtLast(y.body.lastChild).setCursor(false,true)}else{x.select(true)}this.fireEvent("focus")}catch(z){}},_initEvents:function(){var y=this,x=y.body;y._proxyDomEvent=p.bind(y._proxyDomEvent,y);f.on(x,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],y._proxyDomEvent);f.on(x,["focus","blur"],y._proxyDomEvent);f.on(x,["mouseup","keydown"],function(z){if(z.type=="keydown"&&(z.ctrlKey||z.metaKey||z.shiftKey||z.altKey)){return}if(z.button==2){return}y._selectionChange(250,z)})},_proxyDomEvent:function(x){return this.fireEvent(x.type.replace(/^on/,""),x)},_selectionChange:function(A,x){var D=this;var C=false;var B,z;if(j.ie&&j.version<9&&x&&x.type=="mouseup"){var y=this.selection.getRange();if(!y.collapsed){C=true;B=x.clientX;z=x.clientY}}clearTimeout(s);s=setTimeout(function(){if(!D.selection.getNative()){return}var F;if(C&&D.selection.getNative().type=="None"){F=D.document.body.createTextRange();try{F.moveToPoint(B,z)}catch(E){F=null}}var G;if(F){G=D.selection.getIERange;D.selection.getIERange=function(){return F}}D.selection.cache();if(G){D.selection.getIERange=G}if(D.selection._cachedRange&&D.selection._cachedStartElement){D.fireEvent("beforeselectionchange");D.fireEvent("selectionchange",!!x);D.fireEvent("afterselectionchange");D.selection.clear()}},A||50)},_callCmdFn:function(B,y){y=Array.prototype.slice.call(y,0);var x=y.shift().toLowerCase(),A,z;A=this.commands[x]||UE.commands[x];z=A&&A[B];if((!A||!z)&&B=="queryCommandState"){return 0}else{if(z){return z.apply(this,[x].concat(y))}}},execCommand:function(y){if(!this.selection.hasNativeRange()){this.focus(true)}y=y.toLowerCase();var z=this,x,A=z.commands[y]||UE.commands[y];if(!A||!A.execCommand){return null}if(!A.notNeedUndo&&!z.__hasEnterExecCommand){z.__hasEnterExecCommand=true;if(z.queryCommandState.apply(z,arguments)!=-1){z.fireEvent("saveScene");z.fireEvent("beforeexeccommand",y);x=this._callCmdFn("execCommand",arguments);(!A.ignoreContentChange&&!z._ignoreContentChange)&&z.fireEvent("contentchange");z.fireEvent("afterexeccommand",y);z.fireEvent("saveScene")}z.__hasEnterExecCommand=false}else{x=this._callCmdFn("execCommand",arguments);(!z.__hasEnterExecCommand&&!A.ignoreContentChange&&!z._ignoreContentChange)&&z.fireEvent("contentchange")}(!z.__hasEnterExecCommand&&!A.ignoreContentChange&&!z._ignoreContentChange)&&z._selectionChange();return x},queryCommandState:function(x){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(x){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(y){if(y){for(var A=0,z;z=y[A++];){if(this.body.getElementsByTagName(z).length>0){return true}}}if(!f.isEmptyBlock(this.body)){return true}y=["div"];for(A=0;z=y[A++];){var x=f.getElementsByTagName(this.body,z);for(var C=0,B;B=x[C++];){if(f.isCustomeNode(B)){return true}}}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var y=this,x;if(y.body.contentEditable=="false"){y.body.contentEditable=true;x=y.selection.getRange();try{x.moveToBookmark(y.lastBk);delete y.lastBk}catch(z){x.setStartAtFirst(y.body).collapse(true)}x.select(true);if(y.bkqueryCommandState){y.queryCommandState=y.bkqueryCommandState;delete y.bkqueryCommandState}y.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(x){var y=this;x=x?p.isArray(x)?x:[x]:[];if(y.body.contentEditable=="true"){if(!y.lastBk){y.lastBk=y.selection.getRange().createBookmark(true)}y.body.contentEditable=false;y.bkqueryCommandState=y.queryCommandState;y.queryCommandState=function(z){if(p.indexOf(x,z)!=-1){return y.bkqueryCommandState.apply(y,arguments)}return -1};y.fireEvent("selectionchange")}},disable:function(x){return this.setDisabled(x)},_setDefaultContent:function(){function x(){var y=this;if(y.document.getElementById("initContent")){y.body.innerHTML="<p>"+(c?"":"<br/>")+"</p>";y.removeListener("firstBeforeExecCommand focus",x);setTimeout(function(){y.focus();y._selectionChange()},0)}}return function(y){var z=this;z.body.innerHTML='<p id="initContent">'+y+"</p>";z.addListener("firstBeforeExecCommand focus",x)}}(),setShow:function(){var y=this,x=y.selection.getRange();if(y.container.style.display=="none"){try{x.moveToBookmark(y.lastBk);delete y.lastBk}catch(z){x.setStartAtFirst(y.body).collapse(true)}setTimeout(function(){x.select(true)},100);y.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var x=this;if(!x.lastBk){x.lastBk=x.selection.getRange().createBookmark(true)}x.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(z){var A=UE.I18N[this.options.lang];if(!A){throw Error("not import language file")}z=(z||"").split(".");for(var y=0,x;x=z[y++];){A=A[x];if(!A){break}}return A},getContentLength:function(y,x){var B=this.getContent(false,false,true).length;if(y){x=(x||[]).concat(["hr","img","iframe"]);B=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var A=0,z;z=x[A++];){B+=this.body.getElementsByTagName(z).length}}return B},addInputRule:function(x,y){x.ignoreUndo=y;this.inputRules.push(x)},filterInputRule:function(y,x){for(var A=0,z;z=this.inputRules[A++];){if(x&&z.ignoreUndo){continue}z.call(this,y)}},addOutputRule:function(x,y){x.ignoreUndo=y;this.outputRules.push(x)},filterOutputRule:function(y,x){for(var A=0,z;z=this.outputRules[A++];){if(x&&z.ignoreUndo){continue}z.call(this,y)}}};p.inherits(r,i)})();var h=UE.filterWord=function(){function t(u){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(u)}function r(u){u=u.replace(/[\d.]+\w+/g,function(v){return p.transUnitToPx(v)});return u}function s(u){return u.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(z){if(j.opera){return""}try{var w=z.match(/width:([ \d.]*p[tx])/i)[1],v=z.match(/height:([ \d.]*p[tx])/i)[1],y=z.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+r(w)+'" height="'+r(v)+'" src="'+y+'" />'}catch(x){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(y,v,w,x){return v=="class"&&x=="MsoListParagraph"?y:""}).replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(C,G,A,x){var y=[],F=x.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var B=0,E;E=F[B];B++){var w,D,z=E.split(":");if(z.length==2){w=z[0].toLowerCase();D=z[1].toLowerCase();if(/^(background)\w*/.test(w)&&D.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(w)&&/^0\w+$/.test(D)){continue}switch(w){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(G)){y[B]=w.replace(/^mso-|-alt$/g,"")+":"+r(D)}continue;case"horiz-align":y[B]="text-align:"+D;continue;case"vert-align":y[B]="vertical-align:"+D;continue;case"font-color":case"mso-foreground":y[B]="color:"+D;continue;case"mso-background":case"mso-highlight":y[B]="background:"+D;continue;case"mso-default-height":y[B]="min-height:"+r(D);continue;case"mso-default-width":y[B]="min-width:"+r(D);continue;case"mso-padding-between-alt":y[B]="border-collapse:separate;border-spacing:"+r(D);continue;case"text-line-through":if((D=="single")||(D=="double")){y[B]="text-decoration:line-through"}continue;case"mso-zero-height":if(D=="yes"){y[B]="display:none"}continue;case"background":break;case"margin":if(!/[1-9]/.test(D)){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(w)||/text\-indent|padding|margin/.test(w)&&/\-[\d.]+/.test(D)){continue}y[B]=w+":"+z[1]}}return G+(y.length?' style="'+y.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(v){return p.transUnitToPx(v)})}return function(u){return(t(u)?s(u):u)}}();(function(){var v=UE.uNode=function(D){this.type=D.type;this.data=D.data;this.tagName=D.tagName;this.parentNode=D.parentNode;this.attrs=D.attrs||{};this.children=D.children};var z="    ",y="\n";function t(D,F,E){D.push(y);return F+(E?1:-1)}function C(D,F){for(var E=0;E<F;E++){D.push(z)}}v.createElement=function(D){if(/[<>]/.test(D)){return UE.htmlparser(D).children[0]}else{return new v({type:"element",children:[],tagName:D})}};v.createText=function(E,D){return new UE.uNode({type:"text",data:D?E:p.unhtml(E||"")})};function A(H,D,G,I){switch(H.type){case"root":for(var F=0,E;E=H.children[F++];){if(G&&E.type=="element"&&!b.$inlineWithA[E.tagName]&&F>1){t(D,I,true);C(D,I)}A(E,D,G,I)}break;case"text":w(H,D);break;case"element":x(H,D,G,I);break;case"comment":B(H,D,G)}return D}function w(E,D){D.push(E.parentNode.tagName=="pre"?E.data:E.data.replace(/[ ]{2}/g," &nbsp;"))}function x(D,F,J,G){var H="";if(D.attrs){H=[];var K=D.attrs;for(var I in K){H.push(I+(K[I]!==undefined?'="'+K[I]+'"':""))}H=H.join(" ")}F.push("<"+D.tagName+(H?" "+H:"")+(b.$empty[D.tagName]?"/":"")+">");if(J&&!b.$inlineWithA[D.tagName]&&D.tagName!="pre"){if(D.children&&D.children.length){G=t(F,G,true);C(F,G)}}if(D.children&&D.children.length){for(var E=0,L;L=D.children[E++];){if(J&&L.type=="element"&&!b.$inlineWithA[L.tagName]&&E>1){t(F,G);C(F,G)}A(L,F,J,G)}}if(!b.$empty[D.tagName]){if(J&&!b.$inlineWithA[D.tagName]&&D.tagName!="pre"){if(D.children&&D.children.length){G=t(F,G);C(F,G)}}F.push("</"+D.tagName+">")}}function B(E,D){D.push("<!--"+E.data+"-->")}function u(D,H){var G;if(D.type=="element"&&D.getAttr("id")==H){return D}if(D.children&&D.children.length){for(var F=0,E;E=D.children[F++];){if(G=u(E,H)){return G}}}}function s(H,G,D){if(H.type=="element"&&H.tagName==G){D.push(H)}if(H.children&&H.children.length){for(var F=0,E;E=H.children[F++];){s(E,G,D)}}}function r(D,G){if(D.children&&D.children.length){for(var F=0,E;E=D.children[F];){r(E,G);if(E.parentNode){if(E.children&&E.children.length){G(E)}if(E.parentNode){F++}}}}else{G(D)}}v.prototype={toHtml:function(E){var D=[];A(this,D,E,0);return D.join("")},innerHTML:function(E){if(this.type!="element"||b.$empty[this.tagName]){return this}if(p.isString(E)){if(this.children){for(var G=0,F;F=this.children[G++];){F.parentNode=null}}this.children=[];var D=UE.htmlparser(E);for(var G=0,F;F=D.children[G++];){this.children.push(F);F.parentNode=this}return this}else{var D=new UE.uNode({type:"root",children:this.children});return D.toHtml()}},innerText:function(D,E){if(this.type!="element"||b.$empty[this.tagName]){return this}if(D){if(this.children){for(var G=0,F;F=this.children[G++];){F.parentNode=null}}this.children=[];this.appendChild(v.createText(D,E));return this}else{return this.toHtml().replace(/<[^>]+>/g,"")}},getData:function(){if(this.type=="element"){return""}return this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){var F=this.parentNode;for(var E=0,D;D=F.children[E];E++){if(D===this){return E==0?null:F.children[E-1]}}},nextSibling:function(){var F=this.parentNode;for(var E=0,D;D=F.children[E++];){if(D===this){return F.children[E]}}},replaceChild:function(G,F){if(this.children){if(G.parentNode){G.parentNode.removeChild(G)}for(var E=0,D;D=this.children[E];E++){if(D===F){this.children.splice(E,1,G);F.parentNode=null;G.parentNode=this;return G}}}},appendChild:function(F){if(this.type=="root"||(this.type=="element"&&!b.$empty[this.tagName])){if(!this.children){this.children=[]}if(F.parentNode){F.parentNode.removeChild(F)}for(var E=0,D;D=this.children[E];E++){if(D===F){this.children.splice(E,1);break}}this.children.push(F);F.parentNode=this;return F}},insertBefore:function(G,F){if(this.children){if(G.parentNode){G.parentNode.removeChild(G)}for(var E=0,D;D=this.children[E];E++){if(D===F){this.children.splice(E,0,G);G.parentNode=this;return G}}}},insertAfter:function(G,F){if(this.children){if(G.parentNode){G.parentNode.removeChild(G)}for(var E=0,D;D=this.children[E];E++){if(D===F){this.children.splice(E+1,0,G);G.parentNode=this;return G}}}},removeChild:function(H,I){if(this.children){for(var G=0,F;F=this.children[G];G++){if(F===H){this.children.splice(G,1);F.parentNode=null;if(I&&F.children&&F.children.length){for(var E=0,D;D=F.children[E];E++){this.children.splice(G+E,0,D);D.parentNode=this}}return F}}}},getAttr:function(D){return this.attrs&&this.attrs[D.toLowerCase()]},setAttr:function(F,E){if(!F){delete this.attrs;return}if(!this.attrs){this.attrs={}}if(p.isObject(F)){for(var D in F){if(!F[D]){delete this.attrs[D]}else{this.attrs[D.toLowerCase()]=F[D]}}}else{if(!E){delete this.attrs[F]}else{this.attrs[F.toLowerCase()]=E}}},getIndex:function(){var F=this.parentNode;for(var E=0,D;D=F.children[E];E++){if(D===this){return E}}return -1},getNodeById:function(G){var F;if(this.children&&this.children.length){for(var E=0,D;D=this.children[E++];){if(F=u(D,G)){return F}}}},getNodesByTagName:function(E){E=p.trim(E).replace(/[ ]{2,}/g," ").split(" ");var D=[],F=this;p.each(E,function(I){if(F.children&&F.children.length){for(var H=0,G;G=F.children[H++];){s(G,I,D)}}});return D},getStyle:function(E){var G=this.getAttr("style");if(!G){return""}var F=new RegExp("(^|;)\\s*"+E+":([^;]+)","i");var D=G.match(F);if(D&&D[0]){return D[2]}return""},setStyle:function(F,G){function E(I,K){var J=new RegExp("(^|;)\\s*"+I+":([^;]+;?)","gi");H=H.replace(J,"$1");if(K){H=I+":"+p.unhtml(K)+";"+H}}var H=this.getAttr("style");if(!H){H=""}if(p.isObject(F)){for(var D in F){E(D,F[D])}}else{E(F,G)}this.setAttr("style",p.trim(H))},traversal:function(D){if(this.children&&this.children.length){r(this,D)}return this}}})();var a=UE.htmlparser=function(t,G){var A=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,F=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g;var z={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};t=t.replace(new RegExp(f.fillChar,"g"),"");if(!G){t=t.replace(new RegExp("[\\r\\t\\n"+(G?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(G?"":" ")+"]*","g"),function(K,J){if(J&&z[J.toLowerCase()]){return K.replace(/(^[\n\r]+)|([\n\r]+$)/g,"")}return K.replace(new RegExp("^[\\r\\n"+(G?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(G?"":" ")+"]+$"),"")})}var u=UE.uNode,C={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},D={ol:"li",ul:"li"};function B(K,L){if(D[K.tagName]){var J=u.createElement(D[K.tagName]);K.appendChild(J);J.appendChild(u.createText(L));K=J}else{K.appendChild(u.createText(L))}}function v(O,K,P){var J;if(J=C[K]){var L=O,R;while(L.type!="root"){if(p.isArray(J)?p.indexOf(J,L.tagName)!=-1:J==L.tagName){O=L;R=true;break}L=L.parentNode}if(!R){O=v(O,p.isArray(J)?J[0]:J)}}var N=new u({parentNode:O,type:"element",tagName:K.toLowerCase(),children:b.$empty[K]?null:[]});if(P){var Q={},M;while(M=F.exec(P)){Q[M[1].toLowerCase()]=p.unhtml(M[2]||M[3]||M[4])}N.attrs=Q}O.children.push(N);return b.$empty[K]?O:N}function s(J,K){J.children.push(new u({type:"comment",data:K,parentNode:J}))}var x,r=0,y=0;var E=new u({type:"root",children:[]});var I=E;while(x=A.exec(t)){r=x.index;try{if(r>y){B(I,t.slice(y,r))}if(x[3]){if(b.$cdata[I.tagName]){B(I,x[0])}else{I=v(I,x[3].toLowerCase(),x[4])}}else{if(x[1]){if(I.type!="root"){if(b.$cdata[I.tagName]&&!b.$cdata[x[1]]){B(I,x[0])}else{var w=I;while(I.type=="element"&&I.tagName!=x[1].toLowerCase()){I=I.parentNode;if(I.type=="root"){I=w;throw"break"}}I=I.parentNode}}}else{if(x[2]){s(I,x[2])}}}}catch(H){}y=A.lastIndex}if(y<t.length){B(I,t.slice(y))}return E};var l=UE.filterNode=function(){function r(v,C){switch(v.type){case"text":break;case"element":var t;if(t=C[v.tagName]){if(t==="-"){v.parentNode.removeChild(v)}else{if(p.isFunction(t)){var y=v.parentNode,z=v.getIndex();t(v);if(v.parentNode){if(v.children){for(var w=0,D;D=v.children[w];){r(D,C);if(D.parentNode){w++}}}}else{for(var w=z,D;D=y.children[w];){r(D,C);if(D.parentNode){w++}}}}else{var B=t["$"];if(B&&v.attrs){var u={},s;for(var A in B){s=v.getAttr(A);if(A=="style"&&p.isArray(B[A])){var x=[];p.each(B[A],function(E){var F;if(F=v.getStyle(E)){x.push(E+":"+F)}});s=x.join(";")}if(s){u[A]=s}}v.attrs=u}if(v.children){for(var w=0,D;D=v.children[w];){r(D,C);if(D.parentNode){w++}}}}}}else{if(b.$cdata[v.tagName]){v.parentNode.removeChild(v)}else{var y=v.parentNode,z=v.getIndex();v.parentNode.removeChild(v,true);for(var w=z,D;D=y.children[w];){r(D,C);if(D.parentNode){w++}}}}break;case"comment":v.parentNode.removeChild(v)}}return function(s,w){if(p.isEmptyObject(w)){return s}var v;if(v=w["-"]){p.each(v.split(" "),function(x){w[x]="-"})}for(var u=0,t;t=s.children[u];){r(t,w);if(t.parentNode){u++}}return s}}();UE.commands.inserthtml={execCommand:function(s,x,E){var J=this,z,A;if(!x){return}if(J.fireEvent("beforeinserthtml",x)===true){return}z=J.selection.getRange();A=z.document.createElement("div");A.style.display="inline";if(!E){var F=UE.htmlparser(x);if(J.options.filterRules){UE.filterNode(F,J.options.filterRules)}J.filterInputRule(F);x=F.toHtml()}A.innerHTML=p.trim(x);if(!z.collapsed){var I=z.startContainer;if(f.isFillChar(I)){z.setStartBefore(I)}I=z.endContainer;if(f.isFillChar(I)){z.setEndAfter(I)}z.txtToElmBoundary();if(z.endContainer&&z.endContainer.nodeType==1){I=z.endContainer.childNodes[z.endOffset];if(I&&f.isBr(I)){z.setEndAfter(I)}}if(z.startOffset==0){I=z.startContainer;if(f.isBoundaryNode(I,"firstChild")){I=z.endContainer;if(z.endOffset==(I.nodeType==3?I.nodeValue.length:I.childNodes.length)&&f.isBoundaryNode(I,"lastChild")){J.body.innerHTML="<p>"+(j.ie?"":"<br/>")+"</p>";z.setStart(J.body.firstChild,0).collapse(true)}}}!z.collapsed&&z.deleteContents();if(z.startContainer.nodeType==1){var v=z.startContainer.childNodes[z.startOffset],B;if(v&&f.isBlockElm(v)&&(B=v.previousSibling)&&f.isBlockElm(B)){z.setEnd(B,B.childNodes.length).collapse();while(v.firstChild){B.appendChild(v.firstChild)}f.remove(v)}}}var v,w,B,H,u=0,r;if(z.inFillChar()){v=z.startContainer;if(f.isFillChar(v)){z.setStartBefore(v).collapse(true);f.remove(v)}else{if(f.isFillChar(v,true)){v.nodeValue=v.nodeValue.replace(q,"");z.startOffset--;z.collapsed&&z.collapse(true)}}}while(v=A.firstChild){if(u){var C=J.document.createElement("p");while(v&&(v.nodeType==3||!b.$block[v.tagName])){r=v.nextSibling;C.appendChild(v);v=r}if(C.firstChild){v=C}}z.insertNode(v);r=v.nextSibling;if(!u&&v.nodeType==f.NODE_ELEMENT&&f.isBlockElm(v)){w=f.findParent(v,function(K){return f.isBlockElm(K)});if(w&&w.tagName.toLowerCase()!="body"&&!(b[w.tagName][v.nodeName]&&v.parentNode===w)){if(!b[w.tagName][v.nodeName]){B=w}else{H=v.parentNode;while(H!==w){B=H;H=H.parentNode}}f.breakParent(v,B||H);var B=v.previousSibling;f.trimWhiteTextNode(B);if(!B.childNodes.length){f.remove(B)}if(!j.ie&&(D=v.nextSibling)&&f.isBlockElm(D)&&D.lastChild&&!f.isBr(D.lastChild)){D.appendChild(J.document.createElement("br"))}u=1}}var D=v.nextSibling;if(!A.firstChild&&D&&f.isBlockElm(D)){z.setStart(D,0).collapse(true);break}z.setEndAfter(v).collapse()}v=z.startContainer;if(r&&f.isBr(r)){f.remove(r)}if(f.isBlockElm(v)&&f.isEmptyNode(v)){if(r=v.nextSibling){f.remove(v);if(r.nodeType==1&&b.$block[r.tagName]){z.setStart(r,0).collapse(true).shrinkBoundary()}}else{try{v.innerHTML=j.ie?f.fillChar:"<br/>"}catch(G){z.setStartBefore(v);f.remove(v)}}}try{if(j.ie9below&&z.startContainer.nodeType==1&&!z.startContainer.childNodes[z.startOffset]){var t=z.startContainer,B=t.childNodes[z.startOffset-1];if(B&&B.nodeType==1&&b.$empty[B.tagName]){var y=this.document.createTextNode(f.fillChar);z.insertNode(y).setStart(y,0).collapse(true)}}z.select(true)}catch(G){}setTimeout(function(){z=J.selection.getRange();z.scrollIntoView();J.fireEvent("afterinserthtml")},200)}};UE.plugins.undo=function(){var u;var D=this,G=D.options.maxUndoCount||20,C=D.options.maxInputCount||20,x=new RegExp(f.fillChar+"|</hr>","gi");var z={ol:1,ul:1,table:1,tbody:1,tr:1,body:1};var v=D.options.autoClearEmptyNode;function A(K,J){if(K.length!=J.length){return 0}for(var I=0,H=K.length;I<H;I++){if(K[I]!=J[I]){return 0}}return 1}function E(I,H){if(I.collapsed!=H.collapsed){return 0}if(!A(I.startAddress,H.startAddress)||!A(I.endAddress,H.endAddress)){return 0}return 1}function s(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var K=this.editor;var M=this.list[this.index];var I=UE.htmlparser(M.content.replace(x,""));K.options.autoClearEmptyNode=false;K.filterInputRule(I,true);K.options.autoClearEmptyNode=v;K.body.innerHTML=I.toHtml();K.fireEvent("afterscencerestore");if(j.ie){p.each(f.getElementsByTagName(K.document,"td th caption p"),function(N){if(f.isEmptyNode(N)){f.fillNode(K.document,N)}})}try{var H=new g.Range(K.document,K.body).moveToAddress(M.address);if(j.ie&&H.collapsed&&H.startContainer.nodeType==1){var J=H.startContainer.childNodes[H.startOffset];if(!J||J.nodeType==1&&b.$empty[J]){H.insertNode(K.document.createTextNode(" ")).collapse(true)}}H.select(z[H.startContainer.nodeName.toLowerCase()])}catch(L){}this.update();this.clearKey();K.fireEvent("reset",true)};this.getScene=function(){var K=this.editor;var J=K.selection.getRange(),L=J.createAddress(false,true);K.fireEvent("beforegetscene");var I=UE.htmlparser(K.body.innerHTML,true);K.options.autoClearEmptyNode=false;K.filterOutputRule(I,true);K.options.autoClearEmptyNode=v;var H=I.toHtml();j.ie&&(H=H.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">"));K.fireEvent("aftergetscene");return{address:L,content:H}};this.save=function(K,H){clearTimeout(u);var J=this.getScene(H),I=this.list[this.index];if(I&&I.content==J.content&&(K?1:E(I.address,J.address))){return}this.list=this.list.slice(0,this.index+1);this.list.push(J);if(this.list.length>G){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){y=0;r=null}}D.undoManger=new s();D.undoManger.editor=D;function B(){this.undoManger.save()}D.addListener("saveScene",function(){var H=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,H)});D.addListener("beforeexeccommand",B);D.addListener("afterexeccommand",B);D.addListener("reset",function(I,H){if(!H){this.undoManger.reset()}});D.commands.redo=D.commands.undo={execCommand:function(H){this.undoManger[H]()},queryCommandState:function(H){return this.undoManger["has"+(H.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var F={16:1,17:1,18:1,37:1,38:1,39:1,40:1},y=0,r;var t=false;D.addListener("ready",function(){f.on(this.body,"compositionstart",function(){t=true});f.on(this.body,"compositionend",function(){t=false})});D.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89,shift+ctrl+z"});var w=true;D.addListener("keydown",function(I,H){var K=this;var L=H.keyCode||H.which;if(!F[L]&&!H.ctrlKey&&!H.metaKey&&!H.shiftKey&&!H.altKey){if(t){return}if(!K.selection.getRange().collapsed){K.undoManger.save(false,true);w=false;return}if(K.undoManger.list.length==0){K.undoManger.save(true)}clearTimeout(u);function J(M){if(M.selection.getRange().collapsed){M.fireEvent("contentchange")}M.undoManger.save(false,true);M.fireEvent("selectionchange")}u=setTimeout(function(){if(t){var M=setInterval(function(){if(!t){J(K);clearInterval(M)}},300);return}J(K)},200);r=L;y++;if(y>=C){J(K)}}});D.addListener("keyup",function(I,H){var J=H.keyCode||H.which;if(!F[J]&&!H.ctrlKey&&!H.metaKey&&!H.shiftKey&&!H.altKey){if(t){return}if(!w){this.undoManger.save(false,true);w=true}}})};UE.plugins.paste=function(){function s(y){var w=this.document;if(w.getElementById("baidu_pastebin")){return}var v=this.selection.getRange(),u=v.createBookmark(),x=w.createElement("div");x.id="baidu_pastebin";j.webkit&&x.appendChild(w.createTextNode(f.fillChar+f.fillChar));this.body.appendChild(x);u.start.style.display="";x.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+$(u.start).position().top+"px";v.selectNodeContents(x).select(true);setTimeout(function(){if(j.webkit){for(var z=0,A=w.querySelectorAll("#baidu_pastebin"),C;C=A[z++];){if(f.isEmptyNode(C)){f.remove(C)}else{x=C;break}}}try{x.parentNode.removeChild(x)}catch(B){}v.moveToBookmark(u).select(true);y(x)},0)}var t=this;function r(u){var z;if(u.firstChild){var v=f.getElementsByTagName(u,"span");for(var y=0,w;w=v[y++];){if(w.id=="_baidu_cut_start"||w.id=="_baidu_cut_end"){f.remove(w)}}if(j.webkit){var D=u.querySelectorAll("div br");for(var y=0,x;x=D[y++];){var E=x.parentNode;if(E.tagName=="DIV"&&E.childNodes.length==1){E.innerHTML="<p><br/></p>";f.remove(E)}}var F=u.querySelectorAll("#baidu_pastebin");for(var y=0,C;C=F[y++];){var K=t.document.createElement("p");C.parentNode.insertBefore(K,C);while(C.firstChild){K.appendChild(C.firstChild)}f.remove(C)}var B=u.querySelectorAll("meta");for(var y=0,J;J=B[y++];){f.remove(J)}var D=u.querySelectorAll("br");for(y=0;J=D[y++];){if(/^apple-/i.test(J.className)){f.remove(J)}}}if(j.gecko){var I=u.querySelectorAll("[_moz_dirty]");for(y=0;J=I[y++];){J.removeAttribute("_moz_dirty")}}if(!j.ie){var A=u.querySelectorAll("span.Apple-style-span");for(var y=0,J;J=A[y++];){f.remove(J,true)}}z=u.innerHTML;z=UE.filterWord(z);var G=UE.htmlparser(z);if(t.options.filterRules){UE.filterNode(G,t.options.filterRules)}t.filterInputRule(G);if(j.webkit){var H=G.lastChild();if(H&&H.type=="element"&&H.tagName=="br"){G.removeChild(H)}p.each(t.body.querySelectorAll("div"),function(L){if(f.isEmptyBlock(L)){f.remove(L)}})}z={html:G.toHtml()};t.fireEvent("beforepaste",z,G);if(!z.html){return}t.execCommand("insertHtml",z.html,true);t.fireEvent("afterpaste",z)}}t.addListener("ready",function(){f.on(t.body,"cut",function(){var u=t.selection.getRange();if(!u.collapsed&&t.undoManger){t.undoManger.save()}});f.on(t.body,j.ie||j.opera?"keydown":"paste",function(u){if((j.ie||j.opera)&&((!u.ctrlKey&&!u.metaKey)||u.keyCode!="86")){return}s.call(t,function(v){r(v)})})})};UE.plugins.enterkey=function(){var s,t=this,r=t.options.enterTag;t.addListener("keyup",function(B,C){var D=C.keyCode||C.which;if(D==13){var A=t.selection.getRange(),x=A.startContainer,u;if(!j.ie){if(/h\d/i.test(s)){if(j.gecko){var z=f.findParentByTagName(x,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true);if(!z){t.document.execCommand("formatBlock",false,"<p>");u=1}}else{if(x.nodeType==1){var y=t.document.createTextNode(""),v;A.insertNode(y);v=f.findParentByTagName(y,"div",true);if(v){var w=t.document.createElement("p");while(v.firstChild){w.appendChild(v.firstChild)}v.parentNode.insertBefore(w,v);f.remove(v);A.setStartBefore(y).setCursor();u=1}f.remove(y)}}if(t.undoManger&&u){t.undoManger.save()}}j.opera&&A.select()}else{t.fireEvent("saveScene",true,true)}}});t.addListener("keydown",function(y,w){var z=w.keyCode||w.which;if(z==13){if(t.fireEvent("beforeenterkeydown")){f.preventDefault(w);return}t.fireEvent("saveScene",true,true);s="";var x=t.selection.getRange();if(!x.collapsed){var B=x.startContainer,v=x.endContainer,u=f.findParentByTagName(B,"td",true),A=f.findParentByTagName(v,"td",true);if(u&&A&&u!==A||!u&&A||u&&!A){w.preventDefault?w.preventDefault():(w.returnValue=false);return}}if(r=="p"){if(!j.ie){B=f.findParentByTagName(x.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!B&&!j.opera){t.document.execCommand("formatBlock",false,"<p>");if(j.gecko){x=t.selection.getRange();B=f.findParentByTagName(x.startContainer,"p",true);B&&f.removeDirtyAttr(B)}}else{s=B.tagName;B.tagName.toLowerCase()=="p"&&j.gecko&&f.removeDirtyAttr(B)}}}}})};UE.plugins.selectall=function(){var r=this;r.commands.selectall={execCommand:function(){var u=this,s=u.body,t=u.selection.getRange();t.selectNodeContents(s);if(f.isEmptyBlock(s)){if(j.opera&&s.firstChild&&s.firstChild.nodeType==1){t.setStartAtFirst(s.firstChild)}t.collapse(true)}t.select(true)},notNeedUndo:1};r.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins.keystrokes=function(){var r=this;var s=true;r.addListener("keydown",function(z,B){var C=B.keyCode||B.which,t=r.selection.getRange();if(!t.collapsed&&!(B.ctrlKey||B.shiftKey||B.altKey||B.metaKey)&&(C>=65&&C<=90||C>=48&&C<=57||C>=96&&C<=111||{13:1,8:1,46:1}[C])){var w=t.startContainer;if(f.isFillChar(w)){t.setStartBefore(w)}w=t.endContainer;if(f.isFillChar(w)){t.setEndAfter(w)}t.txtToElmBoundary();if(t.endContainer&&t.endContainer.nodeType==1){w=t.endContainer.childNodes[t.endOffset];if(w&&f.isBr(w)){t.setEndAfter(w)}}if(t.startOffset==0){w=t.startContainer;if(f.isBoundaryNode(w,"firstChild")){w=t.endContainer;if(t.endOffset==(w.nodeType==3?w.nodeValue.length:w.childNodes.length)&&f.isBoundaryNode(w,"lastChild")){r.fireEvent("saveScene");r.body.innerHTML="<p>"+(j.ie?"":"<br/>")+"</p>";t.setStart(r.body.firstChild,0).setCursor(false,true);r._selectionChange();return}}}}if(C==8){t=r.selection.getRange();s=t.collapsed;if(r.fireEvent("delkeydown",B)){return}var u,x;if(t.collapsed&&t.inFillChar()){u=t.startContainer;if(f.isFillChar(u)){t.setStartBefore(u).shrinkBoundary(true).collapse(true);f.remove(u)}else{u.nodeValue=u.nodeValue.replace(new RegExp("^"+f.fillChar),"");t.startOffset--;t.collapse(true).select(true)}}if(u=t.getClosedNode()){r.fireEvent("saveScene");t.setStartBefore(u);f.remove(u);t.setCursor();r.fireEvent("saveScene");f.preventDefault(B);return}if(!j.ie){u=f.findParentByTagName(t.startContainer,"table",true);x=f.findParentByTagName(t.endContainer,"table",true);if(u&&!x||!u&&x||u!==x){B.preventDefault();return}}u=t.startContainer;if(t.collapsed&&u.nodeType==1){var v=u.childNodes[t.startOffset-1];if(v&&v.nodeType==1&&v.tagName=="BR"){r.fireEvent("saveScene");t.setStartBefore(v).collapse(true);f.remove(v);t.select();r.fireEvent("saveScene")}}}if(j.gecko&&C==46){var y=r.selection.getRange();if(y.collapsed){u=y.startContainer;if(f.isEmptyBlock(u)){var A=u.parentNode;while(f.getChildCount(A)==1&&!f.isBody(A)){u=A;A=A.parentNode}if(u===A.lastChild){B.preventDefault()}return}}}});r.addListener("keyup",function(y,A){var C=A.keyCode||A.which,t,x=this;if(C==8){if(x.fireEvent("delkeyup")){return}t=x.selection.getRange();if(t.collapsed){var u,B=["h1","h2","h3","h4","h5","h6"];if(u=f.findParentByTagName(t.startContainer,B,true)){if(f.isEmptyBlock(u)){var v=u.previousSibling;if(v&&v.nodeName!="TABLE"){f.remove(u);t.setStartAtLast(v).setCursor(false,true);return}else{var w=u.nextSibling;if(w&&w.nodeName!="TABLE"){f.remove(u);t.setStartAtFirst(w).setCursor(false,true);return}}}}if(f.isBody(t.startContainer)){var u=f.createElement(x.document,"p",{innerHTML:j.ie?f.fillChar:"<br/>"});t.insertNode(u).setStart(u,0).setCursor(false,true)}}if(!s&&(t.startContainer.nodeType==3||t.startContainer.nodeType==1&&f.isEmptyBlock(t.startContainer))){if(j.ie){var z=t.document.createElement("span");t.insertNode(z).setStartBefore(z).collapse(true);t.select();f.remove(z)}else{t.select()}}}})};UE.plugins.fiximgclick=function(){var r=this;if(j.webkit){r.addListener("click",function(t,u){if(u.target.tagName=="IMG"){var s=new g.Range(r.document);s.selectNode(u.target).select()}})}};(function(x){x.parseTmpl=function y(C,B){var z="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+C.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(D,E){return"',"+E.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(D,E){return"');"+E.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var A=new Function("obj",z);return B?A(B):A};x.extend2=function(E,F){var B=arguments,G=x.type(B[B.length-1])=="boolean"?B[B.length-1]:false,A=x.type(B[B.length-1])=="boolean"?B.length-1:B.length;for(var D=1;D<A;D++){var z=B[D];for(var C in z){if(!G||!E.hasOwnProperty(C)){E[C]=z[C]}}}return E};x.IE6=!!window.ActiveXObject&&parseFloat(navigator.userAgent.match(/msie (\d+)/i)[1])==6;var v=[];var s=function(){};var r="edui";s.prototype={on:function(A,z){this.root().on(A,x.proxy(z,this));return this},off:function(A,z){this.root().off(A,x.proxy(z,this));return this},trigger:function(z,A){return this.root().trigger(z,A)===false?false:this},root:function(z){return this._$el||(this._$el=z)},destroy:function(){},data:function(z,A){if(A!==undefined){this.root().data(r+z,A);return this}else{return this.root().data(r+z)}},register:function(z,A,B){v.push({evtname:z,"$els":x.isArray(A)?A:[A],handler:x.proxy(B,A)})}};x.fn.edui=function(z){return z?this.data("eduiwidget",z):this.data("eduiwidget")};function u(D,A,C){D.prototype=x.extend2(x.extend({},A),(UE.ui[C]||s).prototype,true);D.prototype.supper=(UE.ui[C]||s).prototype;if(UE.ui[C]&&UE.ui[C].prototype.defaultOpt){var z=UE.ui[C].prototype.defaultOpt,B=D.prototype.defaultOpt;D.prototype.defaultOpt=x.extend({},z,B||{})}return D}var t=1;function w(A,z){x[r+z]=A;x.fn[r+z]=function(D){var B,C=Array.prototype.slice.call(arguments,1);this.each(function(E,F){var H=x(F);var G=H.edui();if(!G){A(!D||!x.isPlainObject(D)?{}:D,H);H.edui(G)}if(x.type(D)=="string"){if(D=="this"){B=G}else{B=G[D].apply(G,C);if(B!==G&&B!==undefined){return false}B=null}}});return B!==null?B:this}}UE.ui={define:function(A,z,C){var B=UE.ui[A]=u(function(D,E){var H=function(){};x.extend(H.prototype,B.prototype,{guid:A+t++,widgetName:A});var G=new H;if(x.type(D)=="string"){G.init&&G.init({});G.root().edui(G);G.root().find("a").click(function(I){I.preventDefault()});return G.root()[r+A].apply(G.root(),arguments)}else{E&&G.root(E);G.init&&G.init(!D||x.isPlainObject(D)?x.extend2(D||{},G.defaultOpt||{},true):D);try{G.root().find("a").click(function(I){I.preventDefault()})}catch(F){}return G.root().edui(G)}},z,C);w(B,A)}};x(function(){x(document).on("click mouseup mousedown dblclickc mouseover",function(z){x.each(v,function(A,B){if(B.evtname==z.type){x.each(B.$els,function(D,C){if(C[0]!==z.target&&!x.contains(C[0],z.target)){B.handler(z)}})}})})})})(jQuery);UE.ui.define("button",{tpl:'<<%if(!texttype){%>div class="edui-btn edui-btn-<%=icon%> <%if(name){%>edui-btn-name-<%=name%><%}%>" unselectable="on" onmousedown="return false" <%}else{%>a class="edui-text-btn"<%}%><% if(title) {%> data-original-title="<%=title%>" <%};%>> <% if(icon) {%><div unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><% }; %><%if(text) {%><span unselectable="on" onmousedown="return false" class="edui-button-label"><%=text%></span><%}%><%if(caret && text){%><span class="edui-button-spacing"></span><%}%><% if(caret) {%><span unselectable="on" onmousedown="return false" class="edui-caret"></span><% };%></<%if(!texttype){%>div<%}else{%>a<%}%>>',defaultOpt:{text:"",title:"",icon:"",width:"",caret:false,texttype:false,click:function(){}},init:function(r){var s=this;s.root($($.parseTmpl(s.tpl,r))).click(function(t){s.wrapclick(r.click,t)});s.root().hover(function(){if(!s.root().hasClass("disabled")){s.root().toggleClass("hover")}});return s},wrapclick:function(s,r){if(!this.disabled()){this.root().trigger("wrapclick");$.proxy(s,this,r)()}return this},label:function(r){if(r===undefined){return this.root().find(".edui-button-label").text()}else{this.root().find(".edui-button-label").text(r);return this}},disabled:function(r){if(r===undefined){return this.root().hasClass("disabled")}this.root().toggleClass("disabled",r);return this},active:function(r){if(r===undefined){return this.root().hasClass("active")}this.root().toggleClass("active",r);return this},mergeWith:function(s){var r=this;r.data("$mergeObj",s);s.edui().data("$mergeObj",r.root());if(!$.contains(document.body,s[0])){s.appendTo(r.root())}r.on("click",function(){r.wrapclick(function(){s.edui().show()})}).register("click",r.root(),function(t){s.hide()})}});(function(){UE.ui.define("toolbar",{tpl:'<div class="edui-toolbar"  ><div class="edui-btn-toolbar" unselectable="on" onmousedown="return false"  ></div></div>',init:function(){var r=this.root($(this.tpl));this.data("$btnToolbar",r.find(".edui-btn-toolbar"))},appendToBtnmenu:function(s){var r=this.data("$btnToolbar");s=$.isArray(s)?s:[s];$.each(s,function(u,t){r.append(t)})}})})();UE.ui.define("popup",{tpl:'<div class="edui-dropdown-menu edui-popup"<%if(!<%=stopprop%>){%>onmousedown="return false"<%}%>><div class="edui-popup-body"><%=subtpl%></div><div class="edui-popup-caret"></div></div>',defaultOpt:{stopprop:false,subtpl:"",width:"",height:""},init:function(r){this.root($($.parseTmpl(this.tpl,r)));return this},mergeTpl:function(r){return $.parseTmpl(this.tpl,{subtpl:r})},show:function(t,s){if(!s){s={}}var r=s.fnname||"position";if(this.trigger("beforeshow")===false){return}else{this.root().css($.extend({display:"block"},t?{top:t[r]().top+(s.dir=="right"?0:t.outerHeight())-(s.offsetTop||0),left:t[r]().left+(s.dir=="right"?t.outerWidth():0)-(s.offsetLeft||0),position:"absolute"}:{}));this.root().find(".edui-popup-caret").css({top:s.caretTop||0,left:s.caretLeft||0,position:"absolute"}).addClass(s.caretDir||"up")}this.trigger("aftershow")},hide:function(){this.root().css("display","none");this.trigger("afterhide")},attachTo:function(t,s){var r=this;if(!t.data("$mergeObj")){t.data("$mergeObj",r.root());t.on("wrapclick",function(u){r.show(t,s)});r.register("click",t,function(u){r.hide()});r.data("$mergeObj",t)}},getBodyContainer:function(){return this.root().find(".edui-popup-body")}});(function(){var r={},t={},s=[],u=null,x=null,v={},w={};p.extend(UE,{registerUI:function(y,z){p.each(y.split(/\s+/),function(A){r[A]=z})},getWidgetCallback:function(y){return w[y]},registerWidget:function(z,A,y){v[z]=$.extend2(A,{$root:null,_preventDefault:false,root:function(B){return this.$root||(this.$root=B)},preventDefault:function(){this._preventDefault=true},clear:false});if(y){w[z]=y}},getWidgetData:function(y){return v[y]},setWidgetBody:function(z,C,A){var B=v[z];if(!B){return null}B.root(C.edui().getBodyContainer());B.initContent(A,C);if(!B._preventDefault){B.initEvent(A,C)}B.width&&C.width(B.width);var y=w[z];if(y&&!y.init){w[z]=function(){var D=Array.prototype.slice.call(arguments,0);y.apply(A,[A,C].concat(D))};w[z].init=true}},getUI:function(z,y,A){if(r[y]){return $.proxy(r[y],z,y,A)()}return null},setActiveEditor:function(y){u=y},getActiveEditor:function(A){var y;p.each(UE.instants,function(B){if(B.selection.isFocus()){y=B;return false}});if(y){return y}var z=A.parents(".edui-container");if(u){if(z[0]===u.container){return u}}$.each(t,function(C,B){if(B.container===z[0]){y=B;return false}});return y},setActiveWidget:function(y){x=y},getActiveWidget:function(){return x},getEditor:function(z,y){return t[z]||(t[z]=this.createEditor(z,y))},clearCache:function(y){if(t[y]){delete t[y]}},delEditor:function(z){var y;if(y=t[z]){y.key&&y.destroy()}},ready:function(y){s.push(y)},createEditor:function(C,z){var B=new UE.Editor(z);var y=this;B.langIsReady?$.proxy(A,y)():B.addListener("langReady",$.proxy(A,y));function A(){var E=this.createUI("#"+C,B);B.key=C;B.ready(function(){$.each(s,function(F,G){$.proxy(G,B)()})});var D=B.options;if(D.initialFrameWidth){D.minFrameWidth=D.initialFrameWidth}else{D.minFrameWidth=D.initialFrameWidth=B.$body.width()}E.css({width:D.initialFrameWidth,zIndex:B.getOpt("zIndex")});UE.browser.ie&&UE.browser.version===6&&E[0].ownerDocument.execCommand("BackgroundImageCache",false,true);B.render(C);$.eduitooltip&&$.eduitooltip("attachTo").css("z-index",B.getOpt("zIndex")+1);E.find("a").click(function(F){F.preventDefault()});B.fireEvent("afteruiready")}return B},createUI:function(C,A){var z=$(C),B=$('<div class="edui-container"><div class="edui-editor-body"></div></div>').insertBefore(z);A.$container=B;A.container=B[0];A.$body=z;if(j.ie&&j.ie9above){var y=$('<span style="padding:0;margin:0;height:0;width:0"></span>');y.insertAfter(B)}B.find(".edui-editor-body").append(z).before(this.createToolbar(A.options,A));B.find(".edui-toolbar").append($('<div class="edui-dialog-container"></div>'));return B},createToolbar:function(z,A){var D=this;var y=$.eduitoolbar(),C=y.edui();if(z.toolbar&&z.toolbar.length){var B=[];$.each(z.toolbar,function(E,F){$.each(F.split(/\s+/),function(H,G){if(G=="|"){$.eduiseparator&&B.push($.eduiseparator())}else{var I=D.getUI(A,G);if(G=="fullscreen"){I&&B.unshift(I)}else{I&&B.push(I)}}});B.length&&C.appendToBtnmenu(B)})}else{y.find(".edui-btn-toolbar").remove()}return y}})})();UE.ready(function(){var H=this,I=H.getLang();H.setOpt({topOffset:0});var D=H.options.autoFloatEnabled!==false,B=H.options.topOffset;if(!D){return}var x=j.ie&&j.version<=6,C=j.quirks;function r(){if(!UE.ui){alert(I.autofloatMsg);return 0}return 1}function y(){var J=document.body.style;J.backgroundImage='url("about:blank")';J.backgroundAttachment="fixed"}var z,E=document.createElement("div"),v,u,G=function(J){var N;try{N=J.getBoundingClientRect()}catch(M){N={left:0,top:0,height:0,width:0}}var K={left:Math.round(N.left),top:Math.round(N.top),height:Math.round(N.bottom-N.top),width:Math.round(N.right-N.left)};var L;while((L=J.ownerDocument)!==document&&(J=f.getWindow(L).frameElement)){N=J.getBoundingClientRect();K.left+=N.left;K.top+=N.top}K.bottom=K.top+K.height;K.right=K.left+K.width;return K};var t=false;function A(){if(t){return}var K=f.getXY(v),J=f.getComputedStyle(v,"position"),L=f.getComputedStyle(v,"left");v.style.width=v.offsetWidth+"px";v.style.zIndex=H.options.zIndex*1+1;$(v).addClass("edui-toolbar-floating");v.parentNode.insertBefore(E,v);if(x||(C&&j.ie)){if(v.style.position!="absolute"){v.style.position="absolute"}v.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-u+B+"px"}else{if(v.style.position!="fixed"){v.style.position="fixed";v.style.top=B+"px";((J=="absolute"||J=="relative")&&parseFloat(L))&&(v.style.left=K.x+"px")}}}function w(){if(E.parentNode){E.parentNode.removeChild(E)}v.style.cssText=z;$(v).removeClass("edui-toolbar-floating")}function s(){var J=G(H.container);var K=H.options.topOffset||0;var L=H.options.toolbarTopOffset||0;if((J.top-K)<0&&J.bottom-v.offsetHeight>L){A()}else{w()}}var F=p.defer(function(){s()},j.ie?200:100,true);H.addListener("destroy",function(){f.un(window,["scroll","resize"],s);H.removeListener("keydown",F)});if(r(H)){v=$(".edui-toolbar",H.container)[0];H.addListener("afteruiready",function(){setTimeout(function(){u=$(v).offset().top},100)});z=v.style.cssText;E.style.height=v.offsetHeight+"px";if(x){y()}f.on(window,["scroll","resize"],s);H.addListener("keydown",F);H.addListener("beforefullscreenchange",function(K,J){if(J){w();t=J}});H.addListener("fullscreenchanged",function(K,J){if(!J){s()}t=J});H.addListener("sourcemodechanged",function(K,J){setTimeout(function(){s()},0)});H.addListener("clearDoc",function(){setTimeout(function(){s()},0)})}})})();;(function(){var a=window.UEDITOR_HOME_URL||(function(){function c(){this.documentURL=self.document.URL||self.location.href;this.separator="/";this.separatorPattern=/\\|\//g;this.currentDir="./";this.currentDirPattern=/^[.]\/]/;this.path=this.documentURL;this.stack=[];this.push(this.documentURL)}c.isParentPath=function(f){return f===".."};c.hasProtocol=function(f){return !!c.getProtocol(f)};c.getProtocol=function(f){var g=/^[^:]*:\/*/.exec(f);return g?g[0]:null};c.prototype={push:function(f){this.path=f;e.call(this);d.call(this);return this},getPath:function(){return this+""},toString:function(){return this.protocol+(this.stack.concat([""])).join(this.separator)}};function e(){var f=c.getProtocol(this.path||"");if(f){this.protocol=f;this.localSeparator=/\\|\//.exec(this.path.replace(f,""))[0];this.stack=[]}else{f=/\\|\//.exec(this.path);f&&(this.localSeparator=f[0])}}function d(){var j=this.path.replace(this.currentDirPattern,"");if(c.hasProtocol(this.path)){j=j.replace(this.protocol,"")}j=j.split(this.localSeparator);j.length=j.length-1;for(var h=0,k,g=j.length,f=this.stack;h<g;h++){k=j[h];if(k){if(c.isParentPath(k)){f.pop()}else{f.push(k)}}}}var b=document.getElementsByTagName("script");b=b[b.length-1].src;return new c().push(b)+""})();window.UEDITOR_CONFIG={UEDITOR_HOME_URL:a,imageUrl:a+"php/imageUp.php",imagePath:a+"php/",toolbar:["bold","red","medal","image","video","music","emotion","scrawl","attachment","voice"],zIndex:0,initialStyle:".edui-editor-body .edui-body-container p{margin:5px 0;} .edui-editor-body .edui-body-container{border:1px solid #ccc; border-left-color: #9a9a9a; border-top-color: #9a9a9a; outline:none;padding:0 10px 0;word-wrap:break-word;font-size:14px;}.edui-editor-body.focus{border:1px solid #5c9dff}",excludePlugins:"medal",maxUndoCount:21,autoFloatEnabled:false,filterRules:(function(){return{img:function(c){var d=560;var b=c.getAttr("class");if(b=="BDE_Music"||b=="BDE_Flash"||b=="BDE_Colorful"){}else{var e=c.getAttr("src");if(/^file:\/\//.test(e)||/^data:/.test(e)){c.parentNode.removeChild(c)}else{if(!/\.(jpg|jpeg|gif|png|bmp)/.test(e)){e+=".gif"}c.setAttr("");c.setAttr("pic_type",1);c.setAttr("src",e);c.setAttr("class",b=="BDE_Smiley"?b:"BDE_Image");c.setAttr("onload","EditorUI.resizeImage(this, "+d+")")}}c.setAttr("unselectable","on")},p:{$:{}},br:{$:{}},li:function(b){b.tagName="p";b.setAttr()},tr:function(b){b.tagName="p";b.setAttr()},th:function(b){b.tagName="span";b.setAttr();b.innerHTML(b.innerText()+"&nbsp;")},td:function(b){b.tagName="span";b.setAttr();b.innerHTML(b.innerText()+"&nbsp;")},"-":"script style meta iframe object"}})()}})();;UE.I18N["zh-cn"]={labelMap:{image:"\u56fe\u7247",video:"\u89c6\u9891",music:"\u97f3\u4e50",emotion:"\u8868\u60c5",scrawl:" \u6d82\u9e26",attachment:"\u9644\u4ef6"}};;(function(c){var b={modelFactories:{},layerFactories:{},registerModel:function(e,d){this.modelFactories[e]=d},getModel:function(e){var d=this.modelFactories[e];if(d){return d.call(this,PosterContext.getContext(),PosterContext.getAuthorities())}else{throw"No such model factory: "+e}},registerLayer:function(e,d){this.layerFactories[e]=d},bindLayer:function(f,e){var d=this.layerFactories[f];if(d){return d.call(this,e,PosterContext.getContext(),PosterContext.getAuthorities())}else{throw"No such layer factory: "+f}}};var a=function(){};a.prototype={data:{},eventPool:$({}),getButton:function(){return this.$button},setButton:function(d){this.$button=d},getWidget:function(){return this.$widget},setWidget:function(d){this.$widget=d},setValue:function(d,e){this.data[d]=e},getValue:function(d){return this.data[d]},bind:function(){this.eventPool.bind.apply(this.eventPool,arguments)},trigger:function(){this.eventPool.trigger.call(this.eventPool,arguments[0],Array.prototype.slice.call(arguments,1))}};b.EditorModel=a;b.resizeImage=function(d,e){if(d.width>e){d.height=d.height/d.width*e;d.width=e}else{d.height=d.height;d.width=d.width}d.onload=null};c.EditorUI=b})(window);;UE.plugins.extendcontent=function(){var c=this;var a=c.getExtendContent&&c.getExtendContent;c.getExtendContent=function(){return a?a():{}};var b=c.getContent;c.getContent=function(){var d=b.call(this);return d.replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/(^(<br\/>)+)|((<br\/>)+$)/g,"")};c.addListener("focus",function(){c.$body.addClass("body-container-focus")});c.addListener("blur",function(){c.$body.removeClass("body-container-focus")})};UE.plugins.basicrules=function(){var a=this;a.addOutputRule(function(b){$.each(b.getNodesByTagName("p"),function(c,d){d.tagName="br"})},true)};UE.plugins.eduilastbtn=function(){var a=this;a.ready(function(){$("#tb_rich_poster_container").find(".edui-btn").filter(function(b){return $(this).css("display")!="none"}).last().addClass("edui-last-btn")})};;UE.plugins.autolink=function(){var a=function(c){var e=String.prototype.split,d=/()??/.exec("")[1]===c,b;b=function(n,k,j){if(Object.prototype.toString.call(k)!=="[object RegExp]"){return e.call(n,k,j)}var h=[],i=(k.ignoreCase?"i":"")+(k.multiline?"m":"")+(k.extended?"x":"")+(k.sticky?"y":""),f=0,k=new RegExp(k.source,i+"g"),g,l,m,o;n+="";if(!d){g=new RegExp("^"+k.source+"$(?!\\s)",i)}j=j===c?-1>>>0:j>>>0;while(l=k.exec(n)){m=l.index+l[0].length;if(m>f){h.push(n.slice(f,l.index));if(!d&&l.length>1){l[0].replace(g,function(){for(var p=1;p<arguments.length-2;p++){if(arguments[p]===c){l[p]=c}}})}if(l.length>1&&l.index<n.length){Array.prototype.push.apply(h,l.slice(1))}o=l[0].length;f=m;if(h.length>=j){break}}if(k.lastIndex===l.index){k.lastIndex++}}if(f===n.length){if(o||!k.test("")){h.push("")}}else{h.push(n.slice(f))}return h.length>j?h.slice(0,j):h};String.prototype.split=function(g,f){return b(this,g,f)};return b}();this.addOutputRule(function(h){$.each(h.getNodesByTagName("a"),function(i,l){var n=l.innerText();if(!/^\w+:\/\//.test(n)){n="http://"+n}l.setAttr("href",n);l.setAttr("target","_blank")});var g=[];h.traversal(function(i){if(i.type=="text"&&i.parentNode.tagName!="a"){g.push(i)}});for(var b=0,c;c=g[b];b++){var o=c.getData().replace(/&#39;/g,"'").replace(/&quot;/g,'"');var m=a(o,/((?:www\.|http:\/\/|mms:\/\/|rtsp:\/\/|ftp:\/\/|https:\/\/)[0-9a-zA-Z;\.\!\~\#\?\:\/\&\%\-\+\*\=\@\_\$]+)/gi);if(m.length>1){var k=c.parentNode;for(var f=0,d=m.length;f<d;f++){var e=m[f];if(e.length>0){var j;if(f%2==0){j=UE.uNode.createText(e)}else{j=UE.uNode.createElement("a");if(/^\w+:\/\//.test(e)){j.setAttr("href",e)}else{j.setAttr("href","http://"+e)}j.setAttr("target","_blank");j.innerText(e)}k.insertBefore(j,c)}}k.removeChild(c)}}$.each(h.getNodesByTagName("a"),function(n,l){l.setAttr("href",UE.utils.unhtml(l.getAttr("href")))})},true)};;EditorUI.registerLayer("image",function(a,b,f){var c=['<ul class="layer_btn_list clearfix">','<li class="from_upload" ><a class="pic_upload_container" href="javascript: void(0);"></a><a href="#"></a></li>','<li class="from_album"><a href="#"></a></li>','<li class="from_web"><a href="#"></a></li>',"</ul>"].join("");var e='<div class="layer_text_tip">\u63d2\u5165\u56fe\u7247\u5df2\u8fbe\u4e0a\u9650\uff0c\u6700\u591a\u53ef\u63d2\u5165#{maxLimit}\u5f20~</div>';var d=$.eduipopup().on("beforeshow",function(){var g=a.getValue("maxLimit")-a.getValue("imageNumber");var h=null;if(g>0){h=$(c);h.find(".from_album > a").click(function(j){j.preventDefault();_.Module.use("common/component/PictureAlbumSelector",{maxLimit:g},function(k){k.bind("ok",function(m,l){a.trigger("insertimage",l)})})});h.find(".from_web > a").click(function(j){j.preventDefault();_.Module.use("common/component/PictureWebSelector",{maxLimit:g},function(k){k.bind("ok",function(m,l){a.trigger("insertimage",l)})})})}else{h=$($.tb.format(e,{maxLimit:a.getValue("maxLimit")}))}var i=d.edui().getBodyContainer();i.html("");i.append(h)}).on("aftershow",function(){var g=a.getValue("maxLimit")-a.getValue("imageNumber");if(g>0){_.Module.use("common/component/PictureUploader",{uploadButtonContainer:d.edui().getBodyContainer().find(".pic_upload_container"),maxLimit:g,forumId:b.forum.id,props:b.user.props,tbs:b.tbs},function(h){h.bind("ok",function(j,i){a.trigger("insertimage",i)});h.bind("open",function(){a.setValue("pictureUploaderOpen",true)});h.bind("close",function(){a.setValue("pictureUploaderOpen",false);a.trigger("close")})})}});a.setWidget(d);return d});;EditorUI.registerModel("image",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("image",a);var c=$.eduibutton({icon:"image",title:"\u63d2\u5165\u56fe\u7247"});a.setButton(c);a.setValue("maxLimit",d.img_num);return a});;UE.plugins.tb_image=function(){var c=this,e=0;var f=560;function b(k){var h=[];for(var g=0,j;j=k[g];g++){if(j.url){h.push(d(j))}}return h.join("")}function d(g){if(g.width&&g.width>f){g.height=Math.floor(g.height/g.width*f);g.width=f}if(g.width&&g.height){g.size='width="'+g.width+'" height="'+g.height+'"'}else{g.size='onload="EditorUI.resizeImage(this, '+f+')"'}if(g.ptype){e=103}if(g.picType!=null){g.picType='pic_type="'+g.picType+'"'}else{g.picType=""}return $.tb.format('<img class="BDE_Image" src="#{url}" unselectable="on" #{picType} #{size} /><br />',g)}c.addListener("beforepaste",function(j,h,g){var i=/<img[^>]*class="BDE_Colorful"[^>]*code="([\w\d]*)".*?(?:>|\/>)/gi;h.html=h.html.replace(i,function(l,k){return String.fromCharCode(k)});var i=/(?:<img.*?>)|(?:<emb.*?>)|(?:http:\/\/((?:[a-zA-Z\d\-]+\.)+[a-zA-Z\d]+(?:\:[\d]{2,5})?)\/([^\s]+?)\.(jpg|jpeg|gif|png|bmp))/gi;h.html=h.html.replace(i,function(k){if(k.charAt(0)=="<"){return k}else{return d({url:k,picType:1})}})});c.getImageNumber=function(){return $(c.body).find(".BDE_Image").size()};c.commands.insertimage={execCommand:function(h,i){var g=b(i);c.execCommand("inserthtml",g,true)}};c.addOutputRule(function(g){$.each(g.getNodesByTagName("img"),function(h,i){i.setAttr("onload","");var j=i.getAttr("src");if(/^data:/.test(j)){i.parentNode.removeChild(i)}})},true);c.addListener("aftergetcontent",function(h,g){UE.utils.each(g.getNodesByTagName("img"),function(j){var i=/http:\/\/d.pcs.baidu.com\/thumbnail/;if(j.getAttr("class")=="BDE_Image"){var k=j.getAttr("src");if(i.test(k)){j.setAttr("src",k.replace(/&amp;/g,"&"))}}})});var a=c.getExtendContent;c.getExtendContent=function(){var g={ptype:e};return $.extend(a?a():{},g)}};;UE.registerUI("image",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();var e=b.getWidget();d.click(function(){b.setValue("imageNumber",a.getImageNumber());if(!e.parent().length){a.$container.find(".edui-dialog-container").append(e)}e.css("zIndex",a.options.zIndex+1).edui().show(d,{offsetTop:-10,caretLeft:20,caretTop:-8});$.stats.track("picture_btn","ueditor")});b.bind("insertimage",function(f,g){a.execCommand("insertimage",g)});b.bind("close",function(){e.hide()});d.edui().register("click",d,function(){var f=b.getValue("pictureUploaderOpen");if(f==null||f==false){e.hide()}});return d});;UE.plugins.video=function(){var d=this;function b(f){f.title=f.title||f.swf_url;f.vsrc=f.html_url;f.url=decodeURI(f.html_url);if(f.url.toLowerCase().indexOf("baidu.com")>-1){f.width=480;f.height=410}else{if(f.url.toLowerCase().indexOf("player.video.qiyi.com")>-1){f.width=500;f.height=415}else{f.width=500;f.height=450}}var h='<img unselectable="on" class="BDE_Flash" src="/tb/static-common/editor_img/flash.png" data-video_url="#{url}" data-vsrc="#{vsrc}" data-pkey="#{pkey}" data-vpic="#{vpic}" title="#{title}" width="219" height="175" data-width="#{width}" data-height="#{height}"'+(f.html5!="null"?' data-html5_url="#{html5}"':"")+"><br/>";var g=$.tb.format(h,f);return g}function e(f){return f.replace(/<img[^>]*class="?(?:BDE_Flash|BDE_Music)[^>]*>/gi,function(q){var h=q.replace(/.* title\="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),i=q.replace(/.* data\-width\="?([^\s">]+).*/i,"$1"),p=q.replace(/.* data\-height\="?([^\s">]+).*/i,"$1"),n=q.replace(/.* class="?([^\s">]+).*/i,"$1"),g="",j="",l='<embed allowfullscreen="true" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" scale="noborder"'+(h.toLowerCase().indexOf("http://player.ku6.com")==0?' flashvars="adss=0"':" ")+'src="'+h+'"  class="'+n+'" width="'+i+'" height="'+p+'" ';if(n=="BDE_Flash"){g=q.replace(/.* data-video_url="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");j=q.match(/.* data-html5_url="?([^\s">]+).*/i);if(j){j=j[1].replace(/&amp;/gi,"&");l+=' vhsrc="'+j+'"'}var k=q.replace(/.* data-vsrc="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");var m=q.replace(/.* data-pkey="?([^\s">]+).*/i,"$1");var o=q.replace(/.* data-vpic="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");if(m!="null"&&m.length<40){l+=' vsrc="'+k+'"';if(o!="null"){l+=' vpic="'+o+'"'}l+=' pkey="'+m+'"'}}l+=" ><br/>";return l})}function c(f,g){UE.utils.each(f.getNodesByTagName("img"),function(i){if(i.getAttr("class")=="BDE_Flash"){if(g){var h=e(i.toHtml());i.parentNode.replaceChild(UE.uNode.createElement(h),i)}}})}d.addOutputRule(function(f){c(f,true)},true);d.addInputRule(function(f){c(f,false)});d.getVideoNumber=function(){return $(d.body).find(".BDE_Flash").size()};d.hasLocalVideo=function(){return $(d.body).find(".BDE_Flash").filter(function(f){var g=$(this).data("pkey");return g!=null&&g!=""&&g.substr(0,5)=="pkey_"}).size()>0};d.getVideoUrl=function(){var f=$(d.body).find(".BDE_Flash");return f.size()>0?f.data("vsrc"):null};d.getFileId=function(){var f=d.getVideoUrl();var g=d.hasLocalVideo();return g&&f.length>0?f.substr(5):""};d.commands.insertvideo={execCommand:function(l,j){j=UE.utils.isArray(j)?j:[j];var h=[];for(var g=0,k,f=j.length;g<f;g++){k=j[g];h.push(b(k))}d.execCommand("inserthtml",h.join(""),true)},queryCommandState:function(){var g=d.selection.getRange().getClosedNode();var f=g&&(g.className=="BDE_Video");return f?1:0}};d.addListener("aftergetcontent",function(g,f){UE.utils.each(f.getNodesByTagName("embed"),function(h){if(h.getAttr("class")=="BDE_Flash"){h.setAttr("src",h.getAttr("src").replace(/&amp;/g,"&"));var i=h.getAttr("vsrc");if(i){h.setAttr("vsrc",i.replace(/&amp;/g,"&"))}var j=h.getAttr("vhsrc");if(j){h.setAttr("vhsrc",j.replace(/&amp;/g,"&"))}}})});var a=d.getExtendContent&&d.getExtendContent;d.getExtendContent=function(){var f={videoNumber:d.getVideoNumber(),hasLocalVideo:d.hasLocalVideo(),videoUrl:d.getVideoUrl(),fileId:d.getFileId()};return $.extend(a?a():{},f)}};;EditorUI.registerLayer("video",function(a,b,f){var c={can_local_upload:'<div class="j_video_container video_container"><div class="v_layer_content j_content"><ul class="v_ul clearfix"><li class="v_url_btn" ><a href="#" onclick="return false;" class="v_url_bg"></a></li><li class="v_local_btn"><a a href="#" onclick="return false;"  class="v_url_container" ></a><a href="#" onclick="return false;" class="v_local_bg" ></a></li></ul></div></div>',normal:['<div class="j_video_container video_container"><div class="v_layer_content j_content">','<div style="padding:30px 0px 5px 30px" class="clearfix"><input type="text" class="v_layer_input ui_textfield j_input" value="\u8bf7\u76f4\u63a5\u8f93\u5165\u89c6\u9891\u64ad\u653e\u9875\u5730\u5740"  ><a href="#" style="float:left;margin-left:5px;" class="ui_btn ui_btn_m j_btn"><span><em>\u63d2\u5165\u89c6\u9891</em></span></a></div>','<div  class="j_error_tip v_error_tip" style="display:none;padding-left:30px;line-height:22px;"></div>','<div style="color:#999;line-height:22px;padding-left:30px;" class="v_layer_text j_layer_text">\u76ee\u524d\u652f\u6301\u7231\u5947\u827a\u3001\u4f18\u9177\u3001\u571f\u8c46\u3001\u641c\u72d0\u3001\u817e\u8baf\u3001\u4e50\u89c6\u7b49\u89c6\u9891\u7f51\u7ad9\u94fe\u63a5</div>',"</div></div>"].join("")};var e=f.can_local_upload;var d=$.eduipopup().on("beforeshow",function(){var h=d.edui().getBodyContainer();var g=$(e?c.can_local_upload:c.normal);h.html("");h.append(g);if(a.getValue("UeditorVideo")){a.getValue("UeditorVideo").init(g)}else{_.Module.use("common/component/UeditorVideo",[{container:g,CAN_LOCAL_UPLOAD:e}],function(i){a.setValue("UeditorVideo",i);i.bind("insertvideo",function(k,j){a.trigger("insertvideo",j)})})}}).on("afterhide",function(){var g=a.getValue("UeditorVideo");g&&g.trigger("closelocalvideo")});a.setWidget(d);return d});;EditorUI.registerModel("video",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("video",a);var c=$.eduibutton({icon:"video",title:"\u63d2\u5165\u89c6\u9891"});a.setButton(c);return a});;UE.registerUI("video",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();var e=b.getWidget();d.click(function(f){if(!e.parent().length){a.$container.find(".edui-dialog-container").append(e)}if(e.css("display")==="none"){e.css("zIndex",a.options.zIndex+1).edui().show(d,{offsetTop:-10,offsetLeft:85,caretLeft:105,caretTop:-8})}else{e.edui().hide()}$.stats.track("video_btn","ueditor")});e.edui().register("click",e,function(f){if(d[0]!==f.target&&!$.contains(d[0],f.target)){e.edui().hide()}});b.bind("insertvideo",function(g,f){a.execCommand("insertvideo",f);e.edui().hide()});return b.getButton()});;UE.plugins.music=function(){var e=this;function b(g,i){var j='<img unselectable="on" class="BDE_Music" title="#{url}" src="/tb/static-common/img/rich_editor/music.png" width="112" height="31" data-width="400" data-height="95" /><br/>';g.url="http://box.baidu.com/widget/flash/bdspacesong.swf?from=tieba&url=&name=&artist=&song_id="+g.song_id+"&extra=&autoPlay=false&loop=true";g.url=encodeURI(g.url);var h=[(i&&g.title&&g.artist)?$.tb.format("<p>#{title} - #{artist}</p>",g):"",$.tb.format(j,g)].join("");return h}function f(g){return g.replace(/<img[^>]*class="?(?:BDE_Flash|BDE_Music)[^>]*>/gi,function(r){var i=r.replace(/.* title\="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&"),j=r.replace(/.* data\-width\="?([^\s">]+).*/i,"$1"),q=r.replace(/.* data\-height\="?([^\s">]+).*/i,"$1"),o=r.replace(/.* class="?([^\s">]+).*/i,"$1"),h="",k="",m='<embed allowfullscreen="true" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" scale="noborder"'+(i.toLowerCase().indexOf("http://player.ku6.com")==0?' flashvars="adss=0"':" ")+'src="'+i+'"  class="'+o+'" width="'+j+'" height="'+q+'" ';if(o=="BDE_Flash"){h=r.replace(/.* data-video_url="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");k=r.match(/.* data-html5_url="?([^\s">]+).*/i);if(k){k=k[1].replace(/&amp;/gi,"&");m+=' vhsrc="'+k+'"'}var l=r.replace(/.* data-vsrc="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");var n=r.replace(/.* data-pkey="?([^\s">]+).*/i,"$1");var p=r.replace(/.* data-vpic="?([^\s">]+).*/i,"$1").replace(/&amp;/gi,"&");if(n!="null"&&n.length<40){m+=' vsrc="'+l+'"';if(p!="null"){m+=' vpic="'+p+'"'}m+=' pkey="'+n+'"'}}m+=" ><br/>";return m})}function d(g,i,h){UE.utils.each(g.getNodesByTagName("img"),function(l){if(l.getAttr("class")=="BDE_Music"){var j=l.getAttr("title");var k=b({song_id:c("song_id",j),title:c("name",j),artist:c("artist",j)});if(i){k=f(k)}l.parentNode.replaceChild(UE.uNode.createElement(k),l)}})}function c(h,g){g=decodeURI(g);return decodeURIComponent((new RegExp(h+"=([^&]+?)($|&)").exec(g)||[undefined,""])[1])}e.addOutputRule(function(g){d(g,true,false)},true);e.addInputRule(function(g){d(g,false,false)});e.getMusicNumber=function(){return $(e.body).find(".BDE_Music").size()};e.commands.insertmusic={execCommand:function(l,k){k=UE.utils.isArray(k)?k:[k];var j=[];for(var h=0,m,g=k.length;h<g;h++){m=k[h];j.push(b(m,true))}e.execCommand("inserthtml",j.join(""),true)},queryCommandState:function(){var h=e.selection.getRange().getClosedNode();var g=h&&(h.className=="BDE_Music");return g?1:0}};var a=e.getExtendContent&&e.getExtendContent;e.getExtendContent=function(){var g={musicNumber:e.getMusicNumber()};return $.extend(a?a():{},g)}};;EditorUI.registerModel("music",function(b,e){var c=$.eduibutton({icon:"music",title:"\u63d2\u5165\u97f3\u4e50"});var a=new EditorUI.EditorModel();a.setButton(c);var d=e.music_num;c.on("click",function(){if(a.getValue("UeditorMusic")){a.trigger("showdialog")}else{_.Module.use("common/component/UeditorMusic",[{MAX_MUSIC_NUM:d}],function(f){a.setValue("UeditorMusic",f);a.bind("showdialog",function(){f.trigger("showdialog");a.trigger("aftershowdialog")});a.bind("updatecount",function(g,h){f.trigger("updatecount",h)});f.bind("insertmusic",function(h,g){a.trigger("insertmusic",g)});a.trigger("showdialog")})}$.stats.track("music_btn","ueditor")});return a});;UE.registerUI("music",function(b){var c=this;var a=EditorUI.getModel(b);var d=a.getButton();a.bind("insertmusic",function(g,f){c.execCommand("insertmusic",f);a.trigger("updatecount",c.getMusicNumber())});a.bind("aftershowdialog",function(f){a.trigger("updatecount",c.getMusicNumber())});return a.getButton()});;EditorUI.registerLayer("emotion",function(b,c,f){var d='<div class="j_emotion_container emotion_container"></div>';var a=$(d);var e=$.eduipopup().on("beforeshow",function(){if(!b.getValue("UeditorEmotion")){var g=e.edui().getBodyContainer();g.html("");g.append(a);_.Module.use("common/component/UeditorEmotion",[{container:a,customEmotionEnable:PosterContext.getAuthorities().custom_emotion}],function(h){b.setValue("UeditorEmotion",h);h.bind("insertemotion",function(j,i){b.trigger("insertemotion",i)})})}if($.browser.msie&&$.browser.version==6){$("#tb_rich_poster").find(".j_sign_id").hide()}});if($.browser.msie&&$.browser.version==6){e.on("afterhide",function(){$("#tb_rich_poster").find(".j_sign_id").show()})}b.setWidget(e);return e});;EditorUI.registerModel("emotion",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("emotion",a);var c=$.eduibutton({icon:"emotion",title:"\u63d2\u5165\u8868\u60c5"});a.setButton(c);return a});;UE.registerUI("emotion",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();var e=b.getWidget();d.click(function(f){if(!e.parent().length){a.$container.find(".edui-dialog-container").append(e)}e.css("zIndex",a.options.zIndex+1).edui().show(d,{offsetTop:-10,offsetLeft:225,caretLeft:247,caretTop:-8});$.stats.track("emotion_btn","ueditor")});e.edui().register("click",e,function(f){if(d[0]!==f.target&&!$.contains(d[0],f.target)){e.edui().hide()}});b.bind("insertemotion",function(i,f){if(f.type=="custom"){f.picType=1;a.execCommand("insertimage",[f])}else{var h='<img unselectable="on" pic_type="" class="BDE_Smiley" src="#{url}">';var g=f.type==="text"?f.title:$.tb.format(h,f);a.execCommand("inserthtml",g)}e.hide()});return d});;EditorUI.registerLayer("scrawl",function(b,c,f){var d='<div style="padding:10px;">\u54a6\uff0c\u6b64\u529f\u80fd\u9700\u8981\u62e5\u6709\u672c\u54276\u7ea7\u5934\u8854\u624d\u80fd\u4f7f\u7528\uff0c\u518d\u52aa\u529b\u4e00\u4e0b\uff01&nbsp;<a href="http://tieba.baidu.com/f/like/level?kw=#{name}#level_main" target="_blank">\u67e5\u770b\u5347\u7ea7\u79d8\u7c4d</a></div>';var a=null;b.bind("show",function(){if(c.user.level>=6){_.Module.use("common/component/Scrawl",{forumName:c.forum.name,userName:c.user.name},function(g){a=g;g.bind("ok",function(h,i){b.trigger("insertscrawl",i)})})}});if(c.user.level<6){var e=$.eduipopup().on("beforeshow",function(){var g=e.edui().getBodyContainer();g.html($.tb.format(d,c.forum))});b.setWidget(e)}});;EditorUI.registerModel("scrawl",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("scrawl",a);var c=$.eduibutton({icon:"scrawl",title:""});a.setButton(c);return a});;UE.registerUI("scrawl",function(c){var a=this;var d=this;var b=EditorUI.getModel(c);var e=b.getButton();var f=b.getWidget();e.click(function(){b.trigger("show");if(f){if(!f.parent().length){a.$container.find(".edui-dialog-container").append(f)}f.css("zIndex",a.options.zIndex+1).edui().show(e,{offsetTop:-10,caretLeft:20,caretTop:-8})}$.stats.track("scrawl_btn","ueditor")});e.edui().register("click",e,function(){f&&f.hide()});b.bind("insertscrawl",function(g,h){d.execCommand("insertimage",[{url:h,picType:5,width:416,height:335}])});return e});;UE.plugins.attachment=function(){this.attachments=[];this.addAttachment=function(b){this.attachments.push(b)};this.removeAttachment=function(c){if(c.md5){for(var b=0,d;d=this.attachments[b];b++){if(d.path===c.path){this.attachments.splice(b,1);break}}}};var a=this.getExtendContent;this.getExtendContent=function(){var b=a.call(this);b.attachments=$.json.encode(this.attachments);return b}};;EditorUI.registerLayer("attachment",function(e,b,h){var c=5;function g(j){j=parseInt(j);if(j<1024){return j+"byte"}var k=(j/1024).toFixed(2);if(k<1024){return k+"KB"}var l=(k/1024).toFixed(2);if(l<1024){return l+"MB"}return(l/1024).toFixed(2)+"GB"}var i='<div class="attachment_layer"><div class="attachment_btn_container"><button style="display: none;">\u4e0a\u4f20\u6587\u4ef6</button><span>\u6b63\u5728\u8fde\u63a5\u767e\u5ea6\u4e91\uff0c\u8bf7\u7a0d\u5019...</span><div class="attachment_flash_container"></div></div>\u8fd8\u80fd\u4e0a\u4f20<em id="attachmentNumberCount" class="j_number_count"></em>\u4e2a\u9644\u4ef6\uff0c\u6bcf\u4e2a\u9644\u4ef6\u5c0f\u4e8e<em>'+(h.attachment_size/1024/1024)+'</em><br/>\u9644\u4ef6\u5c06\u540c\u6b65\u5230\u767e\u5ea6\u4e91\u7f51\u76d8\uff0c\u60a8\u7684\u5269\u4f59\u7a7a\u95f4\uff1a<em class="j_pan_unused"></em> <a href="http://pan.baidu.com/" target="_blank">\u6574\u7406\u7f51\u76d8</a></div>';var d="<div style='padding: 15px'>\u54a6\uff0c\u6b64\u529f\u80fd\u9700\u8981\u62e5\u6709\u672c\u54275\u7ea7\u5934\u8854\u624d\u80fd\u4f7f\u7528\uff0c\u518d\u52aa\u529b\u4e00\u4e0b\uff01 <a href='http://tieba.baidu.com/f/like/level?kw="+b.forum.name+"#level_main' target='_blank'>\u67e5\u770b\u5347\u7ea7\u79d8\u7c4d</a></div>";var f=null;var a=$.eduipopup({stopprop:true}).on("beforeshow",function(){var j=a.edui().getBodyContainer();j.html("");if(b.user.level>=c){f=$(i);f.find(".j_number_count").text(h.attachment_num-e.getValue("attachmentNumber"))}else{f=$(d)}f.click(function(k){k.stopPropagation()});j.append(f)}).on("aftershow",function(){if(b.user.level>=c){var l=f.find(".attachment_flash_container");var k=f.find("button");var j=f.find(".j_number_count");$.getJSON("http://pcs.baidu.com/rest/2.0/pcs/quota?app_id=419237&method=info&callback=?",function(n){if(n.error_code){k.next().html("\u8fde\u63a5\u5931\u8d25")}else{var m=n.quota-n.used;f.find(".j_pan_unused").text(g(m));k.show().next().hide();_.Module.use("common/component/AttachmentUploader",[{coverButton:k,container:l,UIContainer:e.getValue("attachmentContainer")},{max_length:h.attachment_num-e.getValue("attachmentNumber"),forum_id:b.forum.id,upload_size_limit:h.attachment_size,storage_capacity:m,upload_url:"http://pcs.baidu.com/rest/2.0/pcs/file?method=upload&dir=%2fapps%2ftieba&ondup=newcopy&app_id=419237"}],function(o){o.bind("file_added",function(){j.text(j.text()-1)});o.bind("upload_complete",function(q,p){e.trigger("add_attachment",p)});o.bind("remove_file",function(q,p){e.trigger("remove_attachment",p);j.text(j.text()-0+1)})})}})}});e.setWidget(a);return a});;EditorUI.registerModel("attachment",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("attachment",a);var c=$.eduibutton({icon:"attachment",title:"\u63d2\u5165\u9644\u4ef6"});a.setButton(c);if(b.product!="frs"){c.hide()}return a});;UE.registerUI("attachment",function(e){var c=this;var d=EditorUI.getModel(e);var f=d.getButton();var g=d.getWidget();var b=$("<div class='edui-attachment-container'></div>");c.$container.append(b);d.setValue("attachmentContainer",b);d.bind("add_attachment",function(h,i){c.addAttachment(i)});d.bind("remove_attachment",function(h,i){c.removeAttachment(i)});var a="135px";f.click(function(i){d.setValue("attachmentNumber",c.attachments.length);if(!g.parent().length){var h=$('<div class="edui-attachment-dialog-container"></div>');c.$container.find(".edui-toolbar").append(h);h.append(g);g.css("zIndex",c.options.zIndex+1).edui().show(f,{offsetTop:-10,offsetLeft:300,caretLeft:320,caretTop:-8});a=g.css("left")}else{g.css("left",a)}$.stats.track("attachment_btn","ueditor")});f.edui().register("click",f,function(){g.css("left","-9999px")});return f});;EditorUI.registerModel("voice",function(b,d){var c=$.eduibutton({icon:"voice",title:"\u53d1\u8bed\u97f3"});if(b.product!="pb"){c.hide()}var a=new EditorUI.EditorModel();a.setButton(c);if($.tb.Storage.get("VoicePosterAdClosed")!=1){c.append('<span class="edui-icon-new"></span>')}c.on("click",function(){c.find(".edui-icon-new").remove();$("body").trigger("showvoicedialog",true);$.tb.Storage.set("VoicePosterAdClosed",1);$.stats.track("voice_btn","ueditor")});return a});;UE.registerUI("voice",function(c){var a=this;var d=this;var b=EditorUI.getModel(c);var e=b.getButton();var f=b.getWidget();return e});;UE.plugins.bold=function(){var a=this;a.addOutputRule(function(b){$.each(b.getNodesByTagName("b"),function(c,d){d.tagName="strong"})},true);a.commands.bold={execCommand:function(b){return this.document.execCommand(b)},queryCommandState:function(b){try{return this.document.queryCommandState(b)}catch(c){return false}}}};;EditorUI.registerModel("bold",function(b,d){var a=new EditorUI.EditorModel();var c=$.eduibutton({icon:"bold"});a.setButton(c);if(b.user.signNumber<10){c.hide()}return a});;UE.registerUI("bold",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();d.click(function(){a.execCommand(c)});this.addListener("selectionchange",function(){var e=this.queryCommandState(c);d.edui().disabled(e==-1).active(e==1)});return d});;UE.plugins.red=function(){var a="#000000";var c="#e10602";function b(m){var j=/[0-9]{0,3}/g;var n=m.match(j);var o="#";var f=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];for(var h=0;h<n.length;h++){var d=null,k=n[h],g=k;var e=[];while(k>16){d=k%16;k=(k/16)>>0;e.push(f[d])}e.push(f[k]);if(g<16&&g!=""){e.push(0)}o+=e.reverse().join("")}return o}this.addOutputRule(function(d){$.each(d.getNodesByTagName("span"),function(f,g){var e=g.getStyle("color");if(e){g.setAttr();if(e.indexOf("rgb")!=-1){e=b(e)}if(e==a){g.setAttr("class","edit_font_normal")}else{g.setAttr("class","edit_font_color")}}});$.each(d.getNodesByTagName("font"),function(f,e){e.setAttr();e.tagName="span";e.setAttr("class","edit_font_color")})},true);UE.commands.red={execCommand:function(){var f;if(this.queryCommandState("red")){f=a}else{f=c}var d=this.selection.getRange();if(d.collapsed){var e=$("<span></span>")[0];e.style.color=f;d.insertNode(e).setStart(e,0).setCursor()}else{this.document.execCommand("forecolor",false,f)}},queryCommandState:function(d){var f=this.selection.getStart();var e=$(f).css("color");if(e.indexOf("rgb")!=-1){e=b(e)}if(e.toLowerCase()==c){return 1}else{return 0}}}};;EditorUI.registerModel("red",function(b,d){var a=new EditorUI.EditorModel();var c=$.eduibutton({icon:"red"});a.setButton(c);if(b.user.signNumber<20){c.hide()}return a});;UE.registerUI("red",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();d.click(function(){a.execCommand("red")});this.addListener("selectionchange",function(){var e=this.queryCommandState("red");d.edui().disabled(e==-1).active(e==1)});return d});;UE.plugins.medal=function(){var a=this;a.getContentRoot=function(){return this.$body};a.addListener("beforepaste",function(f,c,b){var d=/<img[^>]*class="BDE_Colorful"[^>]*code="([\w\d]*)".*?(?:>|\/>)/gi;c.html=c.html.replace(d,function(g,e,h){return String.fromCharCode(e)});c.html=c.html.replace(/<\/?[^>]+>/g,"")});a.commands.insertcolorful={execCommand:function(c,b){a.execCommand("inserthtml",b,true)},ignoreContentChange:true}};;EditorUI.registerLayer("medal",function(b,c,f){var a=this;var d=['<ul class="layer_medal_list clearfix">','<li class="post_bubble" ><a href="#"></a></li>','<li class="colorful_font"><a href="#"></a></li>',"</ul>"].join("");var e=$.eduipopup().on("beforeshow",function(){var g=null;g=$(d);var h=e.edui().getBodyContainer();h.html("");h.append(g);g.find(".post_bubble > a").click(function(i){$.stats.track("post_bubble");b.trigger("showMedal",1);return false});g.find(".colorful_font > a").click(function(i){$.stats.track("colorful");b.trigger("showMedal",2);return false})}).on("aftershow",function(){if(!b.getValue("medalEvents")){b.setValue("medalEvents",true);b.bind("postbubble",function(g){_.Module.use("common/component/PostBubble",[{forumId:c.forum.id,props:c.user.props}],function(h){})});b.bind("colorfulfont",function(g){_.Module.use("common/component/Colorful",[{forumId:c.forum.id,props:c.user.props}],function(h){})})}});b.setWidget(e);return e});;EditorUI.registerModel("medal",function(b,d){var a=new EditorUI.EditorModel();EditorUI.bindLayer("medal",a);var c=$.eduibutton({icon:"medal",title:"\u52cb\u7ae0\u7279\u6743"});a.setButton(c);return a});;UE.registerUI("medal",function(c){var a=this;var b=EditorUI.getModel(c);var d=b.getButton();var e=b.getWidget();d.click(function(){d.addClass("edui-btn-medal-open");if(!e.parent().length){a.$container.find(".edui-dialog-container").append(e)}e.css("zIndex",a.options.zIndex+1).edui().show(d,{offsetTop:-10,caretLeft:20,caretTop:-8});$.stats.track("medal_btn","ueditor")});e.edui().register("click",e,function(f){if(d[0]!==f.target&&!$.contains(d[0],f.target)){d.removeClass("edui-btn-medal-open");e.edui().hide()}});b.bind("close",function(){e.hide()});b.bind("showMedal",function(j,i){var f={"1":{title:"\u53d1\u8d34\u6c14\u6ce1",evtName:"postbubble"},"2":{title:"\u70ab\u5f69\u6587\u5b57",evtName:"colorfulfont"}};if(a.getContent().length>0){var g=null;var h=['<div id="medal_tip_wrap">','<p style="font-weight: bold; line-height: 61px; text-align: center; height: 52px;">\u4f7f\u7528'+f[i].title+"\uff0c\u60a8\u5f53\u524d\u5df2\u7f16\u8f91\u7684\u5185\u5bb9\u5c06\u88ab\u6e05\u7a7a</p>",'<p style="text-align:center;">','<a class="ui_btn ui_btn_m j_btn_ok" href="#" style="margin-right:20px;"><span><em>\u786e\u5b9a\u4f7f\u7528</em></span></a>','<a class="ui_btn ui_btn_sub_m j_btn_cancel" href="#"><span><em>\u53d6\u6d88</em></span></a>',"</p>","</div>"].join("");var k=$(h);k.on("click",".j_btn_ok",function(){a.setContent("");b.trigger(f[i].evtName);g.close();return false});k.on("click",".j_btn_cancel",function(){g.close();return false});g=new $.dialog({showTitle:false,html:k,width:317,height:100,show:false});g.show()}else{b.trigger(f[i].evtName)}e.hide()});return d});;UE.plugins.height_limit=function(){var g=$(window).height()-250;var e=g;var a=true;var c=false;var b=this;this.disableHeightLimit=function(){a=false;c=false;f()};this.enableHeightLimit=function(h){e=h||g;a=true;var i=b.$body[0].scrollHeight;if(i>e){b.$body.css({height:e});c=true}else{if(i<=e){f()}}};this.addListener("contentchange afterinserthtml keyup mouseup",function(){d()});this.ready(function(){if(b.options.heightLimit===false){a=false}b.$container.on("restored.draft",function(){setTimeout(d,1000)})});function d(){if(a){var h=b.$body[0].scrollHeight;if(!c&&h>e){b.$body.css({height:e});c=true}else{if(c&&h<=e){f()}}}}function f(){b.$body.css({height:"auto"});c=false}};;UE.plugins.draft=function(){var a=this;if($.tb.Storage.isSupport()){var c=PosterContext.getContext();var b=["draft",c.user.id,c.forum.id,c.thread?c.thread.id:0].join("-");var d=$.tb.throttle(function(e,f){$.tb.Storage.set(e,f);a.$container.trigger("saved.draft")},2000);this.addListener("contentchange",function(){d(b,this.body.innerHTML)});this.restoreDraft=function(){var e=$.tb.Storage.get(b);if(e&&e!="<p><br></p>"&&e!="<P>&nbsp;</P>"){this.body.innerHTML=e;this.$container.trigger("restored.draft")}};this.clearDraft=function(){$.tb.Storage.remove(b)}}else{this.clearDraft=function(){}}};;UE.plugins.counter=function(){var b=this;function a(c){return c.replace(/[^\x00-\xff]/g,"mm").length}b.getContentByteLength=function(){return a(b.getContent())}};;UE.plugins.at=function(){var d=this;function a(e,g){var f=this;this.$root=$("<div class='edui_at_box' style='display: none;'><div class='at_box_title'>\u60f3\u7528@\u63d0\u5230\u8c01\uff1f</div><ul></ul></div>").appendTo(e);this.$list=this.$root.children("ul");this.$list.on({mouseenter:function(){f.setFocus(this)},click:function(){var h=$(this).text();f.hide();g(h)}},"li");this.shown=false}a.prototype={loadSuggestion:function(f){var e=this;$.get("/at-sug",{query:f,uid:PosterContext.getContext().user.id,ie:"utf-8"},function(g){if(g.error==0){var k=[];for(var j=0,h;h=g.msg[j];j++){k.push("<li>");k.push(h);k.push("</li>")}e.$list.html("").append(k.join(""))}},"json")},clearList:function(){this.$list.html("")},isShown:function(e){if(e){return this.shown&&this.target==e}else{return this.shown}},show:function(f){if(f!=this.target){this.clearList()}this.target=f;this.shown=true;var e=$(f).position();this.$root.css({left:e.left,top:e.top+16}).show()},hide:function(){this.$root.hide();this.shown=false},first:function(){this.setFocus(this.$list.children(":first"))},last:function(){this.setFocus(this.$list.children(":last"))},next:function(){var e=this.$list.children(".focus");if(e.size()==0){this.first()}else{if(e.index()==(this.$list.children().size()-1)){this.first()}else{this.setFocus(e.next())}}},prev:function(){var e=this.$list.children(".focus");if(e.size()==0){this.last()}else{if(e.index()==0){this.last()}else{this.setFocus(e.prev())}}},setFocus:function(e){$(e).siblings(".focus").removeClass("focus").end().addClass("focus")},getValue:function(){return this.$list.find(".focus").text()}};function c(f){var e=f.selection.getRange();if(e.collapsed){var g=$("<span class='at'>@</span>")[0];e.setStart(e.startContainer,e.startOffset-1).select().deleteContents().insertNode(g).setStart(g,1).collapse(true).select();f.atBox.show(g)}}function b(f){var e=d.selection.getRange();var h=d.selection.getStart();var g=UE.dom.domUtils.findParent(h,function(i){return $(i).is(".at")&&i.tagName=="SPAN"},true);if(g&&f!=null&&f.length>0){g.innerHTML="@"+f+""}e.setStartAfter(g).collapse(true).select();d.execCommand("inserthtml","&nbsp;")}d.addListener("ready",function(){d.atBox=new a(d.$body.parent(),b)});d.addListener("keydown",function(e,f){if(d.atBox.isShown()){switch(f.keyCode){case 38:d.atBox.prev();break;case 40:d.atBox.next();break;case 13:var g=d.atBox.getValue();d.atBox.hide();b(g);break;case 32:b(null);break;default:return}if(f.preventDefault){f.preventDefault()}return false}});d.addListener("keyup",function(e,f){if(f.keyCode==50&&f.shiftKey){c(this)}else{if(this.atBox.isShown()&&$.inArray(f.keyCode,[38,40,13,32])==-1){var h=UE.dom.domUtils.findParent(this.selection.getStart(),function(i){return i.className=="at"},true);var g=$(h).text().substring(1);if(g.length>0){this.atBox.loadSuggestion(g)}}}});d.addListener("selectionchange",function(){var e=d.selection.getRange();if(e.collapsed){var g=d.selection.getStart();var f=UE.dom.domUtils.findParent(g,function(h){return h.className=="at"},true);if(f){if(!this.atBox.isShown(f)){this.atBox.show(f);this.atBox.loadSuggestion($(f).text().substring(1))}}else{this.atBox.isShown()&&this.atBox.hide()}}});this.addOutputRule(function(e){$.each(e.getNodesByTagName("span"),function(g,j){var f=j.getAttr("class");if(f=="at"){var k=j.innerText();var h=UE.uNode.createText(k);var i=j.parentNode;i.insertBefore(h,j);i.removeChild(j)}})},true)};;UE.plugins.emotion_transform=function(){var h=this;var d=[{tip:[],type:"custom"},{tip:["\u5475\u5475","\u54c8\u54c8","\u5410\u820c","\u554a","\u9177","\u6012","\u5f00\u5fc3","\u6c57","\u6cea","\u9ed1\u7ebf","\u9119\u89c6","\u4e0d\u9ad8\u5174","\u771f\u68d2","\u94b1","\u7591\u95ee","\u9634\u9669","\u5410","\u54a6","\u59d4\u5c48","\u82b1\u5fc3","\u547c~","\u7b11\u773c","\u51b7","\u592a\u5f00\u5fc3","\u6ed1\u7a3d","\u52c9\u5f3a","\u72c2\u6c57","\u4e56","\u7761\u89c9","\u60ca\u54ed","\u751f\u6c14","\u60ca\u8bb6","\u55b7","\u7231\u5fc3","\u5fc3\u788e","\u73ab\u7470","\u793c\u7269","\u5f69\u8679","\u661f\u661f\u6708\u4eae","\u592a\u9633","\u94b1\u5e01","\u706f\u6ce1","\u8336\u676f","\u86cb\u7cd5","\u97f3\u4e50","haha","\u80dc\u5229","\u5927\u62c7\u6307","\u5f31","OK","\u5b64\u72ec\u5bc2\u5bde\u51b7","\u5149\u68cd\u5403\u6839\u6cb9\u6761","\u53ef\u601c\u6ca1\u4eba\u7231","\u53bbtmd\u5149\u68cd\u8282","\u6765\u6361\u80a5\u7682\u554a","\u7ed9\u8dea\u4e86","\u60ca\u5446\u4e86","\u62ff\u53bb\u64b8","\u54e6\u5973\u795e","\u697c\u4e3b\u597d\u4eba"],num:60,prev:"i_f",folder:"face/",suffix:"png"},{tip:["\u8e66\u8e66\u8df3\u8df3","\u6643\u60a0","\u6447\u6447\u6446\u6446","\u5927\u6492\u82b1","\u9ad8\u9ad8\u5174\u5174","\u5f39\u5409\u4ed6","\u9b54\u6cd5\u68d2","\u625b\u5927\u65d7","\u70b9\u8721\u70db","\u5927\u79e7\u6b4c","\u8d34\u5427\u5341\u5468\u5e74","\u5341\u5468\u5e74"],num:12,prev:"10th_0",folder:"10th/"},{tip:["\u4e00\u697c\u5582\u718a","\u4fef\u5367\u6491","\u6253\u9171\u6cb9","\u56e7","\u5927\u7b11","\u7011\u5e03\u6c57~","\u60ca\u8bb6","\u81ed\u7f8e","\u50bb\u7b11","\u629b\u5a9a\u773c","\u53d1\u6012","\u6211\u9519\u4e86","money","\u6c14\u6124","\u6311\u9017","\u543b","\u6012","\u80dc\u5229","\u59d4\u5c48","\u53d7\u4f24","\u8bf4\u5565\u5462\uff1f","\u95ed\u5634","\u4e0d","\u9017\u4f60\u73a9\u513f","\u98de\u543b","\u7729\u6655","\u9b54\u6cd5","\u6211\u6765\u4e86","\u7761\u4e86","\u6211\u6253","\u95ed\u5634","\u6253","\u6253\u6655\u4e86","\u5237\u7259","\u7206\u63cd","\u70b8\u5f39","\u5012\u7acb","\u522e\u80e1\u5b50","\u90aa\u6076\u7684\u7b11","\u4e0d\u8981\u4e0d\u8981","\u7231\u604b\u4e2d","\u653e\u5927\u4ed4\u7ec6\u770b","\u5077\u7aa5","\u8d85\u9ad8\u5174","\u6655","\u677e\u53e3\u6c14","\u6211\u8dd1","\u4eab\u53d7","\u4fee\u517b","\u54ed","\u6c57","\u554a~","\u70ed\u70c8\u6b22\u8fce"],num:53,prev:"w_00",folder:"ldw/",suffix:"gif"},{tip:["lxs\u4e0d\u60f3\u52a8","lxs\u5403\u60ca","lxs\u5439\u53e3\u54e8","lxs\u6253\u6c14","lxs\u6253\u5750","lxs\u7b49\u5f85","lxs\u6124\u6012","lxs\u5e7b\u8c61","lxs\u60ca\u559c","lxs\u5f00\u5fc3","lxs\u54ed\u557c","lxs\u54ed\u7740\u8dd1","lxs\u6ca1\u94b1","lxs\u6015\u9b3c","lxs\u629b\u5a9a\u773c","lxs\u4e03\u5915","lxs\u9a91\u9a6c\u821e","lxs\u5347\u5929","lxs\u77f3\u5316","lxs\u6570\u94b1","lxs\u5077\u5403","lxs\u5077\u7b11","lxs\u4e07\u5723\u8282","lxs\u65e0\u804a","lxs\u65e0\u5948","lxs\u65e0\u8bed","lxs\u59a9\u5a9a","lxs\u6349\u6025","lxs\u8f6c\u6655","lxs\u649e\u8c46\u8150","lxs\u8d58\u8089"],num:31,prev:"lxs_0",folder:"lxs/",suffix:"gif"},{tip:["\u75af\u5566","\u62b1\u5934\u8dd1","\u4e0d\u60f3\u7761","\u4e0d\u8981\u5440","\u82cd\u8747","\u8e6d\u75d2","\u5230\u7897\u91cc\u6765","\u961f\u957f","\u53d1\u8d22\u5566","\u975e\u6d32\u821e","\u9f13\u638c","\u5e7f\u573a\u821e","\u6eda\u7b52","\u6a2a\u884c","\u6325\u624b","\u706b\u821e\u9e21","\u5bc2\u5bde\u5440","\u52a0\u6cb9","\u6c5f\u5357style","\u5a07\u7f9e","\u60ca\u614c\u5931\u63aa","\u7ea0\u7ed3","\u5f00\u996d\u5566","\u96f7\u795e","\u6cea\u5954","\u804aQQ","\u9ea6\u9738","\u732b\u5973","\u9b54\u5492","\u5c3f\u6025","\u626d\u5c41\u80a1","\u7011\u5e03\u6c57","\u6c42\u9976","\u6492\u5a07","\u5c11\u5973","\u6c34\u51b0\u9e21","\u5929\u7136\u5446","\u5410\u8840","\u73a9\u624b\u673a","\u5a01\u6b66","\u4e94\u9053\u6760","\u821e\u52a8","\u6d17\u6d17","\u54b8\u86cb\u9e21","\u5411\u65e5\u8475","\u9e2d\u5b50\u821e","\u6e38\u6cf3","\u62db\u8d22\u9e21","\u7167\u955c\u5b50","\u8718\u86db\u9e21"],num:50,prev:"xyj_0",folder:"xyj/",suffix:"gif"},{tip:["\u8d56\u76ae","\u611f\u52a8","\u60ca\u8bb6","\u6012\u6c14","\u54ed\u6ce3","\u5403\u60ca","\u5632\u5f04","\u98d8\u8fc7","\u8f6c\u5708\u54ed","\u795e\u7ecf\u75c5","\u63ea\u8033\u6735","\u60ca\u6c57","\u9690\u8eab","\u4e0d\u8981","\u9041","\u4e0d\u516c\u5e73","\u722c\u6765\u4e86","\u86cb\u82b1\u54ed","\u6e29\u6696","\u70b9\u5934","\u6492\u94b1","\u732e\u82b1","\u5bd2","\u50bb\u7b11","\u626d\u626d","\u75af","\u6293\u72c2","\u6293","\u8737","\u6320\u5899","\u72c2\u7b11","\u62b1\u6795","\u543c\u53eb","\u56b7","\u5520\u53e8","\u634f\u8138","\u72c2\u7b11","\u90c1\u95f7","\u6f5c\u6c34","\u5f00\u5fc3","\u51b7\u7b11\u8bdd","\u9876","\u6f5c","\u753b\u5708\u5708","\u73a9\u7535\u8111","\u5410","\u54ed\u7740\u8dd1","\u963f\u72f8\u4fa0","\u51b7\u6b7b\u4e86","\u60c6\u6005~","\u6478\u5934","\u8e6d","\u6253\u6eda","\u53e9\u62dc","\u6478","\u6570\u94b1","\u62d6\u8d70","\u70ed","\u52a01","\u538b\u529b","\u8868\u903c\u6211","\u4eba\u5462","\u6447\u6643","\u6253\u5730\u9f20","\u8fd9\u4e2a\u5c4c","\u6050\u614c","\u6655\u4e4e\u4e4e","\u6d6e\u4e91","\u7ed9\u529b","\u676f\u5177\u4e86"],num:70,prev:"ali_0",folder:"ali/"},{tip:["hold\u4f4f","\u963f\u95e8","\u54ce\u54df","\u5509\uff5e","\u4e0d\u597d\u610f\u601d","\u4e0d\u8981\u561b\uff01","\u5531\u6b4c","\u626f\u809a\u76ae","\u626f\u8138","\u6413\u8138","\u6413\u624b","\u6253\u706f\u7b3c","\u6253\u8d77\u7cbe\u795e","\u70b9\u5934","\u70b9\u59342","\u52a8\u52a8\u811a","\u52a8\u52a8\u811a2","\u6296\u811a","\u6296\u811a2","\u55ef\uff5e","\u53d1\u5446","\u9f13\u638c","\u6eda\u684c\u5b50","\u597d\u95f2\u963f\uff5e","\u559d\u8336\u53d1\u5446","\u54fc\uff01","\u6643","\u54ed","\u56f0\u4e86","\u6269\u80f8\u8fd0\u52a8","\u6765\u6765\u6765","\u6765\u561b\uff5e","\u51b7\u9759\u51b7\u9759","\u7f57\u7238\u7238\u626d\u626d","\u7f57\u5988\u5988\u626d\u626d","\u9e8b\u9e7f\u7f57\u7f57\u5e03","\u626dpp","\u626dpp2","\u626d\u626d","\u6b27\u4e5f","\u8db4\u7740","\u5207\uff01","\u53bb\u53bb","\u6492\u82b1","\u4e0aWC","\u5723\u8bde\u8001\u4eba","\u5929\u4f7f\u7f57\u7f57\u5e03","\u8df3\u5440\u8df3","\u8df3\u5440\u8df32","\u73a9\u4e2a\u7403","\u6211\u6765\u4e86","\u563b\u563b","\u5411\u524d\u8fdb","\u4e9a\u514b\u897f","\u6447\u554a\u6447","\u4e00\u8fb9\u5446\u7740\u53bb\uff01","\u4e00\u8d77\u626d","\u6709\u793c\u4e86","\u8fd9\u53a2\u6709\u793c\u4e86","\u8d70\u5440\u8d70"],num:60,prev:"llb_0",folder:"luoluobu/"},{tip:["\u5fae\u7b11","\u5e05\u54e5","\u7f8e\u5973","\u8001\u5927","\u54c8\u54c8\u54c8","\u5978\u7b11","\u50bb\u4e50","\u98de\u543b","\u5bb3\u7f9e","\u82b1\u75f4","\u61a7\u61ac","\u4f60\u725b","\u9f13\u638c","\u53ef\u7231","\u59d4\u5c48","\u5927\u54ed","\u6cea\u5954","\u5bfb\u6b7b","\u60ca\u8bb6","\u7591\u95ee","\u9119\u89c6","\u5927\u9a82","\u72c2\u6012","\u56e7","\u6655","\u5455\u5410","\u8d22\u8ff7","\u7761\u4e86","\u601d\u8003","\u6c57","\u65e0\u8bed","\u62dc","\u97a0\u8eac","\u7d2f\u4e86","\u75c5\u4e86","\u5899\u89d2","\u8d85\u4eba","\u6233","\u8df3\u821e","\u9b3c\u8138","\u65e0\u804a","\u649e\u5899","\u9876","HI","\u996d","\u86cb\u7cd5","\u793c\u7269","\u5fc3","\u5fc3\u788e","\u73ab\u7470","\u70b8\u5f39","\u96c6\u4f53\u821e","\u6253\u4eba","\u62cd\u62cd","\u4eb2\u4eb2","\u63e1\u624b","\u5b89\u6170","\u77f3\u5934","\u526a\u5b50","\u5e03","\u606d\u559c\u5566","\u5575\u5575"],num:62,prev:"b",folder:"qpx_n/"},{tip:["+1","\u54c0\u4f24","\u9971","\u6fd2\u6b7b","\u75c5","\u5403\u8d27","\u4e0d\u6ee1","\u5446","\u5012\u540a","\u70b9\u5b50","\u9876","\u9f13\u638c","\u5bb3\u7f9e","\u6c57","\u5475\u5475\u5475","\u52a0\u6cb9","\u5978\u7b11","\u5978\u8bc8","\u60ca\u8bb6","\u56e7","\u770b","\u62a0\u9f3b\u5b50","\u54ed","\u56f0","\u4e50","\u6e9c\u8d70","\u8def\u8fc7","\u4e70\u4f60\u59b9\u7684\u623f\u7eb8","\u6572\u9523","\u4eb2\u543b","\u53bb\u4f60\u59b9\u7684\u5de5\u4f5c","\u6247\u98ce","\u5931\u843d","\u5237\u7259","\u9003\u547d","\u8df3\u821e","\u542c\u97f3\u4e50","\u5077\u7b11","\u5410","\u65e0\u8bed","\u559c","\u7b11","\u5174\u594b","\u9e2d\u5b50\u8df3","\u54ac","\u54ac","\u793c\u7269","\u8d5e","\u9707\u60ca","\u8ffd\u94b1","\u505a\u9b3c\u8138"],num:50,prev:"zxh_0",folder:"pczxh/"},{tip:["Kiss","Love","Yeah","\u554a\uff01","\u80cc\u626d","\u9876","\u6296\u80f8","88","\u6c57","\u778c\u7761","\u9c81\u62c9","\u62cd\u7816","\u63c9\u8138","\u751f\u65e5\u5feb\u4e50","\u644a\u624b","\u7761\u89c9","\u762b\u5750","\u65e0\u804a","\u661f\u661f\u95ea","\u65cb\u8f6c","\u4e5f\u4e0d\u884c","\u90c1\u95f7","\u6b63Music","\u6293\u5899","\u649e\u5899\u81f3\u6b7b","\u6b6a\u5934","\u6233\u773c","\u98d8\u8fc7","\u4e92\u76f8\u62cd\u7816","\u780d\u6b7b\u4f60","\u6254\u684c\u5b50","\u5c11\u6797\u5bfa","\u4ec0\u4e48\uff1f","\u8f6c\u5934","\u6211\u7231\u725b\u5976","\u6211\u8e22","\u6447\u6643","\u6655\u53a5","\u5728\u7b3c\u5b50\u91cc","\u9707\u8361"],num:40,prev:"t_00",folder:"tsj/"},{tip:["\u5fc3\u7167\u4e0d\u5ba3","\u84dd\u8138","\u56f0\u60d1","\u591f\u62fd","\u77aa\u773c","\u85d0\u89c6","\u601d\u8003","\u5475\u5475","\u60f3\u8981\u59b9\u5b50","\u5e7b\u60f3","\u65e0\u5948\u7684\u7b11","\u4e3a\u4ec0\u4e48","\u9ed1\u4eba\u6b6a\u5634","\u6b6a\u5634\u7b11","\u82e6\u903c","\u9762\u762b","\u54af\u54af\u54af","\u751f\u6c14","\u9ad8\u5174","\u559c\u6781\u800c\u6ce3","\u544a\u8bc9\u6211","\u6709\u4e86","\u597d\u5427","\u5b64\u72ec\u4e00\u751f","\u560e\u560e","\u66b4\u8e81","\u7d2b\u6b6a\u5634","\u7ea2\u6b6a\u5634","\u8fd9\u4e0d\u79d1\u5b66","\u7b11\u800c\u4e0d\u8bed","\u56f4\u89c2","\u725b\u4ed4\u6b6a\u5634","\u65b9\u8098\u5b50","\u9707\u60ca","\u60ca\u8bb6","\u98a0\u8986\u4e09\u89c2","\u5c3c\u7f8e\u85d0\u89c6","\u5c3c\u7f8e\u5475\u5475","\u5c3c\u7f8e\u53d1\u5446","\u5c3c\u7f8e\u6709\u4e86","\u732b\u5634\u7b11","\u601d\u6625","\u5c3c\u7f8e\u82e6\u903c","\u7b11\u5c3f","\u5c3c\u7f8e\u54af\u54af","\u5c3c\u7f8e\u6b6a\u5634","\u5c3c\u7f8e\u59da","\u66b4\u8d70\u5c3c\u7f8e","\u5a07\u7f9e","\u5c3c\u7f8e\u9707\u60ca","\u5b64\u72ec\u5c3c\u7f8e","\u5c3c\u7f8e\u5927\u54ed","\u5c3c\u7f8e\u6124\u6012","\u5c3c\u7f8e\u560e\u560e","\u5c3c\u7f8e\u6124\u61d1","\u5c3c\u7f8e\u4e0d\u89e3"],num:56,prev:"b_00",folder:"baodong/"},{tip:["\u574f\u6deb","\u6293\u72c2","\u60b2\u621a","\u75db\u54ed","\u72af\u8d31","\u5978\u7b11","\u5c4c\u4e1d","\u9ad8\u547c","\u611f\u53f9","\u611f\u52a8","\u618b\u5c48","\u8212\u723d","\u574f\u7b11","\u5c41\u98a0","\u77b3\u672f","\u6742\u800d","\u59da\u8138","\u5b64\u72ec","\u66b4\u8d70","\u6f47\u6d12","\u5931\u671b","\u540c\u684c","\u53d8\u8138","\u5f97\u745f","\u8179\u9ed1\u7537","\u8179\u9ed1\u5973","\u591f\u62fd","\u767d\u9886","\u55b5\u5c3c\u739b","\u6c6a\u5c3c\u739b","\u563f\u563f\u5c3c\u739b","\u52fe\u5f15","\u53d1\u6cc4","\u64cd\u64cd\u64cd"],num:34,prev:"bd_00",folder:"baodong_d/"},{tip:["hi","kiss","\u4e0d\u8bf4","\u4e0d\u8981","\u626f\u82b1","\u5927\u5fc3","\u9876","\u5927\u60ca","\u98de\u543b","\u9b3c\u8138","\u5bb3\u7f9e","\u53e3\u6c34","\u72c2\u54ed","\u6765","\u6cea\u773c","\u6d41\u6cea","\u751f\u6c14","\u5410\u820c","\u559c\u6b22","\u65cb\u8f6c","\u518d\u89c1","\u6293\u72c2","\u6c57","\u9119\u89c6","\u62dc","\u5410\u8840","\u5618","\u6253\u4eba","\u8e66\u8df3","\u53d8\u8138","\u626f\u8089","\u5403To","\u5403\u82b1","\u5439\u6ce1\u6ce1\u7cd6","\u5927\u53d8\u8eab","\u98de\u5929\u821e","\u56de\u7738","\u53ef\u601c","\u731b\u62bd","\u6ce1\u6ce1","\u82f9\u679c","\u4eb2","","\u9a9a\u821e","\u70e7\u9999","\u7761","\u5957\u5a03\u5a03","\u6345\u6345","\u821e\u5012","\u897f\u7ea2\u67ff","\u7231\u6155","\u6447","\u6447\u6446","\u6742\u800d","\u62db\u8d22","\u88ab\u6bb4","\u88ab\u7403\u95f7","\u5927\u60ca","\u7406\u60f3","\u6b27\u6253","\u5455\u5410","\u788e","\u5410\u75f0"],num:63,prev:"B_00",folder:"bobo/"},{tip:["\u7126\u7cd6\u821e","\u7ffb\u6eda","\u62cd\u5c41\u80a1\u505a\u9b3c\u8138","\u4e0d","\u6cb3\u87f9\u6389\u5566","\u54e6\u8036","\u6211\u5012","\u6295\u964d","\u542c\u97f3\u4e50","\u88ab\u7838","\u5410\u820c\u5934","\u592a\u597d\u5566","\u8d22\u6e90\u6eda\u6eda","\u4eba\u5462","\u6325\u624b\u5e15","\u5077\u7b11","\u5377\u88ab","\u770b\u697c\u4e0a","\u6211\u62bd","\u6709\u6728\u6709","\u54ed","\u6b22\u547c","\u50bb\u516e\u516e","\u6247\u6247\u5b50","\u62cd\u624b","\u7d27\u5f20","\u6d17\u6fa1","\u8036","\u5403\u897f\u74dc","\u7eb3\u5c3c","\u6ca1\u6709\u94b1","\u62ff\u73a9\u5076","\u6765\u770b\u770b","\u54c7\u54c7\u53eb","\u62db\u8d22\u732b","\u653e\u5c41","\u9686\u91cd\u4ecb\u7ecd","\u6c42\u4f60\u4e86","\u649e\u73bb\u7483","\u773a\u671b","\u6492\u82b1","\u73a9\u94c3\u94db","\u601d\u8003\u8005","\u62bd\u98ce","\u5403\u82f9\u679c","\u5149\u68cd"],num:46,prev:"yz_0",folder:"shadow/"},{tip:["\u4e2d\u7bad","ls\u53bb\u6b7b","ls\u53bb\u6b7b\u5b50\u5f39","ls\u53bb\u6b7b\u589e\u5f3a","ls\u53bb\u6b7b\u70ae\u5f39","\u677f\u51f3","\u4e0d\u723d","\u4e0d\u8981","\u8d85\u4eba","\u5403\u96f6\u98df","\u62bd\u70df","\u4e32","\u6253\u72d7","\u6253\u9171\u6cb9","\u6253\u4f60","\u6234\u58a8\u955c","\u86cb","\u8361\u6f3e","\u9876\u7834\u697c\u4e0a","\u53d1\u61f5","\u653e\u5c41","\u8d1f\u5206\u6eda\u7c97","\u559d\u5927\u4e86","\u547c\u5566\u5708\u513f","\u62a4","\u6ed1\u51b0","\u753b\u5708\u5708","\u706b\u94b3\u5218","\u8d31\u8d31\u7684","\u60ca\u5413","\u62a0\u811a","lt\u54ed","\u62c9\u7c91\u7c91","\u64b8","\u6320PP","\u95f9","\u6392\u7403","\u524d\u6392","\u6572\u624b\u9f13","\u6c99\u53d1","\u5254\u7259","\u5154\u5b50\u8e66\u8d77\u6765","\u6316\u9f3b\u5c4e","\u65e0\u8bed","\u778e\u4e86","\u79c0\u808c\u8089","\u6447\u6eda","\u610f\u5916\u60ca\u559c","\u9707\u60ca","\u6b63\u6b65"],num:50,prev:"ltn_0",folder:"lt/"},{tip:["\u524d\u6392","love","\u5c0fcase"],composites:[["face/i_f47.png","face/i_f28.png","face/i_f47.png"],["face/i_f46.png","face/i_f22.png","face/i_f46.png"],["face/i_f26.png","face/i_f50.png"]]}];var n=$.tb.Storage.get("customEmotion");if(n){var j=$.json.decode(n);for(var e=0,k;k=j[e];e++){}}function c(){var q=[];var t=d[d.length-1];var p=t.tip;for(var r=0,s;s=p[r];r++){q.push({title:s,images:t.composites[r]})}return q}function f(v){var x=[];var t=new RegExp("^"+v);for(var w,s=0;w=d[s];s++){var u=w.tip;for(var r=0,q=u.length;r<q;r++){var p=u[r];if(p&&t.test(p)){if(w.composites){x.push({title:p,images:w.composites[r]})}else{x.push({title:p,images:[a(w,r)]})}}}}return x.slice(0,5)}function a(q,r){var p=r+1;var s=q.suffix||"gif";if(q.prev=="i_f"&&p>=51){s="gif"}return[q.folder,q.prev,(p<10?"0":""),p,".",s,"?t=20131111"].join("")}function o(i,q){var p=this;this.$root=$("<div class='edui_at_box' style='display: none;'><div class='at_box_title'>\u8bf7\u8f93\u5165\u8868\u60c5\u540d\u79f0\uff1a</div><ul class='emotion_list'></ul></div>").appendTo(i);this.$list=this.$root.children("ul");this.$list.on({mouseenter:function(){p.setFocus(this)},click:function(){p.hide();q(p.getValue())}},"li");this.shown=false}o.prototype={loadSuggestion:function(v){var p;if(v&&v.length>0){if($.browser.msie){v=v.replace(decodeURIComponent("%E2%80%8B"),"")}p=f(v)}else{p=c()}var u=[];for(var s=0,t;t=p[s];s++){u.push($.tb.format("<li title='#{title}'>",t));for(var r=0,q;q=t.images[r];r++){u.push($.tb.format('<img src="http://static.tieba.baidu.com/tb/editor/images/#{path}" width="30" />',{path:q}))}u.push("</li>")}this.$list.html(u.join(""));this.first()},clearList:function(){this.$list.html("")},isShown:function(i){if(i){return this.shown&&this.target==i}else{return this.shown}},show:function(p){if(p!=this.target){this.clearList()}this.target=p;this.shown=true;var i=$(p).position();this.$root.css({left:i.left,top:i.top+16}).show()},hide:function(){this.$root.hide();this.shown=false},first:function(){this.setFocus(this.$list.children(":first"))},last:function(){this.setFocus(this.$list.children(":last"))},next:function(){var i=this.$list.children(".focus");if(i.size()==0){this.first()}else{if(i.index()==(this.$list.children().size()-1)){this.first()}else{this.setFocus(i.next())}}},prev:function(){var i=this.$list.children(".focus");if(i.size()==0){this.last()}else{if(i.index()==0){this.last()}else{this.setFocus(i.prev())}}},setFocus:function(i){$(i).siblings(".focus").removeClass("focus").end().addClass("focus")},getValue:function(){var i=[];this.$list.find(".focus").children().each(function(){i.push(this.src)});return i}};function g(p){var i=p.selection.getRange();if(i.collapsed){var q=$("<span class='emotion_suggestion'>#</span>")[0];i.setStart(i.startContainer,i.startOffset-1).select().deleteContents().insertNode(q).setStart(q,1).collapse(true).select();p.emotionBox.show(q);p.emotionBox.loadSuggestion()}}function l(q){var p=h.selection.getRange();var v=h.selection.getStart();var u=UE.dom.domUtils.findParent(v,function(i){return $(i).is(".emotion_suggestion")&&i.tagName=="SPAN"},true);p.setStartAfter(u).collapse(true).select();var s=[];for(var r=0,t;t=q[r];r++){s.push($.tb.format('<img unselectable="on" pic_type="" class="BDE_Smiley" src="#{src}">',{src:t}))}h.execCommand("inserthtml",s.join(""));UE.dom.domUtils.remove(u)}var b=false;var m=null;h.addListener("ready",function(){h.emotionBox=new o(h.$body.parent(),l)});h.addListener("keydown",function(i,p){if(h.emotionBox.isShown()){var r=false;switch(p.keyCode){case 38:h.emotionBox.prev();r=true;break;case 40:h.emotionBox.next();r=true;break;case 13:var q=h.emotionBox.getValue();h.emotionBox.hide();l(q);r=true;break;case 32:h.emotionBox.hide();break;default:break}if(r){if(p.preventDefault){p.preventDefault()}return false}}else{if(p.keyCode==16){clearTimeout(m);b=true}}});h.addListener("keyup",function(i,p){if(p.keyCode==51&&b){g(this)}else{if(p.keyCode==16){m=setTimeout(function(){b=false},100)}}});h.addListener("contentchange",function(){var i=h.selection.getRange();if(i.collapsed){var q=h.selection.getStart();var p=UE.dom.domUtils.findParent(q,function(r){return r.className=="emotion_suggestion"},true);if(p){if(this.emotionBox.isShown(p)){this.emotionBox.loadSuggestion($(p).text().substring(1))}}else{this.emotionBox.isShown()&&this.emotionBox.hide()}}})};;UE.plugins.baiduinput=function(){var b=this;function a(){this.bdInputShowErrorHdl=null;this.timer=null;this.createAxObject();this.checkIsSupport(function(d){if(d){this.initial();this._ready(d)}else{}})}a.prototype={createAxObject:function(){var d=document.createElement("div");d.id="bdInputObjWrapper";document.getElementById("tb_rich_poster").appendChild(d);if(UE.browser.ie){document.getElementById("bdInputObjWrapper").innerHTML='<object id="BdInputAx" classid="CLSID:D64016F6-4D8E-4B35-AB22-9B2060800112" width="0" height="0"></object>'}else{if(!UE.browser.gecko){document.getElementById("bdInputObjWrapper").innerHTML='<object id="BdInputAx" type="application/baiducnff-activex" progid="BaiducnAx.ScreenShotAx.1" width="0" height="0"></object>'}}this.baiduInputObj=document.getElementById("BdInputAx")},checkIsSupport:function(e){var d=this;if(this.checkIsSupportHdl){clearTimeout(this.checkIsSupportHdl)}this.checkIsSupportHdl=setTimeout(function(){var f=d.baiduInputObj&&"GetNewSession" in d.baiduInputObj;this.isSupport=f;e.call(d,f)},400)},initial:function(){var d=this;this.baiduInputObj.StartReadFileFuncName="bdInputRead";window.bdInputSession=0;window.bdInputPasting=0;window.bdInputUploader=null;window.btInputTbs="";$.getJSON("http://tieba.baidu.com/dc/common/imgtbs",function(f){var e={isFlash:true};if(f.no==0){e.uploadUrl="http://upload.tieba.baidu.com/upload/pic?tbs="+f.data.tbs}_.Module.use("common/component/image_uploader_manager",[e],function(g){window.bdInputUploader=g})});window.bdInputShowError=function(e){$.tb.alert({message:e,buttons:[{text:"\u786e\u8ba4"}]})};window.bdInputUploadCallback=function(f){var e,g;if(f.errorCode!=0){window.bdInputShowError("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")}else{if(f.response.error_code!=0){window.bdInputShowError("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5")}e=f.response.info.pic_id_encode;g="http://imgsrc.baidu.com/forum/pic/item/"+e+".jpg";b.execCommand("insertimage",[{url:g,picType:8}])}};window.bdInputInsertImg=function(e){if(!window.bdInputUploader){_.Module.use("common/component/image_uploader_manager",[{isFlash:true}],function(f){bdInputUploader=f;bdInputUploader.uploadBase64(e,window.bdInputUploadCallback)})}else{bdInputUploader.uploadBase64(e,window.bdInputUploadCallback)}};window.bdInputRead=function(){var l,k,h="",g=[],f=0,j=0;l=d.baiduInputObj.GetFileCount(window.bdInputSession);l=l>100?100:l;if(l==0){return}for(var e=0;e<l;e++){k=d.baiduInputObj.GetFileRange(window.bdInputSession,e);if(k>4194304){f++;continue}h=d.baiduInputObj.GetFileMem(window.bdInputSession,e,0,k);window.bdInputInsertImg(h);if(f>0){window.bdInputShowError("\u526a\u8d34\u677f\u4e2d\u6709"+f+"\u5f20\u6587\u4ef6\u8fc7\u5927\uff0c\u4f7f\u7528\u56fe\u7247\u4e0a\u4f20\u8bd5\u8bd5\u5427~")}}}},_ready:function(){this.onready.apply(this,arguments)},ready:function(d){this.onready=d||function(){}}};var c=new a();b.baiduInput=c;window.baiduInput=c;c.ready(function(d){if(d){b.addListener("beforepaste",function(h,g,f){if(f.firstChild()){if(c.timer){clearTimeout(c.timer);c.timer=null}c.defaultPaste=true}});b.addListener("afterpaste",function(g,f){c.defaultPaste=false});UE.dom.domUtils.on(b.$container[0],UE.browser.ie||UE.browser.opera?"keydown":"paste",function(f){if((UE.browser.ie||UE.browser.opera)&&((!f.ctrlKey&&!f.metaKey)||f.keyCode!="86")){return}if(d&&!c.defaultPaste){if(c.timer!=null){clearTimeout(c.timer);c.timer=null}c.timer=setTimeout(function(){window.bdInputSession=c.baiduInputObj.GetNewSession();c.baiduInputObj.StartScreenShotParse(window.bdInputSession)},400)}else{c.defaultPaste=false}})}})};;