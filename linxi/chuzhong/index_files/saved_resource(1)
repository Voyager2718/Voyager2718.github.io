_.Module.define({path:"common/widget/browserStatistics",sub:{initial:function(){var e=$.cookie("activelevel");(!e||""==e)&&this._sendActive()},_detectOS:function(){var e=navigator.userAgent,a="Win32"==navigator.platform||"Windows"==navigator.platform,i="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(i)return"Mac";var t="X11"==navigator.platform&&!a&&!i;if(t)return"Unix";var n=String(navigator.platform).indexOf("Linux")>-1;if(n)return"Linux";if(a){var o=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(o)return"Win2000";var r=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(r)return"WinXP";var s=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(s)return"Win2003";var s=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(s)return"WinVista";var s=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(s)return"Win7"}return"other"},_sendActive:function(){var e=this;$.ajax({url:"/activelevel/add",data:{os:e._detectOS().toLowerCase(),psh:window.screen.height,psw:window.screen.width,psl:window.screenLeft,pst:window.screenTop,psx:window.screenX,psy:window.screenY,psah:window.screen.availHeight,psaw:window.screen.availWidth,psal:window.screen.availLeft,psat:window.screen.availTop,pscd:window.screen.colorDepth,pspd:window.screen.pixelDepth,fid:PageData.forum.forum_id},dataType:"json",type:"POST",success:function(e){if(e&&0==e.errno){var a=e.expire/86400;a&&$.cookie("activelevel",1,{expires:a})}}})},_showpop:function(e){if("1"==e){var a=$.dialog.open("<div class='black_cookie_tip'>亲爱的贴吧用户：为避免盗号、隐私泄露等问题，确保账号安全，请您更换更安全的浏览器。我们即将停止支持有安全隐患的浏览器对贴吧的访问。<br/>推荐安装<a href='http://liulanqi.baidu.com/' target='_blank'>百度浏览器</a> <a href='http://www.baidu.com/s?tn=baiduhome_pg&ie=utf-8&bs=IE&f=8&rsv_bp=1&rsv_spt=1&wd=IE10&rsv_sug3=2&rsv_sug=0&rsv_sug1=2&rsv_sug4=78&inputT=1008' target='_blank'>IE</a> <a href='http://chrome.google.com/' target='_blank'>Chrome</a>等安全浏览器。<br/>另外推荐下载<a href='http://c.tieba.baidu.com/c/s/download/pc' target='_blank'>手机客户端</a>或直接手机浏览器访问（tieba.baidu.com），随时随地给您更好更安全的贴吧体验！<a title='关闭' class='black_cookie_dlg_close j_black_cookie_dlg_close' href='#'>&nbsp;</a></div>",{modal:!1,showTitle:!1,width:980,fixed:!0,autoCenter:!0});$(a.element[0]).find(".dialogJcontent").css("background-color","#ffffe3"),$(a.element[0]).find(".j_black_cookie_dlg_close").click(function(){a.close()});var i=($(window).width()-990)/2;a.setPosition(i,0)}else var a=$.dialog.open("<div class='black_cookie_pop'>亲爱的贴吧用户：为避免盗号、隐私泄露等问题，确保账号安全，我们已<span class='black_cookie_red'>停止支持</span>有安全隐患的浏览器对贴吧的访问。请您<span class='black_cookie_red'>更换更安全的浏览器</span>后继续贴吧之旅。推荐安装<a href='http://liulanqi.baidu.com/' target='_blank'>百度浏览器</a> <a href='http://www.baidu.com/s?tn=baiduhome_pg&ie=utf-8&bs=IE&f=8&rsv_bp=1&rsv_spt=1&wd=IE10&rsv_sug3=2&rsv_sug=0&rsv_sug1=2&rsv_sug4=78&inputT=1008' target='_blank'>IE</a> <a href='http://chrome.google.com/' target='_blank'>Chrome</a>等安全浏览器。<br/>另外推荐下载<a href='http://c.tieba.baidu.com/c/s/download/pc' target='_blank'>手机客户端</a>或直接手机浏览器访问（tieba.baidu.com），随时随地给您更好更安全的贴吧体验！</div>",{title:"贴吧安全警告",closeable:!1,draggable:!1,escable:!1,width:600})}}});_.Module.define({path:"common/widget/Userbar",requires:["DropDownList"],sub:{_btns:{},_userinfo:null,$root:null,_logoutTimer:null,_product:null,_self:this,_urls:{itb_home:"",my_itb:"",my_club:"",u_split:"",my_space:""},_ddls:{itb:null,club:null,space:null},_userDataRended:{my_forum:!1,club:!1,space:!1},initial:function(t,i,s){i=i||"",TbCom.process("User","init",t,i),this._userinfo=t,this._product=i,this._buildLayout(s),TbCom.process("MsgSystem","init"),TbCom.process("UserMessage","init",i,s)},_initURLs:function(){this._urls.itb_st_param="st_mod=userbar&fr=tb0_"+this._product,this._urls.itb_home="/i/sys/jump?un="+this._userinfo.name_url+(this._userinfo.no_un?"&fr_noun=1":""),this._urls.my_favor=this._urls.itb_home+"&type=storethread&"+this._urls.itb_st_param,this._urls.itb_profile="/home/profile?un="+this._userinfo.name_url+(this._userinfo.no_un?"&fr_noun=1":"")},_buildLayout:function(t){var i=this,s="";-1!=$.inArray(this._product,["tbmall"])&&(s="userbar_theme2"),this.$root=$('<div id="com_userbar" class="userbar '+s+'"></div>');var e=$.getcurzIndex();(null==e||0>=e)&&(e=11e3),this.$root.css({"z-index":e});var a=$(t?t:"body");a.prepend(this.$root),this._btns.bdsearch=$('<a href="http://www.baidu.com">百度首页</a>'),this._btns.tbmall=$('<div class="u_menu_item u_menu_tbmall"><a class="u_menu_wrap u_tbmall_wrap" title="点击到商城购买道具" href="http://tieba.baidu.com/tbmall/home" target="_blank">T豆商城</a></div>'),this._btns.school=$('<a class="j_school" href="https://passport.baidu.com/v2/?reg&tpl=tb&u=http://tieba.baidu.com/&school=1" target="_blank" style="color:red;">校园用户注册通道</a>'),this._btns.app=$('<div class="u_menu_item u_menu_app"><a class="u_menu_wrap u_app_wrap" href="http://c.tieba.baidu.com/c/s/download/pc?src=webtbGF" target="_blank">客户端</a></div>'),this._userinfo.is_login?(this._buildLoginLayout(),this._buildWallet(),this._buildNews(),TbCom.process("User","getUserInfoByRequest",function(t){i._initURLs(t),i._buildUsername(t),i._buildUSetting(t),i._buildTShow(t)})):(this._buildLogoutLayout(),this._buildTShow())},_buildLoginLayout:function(){var t=["<ul>",'<li id="j_u_username" class="u_username"></li>','<li class="u_setting"></li>','<li class="u_wallet"></li>','<li class="u_news"></li> <li class="split">|</li>','<li class="u_app"></li> <li class="split">|</li>','<li class="u_tbmall"></li> <li class="split">|</li>','<li class="u_tshow"></li>',"</ul>"].join("");this.$root.html(t),this._btns.logout=$('<a href="#" >退出</a>'),this.$root.find(".u_tbmall").append(this._btns.tbmall),this.$root.find(".u_app").append(this._btns.app)},_buildLogoutLayout:function(){var t=["<ul>",'<li class="u_login"></li>','<li class="u_reg"></li><li class="split">|</li>','<li class="u_app"></li> <li class="split">|</li>','<li class="u_tbmall"></li><li class="split">|</li>','<li class="u_tshow"></li>',"</ul>"].join("");this._btns.reg=$('<a href="https://passport.baidu.com/v2/?reg&tpl=tb&u=http://tieba.baidu.com?tb_mod=userBar&tb_fr=index" onclick="return false;" >注册</a>'),this._btns.login=$('<a href="#" onclick="return false;">登录</a>'),this.$root.html(t),this.$root.find(".u_reg").append(this._btns.reg),this.$root.find(".u_login").append(this._btns.login),this.$root.find(".u_tbmall").append(this._btns.tbmall),this.$root.find(".u_app").append(this._btns.app),this._btns.reg.click(function(){TbCom.process("User","buildRegisterFrame","userBar")}),this._btns.login.click(function(){_.Module.use("common/widget/LoginDialog",["","userBar"])})},_buildUsername:function(t){var i=this.$root.find(".u_username"),s=$('<div class="u_menu_item u_menu_username"></div>'),e=t.name_weak,a="",n="";n=t.no_un?"https:/passport.baidu.com/v2/?ucenteradduname&u="+encodeURIComponent(location.href):"http://tieba.baidu.com/home/main?id="+t.portrait+"&fr=userbar";var l="";t.Parr_props&&t.Parr_props.level&&t.Parr_props.level.end_time>Env.server_time/1e3&&(l='style="color:#FF0000;"'),a='<img class="u_username_avatar" src="http://tb.himg.baidu.com/sys/portrait/item/'+t.portrait+'"/>',a='<a href="'+n+'" title="点击到个人中心" class="u_menu_wrap u_username_wrap">'+a+'<span class="u_username_title" '+l+">"+e+"</span></a>",s.html(a),i.append(s);var r='<ul><li class="u_itieba"><a href="/home/main?id='+t.portrait+'&fr=userbar" >我的贴吧</a></li><li class="u_mytbmall"><a href="/tbmall/mymall" target="_blank">我的商城</a></li><li class="u_favor" location="user_favor_ch"><a href="'+this._urls.my_favor+'" target="_blank">我的收藏</a></li><li class="u_xiangce" id="u_xiangce"><a href="http://xiangce.baidu.com/home?from=tb" target="_blank">我的相册</a></li><li class="u_pan"><a href="http://pan.baidu.com/" target="_blank">我的网盘</a></li><li class="u_game"><a href="/game/index" target="_blank">我的游戏</a></li></ul>',o=this._ddls.uname=this.use("DropDownList",i,s,"uname");o.innerContent("top",r)},_buildUSetting:function(t){var i=this,s=this.$root.find(".u_setting"),e=$('<div class="u_menu_item u_menu_setting"><a class="u_menu_wrap u_setting_wrap" href="#" onclick="return false;"></a></div>');s.append(e);var a=["<ul>",'<li><a href="http://passport.baidu.com/?center&tpl=tb&aid=6&default_tab=3#3,0">帐号设置</a></li>','<li class="u_tb_profile"><a href="',this._urls.itb_profile,'">贴吧设置</a></li>','<li class="fuwu_center"><a href="http://tieba.baidu.com/helpcenter/index" class="j_help-center" target="_blank">帮助中心</a></li>','<li class="u_logout"></li>',"</ul>"].join(""),n=this._ddls.usetting=this.use("DropDownList",s,e);n.innerContent("top",a),$("body").on("click.helpcenter",".j_help-center",function(){$.stats.track("helpcenter","UEG-track-click","userbar","click")}),t.no_un&&s.find(".u_tb_profile a").click(function(){return TbCom.process("User","buildUnameFrame"),!1}),s.find(".u_logout").append(this._btns.logout),this._btns.logout.click(function(){i._logout()})},_buildWallet:function(){var t=this.$root.find(".u_wallet"),i=$('<div class="u_menu_item u_menu_wallet"><a class="u_menu_wrap u_wallet_wrap j_wallet" title="点击查看T豆账单" href="#" onclick="return false;"></a></div>');t.append(i),t.find(".j_wallet").on("click",function(t){t.preventDefault(),_.Module.getInstance("common/widget/wallet_dialog",function(t){t.show()})})},_flowRateTest:function(){var t=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=1",function(i){i.data&&(t.location.href=i.data)})},_buildTShow:function(t){var i=this,s=this.$root.find(".u_tshow"),e="开通会员";t&&t.Parr_props&&t.Parr_props.level&&1e3*t.Parr_props.level.end_time>Env.server_time&&(e="续费会员");var a=$('<div class="u_menu_item u_menu_tshow"><a class="u_menu_wrap u_tshow_wrap j_btn_getmember" href="/tbmall/tshow" title="点击到支付中心'+e+'" target="_blank"></a></div>'),n='<ul><li class="u_tshow_buy"><a class="j_btn_getmember" href="#">'+e+'</a></li><li class="u_tshow_web"><a href="/tbmall/tshow" target="_blank">会员官网</a></li></ul>';s.append(a);var l=this._ddls.tshow=this.use("DropDownList",s,a);l.innerContent("top",n),s.find(".j_btn_getmember").on("click",function(){return PageData.user.is_login?(i._flowRateTest(),!1):(_.Module.use("common/widget/LoginDialog"),!1)})},_buildNews:function(){var t=this,i=this.$root.find(".u_news"),s=$('<div class="u_menu_item u_menu_news"><a href="#" class="u_menu_wrap u_news_wrap j_news" onclick="return false;"></a></div>');i.append(s);var e=this._ddls.news=this.use("DropDownList",i,s),a='<ul><li class="u_msg"></li><li class="u_notice"></li></ul>';e.innerContent("top",a),this._btns.msg=$('<a href="http://msg.baidu.com/" target="_blank">私信</a>'),this.$root.find(".u_msg").append(this._btns.msg),this._btns.notice=$('<a href="http://msg.baidu.com/msg/sys" target="_blank">通知</a>'),this.$root.find(".u_notice").append(this._btns.notice),TbCom.process("User","requestUserMessage",function(i){if(i){var s=0;"number"==typeof i.msgnum&&i.msgnum>0&&(t._btns.msg.append('(<span style="color:#ff0000" >'+i.msgnum+"</span>)"),s+=i.msgnum),"number"==typeof i.sysnum&&i.sysnum>0&&(t._btns.notice.append('(<span style="color:#ff0000" >'+i.sysnum+"</span>)"),s+=i.sysnum),s>0&&t.$root.find(".j_news").append("<span>"+s+"</span>")}})},_logout:function(){var t,i=0;try{t=PageData.user?PageData.user.name:PageData.user_info.name}catch(s){t=""}try{i="baidubrowser.tieba"==window.external.GetVersion("version")?!0:null}catch(s){i=null}(!$.cookie("baidu_broswer_setup_"+t)&&!i||"NaN"===$.cookie("baidu_broswer_setup_"+t))&&$.cookie("baidu_broswer_setup_"+t,0),TbCom.process("User","logout")}}}),_.Module.define({path:"common/widget/Userbar/DropDownList",requires:[],sub:{_ite:null,_wrapper:null,key:null,_listWrapper:null,_titWrapper:null,_conWrapper:null,_bottomConWrapper:null,_topConWrapper:null,initial:function(t,i,s){this._wrapper=t,this._ite=i,this.key=s,this._build()},_build:function(){var t=['<div class="u_ddl">','<div class="u_ddl_tit" ></div>','<div class="u_ddl_con">','<div class="u_ddl_con_top" ></div>','<div class="d_ddl_con_bottom"></div>',"</div>","</div>"].join("");this._listWrapper=$(t),this._wrapper.append(this._listWrapper),this._titWrapper=this._listWrapper.find(".u_ddl_tit:first"),this._conWrapper=this._listWrapper.find(".u_ddl_con:first"),this._topConWrapper=this._listWrapper.find(".u_ddl_con_top:first"),this._bottomConWrapper=this._listWrapper.find(".d_ddl_con_bottom:first"),this._bindEvents()},_bindEvents:function(){var t=this;t._wrapper.hover(function(){t.expand()},function(){t.close()})},_innerTopContent:function(t){"object"==typeof t?this._topConWrapper.append(t):"string"==typeof t&&this._topConWrapper.html(this._topConWrapper.html()+t)},_innerBottomContent:function(t){"object"==typeof t?this._bottomConWrapper.append(t):"string"==typeof t&&this._bottomConWrapper.html(this._bottomConWrapper.html()+t),this._bottomConWrapper.css("display","block")},expand:function(){this._ite.addClass("u_menu_hover");var t=this._ite.position();this._listWrapper.css({display:"block"});var i=this._ite.innerWidth();this.key&&"uname"==this.key&&(i=this._ite.find(".u_username_title").innerWidth());var s=this._conWrapper.width()-i;this._titWrapper.css({width:i,left:s+1}),s=t.left-s,this.key&&"uname"==this.key&&(s+=22),this._listWrapper.css({left:s})},close:function(){this._ite.removeClass("u_menu_hover"),this._listWrapper.css("display","none")},innerContent:function(t,i){"top"==t?this._innerTopContent(i):"bottom"==t&&this._innerBottomContent(i)}}});_.Module.define({path:"common/widget/top_banner",sub:{_jq_container:null,_cookie_key:"top_banner_close",_show:function(){this._jq_container.show(),this._moveUserBar(!0),$.stats.sendRequest("fr=tb0_forum&st_mod=top_banner&st_type=show"),this._jq_container.find(".j_top_banner_img").click(function(){$.stats.sendRequest("fr=tb0_forum&st_mod=top_banner&st_type=click")})},_hide:function(){this._jq_container.hide(),this._moveUserBar(!1)},_moveUserBar:function(e){e?$("head").append('<style id="top_banner_pos">body #com_userbar{top:32px;} body .ui_bubble_wrap{top:50px;}</style>'):$("#top_banner_pos").remove()},_bindEvents:function(){var e=this;e._jq_container.find(".j_top_banner_close").click(function(){$.cookie(e._cookie_key,1,{expires:1}),e._hide(),$.stats.sendRequest("fr=tb0_forum&st_mod=top_banner&st_type=close")})},initial:function(){this._jq_container=$("#top_banner");var e=$.cookie(this._cookie_key);1!=e&&(this._show(),this._bindEvents())}}});_.Module.define({path:"common/widget/footer",requires:[],sub:{initial:function(){this._handleEvents()},_handleEvents:function(){var i=$("#btnFroceToPad");i.bind("click",function(){$.cookie("tb_device",null),url=window.location.href.toString(),-1!==url.indexOf("kw")&&-1===url.indexOf("ie=utf-8")&&(url+=-1!==url.indexOf("?")?"&ie=utf-8":"?ie=utf-8"),window.location.href=url})}}});_.Module.define({path:"common/widget/MobileTip",sub:{initial:function(){function i(){$("#tbMobileTip").remove(),$.cookie("mobile_tip_closed","1",{expires:1})}var e="1"==$.cookie("wap_skipped"),o="1"==$.cookie("mobile_tip_closed");if(e&&!o){var t="http://wapp.baidu.com/",l=["<div id='tbMobileTip' class='tb_mobile_tip'>","<div class='tb_mobile_tip_title'>手机浏览时建议您：</div>","<div class='tb_mobile_tip_content'>直接<a href='#{link}' class='ui_text_link'>访问手机贴吧</a>，签到经验更多，浏览体验更好！</div>","<div class='tb_mobile_tip_close'></div>","</div>"].join(""),b=$($.tb.format(l,{link:t}));b.find(".tb_mobile_tip_close").bind("click",i).bind("touch",i),$(".wrap1").before(b)}}}});_.Module.define({path:"common/widget/poptip",sub:{_cookieKey:"poptip_0",initial:function(o){o=o||{};var e=$("#common_poptip_html").html(),i=/pv_code=.?(\d+).?/.exec(e);null!=i&&(this._cookieKey="poptip_"+i[1]),this._isShowed(this._cookieKey)||this._show(e,o)},_show:function(o,e){var i=this,t={content:o,arrow_dir:"up",bubble_css:{top:20,right:20,width:null!=e.width?e.width:228},arrow_pos:{right:15},wrap:$("body"),closeBtn:!0,arrowReq:!1},n=new UiBubbleTipBase(t);n.bind("onclose",function(){i._setShowed(i._cookieKey),n.closeBubble()}),n.showBubble()},_setShowed:function(o){$.cookie(o,1,{expires:30})},_isShowed:function(o){return null!=$.cookie(o)}}});var Page={modules:{},checkLoadedModules:function(t){return this.modules[t]?!0:(this.modules[t]=!0,!1)},toQuerystring:function(t){var e="";for(var r in t)e+=r+"="+t[r]+"&";return e.substr(0,e.length-1)},isBaiduDomain:function(t){var e=/^((https:\/\/|http:\/\/|ftp:\/\/|rtsp:\/\/|mms:\/\/)(([0-9a-zA-Z\.\-\_]+\.baidu.com[:8090]*)|(baidu.com))\/)/;return e.test(t)},isAlbumImg:function(t){var e=/^http:\/\/[^\/\?]*?\.baidu\.com[:8090]*\/(\w+)\/([^\/\?]+)\/([^\/\?]+)\/(\w+?)\.(?:webp|jpg)/;return e.test(t)},resizePic:function(t,e,r,a){var n=e||120,i=r||120,s=!1,g=new Image;g.src=t.src;var o=Page.getRightWH(g.width,g.height,n,i);return t.style.width=o[0]+"px",t.style.height=o[1]+"px",t.style.visibility="visible",1==a&&(t.style.marginTop=(r-parseInt(o[1]))/2+"px"),g=null,s},getRightWH:function(t,e,r,a){var n=0,i=t,s=e;switch(t>r&&(n+=1),e>a&&(n+=2),n){case 1:i=r,i=e*r/t;case 2:s=a,i=t*a/e;case 3:s=e/a>t/r?a:e*r/t,i=e/a>t/r?t*a/e:r}return 0!=n&&(need_resize=!0),[i,s]},resizcImg:function(t,e){var r=!1,a=t;if(0==a.width){var n=this,i=arguments;return setTimeout(function(){i.callee.apply(n,i)},100),!1}a.width>e&&(r=!0);var s=Page.getImgRightWH(a.width,a.height,e);return t.style.width=s[0]+"px",t.style.height=s[1]+"px",t.style.visibility="visible",r},getImgRightWH:function(t,e,r){var a=t,n=e;return t>r&&(a=r,n=e*r/t),a=parseInt(a),n=parseInt(n),[a,n]},resetChangedSizeImage:function(t,e){if(t&&e&&"old"==t){if(Page.resizcImg(e,570)){var r=e;Page.isBaiduDomain(r.src)&&(r.style.cursor="pointer",r.title="点击查看原图",r.onclick=function(t){try{t||(t=window.event);var e=t.target||t.srcElement;NsLogLinker.isOutLink(e.src)&&NsLogLinker.stat(e.src,110),window.open(e.src,"_blank")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/util/util.js",method:"",ln:122}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/util/util.js",linenum:122}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/util/util.js","linenum:122")}})}return!0}},bindOpenImg:function(){var t,e,r,a,n,i=$("#j_p_postlist"),s=i.find(".j_d_post_content"),g=i.find(".BDE_Image");s.find(".BDE_Smiley[setCursor!=1]").each(function(){var t=$(this);t.width()>570&&t.width(570),t.tbattr("setCursor",1)}),s.find(".BDE_Smiley2[setCursor!=1]").each(function(){var t=$(this);t.width()>570&&t.width(570),t.tbattr("setCursor",1)});for(var o=$.browser.msie&&$.browser.version<=7,u=0,c=g.length;c>u;u++){var l=g[u];l&&(t=$(l),a=t.closest(".l_post"),n=a&&a.getData(),Page.isAlbumImg(l.src)&&"album_pb"!=PageData.pageType&&t.height()>=80&&t.width()>=80&&t.height()*t.width()>=1e4&&n&&101!=n.content.ptype.substr(0,3)&&(t.click(function(t){try{var a=t.target||t.srcElement,n=1;e=$(a).tbattr("src");var i=$(a).closest(".l_post");i&&(postData=i.getData(),postData.author.user_name!=PageData.thread.author&&(n=0)),r=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."));var s=$(a).closest(".j_d_post_content").find("#j_pb_repost"),g="";if(0==s.length)g="http://tieba.baidu.com/photo/p?kw="+PageData.forum.name_url+"&flux=1&tid="+PageData.thread.thread_id+"&pic_id="+r+"&pn=1&fp=2&see_lz="+n;else{var o=s.getData();g="http://tieba.baidu.com/photo/p?kw="+o.fname+"&flux=1&tid="+o.tid+"&pic_id="+r+"&pn=1&fp=2&see_lz="+n}window.open(g,"_blank"),$.stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=album_pic&st_value=click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/util/util.js",method:"",ln:184}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/util/util.js",linenum:184}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/util/util.js","linenum:184")}}),o?$(l).css("cursor","pointer").tbattr("title","点击进入连续看图模式"):$(l).css("cursor","url('http://tb2.bdstatic.com/tb/static-pb/img/cur_zin.cur'),pointer")))}},changeNumber:function(t,e){var r=PageData.curr_page_num,a=PageData.all_page_num;if("input"!=e.tagName&&"INPUT"!=e.tagName&&r>0&&a>=r){var n=0,i=PageData.thread_cur_url,s=/&pn=[^&]+/;return s.exec(i)&&(i=RegExp.leftContext+RegExp.rightContext),n=30*(r-1+t),n>=0&&30*(a-1)>=n&&$.tb.location.setHref(i+"&pn="+n),!0}return!1},changeVersion:function(t){var e=PageData.thread_cur_url,r=/&rs1=[^&]+/;r.exec(e)&&(e=RegExp.leftContext+RegExp.rightContext),$.tb.location.setHref(e+"&rs1="+t)},changeVersionPhp:function(t){var e=PageData.thread_cur_url,r=/&v=[^&]+/;r.exec(e)&&(e=RegExp.leftContext+RegExp.rightContext),$.tb.location.setHref(e+"&v="+t)},init:function(){Page.resetChangedSizeImage()},checkErrorImage:function(t){var e=t.parentNode;e.innerHTML="<br><img src='http://yourimgloaderroratbaidu' border='0'/>"},sign_change_img:function(t){t.src="http://tb2.bdstatic.com/tb/static-itieba/img/sign_err.png",t.width=100,t.height=25},login:function(){TbCom.process("User","buildLoginFrame")},isString:function(t){return"string"==typeof t},escapeHTML:function(t){return Page.isString(t)?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t},getByteLength:function(t){return t.replace(/[^\x00-\xff]/g,"mm").length},subByteFix:function(t,e,r){if(Page.getByteLength(t)<=e)return t;for(var a=Math.floor((e-2)/2),n=t.length;n>a;a++){var i=t.substring(0,a);if(Page.getByteLength(i)==e)return i+(r?r:"");if(Page.getByteLength(i)>e)return t.substring(0,--a)+(r?r:"")}return t}};Page.Date={},Page.Date.lang={},Page.Date.lang.dayNames=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],Page.Date.lang.abbreviatedDayNames=["日","一","二","三","四","五","六"],Page.Date.lang.shortestDayNames=["日","一","二","三","四","五","六"],Page.Date.lang.firstLetterDayNames=["日","一","二","三","四","五","六"],Page.Date.format=function(t,e){var r=t,a=function(t){return 10>t?"0"+t:t};return e.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?/g,function(t){switch(t){case"hh":return a(r.getHours()<13?0===r.getHours()?12:r.getHours():r.getHours()-12);case"h":return r.getHours()<13?0===r.getHours()?12:r.getHours():r.getHours()-12;case"HH":return a(r.getHours());case"H":return r.getHours();case"mm":return a(r.getMinutes());case"m":return r.getMinutes();case"ss":return a(r.getSeconds());case"s":return r.getSeconds();case"yyyy":var e="000"+r.getFullYear();return e.substring(e.length-4);case"yy":return r.toString("yyyy").substring(2);case"dddd":return Page.Date.lang.dayNames[r.getDay()];case"ddd":return Page.Date.lang.abbreviatedDayNames[r.getDay()];case"dd":return a(r.getDate());case"d":return r.getDate().toString();case"MM":return a(r.getMonth()+1);case"M":return r.getMonth()+1}})};var NoSkinList=function(){this._forumList=[],this._key="TB_NOBG_FORUMS",this._capacity=10};$.extend(NoSkinList.prototype,{init:function(){this.load()},getIndex:function(i){return $.inArray(String(i),this._forumList)},exist:function(i){return this.getIndex(i)>=0},add:function(i){i=String(i),this.exist(i)||this._forumList.push(i),this._restrict(),this._save()},remove:function(i){var n=this.getIndex(i);n>=0&&this._forumList.splice(n,1),this._save()},_restrict:function(){var i=this._forumList,n=i.length-this._capacity;n>0&&i.splice(0,n)},_save:function(){var i=this._forumList.join("-");$.cookie(this._key,i,{expires:30,path:"/"})},load:function(){var i=$.cookie(this._key)||"";i.length>0&&(this._forumList=i.split("-"))}});var UserSkinManager=function(){this._skinId=UserSkinManager.DEFAULT_SKINID,this._noskinForumList=null,this._fid=-1};UserSkinManager.DEFAULT_SKINID=1,$.extend(UserSkinManager.prototype,{init:function(i){null!=i.skinId&&(this._skinId=i.skinId),this._fid=i.forumId,this._noskinForumList=new NoSkinList,this._noskinForumList.init();var n=this._skinId;if(n!=UserSkinManager.DEFAULT_SKINID){var t=this.isSkinEnabled();t||(n=UserSkinManager.DEFAULT_SKINID)}return this.setSkin(n),this},isDefaultSkin:function(){return this._skinId===UserSkinManager.DEFAULT_SKINID},isSkinEnabled:function(){return!this._noskinForumList.exist(this._fid)},enableSkin:function(){this._noskinForumList.remove(this._fid),this.setSkin(this._skinId),this.doAfterChange(!0)},disableSkin:function(){this._noskinForumList.add(this._fid),this.setSkin(UserSkinManager.DEFAULT_SKINID),this.doAfterChange(!1)},setSkin:function(i){var n=["http://tb1",".bdstatic.com/tb/cms/common/tbskin/skins/skin_",i,".css?v=",PageUnit.load("tbskin_version")].join(""),t=$("#css_skin");0==t.size()?$('<link id="css_skin" href="'+n+'" rel="stylesheet">').appendTo("head"):t.tbattr("href",n);var s=$("body"),e=s.tbattr("class");e=e?e.replace(/skin_\d+/g,""):"",s.tbattr("class",e),s.addClass("skin_"+i)},resetSkin:function(i){this._skinId=i,this.setSkin(i)},doAfterChange:function(){},initPageComponents:function(i){this.doAfterChange=function(n){this.changeBtnStatus(i,n)},this.bindBtnEvent(i),this.isDefaultSkin()||this.changeBtnStatus(i,this.isSkinEnabled())},changeBtnStatus:function(i,n){n?(i.jq_btnSkinOn.hide(),i.jq_btnSkinOff.show()):(i.jq_btnSkinOn.show(),i.jq_btnSkinOff.hide())},bindBtnEvent:function(i){var n=this;i.jq_btnSkinOn.find("a").bind("click",function(){n.enableSkin()}),i.jq_btnSkinOff.find("a").bind("click",function(){PageData.user.is_login?n.disableSkin():TbCom.process("User","buildLoginFrame",null,null,{onAfterLogined:function(){n.disableSkin()}})})}});_.Module.define({path:"common/widget/search_handler",sub:{_staticUrl:{no_key:"http://tieba.baidu.com/","\u8d34\u5427\u6295\u8bc9":"http://tieba.baidu.com/tousu/new","\u5e16\u5427\u6295\u8bc9":"http://tieba.baidu.com/tousu/new",tiebatousu:"http://tieba.baidu.com/tousu/new","\u8d34\u5427\u6295\u8bc9\u5427":"http://tieba.baidu.com/tousu/new","\u8d34\u5427\u6295\u8bc9\u4e2d\u5fc3":"http://tieba.baidu.com/tousu/new","\u6295\u8bc9\u4e2d\u5fc3":"http://tieba.baidu.com/tousu/new","\u6295\u8bc9":"http://tieba.baidu.com/tousu/new","\u8d34\u5427\u4e3e\u62a5":"http://tieba.baidu.com/tousu/new","\u77e5\u9053\u6295\u8bc9":"http://tousu.baidu.com/zhidao","\u7a7a\u95f4\u6295\u8bc9":"http://tousu.baidu.com/hi","\u767e\u79d1\u6295\u8bc9":"http://tousu.baidu.com/baike",zhidaotousu:"http://tousu.baidu.com/zhidao",kongjiantousu:"http://tousu.baidu.com/hi",baiketousu:"http://tousu.baidu.com/baike"},_sendStatistics:function(b,a){$.stats.sendRequest("st_mod=search&search_type="+b)},initial:function(){},toStaticUrl:function(b){var a=b.toLowerCase();if(this._staticUrl.hasOwnProperty(a)){$.tb.location.setHref(this._staticUrl[a]);return false}},enterBa:function(a,b){if(a==""){$.tb.location.setHref(this._staticUrl.no_key);return false}this.toStaticUrl(a);var d=[];if(a.indexOf("\uff1a")!=-1){d=a.split("\uff1a")}else{d=a.split(":")}if(d.length==2){if(d[0]=="\u6807\u7b7e"){this._sendStatistics("tagsearch",a);$.tb.location.setHref("/f/search/fm?ie=utf-8&tag="+encodeURIComponent(d[1]));return false}else{if(d[0].indexOf("\u5427\u5185")!=-1){var c=d[0].split("\u5427\u5185")[0];if(c){this._sendStatistics("baneisearch",a);$.tb.location.setHref("/f/search/res?ie=utf-8&kw="+encodeURIComponent(c)+"&qw="+encodeURIComponent(d[1]));return false}}}}if(PageData.search_what&&b!="fromBtn"){if(PageData.search_what=="composite"){this._sendStatistics("compositesearch",a);$.tb.location.setHref("/f/search/res?ie=utf-8&qw="+encodeURIComponent(a));return false}else{if(PageData.search_what=="forum"){this._sendStatistics("forumsearch",a);$.tb.location.setHref("/f/search/fm?ie=utf-8&qw="+encodeURIComponent(a));return false}}}this._sendStatistics("enterba&from=search",a);$.tb.location.setHref("/f?ie=utf-8&kw="+encodeURIComponent(a)+"&fr=search");return false},searchPost:function(a){if(!window.history_search_post){if(PageData.user.is_login){$.tb.post("/f/search/addWord",{word:a},function(b){if(b.no==0){window.history_search_post=false}})}window.history_search_post=true}this._sendStatistics("postsearch",a);setTimeout(function(){$.tb.location.setHref("/f/search/res?ie=utf-8&qw="+encodeURIComponent(a))},100);return false},searchPostInBa:function(c,a){var b="/f/search/res?ie=utf-8&kw="+encodeURIComponent(a)+"&qw="+encodeURIComponent(c);if(!window.history_search_post){if(PageData.user.is_login){$.tb.post("/f/search/addWord",{word:c},function(d){if(d.no==0){window.history_search_post=false}})}window.history_search_post=true}this._sendStatistics("baneisearch",c);setTimeout(function(){$.tb.location.setHref(b)},100);return false},searchPeople:function(a){this._sendStatistics("peoplesearch",a);$.tb.location.setHref("/f/search/sure?ie=utf-8&only_user=1&qw="+encodeURIComponent(a));return false},searchTag:function(a){this._sendStatistics("tagsearch",a);$.tb.location.setHref("/f/search/fm?ie=utf-8&tag="+encodeURIComponent(a));return false},searchForum:function(b){var a="/f/search/fm?ie=UTF-8&";if(b.indexOf("\u6807\u7b7e\uff1a")!=-1){b=b.substr(b.indexOf("\u6807\u7b7e\uff1a")+3);a=a+"tag="+encodeURIComponent(b)}else{if(b.indexOf("\u6807\u7b7e:")!=-1){b=b.substr(b.indexOf("\u6807\u7b7e:")+3);a=a+"tag="+encodeURIComponent(b)}else{a=a+"qw="+encodeURIComponent(b)}}$.tb.location.setHref(a);return false}}});_.Module.define({path:"common/widget/search_dialog",requires:["common/widget/search_handler"],sub:{_DLG_ID:"tb_header_search_dlg",_options:{defaultType:"post",style:null,forumName:null,page:null},_searchHandler:null,_jq_wrap:null,_jq_input:null,_jq_form:null,initial:function(a){$.extend(this._options,a);this._initOptPage();this._searchHandler=this.use("common/widget/search_handler");this._initDlg()},_initOptPage:function(){if(this._options.page==null){if(/^\w+:\/\/[^\/]+\/(index\.html?)|(i\/\d+)/.test($.tb.location.getHref())){this._options.page="index"}else{if(/^\w+:\/\/[^\/]+\/tb\/picture\/(index\.html?)/.test($.tb.location.getHref())){this._options.page="picture_index"}else{if(PageData.product=="itieba3"){this._options.page="itieba"}}}}},_initDlg:function(){var a=this._createDlgHtml();new $.dialog({html:a,title:"\u8bf7\u8f93\u5165\u60a8\u8981\u627e\u7684\u5185\u5bb9",width:482});this._jq_wrap=$("#"+this._DLG_ID);this._jq_input=this._jq_wrap.find(".j_kw");this._jq_form=this._jq_wrap.find(".j_form");this._bindEvents()},_bindEvents:function(){var a=this;a._jq_form.bind("submit",function(){a.submit();return false});a._jq_input.focus()},_formSubmitHandler:function(){var a=this._getSearchType(),b=this._jq_input.val();return this.handleSubmit(a,b)},submit:function(){var a=this.getSearchWord();switch(this._options.defaultType){case"post":this._searchHandler.searchPost(a);break;case"benba":this._searchHandler.searchPostInBa(a,this._options.forumName);break}return false},getSearchWord:function(){var a=this._jq_input.val();a=a.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"");return a},_getSearchType:function(){var b=CommonSearch.SearchConfig.searchTypes.tieba;var a=this._jq_wrap.find("input:checked").tbattr("class");var d=CommonSearch.SearchConfig.radioClasses;for(var c in d){if(d[c]==a){b=CommonSearch.SearchConfig.searchTypes[c];break}}return b},_createDlgHtml:function(){var a='<div id="'+this._DLG_ID+'" class="search_dialog_bright"><form name="f1" class="j_form"  action="/f"><input autocomplete="off" size="42" tabindex="1" name="kw" class="j_kw s_ipt tb_header_search_input" maxlength="100" /><span class="s_btn_wr">';if(this._options.defaultType==="post"){a+='<input type="submit" value="\u8d34\u5427\u641c\u7d22" class="j_submit s_btn" onmousedown="this.className=\'s_btn s_btn_h\'" onmouseout="this.className=\'s_btn\'" /></span></form>'}else{a+='<input type="submit" value="\u5427\u5185\u641c\u7d22" class="j_submit s_btn" onmousedown="this.className=\'s_btn s_btn_h\'" onmouseout="this.className=\'s_btn\'" /></span></form>'}a+="</div>";return a}}});_.Module.define({path:"common/widget/search_bright",requires:["common/widget/search_handler","common/widget/search_dialog"],sub:{_jq_wrap:null,_jq_input:null,_jq_input_box:null,_jq_form:null,_options:{defaultType:"tieba",style:"",forumName:"",page:null},_tip:null,_searchHandler:null,_switchRadios:{},_radioClasses:{tieba:"jointb",itieba:"authortb",post:"searchtb",benba:"nowtb",tag:"searchtag",forum:"searchforum"},_searchTypes:{tieba:1,itieba:2,post:3,benba:4,tag:5,forum:6},_searchFixed:null,initial:function(b,a){this._jq_wrap=b;this._jq_form=b.find(".j_search_form");this._jq_input=b.find("#wd2");this._jq_input_box=b.find(".j_search_input");this._tip=PageUnit.load("search_input_tip");this._searchFixed=a.searchFixed;PageData.searchFixed=this._searchFixed;$.extend(this._options,a);this._foolInit();this._initOptPage();this._searchHandler=this.use("common/widget/search_handler");this._setSwitchRadios();this._setDefaultType();this._setSearchType(this._options.defaultType);this._initPlaceholder();this._bindEvents();if($.browser.msie&&parseInt($.browser.version)<=7){return false}this._searchScrollFixed();TbCom.process("Suggestion","createMainSearchSuggestion")},_setSwitchRadios:function(){var a=this;for(var b in this._searchTypes){this._switchRadios[b]=a._jq_wrap.find(".switch_radios ."+a._radioClasses[b]+":first")}},_setDefaultType:function(){var a=$.tb.location.getHref();if(a.indexOf("/f/search/fm")!=-1){this._options.defaultType="forum"}else{if(a.indexOf("/f/search/res")!=-1){this._options.defaultType="post"}else{if(a.indexOf("/f/search/sure")!=-1){this._options.defaultType="itieba"}}}if(this._options.style=="bright_3"){this._options.defaultType="benba"}},_getSearchType:function(){var b=null;if(this._options.theme&&this._options.theme=="bright_pb"){b=this._searchTypes.benba;return b}else{b=this._searchTypes.tieba}for(var c in this._switchRadios){var a=this._switchRadios[c];if(!a.tbattr("checked")){continue}b=this._searchTypes[c];break}return b},_setSearchType:function(a){if(a in this._switchRadios){if(this._searchTypes[a]=="2"){this._switchRadios.tieba.tbattr("checked",false)}this._switchRadios[a].tbattr("checked",true)}},_bindEvents:function(){var a=this;this._jq_wrap.find("#search_button").on("click",function(){if(PageData.product==="frs"){$.stats.track("FRS_\u53f3\u4fa7\u4e0a\u65b9\u5c0f\u56fe","PC\u7aef\u5546\u4e1a\u5316\u6e38\u620f\u7edf\u8ba1",PageData.product||"","\u70b9\u51fb",{obj_url:"-",obj_name:"-",obj_type:"\u6e38\u620f"})}else{if(PageData.product==="pb"){$.stats.track("PB_\u53f3\u4fa7\u4e0a\u65b9\u5c0f\u56fe","PC\u7aef\u5546\u4e1a\u5316\u6e38\u620f\u7edf\u8ba1",PageData.product||"","\u70b9\u51fb",{obj_url:"-",obj_name:"-",obj_type:"\u6e38\u620f"})}}});this._jq_wrap.find(".j_search_nav a").click(function(){a._changeProduct($(this))});this._jq_form.submit(function(){if(a._options.style=="bright_3"||a._options.style=="bright_4"){a.handleSubmit(a._getSearchType(),a.getSearchWord())}else{a.submit()}return false});this._jq_wrap.find(".j_enter_ba").click(function(){a.submit("fromBtn");return false});this._jq_wrap.find(".j_search_post").click(function(){if(a._options.style=="bright_3"||a._options.style=="bright_4"){a.handleSubmit(a._getSearchType(),a.getSearchWord())}else{a._searchPost()}return false});this._jq_wrap.find(".j_benba_search").click(function(){if(a._options.theme=="bright_pb"){a.handleSubmit(a._getSearchType(),a.getSearchWord())}});this._jq_input_box.bind("webkitspeechchange",function(){a.submit()});if($.browser.webkit){this._jq_input_box.click(function(){this.select()})}else{this._jq_input_box.focus(function(){this.select()})}},submit:function(b){var a=this.getSearchWord();if($("#searchtag").tbattr("checked")){this._searchHandler.searchTag(a)}else{this._searchHandler.enterBa(a,b)}return false},handleSubmit:function(c,a){var b=true;switch(c){case this._searchTypes.tieba:b=this._searchHandler.enterBa(a);break;case this._searchTypes.itieba:b=this._searchHandler.searchPeople(a);break;case this._searchTypes.post:b=this._searchHandler.searchPost(a);break;case this._searchTypes.benba:b=this._searchHandler.searchPostInBa(a,this._options.forumName);break;case this._searchTypes.tag:b=this._searchHandler.searchTag(a);break;case this._searchTypes.forum:b=this._searchHandler.searchForum(a);break;default:b=true;break}return b},_initOptPage:function(){if(this._options.page==null){if(/^\w+:\/\/[^\/]+\/(index\.html?)|(i\/\d+)/.test($.tb.location.getHref())){this._options.page="index"}else{if(/^\w+:\/\/[^\/]+\/tb\/picture\/(index\.html?)/.test($.tb.location.getHref())){this._options.page="picture_index"}else{if(PageData.product=="itieba3"){this._options.page="itieba"}}}}},_changeProduct:function(i){var k=this.getSearchWord();var a=$.tb.unescapeHTML(i.tbattr("href"));var h=$.tb.unescapeHTML(i.tbattr("param"));if(k==""){var f=a.match(/^(\w+:\/\/[^\/]+)/i);var b=a.match(/fr=[^&]+/i);var c=[];var d="";if(b!=null&&b.length>0){c.push(b[0])}if(c.length>0){d="/?"+c.join("&")}i.tbattr("href",f&&f[1]+d)}else{if(h!=null&&h!=""){if(a.indexOf("www.baidu.com")>=0){var g="fr=tb01000&";if($.tb.location.getHref().match("ftype=guide")){g="fr=tb01se0&"}var j=a.indexOf("fr=");if(j>-1){i.tbattr("href",a.substring(0,index)+g)}else{i.tbattr("href",a+g)}}var e=i.tbattr("ie");if(e!=null&&e.match(/utf-?8/gi)!=null){k=encodeURIComponent(k)}else{k=k.replace(/\%/gi,"%25").replace(/&/gi,"%26").replace(/\+/gi,"%2B").replace(/[\ \u3000]/gi,"%20").replace(/\//gi,"%2F").replace(/\#/gi,"%23").replace(/\=/gi,"%3D")}var j=a.indexOf(h+"=");if(j>-1){i.tbattr("href",a.substring(0,j)+h+"="+k)}else{i.tbattr("href",a+h+"="+k)}}}},_searchPost:function(){var a=this.getSearchWord();var b=$.extend({},this._options);b.defaultType="post";if(a==""){this.use("common/widget/search_dialog",b)}else{this._searchHandler.searchPost(a)}},_initPlaceholder:function(){var a=this;if($.inArray(a._options.page,["index","picture_index","itieba"])){if(a._tip=="0"){_.Module.use("common/widget/Placeholder",[a._jq_input_box,a._tip,{color:"#bbb","font-size":"13px"}])}}else{a._jq_input.bind("mousedown focus",function(){if(a._jq_input.val()===a._tip){a._jq_input.val("");a._jq_input_box.val("")}})}},_voiceInput:function(){var b=this.getSearchWord();var a=b.indexOf(this._tip);if(a===0){b=b.slice(this._tip.length);this._jq_input.val(b);this._jq_input_box.val(b)}this.submit()},getSearchWord:function(){return this._jq_input_box.val()},isDefaultTip:function(){return(this._jq_input_box.val()===this._tip&&this._jq_input_box.hasClass("s_ipt_tip"))||this._jq_input_box.val()===""},_searchScrollFixed:function(){var b=this;if(!this._searchFixed){return}var d=$("#head").find(".search_main");var a=$(".search_main").offset().top;var c=false;$(window).scroll(function(){setTimeout(function(){var e=$(window).scrollTop();if(e>a){if(c){return}$(".senior-search-link").css({visibility:"hidden"});d.addClass("search_main_fixed").hide();d.fadeIn(500);d.find(".search_form").addClass("search_form_fixed");d.find(".search_ipt").addClass("search_ipt_fixed");d.find(".search_btn").addClass("search_btn_fixed");d.find(".search_btn_enter_ba").addClass("search_btn_enter_ba_fixed");d.find("#search_logo_small").addClass("search_logo_fixed");d.find("#tb_header_search_form").addClass("j_search_form_fixed");$("#search_logo_small").addClass("search_logo_fixed");$("#tb_header_search_form").addClass("j_search_form_fixed");c=true}else{if(!c){return}$(".senior-search-link").css({visibility:"visible"});$("#search_baidu_promote").show();$("#search_button_wrapper").show();d.removeClass("search_main_fixed");d.find(".search_form").removeClass("search_form_fixed");d.find(".search_ipt").removeClass("search_ipt_fixed");d.find(".search_btn").removeClass("search_btn_fixed");d.find(".search_btn_enter_ba").removeClass("search_btn_enter_ba_fixed");d.find("#search_logo_small").removeClass("search_logo_fixed");d.find("#tb_header_search_form").removeClass("j_search_form_fixed");c=false}b._fixUserbar(c)},1)})},_fixUserbar:function(d){var b=$("#head .search_form");var a=$("#com_userbar");var c=a.children("ul");if(d){c.children().hide();c.find(".u_tbmall").show();c.find(".u_tbmall").next("li.split").show();c.find(".u_tshow").show();b.append(a).css({position:"relative"})}else{c.children().show();$("body").append(a);b.css({position:""})}},_foolInit:function(){var c=$(".fool_wrapper a");if(c.length==0||c.tbattr("href").split("#")[1]!="fool"){return}var b=$("#fool_wrap");var a=new $.modal();$(c).click(function(d){d.preventDefault()});c.one("click",function(d){d.preventDefault();$.ajax({url:"/game/commit/foolDay",type:"post",dataType:"json",success:function(g){var e=g.output;if(e){var f=e.key;var h=e.pwd;b.find(".fool_go").tbattr("href","/f?kw=%B2%CA%C6%B1&tab=lc_mylottery#/user/coupon?key="+f+"&pwd="+h)}else{b.find(".fool_des").addClass("fool_des2");b.find(".fool_go").addClass("fool_go2").tbattr("href","/f?kw=%B2%CA%C6%B1&tab=lc_ssq#/lottery/ssq/?random=1")}a.show();b.show();$("body").css("overflow","hidden")}})});$(".fool_close").on("click",function(){a.hide();b.hide();$("body").css("overflow","auto")})}}});_.Module.define({path:"pb/widget/TbSafe",sub:{initial:function(){try{$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-common/lib/tb_safe.js",function(){TbSafe&&TbSafe.run()})}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/tb_safe/tb_safe.js",method:"",ln:12}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/tb_safe/tb_safe.js",linenum:12}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/tb_safe/tb_safe.js","linenum:12")}}}});_.Module.define({path:"common/widget/ScrollPanel",sub:{dom:null,$content:null,$scrollBar:null,$scrollButton:null,_hasScroll:false,_scrollStep:50,_scrollTop:0,_maxHeight:0,initial:function(a){this._buildUI(a);this._bindEvents(a);$(a.container).append(this.dom);this.setHeight(a.height||100);if(a.content){this.setContent(a.content)}if(a.scrollBarShow){this.bind("onScrollBarShow",a.scrollBarShow)}if(a.scrollBarHide){this.bind("onScrollBarHide",a.scrollBarHide)}},_buildUI:function(b){var a=this,c={left:0,top:0};this.dom=$('<div class="tbui_scroll_panel"></div>');this.dom.html(['<div class="tbui_panel_content j_panel_content clearfix"><ul></ul></div>','<div class="tbui_scroll_bar j_scroll_bar">','<div class="tbui_scroll_button j_scroll_button">&nbsp;</div>',"</div>"].join(""));this.$content=this.dom.find(".j_panel_content:first");this.$scrollBar=this.dom.find(".j_scroll_bar:first");this.$scrollButton=this.dom.find(".j_scroll_button:first");if(b.padding){this.$content.css("padding",b.padding)}},_bindEvents:function(b){var a=this,c=a.$content.get(0);this.$scrollButton.on("drag",function(d,e){if(!e){return}var f=e.position;c.scrollTop=f.top/a.$content.height()*c.scrollHeight});this.$content.mousewheel(function(d,e){d.preventDefault();d.stopPropagation();if(!a._hasScroll){return}a.scrollTopTo(a._scrollTop-e*a._scrollStep)})},scrollTopTo:function(c){var a=this,b=a.$content.get(0);var c=Math.max(Math.min(c,b.scrollHeight-a.$content.height()),0);if(c==a._scrollTop){return}a._scrollTop=c;a.$content.stop();a.$content.scrollTop(a._scrollTop);a._resizeScroll()},setHeight:function(a){this._maxHeight=a;this._resizeHeight();this._resizeScroll();this.$scrollButton.draggable({containment:"parent"})},setContent:function(a){this.$content.html(a);this.$content.get(0).scrollTop=this._scrollTop=0;this._resizeHeight();this._resizeScroll()},appendContent:function(a){this.$content.append(a);this._resizeHeight();this.scrollTopTo(20000)},clearContent:function(){this.setContent("")},_resizeHeight:function(){this.$content.css("height","");var b=this.$content.get(0),c=b.scrollHeight,a=Math.min(c,this._maxHeight);this.$content.css("height",a)},_resizeScroll:function(){var c=this.$content.get(0),d=c.scrollHeight,b=c.scrollTop,a=this.$content.innerHeight();if(d<=a){this.$scrollBar.hide();this.dom.addClass("tbui_no_scroll_bar");this.trigger("onScrollBarHide");this._hasScroll=false}else{this.$scrollBar.show();this.$scrollBar.height(a);this.$scrollButton.height(a/d*a);this.$scrollButton.css("top",b/d*a);this.trigger("onScrollBarShow");this._hasScroll=true}}}});_.Module.define({path:"common/component/CaptchaDialog",requires:["common/component/Captcha"],sub:{template:["<div class='tbui_captcha_dialog'>","<div class='tbui_captcha_container'></div>",'<div class="j_button_bar"><a href="#" class="ui_btn ui_btn_m j_ok"><span><em>\u786e \u5b9a</em></span></a></div>',"</div>"].join(""),initial:function(c){var a=this;var h;var b=$(this.template);this.$content=b;var g=c.title||"\u53d1\u8868\u8d34\u5b50";var f=typeof c.modal=="undefined"?true:c.modal;this.options=c;c.container=b.find(".tbui_captcha_container");this.normalCaptcha=null;this.gridCaptcha=null;this.captcha=this._initCaptchaInstance(c);var d=540;if(c.vCodeType==4){d=360;this.gridCaptcha=this.captcha}else{this.normalCaptcha=this.captcha}h=new $.dialog({title:g,width:d,html:b,modal:f});var e=b.find(".j_ok").click(function(i){i.preventDefault();i.stopPropagation();a.accept()});if(c.vCodeType==4){e.detach()}this.$okButton=e;this.dialog=h},_initCaptchaInstance:function(c){var a=this;var b=this.use("common/component/Captcha",c);b.bind("captcha_submit",function(){a.accept()});b.bind("captcha_type_change",function(e,f,d){a.updateCaptchaImg(f,d)});return b},bind:function(){this.dialog.bind.apply(this.dialog,arguments)},show:function(){this.dialog.show();this.captcha.focus()},hide:function(){this.dialog.hide()},getInputValue:function(){return this.captcha.getInputValue()},setTip:function(a){this.options.message=a;this.captcha.setTip(a)},getVCode:function(){return this.captcha.getVCode()},getVCodeType:function(){return this.captcha.getVCodeType()},updateCaptchaImg:function(b,a){if(a==4&&a!=this.captcha.getVCodeType()){if(this.gridCaptcha==null){this.gridCaptcha=this._initCaptchaInstance($.extend(this.options,{vCode:b,vCodeType:a}))}else{this.gridCaptcha.updateCaptchaImg(b,a)}this.captcha.hide();this.gridCaptcha.show();this.$okButton.detach();this.captcha=this.gridCaptcha;this.dialog.width(360)}else{if(a!=4&&this.captcha.getVCodeType()==4){if(this.normalCaptcha==null){this.normalCaptcha=this._initCaptchaInstance($.extend(this.options,{vCode:b,vCodeType:a}))}else{this.normalCaptcha.updateCaptchaImg(b,a)}this.captcha.hide();this.normalCaptcha.show();this.$content.find(".j_button_bar").append(this.$okButton);this.captcha=this.normalCaptcha;this.dialog.width(540)}else{this.captcha.updateCaptchaImg(b,a)}}},reloadCaptchaImg:function(a){this.captcha.reloadCaptchaImg(a)},focus:function(){this.captcha.focus()},clear:function(){this.captcha.clear()},accept:function(){if(this.captcha.validate()){this.dialog.hide();this.dialog.triggerHandler("onaccept")}}}});_.Module.define({path:"tbmall/component/captcha_payment",requires:["common/component/CaptchaDialog"],sub:{initial:function(a){this.reCommitUrl=a.url,this.data=a.data},showCaptcha:function(a,t){var e=this,o=2150040==e.data.no?"正确输入验证码后，可继续购买":"验证码输入错误，请重新输入";_.Module.use("common/component/CaptchaDialog",{message:e.data.data.captcha_str_reason,vCode:e.data.data.captcha_vcode_str,vCodeType:e.data.data.captcha_code_type,exceptionalAccount:0,title:"T豆支付验证码",message:o,forumName:"",modal:!0,forumId:0,checkUrl:"/tbmall/vcode/safecheckvcode?tbs="+PageData.tbs,vCodeUrl:"/tbmall/vcode/safegetvcode",paramsCallback:function(){return{tbs:PageData.tbs}}},function(e){e.bind("onclose",function(){e.hide(),$.tb.location.reload()}),e.bind("onaccept",function(){var o={};o.captcha_input_str=e.getInputValue(),o.captcha_vcode_str=e.getVCode(),"function"==typeof a&&(t?a.call(t,o):a(o))}),e.show()})}}});_.Module.define({path:"tbmall/widget/paykey_rsa",requires:[],sub:{RSA:{},publicKey:"",setKey:function(){this.publicKey=pkey},getKey:function(){var t=this;$.ajax({url:"/tbmall/pass/getpubkey",type:"get",dataType:"json",success:function(e){PageData.publicKey=e.data.pubkey,t.publicKey=PageData.publicKey}})},vcode:function(t){var e=new this.RSA;return e.setKey(this.publicKey),encodeURIComponent(e.encrypt(t))},initial:function(){var t=this;PageData.publicKey?this.publicKey=PageData.publicKey:this.getKey(),function(t){function e(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new e(null)}function r(t,e,i,r,s,n){for(;--n>=0;){var o=e*this[t++]+i[r]+s;s=Math.floor(o/67108864),i[r++]=67108863&o}return s}function s(t,e,i,r,s,n){for(var o=32767&e,h=e>>15;--n>=0;){var a=32767&this[t],u=this[t++]>>15,c=h*a+u*o;a=o*a+((32767&c)<<15)+i[r]+(1073741823&s),s=(a>>>30)+(c>>>15)+h*u+(s>>>30),i[r++]=1073741823&a}return s}function n(t,e,i,r,s,n){for(var o=16383&e,h=e>>14;--n>=0;){var a=16383&this[t],u=this[t++]>>14,c=h*a+u*o;a=o*a+((16383&c)<<14)+i[r]+s,s=(a>>28)+(c>>14)+h*u,i[r++]=268435455&a}return s}function o(t){return Ui.charAt(t)}function h(t,e){var i=Oi[t.charCodeAt(e)];return null==i?-1:i}function a(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function u(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function c(t){var e=i();return e.fromInt(t),e}function f(t,i){var r;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;else if(32==i)r=5;else{if(4!=i)return void this.fromRadix(t,i);r=2}this.t=0,this.s=0;for(var s=t.length,n=!1,o=0;--s>=0;){var a=8==r?255&t[s]:h(t,s);0>a?"-"==t.charAt(s)&&(n=!0):(n=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,o+=r,o>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),n&&e.ZERO.subTo(this,this)}function p(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function l(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,s=!1,n="",h=this.t,a=this.DB-h*this.DB%e;if(h-->0)for(a<this.DB&&(i=this[h]>>a)>0&&(s=!0,n=o(i));h>=0;)e>a?(i=(this[h]&(1<<a)-1)<<e-a,i|=this[--h]>>(a+=this.DB-e)):(i=this[h]>>(a-=e)&r,0>=a&&(a+=this.DB,--h)),i>0&&(s=!0),s&&(n+=o(i));return s?n:"0"}function d(){var t=i();return e.ZERO.subTo(this,t),t}function g(){return this.s<0?this.negate():this}function y(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(e=i-t.t,0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function m(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function b(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function T(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function S(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function R(t,e){var i,r=t%this.DB,s=this.DB-r,n=(1<<s)-1,o=Math.floor(t/this.DB),h=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>s|h,h=(this[i]&n)<<r;for(i=o-1;i>=0;--i)e[i]=0;e[o]=h,e.t=this.t+o+1,e.s=this.s,e.clamp()}function D(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return void(e.t=0);var r=t%this.DB,s=this.DB-r,n=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&n)<<s,e[o-i]=this[o]>>r;r>0&&(e[this.t-i-1]|=(this.s&n)<<s),e.t=this.t-i,e.clamp()}function E(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=0>r?-1:0,-1>r?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()}function x(t,i){var r=this.abs(),s=t.abs(),n=r.t;for(i.t=n+s.t;--n>=0;)i[n]=0;for(n=0;n<s.t;++n)i[n+r.t]=r.am(0,s[n],i,n,0,r.t);i.s=0,i.clamp(),this.s!=t.s&&e.ZERO.subTo(i,i)}function w(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function K(t,r,s){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=r&&r.fromInt(0),void(null!=s&&this.copyTo(s));null==s&&(s=i());var h=i(),a=this.s,u=t.s,c=this.DB-m(n[n.t-1]);c>0?(n.lShiftTo(c,h),o.lShiftTo(c,s)):(n.copyTo(h),o.copyTo(s));var f=h.t,p=h[f-1];if(0!=p){var l=p*(1<<this.F1)+(f>1?h[f-2]>>this.F2:0),d=this.FV/l,g=(1<<this.F1)/l,y=1<<this.F2,v=s.t,b=v-f,T=null==r?i():r;for(h.dlShiftTo(b,T),s.compareTo(T)>=0&&(s[s.t++]=1,s.subTo(T,s)),e.ONE.dlShiftTo(f,T),T.subTo(h,h);h.t<f;)h[h.t++]=0;for(;--b>=0;){var S=s[--v]==p?this.DM:Math.floor(s[v]*d+(s[v-1]+y)*g);if((s[v]+=h.am(0,S,s,b,0,f))<S)for(h.dlShiftTo(b,T),s.subTo(T,s);s[v]<--S;)s.subTo(T,s)}null!=r&&(s.drShiftTo(f,r),a!=u&&e.ZERO.subTo(r,r)),s.t=f,s.clamp(),c>0&&s.rShiftTo(c,s),0>a&&e.ZERO.subTo(s,s)}}}function A(t){var r=i();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(e.ZERO)>0&&t.subTo(r,r),r}function B(t){this.m=t}function U(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function O(t){return t}function V(t){t.divRemTo(this.m,null,t)}function N(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function J(t,e){t.squareTo(e),this.reduce(e)}function I(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function P(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function M(t){var r=i();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(e.ZERO)>0&&this.m.subTo(r,r),r}function L(t){var e=i();return t.copyTo(e),this.reduce(e),e}function q(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function H(t,e){t.squareTo(e),this.reduce(e)}function C(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function j(){return 0==(this.t>0?1&this[0]:this.s)}function k(t,r){if(t>4294967295||1>t)return e.ONE;var s=i(),n=i(),o=r.convert(this),h=m(t)-1;for(o.copyTo(s);--h>=0;)if(r.sqrTo(s,n),(t&1<<h)>0)r.mulTo(n,o,s);else{var a=s;s=n,n=a}return r.revert(s)}function F(t,e){var i;return i=256>t||e.isEven()?new B(e):new P(e),this.exp(t,i)}function _(){var t=i();return this.copyTo(t),t}function z(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return 0==this.t?this.s:this[0]<<24>>24}function G(){return 0==this.t?this.s:this[0]<<16>>16}function Y(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function Q(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),s=c(r),n=i(),o=i(),h="";for(this.divRemTo(s,n,o);n.signum()>0;)h=(r+o.intValue()).toString(t).substr(1)+h,n.divRemTo(s,n,o);return o.intValue().toString(t)+h}function X(t,i){this.fromInt(0),null==i&&(i=10);for(var r=this.chunkSize(i),s=Math.pow(i,r),n=!1,o=0,a=0,u=0;u<t.length;++u){var c=h(t,u);0>c?"-"==t.charAt(u)&&0==this.signum()&&(n=!0):(a=i*a+c,++o>=r&&(this.dMultiply(s),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(i,o)),this.dAddOffset(a,0)),n&&e.ZERO.subTo(this,this)}function te(t,i,r){if("number"==typeof i)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(e.ONE.shiftLeft(t-1),this);else{var s=new Array,n=7&t;s.length=(t>>3)+1,i.nextBytes(s),n>0?s[0]&=(1<<n)-1:s[0]=0,this.fromString(s,256)}}function ee(){var t=this.t,e=new Array;e[0]=this.s;var i,r=this.DB-t*this.DB%8,s=0;if(t-->0)for(r<this.DB&&(i=this[t]>>r)!=(this.s&this.DM)>>r&&(e[s++]=i|this.s<<this.DB-r);t>=0;)8>r?(i=(this[t]&(1<<r)-1)<<8-r,i|=this[--t]>>(r+=this.DB-8)):(i=this[t]>>(r-=8)&255,0>=r&&(r+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==s&&(128&this.s)!=(128&i)&&++s,(s>0||i!=this.s)&&(e[s++]=i);return e}function ie(t){return 0==this.compareTo(t)}function re(t){return this.compareTo(t)<0?this:t}function se(t){return this.compareTo(t)>0?this:t}function ne(t,e,i){var r,s,n=Math.min(t.t,this.t);for(r=0;n>r;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(s=t.s&this.DM,r=n;r<this.t;++r)i[r]=e(this[r],s);i.t=this.t}else{for(s=this.s&this.DM,r=n;r<t.t;++r)i[r]=e(s,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function oe(t,e){return t&e}function he(t){var e=i();return this.bitwiseTo(t,oe,e),e}function ae(t,e){return t|e}function ue(t){var e=i();return this.bitwiseTo(t,ae,e),e}function ce(t,e){return t^e}function fe(t){var e=i();return this.bitwiseTo(t,ce,e),e}function pe(t,e){return t&~e}function le(t){var e=i();return this.bitwiseTo(t,pe,e),e}function de(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function ge(t){var e=i();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ye(t){var e=i();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function me(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function ve(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+me(this[t]);return this.s<0?this.t*this.DB:-1}function be(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Te(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=be(this[i]^e);return t}function Se(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function Re(t,i){var r=e.ONE.shiftLeft(t);return this.bitwiseTo(r,i,r),r}function De(t){return this.changeBit(t,ae)}function Ee(t){return this.changeBit(t,pe)}function xe(t){return this.changeBit(t,ce)}function we(t,e){for(var i=0,r=0,s=Math.min(t.t,this.t);s>i;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=0>r?-1:0,r>0?e[i++]=r:-1>r&&(e[i++]=this.DV+r),e.t=i,e.clamp()}function Ke(t){var e=i();return this.addTo(t,e),e}function Ae(t){var e=i();return this.subTo(t,e),e}function Be(t){var e=i();return this.multiplyTo(t,e),e}function Ue(){var t=i();return this.squareTo(t),t}function Oe(t){var e=i();return this.divRemTo(t,e,null),e}function Ve(t){var e=i();return this.divRemTo(t,null,e),e}function Ne(t){var e=i(),r=i();return this.divRemTo(t,e,r),new Array(e,r)}function Je(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Ie(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function Pe(){}function Me(t){return t}function Le(t,e,i){t.multiplyTo(e,i)}function qe(t,e){t.squareTo(e)}function He(t){return this.exp(t,new Pe)}function Ce(t,e,i){var r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;var s;for(s=i.t-this.t;s>r;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(s=Math.min(t.t,e);s>r;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function je(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}function ke(t){this.r2=i(),this.q3=i(),e.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Fe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e}function _e(t){return t}function ze(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ze(t,e){t.squareTo(e),this.reduce(e)}function Ge(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function $e(t,e){var r,s,n=t.bitLength(),o=c(1);if(0>=n)return o;r=18>n?1:48>n?3:144>n?4:768>n?5:6,s=8>n?new B(e):e.isEven()?new ke(e):new P(e);var h=new Array,a=3,u=r-1,f=(1<<r)-1;if(h[1]=s.convert(this),r>1){var p=i();for(s.sqrTo(h[1],p);f>=a;)h[a]=i(),s.mulTo(p,h[a-2],h[a]),a+=2}var l,d,g=t.t-1,y=!0,v=i();for(n=m(t[g])-1;g>=0;){for(n>=u?l=t[g]>>n-u&f:(l=(t[g]&(1<<n+1)-1)<<u-n,g>0&&(l|=t[g-1]>>this.DB+n-u)),a=r;0==(1&l);)l>>=1,--a;if((n-=a)<0&&(n+=this.DB,--g),y)h[l].copyTo(o),y=!1;else{for(;a>1;)s.sqrTo(o,v),s.sqrTo(v,o),a-=2;a>0?s.sqrTo(o,v):(d=o,o=v,v=d),s.mulTo(v,h[l],o)}for(;g>=0&&0==(t[g]&1<<n);)s.sqrTo(o,v),d=o,o=v,v=d,--n<0&&(n=this.DB-1,--g)}return s.revert(o)}function Ye(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var s=e.getLowestSetBit(),n=i.getLowestSetBit();if(0>n)return e;for(n>s&&(n=s),n>0&&(e.rShiftTo(n,e),i.rShiftTo(n,i));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=i.getLowestSetBit())>0&&i.rShiftTo(s,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i}function We(t){if(0>=t)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}function Qe(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return e.ZERO;for(var r=t.clone(),s=this.clone(),n=c(1),o=c(0),h=c(0),a=c(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),i?(n.isEven()&&o.isEven()||(n.addTo(this,n),o.subTo(t,o)),n.rShiftTo(1,n)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;s.isEven();)s.rShiftTo(1,s),i?(h.isEven()&&a.isEven()||(h.addTo(this,h),a.subTo(t,a)),h.rShiftTo(1,h)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(s)>=0?(r.subTo(s,r),i&&n.subTo(h,n),o.subTo(a,o)):(s.subTo(r,s),i&&h.subTo(n,h),a.subTo(o,a))}return 0!=s.compareTo(e.ONE)?e.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}function Xe(t){var e,i=this.abs();if(1==i.t&&i[0]<=Vi[Vi.length-1]){for(e=0;e<Vi.length;++e)if(i[0]==Vi[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<Vi.length;){for(var r=Vi[e],s=e+1;s<Vi.length&&Ni>r;)r*=Vi[s++];for(r=i.modInt(r);s>e;)if(r%Vi[e++]==0)return!1}return i.millerRabin(t)}function ti(t){var r=this.subtract(e.ONE),s=r.getLowestSetBit();if(0>=s)return!1;var n=r.shiftRight(s);t=t+1>>1,t>Vi.length&&(t=Vi.length);for(var o=i(),h=0;t>h;++h){o.fromInt(Vi[Math.floor(Math.random()*Vi.length)]);var a=o.modPow(n,this);if(0!=a.compareTo(e.ONE)&&0!=a.compareTo(r)){for(var u=1;u++<s&&0!=a.compareTo(r);)if(a=a.modPowInt(2,this),0==a.compareTo(e.ONE))return!1;if(0!=a.compareTo(r))return!1}}return!0}function ei(){this.i=0,this.j=0,this.S=new Array}function ii(t){var e,i,r;for(e=0;256>e;++e)this.S[e]=e;for(i=0,e=0;256>e;++e)i=i+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[i],this.S[i]=r;this.i=0,this.j=0}function ri(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function si(){return new ei}function ni(t){Ii[Pi++]^=255&t,Ii[Pi++]^=t>>8&255,Ii[Pi++]^=t>>16&255,Ii[Pi++]^=t>>24&255,Pi>=Mi&&(Pi-=Mi)}function oi(){ni((new Date).getTime())}function hi(){if(null==Ji){for(oi(),Ji=si(),Ji.init(Ii),Pi=0;Pi<Ii.length;++Pi)Ii[Pi]=0;Pi=0}return Ji.next()}function ai(t){var e;for(e=0;e<t.length;++e)t[e]=hi()}function ui(){}function ci(t,i){return new e(t,i)}function fi(t,i){if(i<t.length+11)return console.error("Message too long for RSA"),null;for(var r=new Array,s=t.length-1;s>=0&&i>0;){var n=t.charCodeAt(s--);128>n?r[--i]=n:n>127&&2048>n?(r[--i]=63&n|128,r[--i]=n>>6|192):(r[--i]=63&n|128,r[--i]=n>>6&63|128,r[--i]=n>>12|224)}r[--i]=0;for(var o=new ui,h=new Array;i>2;){for(h[0]=0;0==h[0];)o.nextBytes(h);r[--i]=h[0]}return r[--i]=2,r[--i]=0,new e(r)}function pi(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function li(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")}function di(t){return t.modPowInt(this.e,this.n)}function gi(t){var e=fi(t,this.n.bitLength()+7>>3);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;var r=i.toString(16);return 0==(1&r.length)?r:"0"+r}function yi(t,e){for(var i=t.toByteArray(),r=0;r<i.length&&0==i[r];)++r;if(i.length-r!=e-1||2!=i[r])return null;for(++r;0!=i[r];)if(++r>=i.length)return null;for(var s="";++r<i.length;){var n=255&i[r];128>n?s+=String.fromCharCode(n):n>191&&224>n?(s+=String.fromCharCode((31&n)<<6|63&i[r+1]),++r):(s+=String.fromCharCode((15&n)<<12|(63&i[r+1])<<6|63&i[r+2]),r+=2)}return s}function mi(t,e,i){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16)):console.error("Invalid RSA private key")}function vi(t,e,i,r,s,n,o,h){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=ci(t,16),this.e=parseInt(e,16),this.d=ci(i,16),this.p=ci(r,16),this.q=ci(s,16),this.dmp1=ci(n,16),this.dmq1=ci(o,16),this.coeff=ci(h,16)):console.error("Invalid RSA private key")}function bi(t,i){var r=new ui,s=t>>1;this.e=parseInt(i,16);for(var n=new e(i,16);;){for(;this.p=new e(t-s,1,r),0!=this.p.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.p.isProbablePrime(10););for(;this.q=new e(s,1,r),0!=this.q.subtract(e.ONE).gcd(n).compareTo(e.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var h=this.p.subtract(e.ONE),a=this.q.subtract(e.ONE),u=h.multiply(a);if(0==u.gcd(n).compareTo(e.ONE)){this.n=this.p.multiply(this.q),this.d=n.modInverse(u),this.dmp1=this.d.mod(h),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function Ti(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)}function Si(t){var e=ci(t,16),i=this.doPrivate(e);return null==i?null:yi(i,this.n.bitLength()+7>>3)}function Ri(t){var e,i,r="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),r+=Hi.charAt(i>>6)+Hi.charAt(63&i);for(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),r+=Hi.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),r+=Hi.charAt(i>>2)+Hi.charAt((3&i)<<4));(3&r.length)>0;)r+=Ci;return r}function Di(t){var e,i,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=Ci;++e)v=Hi.indexOf(t.charAt(e)),0>v||(0==s?(r+=o(v>>2),i=3&v,s=1):1==s?(r+=o(i<<2|v>>4),i=15&v,s=2):2==s?(r+=o(i),r+=o(v>>2),i=3&v,s=3):(r+=o(i<<2|v>>4),r+=o(15&v),s=0));return 1==s&&(r+=o(i<<2)),r}var Ei,xi=0xdeadbeefcafe,wi=15715070==(16777215&xi);wi&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=s,Ei=30):wi&&"Netscape"!=navigator.appName?(e.prototype.am=r,Ei=26):(e.prototype.am=n,Ei=28),e.prototype.DB=Ei,e.prototype.DM=(1<<Ei)-1,e.prototype.DV=1<<Ei;var Ki=52;e.prototype.FV=Math.pow(2,Ki),e.prototype.F1=Ki-Ei,e.prototype.F2=2*Ei-Ki;var Ai,Bi,Ui="0123456789abcdefghijklmnopqrstuvwxyz",Oi=new Array;for(Ai="0".charCodeAt(0),Bi=0;9>=Bi;++Bi)Oi[Ai++]=Bi;for(Ai="a".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;for(Ai="A".charCodeAt(0),Bi=10;36>Bi;++Bi)Oi[Ai++]=Bi;B.prototype.convert=U,B.prototype.revert=O,B.prototype.reduce=V,B.prototype.mulTo=N,B.prototype.sqrTo=J,P.prototype.convert=M,P.prototype.revert=L,P.prototype.reduce=q,P.prototype.mulTo=C,P.prototype.sqrTo=H,e.prototype.copyTo=a,e.prototype.fromInt=u,e.prototype.fromString=f,e.prototype.clamp=p,e.prototype.dlShiftTo=T,e.prototype.drShiftTo=S,e.prototype.lShiftTo=R,e.prototype.rShiftTo=D,e.prototype.subTo=E,e.prototype.multiplyTo=x,e.prototype.squareTo=w,e.prototype.divRemTo=K,e.prototype.invDigit=I,e.prototype.isEven=j,e.prototype.exp=k,e.prototype.toString=l,e.prototype.negate=d,e.prototype.abs=g,e.prototype.compareTo=y,e.prototype.bitLength=b,e.prototype.mod=A,e.prototype.modPowInt=F,e.ZERO=c(0),e.ONE=c(1),Pe.prototype.convert=Me,Pe.prototype.revert=Me,Pe.prototype.mulTo=Le,Pe.prototype.sqrTo=qe,ke.prototype.convert=Fe,ke.prototype.revert=_e,ke.prototype.reduce=ze,ke.prototype.mulTo=Ge,ke.prototype.sqrTo=Ze;var Vi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ni=(1<<26)/Vi[Vi.length-1];e.prototype.chunkSize=Y,e.prototype.toRadix=Q,e.prototype.fromRadix=X,e.prototype.fromNumber=te,e.prototype.bitwiseTo=ne,e.prototype.changeBit=Re,e.prototype.addTo=we,e.prototype.dMultiply=Je,e.prototype.dAddOffset=Ie,e.prototype.multiplyLowerTo=Ce,e.prototype.multiplyUpperTo=je,e.prototype.modInt=We,e.prototype.millerRabin=ti,e.prototype.clone=_,e.prototype.intValue=z,e.prototype.byteValue=Z,e.prototype.shortValue=G,e.prototype.signum=W,e.prototype.toByteArray=ee,e.prototype.equals=ie,e.prototype.min=re,e.prototype.max=se,e.prototype.and=he,e.prototype.or=ue,e.prototype.xor=fe,e.prototype.andNot=le,e.prototype.not=de,e.prototype.shiftLeft=ge,e.prototype.shiftRight=ye,e.prototype.getLowestSetBit=ve,e.prototype.bitCount=Te,e.prototype.testBit=Se,e.prototype.setBit=De,e.prototype.clearBit=Ee,e.prototype.flipBit=xe,e.prototype.add=Ke,e.prototype.subtract=Ae,e.prototype.multiply=Be,e.prototype.divide=Oe,e.prototype.remainder=Ve,e.prototype.divideAndRemainder=Ne,e.prototype.modPow=$e,e.prototype.modInverse=Qe,e.prototype.pow=He,e.prototype.gcd=Ye,e.prototype.isProbablePrime=Xe,e.prototype.square=Ue,ei.prototype.init=ii,ei.prototype.next=ri;var Ji,Ii,Pi,Mi=256;if(null==Ii){Ii=new Array,Pi=0;var Li;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var qi=window.crypto.random(32);for(Li=0;Li<qi.length;++Li)Ii[Pi++]=255&qi.charCodeAt(Li)}for(;Mi>Pi;)Li=Math.floor(65536*Math.random()),Ii[Pi++]=Li>>>8,Ii[Pi++]=255&Li;Pi=0,oi()}ui.prototype.nextBytes=ai,pi.prototype.doPublic=di,pi.prototype.setPublic=li,pi.prototype.encrypt=gi,pi.prototype.doPrivate=Ti,pi.prototype.setPrivate=mi,pi.prototype.setPrivateEx=vi,pi.prototype.generate=bi,pi.prototype.decrypt=Si,function(){var t=function(t,r,s){var n=new ui,o=t>>1;this.e=parseInt(r,16);var h=new e(r,16),a=this,u=function(){var r=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var i=a.p.subtract(e.ONE),r=a.q.subtract(e.ONE),n=i.multiply(r);0==n.gcd(h).compareTo(e.ONE)?(a.n=a.p.multiply(a.q),a.d=h.modInverse(n),a.dmp1=a.d.mod(i),a.dmq1=a.d.mod(r),a.coeff=a.q.modInverse(a.p),setTimeout(function(){s()},0)):setTimeout(u,0)},c=function(){a.q=i(),a.q.fromNumberAsync(o,1,n,function(){a.q.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.q.isProbablePrime(10)?setTimeout(r,0):setTimeout(c,0)})})},f=function(){a.p=i(),a.p.fromNumberAsync(t-o,1,n,function(){a.p.subtract(e.ONE).gcda(h,function(t){0==t.compareTo(e.ONE)&&a.p.isProbablePrime(10)?setTimeout(c,0):setTimeout(f,0)})})};setTimeout(f,0)};setTimeout(u,0)};pi.prototype.generateAsync=t;var r=function(t,e){var i=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var s=i;i=r,r=s}var n=i.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return void e(i);o>n&&(o=n),o>0&&(i.rShiftTo(o,i),r.rShiftTo(o,r));var h=function(){(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),i.compareTo(r)>=0?(i.subTo(r,i),i.rShiftTo(1,i)):(r.subTo(i,r),r.rShiftTo(1,r)),i.signum()>0?setTimeout(h,0):(o>0&&r.lShiftTo(o,r),setTimeout(function(){e(r)},0))};setTimeout(h,10)};e.prototype.gcda=r;var s=function(t,i,r,s){if("number"==typeof i)if(2>t)this.fromInt(1);else{this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(e.ONE.shiftLeft(t-1),ae,this),this.isEven()&&this.dAddOffset(1,0);var n=this,o=function(){n.dAddOffset(2,0),n.bitLength()>t&&n.subTo(e.ONE.shiftLeft(t-1),n),n.isProbablePrime(i)?setTimeout(function(){s()},0):setTimeout(o,0)};setTimeout(o,0)}else{var h=new Array,a=7&t;h.length=(t>>3)+1,i.nextBytes(h),a>0?h[0]&=(1<<a)-1:h[0]=0,this.fromString(h,256)}};e.prototype.fromNumberAsync=s}();var Hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ci="=",ji=ji||{};ji.env=ji.env||{};var ki=ji,Fi=Object.prototype,_i="[object Function]",zi=["toString","valueOf"];ji.env.parseUA=function(t){var e,i=function(t){var e=0;return parseFloat(t.replace(/\./g,function(){return 1==e++?"":"."}))},r=navigator,s={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:r&&r.cajaVersion,secure:!1,os:null},n=t||navigator&&navigator.userAgent,o=$.tb.location,h=o&&o.getHref();return s.secure=h&&0===h.toLowerCase().indexOf("https"),n&&(/windows|win32/i.test(n)?s.os="windows":/macintosh/i.test(n)?s.os="macintosh":/rhino/i.test(n)&&(s.os="rhino"),/KHTML/.test(n)&&(s.webkit=1),e=n.match(/AppleWebKit\/([^\s]*)/),e&&e[1]&&(s.webkit=i(e[1]),/ Mobile\//.test(n)?(s.mobile="Apple",e=n.match(/OS ([^\s]*)/),e&&e[1]&&(e=i(e[1].replace("_","."))),s.ios=e,s.ipad=s.ipod=s.iphone=0,e=n.match(/iPad|iPod|iPhone/),e&&e[0]&&(s[e[0].toLowerCase()]=s.ios)):(e=n.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),e&&(s.mobile=e[0]),/webOS/.test(n)&&(s.mobile="WebOS",e=n.match(/webOS\/([^\s]*);/),e&&e[1]&&(s.webos=i(e[1]))),/ Android/.test(n)&&(s.mobile="Android",e=n.match(/Android ([^\s]*);/),e&&e[1]&&(s.android=i(e[1])))),e=n.match(/Chrome\/([^\s]*)/),e&&e[1]?s.chrome=i(e[1]):(e=n.match(/AdobeAIR\/([^\s]*)/),e&&(s.air=e[0]))),s.webkit||(e=n.match(/Opera[\s\/]([^\s]*)/),e&&e[1]?(s.opera=i(e[1]),e=n.match(/Version\/([^\s]*)/),e&&e[1]&&(s.opera=i(e[1])),e=n.match(/Opera Mini[^;]*/),e&&(s.mobile=e[0])):(e=n.match(/MSIE\s([^;]*)/),e&&e[1]?s.ie=i(e[1]):(e=n.match(/Gecko\/([^\s]*)/),e&&(s.gecko=1,e=n.match(/rv:([^\s\)]*)/),e&&e[1]&&(s.gecko=i(e[1]))))))),s},ji.env.ua=ji.env.parseUA(),ji.isFunction=function(t){return"function"==typeof t||Fi.toString.apply(t)===_i},ji._IEEnumFix=ji.env.ua.ie?function(t,e){var i,r,s;for(i=0;i<zi.length;i+=1)r=zi[i],s=e[r],ki.isFunction(s)&&s!=Fi[r]&&(t[r]=s)}:function(){},ji.extend=function(t,e,i){if(!e||!t)throw new Error("extend failed, please check that all dependencies are included.");var r,s=function(){};if(s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Fi.constructor&&(e.prototype.constructor=e),i){for(r in i)ki.hasOwnProperty(i,r)&&(t.prototype[r]=i[r]);ki._IEEnumFix(t.prototype,i)}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var r=i.substr(1),s=r.length;s%2==1?s+=1:i.match(/^[0-7]/)||(s+=2);for(var n="",o=0;s>o;o++)n+="f";var h=new e(n,16),a=h.xor(t).add(e.ONE);i=a.toString(16).replace(/^-/,"")}return i},this.getPEMStringFromHex=function(t,e){var i=CryptoJS.enc.Hex.parse(t),r=CryptoJS.enc.Base64.stringify(i),s=r.replace(/(.{64})/g,"$1\r\n");return s=s.replace(/\r\n$/,""),"-----BEGIN "+e+"-----\r\n"+s+"\r\n-----END "+e+"-----\r\n"}},KJUR.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+t.length+",v="+this.hV;var e=this.hV.length/2,i=e.toString(16);if(i.length%2==1&&(i="0"+i),128>e)return i;var r=i.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);var s=128+r;return s.toString(16)+i},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex&&this.setStringHex(t.hex))},ji.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){utc=t.getTime()+6e4*t.getTimezoneOffset();var e=new Date(utc);return e},this.formatDate=function(t,e){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var n=i(String(r.getMonth()+1),2),o=i(String(r.getDate()),2),h=i(String(r.getHours()),2),a=i(String(r.getMinutes()),2),u=i(String(r.getSeconds()),2);return s+n+o+h+a+u+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(t,e,i,r,s,n){var o=new Date(Date.UTC(t,e-1,i,r,s,n,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ji.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(t){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,"undefined"!=typeof t&&"undefined"!=typeof t.array&&(this.asn1Array=t.array)},ji.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ji.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(t){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var i=new e(String(t),10);this.setByBigInteger(i)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.bigint?this.setByBigInteger(t.bigint):"undefined"!=typeof t["int"]?this.setByInteger(t["int"]):"undefined"!=typeof t.hex&&this.setValueHex(t.hex))},ji.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(t){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t
},this.setUnusedBitsAndHexValue=function(t,e){if(0>t||t>7)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var e=8-t.length%8;8==e&&(e=0);for(var i=0;e>=i;i++)t+="0";for(var r="",i=0;i<t.length-1;i+=8){var s=t.substr(i,8),n=parseInt(s,2).toString(16);1==n.length&&(n="0"+n),r+=n}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)e+=1==t[i]?"1":"0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;t>i;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.hex?this.setHexValueIncludingUnusedBits(t.hex):"undefined"!=typeof t.bin?this.setByBinaryString(t.bin):"undefined"!=typeof t.array&&this.setByBooleanArray(t.array))},ji.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(t){KJUR.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ji.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ji.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(t){var i=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},r=function(t){var r="",s=new e(t,10),n=s.toString(2),o=7-n.length%7;7==o&&(o=0);for(var h="",a=0;o>a;a++)h+="0";n=h+n;for(var a=0;a<n.length-1;a+=7){var u=n.substr(a,7);a!=n.length-7&&(u="1"+u),r+=i(parseInt(u,2))}return r};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var e="",s=t.split("."),n=40*parseInt(s[0])+parseInt(s[1]);e+=i(n),s.splice(0,2);for(var o=0;o<s.length;o++)e+=r(s[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueName=function(t){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[t])throw"DERObjectIdentifier oidName undefined: "+t;var e=KJUR.asn1.x509.OID.name2oidList[t];this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.oid?this.setValueOidString(t.oid):"undefined"!=typeof t.hex?this.setValueHex(t.hex):"undefined"!=typeof t.name&&this.setValueName(t.name))},ji.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(t){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ji.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(t){KJUR.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ji.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(t){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ji.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(t){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ji.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(t){KJUR.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ji.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(t){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(t){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof t&&("undefined"!=typeof t.str?this.setString(t.str):"undefined"!=typeof t.hex?this.setStringHex(t.hex):"undefined"!=typeof t.date&&this.setByDate(t.date))},ji.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(t){KJUR.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t+=i.getEncodedHex()}return this.hV=t,this.hV}},ji.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(t){KJUR.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}},ji.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(t){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof t&&("undefined"!=typeof t.tag&&(this.hT=t.tag),"undefined"!=typeof t.explicit&&(this.isExplicit=t.explicit),"undefined"!=typeof t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ji.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="0123456789ABCDEF",n=" \f\n\r	  \u2028\u2029";for(e=[],r=0;16>r;++r)e[s.charAt(r)]=r;for(s=s.toLowerCase(),r=10;16>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=2?(o[o.length]=h,h=0,a=0):h<<=4}}if(a)throw"Hex encoding incomplete: 4 bits missing";return o},window.Hex=i}(),function(t){"use strict";var e,i={};i.decode=function(i){var r;if(e===t){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="= \f\n\r	  \u2028\u2029";for(e=[],r=0;64>r;++r)e[s.charAt(r)]=r;for(r=0;r<n.length;++r)e[n.charAt(r)]=-1}var o=[],h=0,a=0;for(r=0;r<i.length;++r){var u=i.charAt(r);if("="==u)break;if(u=e[u],-1!=u){if(u===t)throw"Illegal character at offset "+r;h|=u,++a>=4?(o[o.length]=h>>16,o[o.length]=h>>8&255,o[o.length]=255&h,h=0,a=0):h<<=6}}switch(a){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:o[o.length]=h>>10;break;case 3:o[o.length]=h>>16,o[o.length]=h>>8&255}return o},i.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,i.unarmor=function(t){var e=i.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw"RegExp out of sync";t=e[2]}return i.decode(t)},window.Base64=i}(),function(t){"use strict";function e(t,i){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=i)}function i(t,e,i,r,s){this.stream=t,this.header=e,this.length=i,this.tag=r,this.sub=s}var r=100,s="…",n={tag:function(t,e){var i=document.createElement(t);return i.className=e,i},text:function(t){return document.createTextNode(t)}};e.prototype.get=function(e){if(e===t&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},e.prototype.hexDump=function(t,e,i){for(var r="",s=t;e>s;++s)if(r+=this.hexByte(this.get(s)),i!==!0)switch(15&s){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},e.prototype.parseStringISO=function(t,e){for(var i="",r=t;e>r;++r)i+=String.fromCharCode(this.get(r));return i},e.prototype.parseStringUTF=function(t,e){for(var i="",r=t;e>r;){var s=this.get(r++);i+=String.fromCharCode(128>s?s:s>191&&224>s?(31&s)<<6|63&this.get(r++):(15&s)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return i},e.prototype.parseStringBMP=function(t,e){for(var i="",r=t;e>r;r+=2){var s=this.get(r),n=this.get(r+1);i+=String.fromCharCode((s<<8)+n)}return i},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(t,e){var i=this.parseStringISO(t,e),r=this.reTime.exec(i);return r?(i=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(i+=":"+r[5],r[6]&&(i+=":"+r[6],r[7]&&(i+="."+r[7]))),r[8]&&(i+=" UTC","Z"!=r[8]&&(i+=r[8],r[9]&&(i+=":"+r[9]))),i):"Unrecognized time: "+i},e.prototype.parseInteger=function(t,e){var i=e-t;if(i>4){i<<=3;var r=this.get(t);if(0===r)i-=8;else for(;128>r;)r<<=1,--i;return"("+i+" bit)"}for(var s=0,n=t;e>n;++n)s=s<<8|this.get(n);return s},e.prototype.parseBitString=function(t,e){var i=this.get(t),r=(e-t-1<<3)-i,s="("+r+" bit)";if(20>=r){var n=i;s+=" ";for(var o=e-1;o>t;--o){for(var h=this.get(o),a=n;8>a;++a)s+=h>>a&1?"1":"0";n=0}}return s},e.prototype.parseOctetString=function(t,e){var i=e-t,n="("+i+" byte) ";i>r&&(e=t+r);for(var o=t;e>o;++o)n+=this.hexByte(this.get(o));return i>r&&(n+=s),n},e.prototype.parseOID=function(t,e){for(var i="",r=0,s=0,n=t;e>n;++n){var o=this.get(n);if(r=r<<7|127&o,s+=7,!(128&o)){if(""===i){var h=80>r?40>r?0:1:2;i=h+"."+(r-40*h)}else i+="."+(s>=31?"bigint":r);r=s=0}}return i},i.prototype.typeName=function(){if(this.tag===t)return"unknown";var e=this.tag>>6,i=(this.tag>>5&1,31&this.tag);switch(e){case 0:switch(i){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+i.toString(16)}case 1:return"Application_"+i.toString(16);case 2:return"["+i+"]";case 3:return"Private_"+i.toString(16)}},i.prototype.reSeemsASCII=/^[ -~]+$/,i.prototype.content=function(){if(this.tag===t)return null;var e=this.tag>>6,i=31&this.tag,n=this.posContent(),o=Math.abs(this.length);if(0!==e){if(null!==this.sub)return"("+this.sub.length+" elem)";var h=this.stream.parseStringISO(n,n+Math.min(o,r));return this.reSeemsASCII.test(h)?h.substring(0,2*r)+(h.length>2*r?s:""):this.stream.parseOctetString(n,n+o)}switch(i){case 1:return 0===this.stream.get(n)?"false":"true";case 2:return this.stream.parseInteger(n,n+o);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+o);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+o);case 6:return this.stream.parseOID(n,n+o);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+o);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+o);case 30:return this.stream.parseStringBMP(n,n+o);case 23:case 24:return this.stream.parseTime(n,n+o)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},i.prototype.print=function(e){if(e===t&&(e=""),document.writeln(e+this),null!==this.sub){e+="  ";for(var i=0,r=this.sub.length;r>i;++i)this.sub[i].print(e)}},i.prototype.toPrettyString=function(e){e===t&&(e="");var i=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(i+="+"),i+=this.length,32&this.tag?i+=" (constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+=" (encapsulates)"),i+="\n",null!==this.sub){e+="  ";for(var r=0,s=this.sub.length;s>r;++r)i+=this.sub[r].toPrettyString(e)}return i},i.prototype.toDOM=function(){var t=n.tag("div","node");t.asn1=this;var e=n.tag("div","head"),i=this.typeName().replace(/_/g," ");e.innerHTML=i;var r=this.content();if(null!==r){r=String(r).replace(/</g,"&lt;");var s=n.tag("span","preview");s.appendChild(n.text(r)),e.appendChild(s)}t.appendChild(e),this.node=t,this.head=e;var o=n.tag("div","value");if(i="Offset: "+this.stream.pos+"<br/>",i+="Length: "+this.header+"+",i+=this.length>=0?this.length:-this.length+" (undefined)",32&this.tag?i+="<br/>(constructed)":3!=this.tag&&4!=this.tag||null===this.sub||(i+="<br/>(encapsulates)"),null!==r&&(i+="<br/>Value:<br/><b>"+r+"</b>","object"==typeof oids&&6==this.tag)){var h=oids[r];h&&(h.d&&(i+="<br/>"+h.d),h.c&&(i+="<br/>"+h.c),h.w&&(i+="<br/>(warning!)"))}o.innerHTML=i,t.appendChild(o);var a=n.tag("div","sub");if(null!==this.sub)for(var u=0,c=this.sub.length;c>u;++u)a.appendChild(this.sub[u].toDOM());return t.appendChild(a),e.onclick=function(){t.className="node collapsed"==t.className?"node":"node collapsed"},t},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.fakeHover=function(t){this.node.className+=" hover",t&&(this.head.className+=" hover")},i.prototype.fakeOut=function(t){var e=/ ?hover/;this.node.className=this.node.className.replace(e,""),t&&(this.head.className=this.head.className.replace(e,""))},i.prototype.toHexDOM_sub=function(t,e,i,r,s){if(!(r>=s)){var o=n.tag("span",e);o.appendChild(n.text(i.hexDump(r,s))),t.appendChild(o)}},i.prototype.toHexDOM=function(e){var i=n.tag("span","hex");if(e===t&&(e=i),this.head.hexNode=i,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},i.asn1=this,i.onmouseover=function(){var t=!e.selected;t&&(e.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(t)},i.onmouseout=function(){var t=e.selected==this.asn1;this.asn1.fakeOut(t),t&&(e.selected=null,this.className="hex")},this.toHexDOM_sub(i,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(i,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),null===this.sub)i.appendChild(n.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var r=this.sub[0],s=this.sub[this.sub.length-1];this.toHexDOM_sub(i,"intro",this.stream,this.posContent(),r.posStart());for(var o=0,h=this.sub.length;h>o;++o)i.appendChild(this.sub[o].toHexDOM(e));this.toHexDOM_sub(i,"outro",this.stream,s.posEnd(),this.posEnd())}return i},i.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(t){var e=t.get(),i=127&e;if(i==e)return i;if(i>3)throw"Length over 24 bits not supported at position "+(t.pos-1);if(0===i)return-1;e=0;for(var r=0;i>r;++r)e=e<<8|t.get();return e},i.hasContent=function(t,r,s){if(32&t)return!0;if(3>t||t>4)return!1;var n=new e(s);3==t&&n.get();var o=n.get();if(o>>6&1)return!1;try{var h=i.decodeLength(n);return n.pos-s.pos+h==r}catch(a){return!1}},i.decode=function(t){t instanceof e||(t=new e(t,0));var r=new e(t),s=t.get(),n=i.decodeLength(t),o=t.pos-r.pos,h=null;if(i.hasContent(s,n,t)){var a=t.pos;if(3==s&&t.get(),h=[],n>=0){for(var u=a+n;t.pos<u;)h[h.length]=i.decode(t);if(t.pos!=u)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var c=i.decode(t);if(0===c.tag)break;h[h.length]=c}n=a-t.pos}catch(f){throw"Exception while decoding undefined length content: "+f}}else t.pos+=n;return new i(r,o,n,s,h)},i.test=function(){for(var t=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],r=0,s=t.length;s>r;++r){var n=new e(t[r].value,0),o=i.decodeLength(n);o!=t[r].expected&&document.write("In test["+r+"] expected "+t[r].expected+" got "+o+"\n")}},window.ASN1=i}(),ASN1.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,i=2*this.length;return t.substr(e,i)},pi.prototype.parseKey=function(t){try{var e=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,i=e.test(t)?Hex.decode(t):Base64.unarmor(t),r=ASN1.decode(i);if(9===r.sub.length){var s=r.sub[1].getHexStringValue();this.n=ci(s,16);var n=r.sub[2].getHexStringValue();this.e=parseInt(n,16);var o=r.sub[3].getHexStringValue();this.d=ci(o,16);var h=r.sub[4].getHexStringValue();this.p=ci(h,16);var a=r.sub[5].getHexStringValue();this.q=ci(a,16);var u=r.sub[6].getHexStringValue();this.dmp1=ci(u,16);var c=r.sub[7].getHexStringValue();this.dmq1=ci(c,16);var f=r.sub[8].getHexStringValue();this.coeff=ci(f,16)}else{if(2!==r.sub.length)return!1;var p=r.sub[1],l=p.sub[0],s=l.sub[0].getHexStringValue();this.n=ci(s,16);var n=l.sub[1].getHexStringValue();this.e=parseInt(n,16)}return!0}catch(d){return!1}},pi.prototype.getPrivateBaseKey=function(){var t={array:[new KJUR.asn1.DERInteger({"int":0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},e=new KJUR.asn1.DERSequence(t);return e.getEncodedHex()},pi.prototype.getPrivateBaseKeyB64=function(){return Ri(this.getPrivateBaseKey())},pi.prototype.getPublicBaseKey=function(){var t={array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]},e=new KJUR.asn1.DERSequence(t);t={array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({"int":this.e})]};var i=new KJUR.asn1.DERSequence(t);t={hex:"00"+i.getEncodedHex()};var r=new KJUR.asn1.DERBitString(t);t={array:[e,r]};var s=new KJUR.asn1.DERSequence(t);return s.getEncodedHex()},pi.prototype.getPublicBaseKeyB64=function(){return Ri(this.getPublicBaseKey())},pi.prototype.wordwrap=function(t,e){if(e=e||64,!t)return t;var i="(.{1,"+e+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(i,"g")).join("\n")},pi.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=this.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},pi.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=this.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},pi.prototype.hasPublicKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")},pi.prototype.hasPrivateKeyProperty=function(t){return t=t||{},t.hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},pi.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)};var Zi=function(t){pi.call(this),t&&("string"==typeof t?this.parseKey(t):(this.hasPrivateKeyProperty(t)||this.hasPublicKeyProperty(t))&&this.parsePropertiesFrom(t))};Zi.prototype=new pi,Zi.prototype.constructor=Zi;var Gi=function(t){t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};Gi.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new Zi(t)},Gi.prototype.setPrivateKey=function(t){this.setKey(t)},Gi.prototype.setPublicKey=function(t){this.setKey(t)},Gi.prototype.decrypt=function(t){try{return this.getKey().decrypt(Di(t))}catch(e){return!1}},Gi.prototype.encrypt=function(t){try{return Ri(this.getKey().encrypt(t))}catch(e){return console.log(arguments),!1}},Gi.prototype.getKey=function(t){if(!this.key){if(this.key=new Zi,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},Gi.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},Gi.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},Gi.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},Gi.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.JSEncrypt=Gi}(t.RSA),t.RSA=t.RSA.JSEncrypt}}});_.Module.define({path:"tbmall/widget/paykey_dialog",requires:["tbmall/widget/paykey_rsa"],sub:{ERROR:{2270018:"",1990005:"支付密码验证错误，请重新输入，您还有{#NUM#}次输入机会",2190005:'你已输入密码错误5次，支付密码被锁定，请<a target="_blank" href="/tbmall/pass/set">找回密码</a>'},MAX_ERR_TIME:5,_setTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">',"<p>您设置T豆支付密码，可有效降低您的T豆被盗风险，<br>保障财产安全！</p>",'<div class="paykey_btn_area clearfix">','<a href="#" class="paykey_set_cancel_btn paykey_set_btn" id="paykey_set_cancel_btn">稍后设置</a>','<a href="/tbmall/pass/set" target="_blank" class="paykey_set_accept_btn paykey_set_btn" id="paykey_set_accept_btn">立即设置</a>',"</div>","</div>"].join(""),_inputTpl:['<div id="paykey_set_dialog" class="paykey_set_dialog clearfix">','<form id="paykey_set_form">','<div class="paykey_input_area">',"<span>请输入支付密码</span>",'<input type="password" class="j_paykey_input paykey_input" id="paykey_input"/>','<p id="paykey_input_msg" class="paykey_input_msg">{#ERROR#}</p>',"</div>",'<div class="paykey_btn_area clearfix">','<a class="j_paykey_submit_btn paykey_submit_btn paykey_set_btn" id="paykey_submit_btn">提交</a>','<a href="/tbmall/pass/set" target="_blank" class="j_paykey_cancel_btn  paykey_set_btn" id="paykey_cancel_btn">忘记密码</a>',"</div>","</form>","</div>"].join(""),_dialog:null,conf:{accept:function(){},cancel:function(){}},initial:function(a){this.conf=$.extend(this.conf,a),this.RSA=this.use("tbmall/widget/paykey_rsa")},showDialog:function(a,t,e){cn=t,2==arguments.length&&(e=t,cn=null),2===this.conf.showType?this.inputPasskeyDialog(a,cn,e):1===this.conf.showType?this.setPasskeyDialog(a,cn,e):"function"==typeof a&&(e?a.call(e):a())},inputPasskeyDialog:function(a,t,e){var i=this;2==arguments.length&&(e=t);var s=this._inputTpl;if(this.conf.errType&&(s=s.replace("{#ERROR#}",this.ERROR[this.conf.errType])),this.conf.errTime){var n=this.MAX_ERR_TIME-this.conf.errTime;s=s.replace("{#NUM#}",n)}this._dialog=new $.dialog({html:s,title:"支付密码",draggable:!1,width:420});var l=function(){var t=$("#paykey_input").val();if(!t)return void $("#paykey_input_msg").text("请输入支付密码");var s=i.RSA.vcode(t);"function"==typeof a&&(e?a.call(e,{password:s}):a({password:s})),i._dialog.close()};$("#paykey_submit_btn").click(function(a){a.preventDefault(),l()}),$("#paykey_set_form").submit(function(a){a.preventDefault(),l()}),this._dialog.onclose(function(){"function"==typeof t&&(e?t.call(e):t())})},setPasskeyDialog:function(a,t,e){var i=this;2==arguments.length&&(e=t),this._dialog=new $.dialog({html:this._setTpl,title:"提示",draggable:!1,width:420}),$("#paykey_set_accept_btn").click(function(){i._dialog.close()}),$("#paykey_set_cancel_btn").click(function(a){a.preventDefault(),i._dialog.close()}),this._dialog.onclose(function(){"function"==typeof a&&(e?a.call(e):a())})}}});_.Module.define({path:"frs/widget/headSkin",requires:["common/widget/ScrollPanel","tbmall/component/captcha_payment","tbmall/widget/paykey_dialog"],sub:{forumSkinHtml:['<div class="skin_wrapper">','<div class="skin_content">','<h4 class="skin_title">集资额度满足条件，瞬间换新装！我爱我吧，我出力！</h4>','<div class="skin_items clearfix"></div>',"</div>",'<div class="skin_rank">','<h4 class="week_rank_title">本周贡献排行</h4>','<div class="skin_rank_items clearfix"></div>',"</div>","</div>"].join(""),skinPurchaseHtml:['<div class="skin_purchase">','<p><b>我的T豆：<span class="skin_money_remain">#{user_scores}</span></b></p>','<p class="skin_money_wrapper">你要出力：<input class="skin_money_purchase" type="text"/> T豆',"</p>",'<p class="skin_money_tip"></p>',"<p>",'<a href="#" class="skin_purchase_btn  purchase_submit"></a>','<a href="#" class="skin_purchase_btn  purchase_cancel"></a>','<div class="skin_purchase_set_pass"><p><a class="skin_purchase_setpass_link" href="/tbmall/pass/set" target="_blank">立即设置支付密码</a>，降低T豆被盗风险!</p></div>',"</p></div>"].join(""),skinPurchaseSuccessHtml:["<p><b>出力成功！</b></p>",'<p class="skin_money_wrapper">高端大气华丽装修即将完成！',"</p>",'<p class="skin_success_timeout"><span></span>后将自动回到本吧',"</p>"].join(""),skinPurchaseErrorHtml:["<p><b>出力失败！</b></p>",'<p class="skin_money_wrapper">#{content}</p>','<p class="skin_success_timeout"><span></span>后将自动回到本吧',"</p>"].join(""),skinMap:{1060001:"/tb/static-frs/img/head_skin/1060001.gif",1060002:"/tb/static-frs/img/head_skin/1060002.gif",1060003:"/tb/static-frs/img/head_skin/1060003.gif",1060004:"/tb/static-frs/img/head_skin/1060004.gif",1060005:"/tb/static-frs/img/head_skin/1060005.gif",1060006:"/tb/static-frs/img/head_skin/1060006.gif",1060007:"/tb/static-frs/img/head_skin/1060007.gif",1060008:"/tb/static-frs/img/head_skin/1060008.gif",1060009:"/tb/static-frs/img/head_skin/1060009.gif",1060010:"/tb/static-frs/img/head_skin/1060010.gif",1060011:"/tb/static-frs/img/head_skin/1060011.gif",1060012:"/tb/static-frs/img/head_skin/1060012.gif"},headSkin:$(".card_top"),initial:function(s){try{this.skinId=0,this.skinNeedScore=0,this.forumId=s.forum_id,this.forumName=s.forum_name,this.skinUsedId=s.skin_used_id,this.skinEndTime=s.skin_end_time,this.userScores=parseInt(s.user_scores)||0,this.skinWrapper=$(this.forumSkinHtml),this.skinItems=this.skinWrapper.find(".skin_items"),this.skinRankItems=this.skinWrapper.find(".skin_rank_items"),this.skinPurchaseHtml=$.tb.format(this.skinPurchaseHtml,{user_scores:this.userScores}),PageData.user.setpass&&(this.skinPurchaseHtml=this.skinPurchaseHtml.replace("skin_purchase_set_pass","skin_purchase_set_none")),this.skinPurchase=$(this.skinPurchaseHtml),this.skinMoney=this.skinPurchase.find(".skin_money_purchase"),this.skinTip=this.skinPurchase.find(".skin_money_tip"),this.initHeadSkin(),this.bindEvent()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:105}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:105}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:105")}},initHeadSkin:function(){var s=this.skinUsedId,e=this.skinEndTime,i=Math.floor((new Date).getTime()/1e3);s&&e>=i&&this.skinMap[s]?this.headSkin.css("backgroundImage","url("+this.skinMap[s]+")"):(this.headSkin.css("backgroundImage",""),s="1060001"),this.initGuide(s)},initGuide:function(s){if("1"!=$.cookie("head_skin_guide")){var e=$('<img class="guide_img" src="'+this.skinMap[s]+'"/>').prependTo(this.headSkin);setTimeout(function(){e.fadeIn(1e3,function(){setTimeout(function(){e.animate({opacity:0,width:"-=978",height:"-=96",left:"+=978"},2e3,function(){e.remove(),$.cookie("head_skin_guide","1",{expires:365})})},1e3)})},1e3)}},initSkinDialog:function(){var s=this;this.skinDialog=new $.dialog({html:this.skinWrapper,title:"吧装修",width:693,height:450,top:"28%",left:($(window).width()-705)/2,autoCenter:!1}),$(window).on("resize.skin",function(){s.skinDialog.setPosition(($(window).width()-705)/2,"28%")}),this.skinDialog.bind("onclose",function(){$(window).off("resize.skin"),s.initHeadSkin()}),this.skinWrapper.closest(".dialogJcontent").css("padding","0"),this.acquireSkins(),this.skinDialog.show()},initPurchaseDialog:function(){var s=this;this.purchaseDialog=new $.dialog({html:this.skinPurchase,title:"提示",width:400,height:180}),this.skinDialog.hide(),this.purchaseDialog.show(),this.skinMoney.val("").focus(),this.purchaseDialog.bind("onclose",function(){s.skinTip.empty(),s.skinDialog.show()})},bindEvent:function(){var s=this;$(".head_skin_btn").bind("click",function(){try{s.initSkinDialog()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:194}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:194}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:194")}}),$("body").delegate(".purchase_skin","click",function(){try{if(!PageData.user.is_login)return s.skinDialog.close(),_.Module.use("common/widget/LoginDialog"),void 0;s.skinId=$(this).getData("data-skinid"),s.skinNeedScore=parseInt($(this).getData("data-skinneedscore")),s.initPurchaseDialog()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:204}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:204}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:204")}}).delegate(".purchase_submit","click",function(){try{s.buySkin($(this))}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:206}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:206}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:206")}}).delegate(".purchase_cancel","click",function(){try{s.purchaseDialog.close()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:208}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:208}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:208")}}),$("body").on("click",".skin_pic_wrapper",function(){try{var e=$(this).tbattr("skinid");e&&s.headSkin.css("background-image","url("+s.skinMap[e]+")")}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"frs:widget/head_skin/head_skin.js",method:"",ln:214}),$.se({msg:(i.message||i.description).replace(/\s+/g,"-"),locator:"frs:widget/head_skin/head_skin.js",linenum:214}),console.log("errormsg:"+(i.message||i.description).replace(/\s+/g,"-"),"locator:frs:widget/head_skin/head_skin.js","linenum:214")}})},acquireSkins:function(){var s=this,e=(new Date).getTime();url="tbmall/post/getforumskins?t="+e,this.skinItems.html('<div class="all_skin_loading"></div>'),$.get(url,{forum_id:s.forumId},function(e){return 0!=e.no?!1:(s.addAllSkin(e.data),s.addRankSkin(e.data),void 0)})},addAllSkin:function(s){var e=s.cur_skin,i=s.skin;if(s&&i&&0==i.length)return this.skinItems.html("目前还没有可供购买的皮肤哦！"),void 0;for(var n="",t=['<div class="skin_item">','<div class="skin_pic_wrapper" skinid="#{skin_id}" title="点击预览">','<img class="skin_pic" src="/tb/static-frs/img/head_skin/small_#{skin_id}.png">',"#{showEndTime}","</div>","<p>价格：","<span>#{scores_need}</span>","T豆/","<span>#{keep_time}</span>","天</p>","<p>当前集资：","<span>#{scores_have}</span>","T豆</p>","<p>",'<a onclick="return false;" class="#{already_used_skin}" ','data-skinid="#{skin_id}" data-skinneedscore="#{skin_need_score}">',"<span><em>#{already_used_text}</em></span>","</a></p>","</div>"].join(""),a=0;a<i.length;a++){i[a].keep_time=parseInt(i[a].keep_time/86400)||"1";var r={already_used_skin:"ui_btn ui_btn_s purchase_skin ",already_used_text:"我要出力",skin_need_score:i[a].scores_need-i[a].scores_have};e&&i[a].skin_id==e.skin_id&&(r={already_used_skin:"ui_btn_disable ui_btn_s_disable already_user_skin",already_used_text:"使用中",scores_have:0,showEndTime:'<div class="show_end_time">到期时间：'+this.endTimeFormat(e.end_time)+"</div>"}),n+=$.tb.format(t,$.extend(i[a],r))}this.skinItems.empty(),this.skinScroll&&(this.skinScroll=null),this.skinScroll=this.use("common/widget/ScrollPanel",{container:this.skinItems,height:400,content:n})},endTimeFormat:function(s){var e=new Date(1e3*s),i=[e.getMonth()>9?e.getMonth()+1:"0"+(e.getMonth()+1),"月",e.getDate()>=10?e.getDate():"0"+e.getDate(),"日 ",e.getHours()>=10?e.getHours():"0"+e.getHours(),":",e.getMinutes()>=10?e.getMinutes():"0"+e.getMinutes()].join("");return i},addRankSkin:function(s){function e(s){return 1e6>s?s:(s/1e4).toFixed(2)+"万"}var i=this,n=s.week_ranking,t=['<div class="skin_rank_item clearfix">','<span class="rank_index #{index_class}">#{index}</span>','<a href="/home/main?un=#{encode_uname}&ie=utf-8&fr=head_skin" target="_blank" class="rank_user_name">#{user_name}</a>','<span class="rank_t_dou">出力：<span class="t_dou_count">#{t_dou}</span></span>',"</div>"].join(""),a="",r={};if(n&&n.length>0)for(var o=0,c=n.length;c>o;o++)r={},2>=o&&(r.index_class="rank_index_top"),r.index=o+1,r.user_name=n[o].user_name,r.encode_uname=encodeURIComponent(n[o].user_name),r.t_dou=e(n[o].scores),a+=$.tb.format(t,r);else a='<div class="empty_rank_txt">还没有土豪来出力呢~</div>';this.skinRankItems.empty(),this.rankScroll&&(this.rankScroll=null),this.rankScroll=i.use("common/widget/ScrollPanel",{container:i.skinRankItems,height:410,content:a})},buySkin:function(s){var e=this,i=this.skinMoney.val(),n="/tbmall/post/raisescore?ie=utf-8",t={101:"*请填写T豆数量",102:'*您的T豆不足 <a href="/tbmall/getTdou" target="_blank">如何获取T豆>></a>',103:"*您只需再出 "+this.skinNeedScore+"T豆 就可以完成集资！"};if(""==i||!i.match(/^\d*$/g)||0==parseInt(i))return this.skinTip.html(t["101"]).show(),void 0;if(i>this.userScores)return this.skinTip.html(t["102"]).show(),void 0;if(i>this.skinNeedScore)return this.skinMoney.val(this.skinNeedScore),this.skinTip.html(t["103"]).show(),void 0;s.removeClass("purchase_submit").addClass("purchase_submit_over");var a=function(t){var r={};t&&$.extend(r,t),$.extend(r,{forum_id:e.forumId,forum_name:e.forumName,skin_id:e.skinId,scores:parseInt(i),tbs:PageData.tbs}),$.post(n,r,function(i){if(s.closest(".uiDialogWrapper").find(".dialogJtitle").remove(),0==i.no)e.skinPurchase.html(e.skinPurchaseSuccessHtml);else{if(2150040==i.no||360007==i.no){var n=e.use("tbmall/component/captcha_payment",{data:i});return n.showCaptcha(a),void 0}if(2270018==i.no||1990005==i.no||2190005==i.no){i.data=i.data||{};var t=e.use("tbmall/widget/paykey_dialog",{showType:2,errType:i.no,errTime:i.data.wrongtime});return t.showDialog(a,function(){s.removeClass("purchase_submit_over").addClass("purchase_submit")},e),void 0}e.skinPurchaseErrorHandler(i.no)}e.setRelocationTime()})},r=Number(i);if(r>=3e4&&!PageData.user.setpass){var o=e.use("tbmall/widget/paykey_dialog",{showType:1});o.showDialog(a,e)}else a()},skinPurchaseErrorHandler:function(s){/^(2270002|2270005|2270007)$/.test(s)||(s=9999999);var e={2270002:{content:"本吧不支持使用吧装修。"},2270005:{content:"T豆不足，请刷新页面。"},2270007:{content:"当前装修正在使用，无法进行集资。"},9999999:{content:"未知错误，请刷新页面。"}};this.skinPurchase.html($.tb.format(this.skinPurchaseErrorHtml,e[s]))},setRelocationTime:function(){var s=this,e=1,i=s.skinPurchase.find(".skin_success_timeout span").text("1s"),n=setInterval(function(){return 0==e?(clearInterval(n),$.tb.location.reload(),!1):(e-=1,i.text(e+"s"),void 0)},1e3)}}});_.Module.define({path:"frs/widget/medal",sub:{_card_op:{width:230,height:78},initial:function(){try{this._createMedalDialog(),this._handleEvent(),this._setMedalMap()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/medal/medal.js",method:"",ln:17}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/medal/medal.js",linenum:17}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/medal/medal.js","linenum:17")}},_handleEvent:function(){var t=this;$("#forum_medal").find("a").hover(function(){t._showMedalDialog($(this))},function(){}),$("#forum_medal").hover(function(){},function(){setTimeout(function(){t._medalShowing===!1&&t._medalDialog&&t._medalDialog.hide()},50)})},_setMedalMap:function(){this.medalMap={medal1:{url:"http://tieba.baidu.com/p/2510950726",title:"新秀贴吧冲刺赛获胜吧",intro:"专属小型吧的助推活动，共有133个吧成功冲刺"},medal2:{url:"http://tieba.baidu.com/p/2576294729",title:"千万助推计划助推贴吧",intro:"吧主千万助推计划，扶持百万吧主和贴吧成长"},medal3:{url:"http://tieba.baidu.com/p/2559913135",title:"牛吧联赛“超吧杯”",intro:"争夺牛吧席位，不做二流贴吧，跻身超一流贴吧！"},medal4:{url:"http://tieba.baidu.com/p/2559913135",title:"牛吧联赛“冠军奖”",intro:"争夺牛吧席位，不做二流贴吧，跻身超一流贴吧！"},medal5:{url:"http://tieba.baidu.com/p/2559913135",title:"牛吧联赛“亚军奖”",intro:"争夺牛吧席位，不做二流贴吧，跻身超一流贴吧！"},medal6:{url:"http://tieba.baidu.com/p/2559913135",title:"牛吧联赛“季军奖”",intro:"争夺牛吧席位，不做二流贴吧，跻身超一流贴吧！"},medal7:{url:"http://tieba.baidu.com/p/2559913135",title:"牛吧联赛“优秀奖”",intro:"争夺牛吧席位，不做二流贴吧，跻身超一流贴吧！"},medal8:{url:"http://tieba.baidu.com/p/2478431219",title:"游戏最强吧冠军",intro:"最具游戏范儿、最多游戏达人聚集的游戏最强吧"},medal9:{url:"http://tieba.baidu.com/p/2478431219",title:"游戏最强吧亚军",intro:"最具游戏范儿、最多游戏达人聚集的游戏最强吧"},medal10:{url:"http://tieba.baidu.com/p/2478431219",title:"游戏最强吧季军",intro:"最具游戏范儿、最多游戏达人聚集的游戏最强吧"},medal11:{url:"http://tieba.baidu.com/p/2478431219",title:"游戏最强吧20强",intro:"最具游戏范儿、最多游戏达人聚集的游戏最强吧"},medal12:{url:"http://tieba.baidu.com/p/2794801701",title:"人气贴吧电台",intro:"校园明星DJ选拔赛中人气爆棚吧"},medal13:{url:"http://tieba.baidu.com/p/2794801701",title:"魅力贴吧电台",intro:"校园明星DJ选拔赛中最具魅力的贴吧"},medal14:{url:"http://tieba.baidu.com/p/2794801701",title:"明星贴吧电台",intro:"校园明星DJ选拔赛中荣获前三甲的实力贴吧"}}},_createMedalDialog:function(){var t,a=this;t=['<div class="ui_card_wrap forum_medal_card" id="forum_medal_card">','<div class="ui_card_content medal-w">','<a class="medal-img-w" target="_blank" href=""></a>','<div class="medal-info-w">','<a class="medal-info-title medal-link" id="medal_title" target="_blank" href=""></a>','<p class="medal-intro"></p>',"</div>","</div>",'<span class="j_ui_white_arrow arrow ui_white_down"></span>',"</div>"].join(""),this._medalDialog=$(t),this._medalDialog.hide(),$("body").append(this._medalDialog),this._medalDialog.hover(function(){a._medalShowing=!0,a._medalDialog.show()},function(){a._medalShowing=!1,a._medalDialog.hide()})},_showMedalDialog:function(t){var a,i=this,e=t.tbattr("class"),l=this.medalMap[e];a=l.title,this._medalDialog.find(".medal-img-w").tbattr("href",l.url)[0].className="medal-img-w "+e,this._medalDialog.find("#medal_title").text(a).tbattr("href",l.url),this._medalDialog.find(".medal-intro").text(l.intro),this._medalDialog.find("#medal_link").text(l.link).tbattr("href",l.url);var d=t.offset();this._medalDialog.css({top:d.top-i._card_op.height-14,left:d.left-i._card_op.width/2+13}).show(),i._medalShowing=!1}}});_.Module.define({path:"frs/widget/forum_card/focus_btn",sub:{initial:function(e){try{this.isOfficial=e.isOfficial,this.tbs=e.tbs,this.uid=e.uid,this.is_forum_fourth_manager=e.is_forum_fourth_manager,this.avatar=e.avatar;var t=this,s=$("#j_head_focus_btn"),o=null;t.config={},t.config.url={closetip:"/f/like/commit/notice/delete",dolike:"/f/like/commit/add",undolike:"/f/like/commit/delete"},o=parseInt(e.islike)?function(){if(PageData.user.power&&PageData.user.power.bawu)return t._showAlert('<p style="text-align: center;">您还是本吧的吧务，辞职后才能取消关注哦~</p>'),!1;var e=PageData.forum_name||PageData.forum.forum_name;e=$.tb.subByte(e,10,"...");var s=['<div style="width:190px;text-align:center;top:18px;left:10px;position:absolute;">确定不再关注 <span style="color:red">'+e+"</span> 吧？</div>",'<a href="#" id="cancel_focus_yes" class=" ui_btn ui_btn_s" style="position:absolute;top:50px;left:55px;">',"<span><em>确认</em></span>","</a>",'<a href="#" onclick="return false;" id="cancel_focus_no" class="ui_btn ui_btn_sub_s" style="position:absolute;top:50px;left:105px;">',"<span><em>取消</em></span>","</a>"].join(""),o=new $.dialog({html:s,showTitle:!1,fixed:!1,show:!0,draggable:!1,autoCenter:!1,modal:!1,top:$("#j_head_focus_btn").offset().top-$(this).height()/2-90,left:$("#j_head_focus_btn").offset().left-$(this).width()/2+15,width:210,height:70});$("#cancel_focus_yes").on("click",function(){try{t._undolike(),o.close()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:64}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:64}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:64")}}),$("#cancel_focus_no").on("click",function(){try{o.close()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:67}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:67}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:67")}})}:function(){t._dolike()},s.on("click",o),$(".j_search_post ").click(function(){try{$.stats.track("FRS全吧搜索","PB及FRS统计合项","frs","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:77}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:77}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:77")}}),$(".search_internal_btn").click(function(){try{$.stats.track("FRS吧内搜索","PB及FRS统计合项","frs","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:80}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:80}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:80")}}),$(".sign_title_text_bright").click(function(){try{$.stats.track("FRS签到广告","PB及FRS统计合项","frs","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:83}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:83}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:83")}}),$(".j_nav_list > li:eq(2) a").click(function(){try{$.stats.track("FRS签到广告","PB及FRS统计合项","frs","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:86}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:86}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:86")}})}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/forum_card/focus_btn.js",method:"",ln:87}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/focus_btn.js",linenum:87}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/focus_btn.js","linenum:87")}},_showAlert:function(e){var t='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+e+"</div>";$.dialog.open(t,{title:"操作失败",width:380})},_dolike:function(){var e=this;if(!PageData.user.is_login)return TbCom.process("User","buildLoginFrame"),!1;if(PageData.user.is_login&&PageData.user.no_un)return TbCom.process("User","buildUnameFrame","填写用户名","有用户名才能点亮“我喜欢”，赶快给自己起一个吧~"),!1;var t={};PageData.forum&&(t={fid:PageData.forum.id||PageData.forum.forum_id,fname:PageData.forum.forum_name||PageData.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs}),$.post(e.config.url.dolike,t,function(t){var s=!1;try{var o=t}catch(a){s=!0}if(!s)if(o&&0==o.no)Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikesucc&bduid="+PageData.user.bduid),e.isOfficial?_.Module.use("frs/widget/platform_attention_recommend",[{tbs:e.tbs,uid:e.uid,is_forum_fourth_manager:e.is_forum_fourth_manager,avatar:e.avatar}]):_.Module.use("ucenter/widget/LikeTip",["",!1,{index:o.data.ret.index,like_no:o.like_no}]),$.stats.sendRequest("fr=tb0_forum&st_page=frs&st_mod=like&st_type=auto");else{Stats.sendRequest("fr=tb0_foruStatm&st_mod=frs&st_type=balvlikefail&errorno="+o.no);var r="";r=8==o.no||9==o.no?"你在本吧被封禁，暂时不能进行操作":220==o.no?"你被吧主加入黑名单，暂时不能进行操作":221==o.no?"你已like了本吧,请不要重复操作":"抱歉，异常错误，建议刷新页面重试一下",e._showAlert(r)}},"json")},_undolike:function(){var e=this,t=null;PageData.forum&&(t={fid:PageData.forum.forum_id,fname:PageData.forum.name_url,uid:PageData.user.name_url,ie:"utf-8",tbs:PageData.tbs}),$.tb.post(e.config.url.undolike,t,function(e){var t=!1;try{var s=e}catch(o){t=!0}t||s&&0==s.no&&$.tb.location.reload(!0)})}}});
;_.Module.define({path:"frs/widget/forum_card",sub:{initial:function(){try{this.delay=150,this.$title=$(".card_title_location"),this.$locations=$(".card_locations"),this.$num=$(".card_num"),this._resizeWidth(),this._handleEvent()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/forum_card/forum_card_main.js",method:"",ln:17}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/forum_card/forum_card_main.js",linenum:17}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/forum_card/forum_card_main.js","linenum:17")}},localDisplay:function(){var e=this;return setTimeout(function(){e.$title.parent().addClass("card_title_location_wrapper_sel"),e.$num.addClass("card_num_fix"),e.$locations.removeClass("card_nor").addClass("card_sel")},e.delay)},localHidden:function(){var e=this;return setTimeout(function(){e.$title.parent().removeClass("card_title_location_wrapper_sel"),e.$num.removeClass("card_num_fix"),e.$locations.removeClass("card_sel").addClass("card_nor")},e.delay)},_handleEvent:function(){var e,a=this;this.$title.on("mouseenter",function(){clearTimeout(e),e=a.localDisplay()}).on("mouseleave",function(){clearTimeout(e),e=a.localHidden()}),this.$locations.on("mouseenter",function(){clearTimeout(e),e=a.localDisplay()}).on("mouseleave",function(){clearTimeout(e),e=a.localHidden()}),this.$locations.delegate("a","mousedown",function(){$.stats.sendRequest("fr=tb0_forum&st_mod=difangba&difangba_down")})},_resizeWidth:function(){var e=this.$locations.find("a").length;e=e%2===0?e:e+1;var a=e/2*60+20*(e/2-1)+15+"px";this.$locations.css("width",a)}}});_.Module.define({path:"common/widget/PadstyleNav",requires:[],sub:{data:{is_good:false,forum_name:"",user_islogin:false,domNav:null,domNavFake:null,objFixer:null},initial:function(c,a,b){this.data.is_good=(a==="good"?true:false);this.data.is_album=(a==="album"?true:false);this.data.forum_name=c;this.data.user_islogin=b;this.data.domNav=$("#frs_nav");this._showType();this._handleEvents()},_showType:function(){if(this.data.is_good){$("#frs_nav_good").removeClass("frs_nav_item_normal").addClass("frs_nav_item_selected");$("#frs_nav_main").removeClass("frs_nav_item_selected").addClass("frs_nav_item_normal")}if(this.data.is_album){$("#frs_nav_album").removeClass("frs_nav_item_normal").addClass("frs_nav_item_selected");$("#frs_nav_main").removeClass("frs_nav_item_selected").addClass("frs_nav_item_normal")}},_handleEvents:function(){var a=this;a.data.domNav.on("click","#nav_post",function(b){});a.data.domNav.on("click","#nav_refresh",function(b){$.tb.location.setHref($.tb.unescapeHTML($.tb.location.getHref()))})},_focusOnEditor:function(a){if(this.data.user_islogin){$(a).focus()}else{LoginInstance.show()}}}});_.Module.define({path:"common/widget/frs_version/version_cookie",sub:{_fid:null,initial:function(i){this._fid=i},fidin:function(i){var i=i||"";return("-"+i+"-").indexOf("-"+this._fid+"-")>-1},delfid:function(i){var i=i||"";return i.replace(new RegExp("\\b("+this._fid+")+\\b\\-?|\\-?\\b("+this._fid+")+\\b","g"),"")},addfid:function(i){var i=i||"",e=10;if(this.fidin(i))return i;if(""!=i)var n=i.split("-");else var n=[];return n.push(this._fid),n.length>e&&n.shift(),n.join("-")},getdate:function(){return parseFloat(((24-(new Date).getHours())/24).toFixed(4))}}});
;_.Module.define({path:"common/widget/frs_version",requires:["common/widget/frs_version/version_cookie"],sub:{_fid:null,initial:function(o){this._fid=o},toggle:function(o){var e=this.use("common/widget/frs_version/version_cookie",this._fid),i=$.cookie("TB_OFRS")||"",t=$.cookie("TB_NFRS")||"";"old"==o?e.fidin(t)?($.cookie("TB_NFRS",e.delfid(t),{expires:365,path:"/"}),$.stats.track("old_tb_nfrs","old_tb_nfrs")):($.cookie("TB_OFRS",e.addfid(i),{expires:e.getdate(),path:"/"}),$.stats.track("old_tb_ofrs","old_tb_ofrs")):e.fidin(i)?($.cookie("TB_OFRS",e.delfid(i),{expires:e.getdate(),path:"/"}),$.stats.track("new_tb_ofrs","new_tb_ofrs")):($.cookie("TB_NFRS",e.addfid(t),{expires:365,path:"/"}),$.stats.track("new_tb_nfrs","new_tb_nfrs")),setTimeout(function(){$.tb.location.reload()},30)}}});_.Module.define({path:"common/widget/tbnav_bright/tbnav_search",requires:["common/widget/search_handler"],sub:{_searchHandler:null,_jq_wrap:null,_jq_input:null,_options:{forumName:""},initial:function(c,b){var a=this;this._searchHandler=this.use("common/widget/search_handler");this._jq_wrap=c;this._jq_input=c.find(".j_search_internal_input");this._options=$.extend(this._options,b);this._jq_wrap.find(".j_search_internal_form").submit(function(){a._searchInternal();return false});this._initPlaceHolder();this._addTabIcon()},_addJump:function(){if($(".qiangzuo_trigger").length>0){$(".qiangzuo_trigger").on("click",function(){window.open("/game/worldcup/index")})}},_addTabIcon:function(){$("#tb_nav").find(".icon_world_cup").closest(".space").css("position","relative");$("#tb_nav").find(".icon_world_cup").closest(".space").append($("<i class='word_cup_sp_icon'></i>"))},_searchInternal:function(){var a=this._getSearchWord();this._searchHandler.searchPostInBa(a,this._options.forumName)},_getSearchWord:function(){return this._jq_input.val()},_initPlaceHolder:function(){var b=this;var c=this._jq_wrap.find(".j_search_internal_placeholder");var a=this._jq_input;if(b._getSearchWord()!=""){c.hide()}a.focus(function(){c.hide()}).blur(function(){if(b._getSearchWord()==""){c.show()}});c.click(function(){a.focus()})}}});_.Module.define({path:"common/widget/tbnav_bright",requires:["common/widget/tbnav_bright/tbnav_search"],sub:{_jq_wrap:null,initial:function(b,a){this._jq_wrap=b;this.use("common/widget/tbnav_bright/tbnav_search",a.jq_search,a);this._bindNavDropDownList()},_bindNavDropDownList:function(){$(".j_tbnav_list").on("mouseenter",function(b){b.preventDefault();var a=$(b.currentTarget);a.addClass("nav_list_over")}).on("mouseleave",function(b){b.preventDefault();var a=$(b.currentTarget);a.removeClass("nav_list_over")})}}});_.Module.define({path:"common/widget/often_forum_bright",sub:{_wrapId:null,_jqWrap:null,_imgPostParams:null,oftengo_bubble:null,initial:function(b,a){this._wrapId=b;this._imgPostParams=a;this.oftenGoForum()},oftenGoForum:function(){var e=this._imgPostParams.user.user_forum_list?this._imgPostParams.user.user_forum_list.info:null,d=$("#often_forum"),c=this;if(d.length>0){var f=null,a=null;c.renderForumMenu(e);var b=c.j_menu;if(!b){return}d.click(function(){c.fixedPosition();d.addClass("btn_select");b.slideDown(100);clearTimeout(f);return false});if(!PageData.is_ipad){d.mouseenter(function(){clearTimeout(a);if(b.css("display")!="none"){return false}f=setTimeout(function(){c.fixedPosition();d.addClass("btn_select");b.slideDown(100)},300)});d.mouseleave(function(){clearTimeout(f);a=setTimeout(function(){d.removeClass("btn_select");b.hide()},50)});b.mouseenter(function(){clearTimeout(a)});b.mouseleave(function(){a=setTimeout(function(){d.removeClass("btn_select");b.hide()},50)})}b.find(".j_often_go_fname").mousedown(function(){$.stats.hive("of_click");$.stats.sendRequest("fr="+PageData.product+"&st_mod=oftenforum&st_type=forumclick&uid="+PageData.user.id);if(PageData&&PageData.forum&&PageData.product){if($(this).hasClass("ui_text_desc")){return}var g={st_mod:"nav_oftenforum_bar",st_type:"enterba",st_from:encodeURIComponent(PageData.product),st_uid:(PageData.user.id),st_benba:encodeURIComponent(PageData.forum.name),st_goto:encodeURIComponent($(this).text())};$.tb.Stats.sendRequest("http://static.tieba.baidu.com/tb/img/hive.gif",g)}});b.find(".j_often_go_more").mousedown(function(){$.stats.hive("of_more");$.stats.sendRequest("fr="+PageData.product+"&st_mod=oftenforum&st_type=forummoreclick&uid="+PageData.user.id)})}},renderForumMenu:function(d){var c=this.genericForumMenu(d);if(c){var b=$(c),a=$("#often_forum"),e=$("#"+this._wrapId);$("body").append(b);this.j_menu=b}},genericForumMenu:function(e){if(e&&e.length>0){var d='<div id="nav_forum_menu" class="nav_forum_menu"><div class="n_menu_wrap clearfix"><ul class="n_menu_content clearfix">';var b=PageData.is_ipad?"n_menu_item_ipad":"n_menu_item";for(var c=0,a=e.length;c<a;c++){var g=e[c],f="";if(c<7||(c==7&&a==8)){f='<li class="'+b+'"><a class="j_often_go_fname" title="'+g.forum_name+'" href="/f?ie=utf-8&kw='+encodeURIComponent(g.forum_name)+'" target="_blank">'+$.tb.subByte(g.forum_name,12,"..")+"</a></li>";d+=f}else{f='<li class="'+b+'"><a href="http://tieba.baidu.com/home/forum?id='+PageData.user.portrait+'&fr=tbnav" target="_blank" class="j_often_go_more nav_g_more">\u66f4\u591a&gt;&gt;</a></li>';d+=f;break}}d+='</ul></div> <div class="btn_inherit">&nbsp;</div></div>';return d}return null},fixedPosition:function(){var d=this.j_menu,c=$("#often_forum"),e=$("#"+this._wrapId);c.removeClass("btn_select");e.addClass("nav_position");var h=c.position(),g=c.offset(),b=e.height();e.removeClass("nav_position");var f=d.find("li.n_menu_item"),a=f.length;if(a==1){f.width(94);d.width(111);d.find(".btn_inherit").css("left","0px");d.css({top:(g.top+b-14),left:g.left})}else{d.find(".btn_inherit").css("left","80px");d.css({top:(g.top+b-14),left:g.left-c.width()+5})}}}});_.Module.define({path:"common/widget/RollNumber",sub:{_defaultOption:{numberString:"0",zeroArray:[],needComma:false,theme:"black",dom:$("body")},_addEasingFunction:function(){jQuery.extend(jQuery.easing,{rollNumber:function(e,f,a,h,g){if((f/=g/2)<1){return h/2*f*f*f*f*f+a}return h/2*((f-=2)*f*f*f*f+2)+a}})},initial:function(a){this._addEasingFunction();this._option=$.extend({},this._defaultOption,a);this._init(this._option.numberString)},_init:function(a){this._option.numberString=a;this._option.zeroArray=this._getZeroArray(a.length,this._option.needComma);this._option.length=this._option.zeroArray.length;this._render();this._roll()},_getZeroArray:function(a,b){var c=new Array(a+1).join(0);return b?this._addComma(c).split(""):c.split("")},_addComma:function(c){var a=[],b=c.length;while(b>0){a.unshift(c.substring(b-=3,b+3))}return a.join(",")},_render:function(){var c="",e=this._option.zeroArray,d="roll_number_wrapper roll_number_"+this._option.theme;for(var b=0,a=e.length;b<a;b++){if(e[b]==","){c+='<div class="num_obg num_break"><span class="num_icon"></span></div>'}else{c+='<div class="num_obg"><span class="num_icon"></span></div>'}}this._option.dom.addClass(d).html(c)},_reRender:function(){var b=this._option.zeroArray.length-this._option.length,a=new Array(b+1).join('<div class="num_obg"><span class="num_icon"></span></div>');this._option.dom.prepend(a);this._option.length=this._option.zeroArray.length},_roll:function(){var c=this,e,b=this._option.numberString,a=this._option.needComma?this._addComma(b).split(""):b.split(""),d=this._option.dom.find(".num_icon");$.each(a,function(g,f){e=-27*Number(f-0)?-27*Number(f-0):-270;c._changeNum(d.eq(g),{t:0,pos_y:e,d:100,b:0})})},_rollTo:function(d){var b=this._option.numberString,e=this._option.needComma?this._addComma(b).split(""):b.split(""),a=this._option.needComma?this._addComma(d).split(""):d.split(""),f=this._option.dom.find(".num_icon");for(var c=a.length-1;c>=0;c--){if(a[c]!=e[c]){f.eq(c).animate({"background-position-y":-27*a[c]+"px"},500,"rollNumber")}else{break}}this._option.numberString=d},refresh:function(a){this._option.zeroArray=this._getZeroArray(a.length,this._option.needComma);this._reRender();this._rollTo(a)},_changeNum:function(c,b){var a=this;c.css("background-position","0px "+this._transition(b.t,b.pos_y,b.d,b.b)+"px");b.t++;if(b.t<=b.d){setTimeout(function(){a._changeNum(c,b)},20)}},_transition:function(c,a,b,d){if((c/=b/2)<1){return a/2*c*c*c+d}return a/2*((c-=2)*c*c+2)+d}}});_.Module.define({path:"frs/widget/cheerForGEFC",requires:["common/widget/RollNumber"],sub:{tpls:{block:'<div class="cfgefc_dialog"><p>您的账号已被封禁，无法参加活动。</p><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div>',notlike:'<div class="cfgefc_dialog"><p>参与活动需要先关注本吧哦~</p><a href="#" class="ui_btn ui_btn_m j_dolike"><span><em>关注本吧</em></span></a></div>',noreason:'<div class="cfgefc_dialog"><p>系统发生未知错误，请稍后再试试吧~</p><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div>',sofast:'<div class="cfgefc_dialog"><p>哇哦~我们都已经感受到你的热情了！请休息一会儿再来吧！</p><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div>',goodcheer:'<div class="cfgefc_dialog_leftbg"><p class="cfgefc_orange" style="font-size:14px;margin-bottom:10px;">已为恒大助攻，拒绝恐韩，为中国加油！</p><p>已有<span class="cfgefc_orange">#{val}</span>名球迷与您一起为恒大助攻</p><p>#{autolike}已获得抽奖资格&nbsp;&nbsp;<a href="#{dialogurl}" target="_blank">#{dialogurlword}</a></p></div><a href="#" class="ui_btn ui_btn_m j_close"><span><em>我知道了</em></span></a></div>'},sending:!1,initial:function(e){try{var o=this;o.dialogurl=e,$.getJSON("/gcf/getVote?forum_id="+PageData.forum.forum_id+"&t="+(new Date-0),function(e){if(0==e.no){$(".cfgefc_wrapper").show();var s="string"==typeof e.data?Number(e.data):0;o.number=s+1,_.Module.use("common/widget/RollNumber",{numberString:s.toString(),dom:$("#cfgefc_rollnumber_wrapper")},function(e){o.roll=e}),o.bindEvents()}})}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/cheerForGEFC/cheerForGEFC.js",method:"",ln:30}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"frs:widget/cheerForGEFC/cheerForGEFC.js",linenum:30}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:frs:widget/cheerForGEFC/cheerForGEFC.js","linenum:30")}},bindEvents:function(){var e=this;$(".j_cfgefc_bigbtn").on("click",function(o){try{o&&o.preventDefault(),PageData.user.is_login?PageData.user.balv.is_block||PageData.user.is_black||PageData.user.fobidden&&PageData.user.fobidden.isForbid?e.showBasicDialog("block"):PageData.user.is_like?e.sendCheer():e.sendLikeCheer():_.Module.use("common/widget/LoginDialog")}catch(o){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:o.message||o.description,path:"frs:widget/cheerForGEFC/cheerForGEFC.js",method:"",ln:44}),$.se({msg:(o.message||o.description).replace(/\s+/g,"-"),locator:"frs:widget/cheerForGEFC/cheerForGEFC.js",linenum:44}),console.log("errormsg:"+(o.message||o.description).replace(/\s+/g,"-"),"locator:frs:widget/cheerForGEFC/cheerForGEFC.js","linenum:44")}}).on("mouseover",function(){$(".cfgefc_bubble").show()}).on("mouseleave",function(){$(".cfgefc_bubble").hide()})},showBasicDialog:function(e,o){var s,a=this;_html=this.tpls[e],"goodcheer"==e&&(s=a.number++,a.roll.refresh(s.toString()),_html=$.tb.format(_html,{val:s,dialogurl:a.dialogurl,dialogurlword:"0"==a.dialogurl?"":"查看抽奖规则",autolike:o?"同时欢迎你成为广州恒大足球俱乐部的会员，并":"您"})),this.timer=setTimeout(function(){switch(a.dialog&&a.dialog.close(),a.dialog=new $.dialog({html:_html,width:435}),e){case"notlike":a.dialog.element.on("click",".j_dolike",function(e){try{e.preventDefault(),a.dialog.close(),Balv.dolike(),$.stats.track("like_from_cheerForGEFC","platforum_activity")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/cheerForGEFC/cheerForGEFC.js",method:"",ln:77}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/cheerForGEFC/cheerForGEFC.js",linenum:77}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/cheerForGEFC/cheerForGEFC.js","linenum:77")}});break;case"goodcheer":a.dialog.element.addClass("pat-noTitle");default:a.dialog.element.on("click",".j_close",function(e){try{e.preventDefault(),a.dialog.close()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/cheerForGEFC/cheerForGEFC.js",method:"",ln:85}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/cheerForGEFC/cheerForGEFC.js",linenum:85}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/cheerForGEFC/cheerForGEFC.js","linenum:85")}}).on("onclose",function(){o&&$.tb.location.reload(),a.sending=!1})}a.timer=null},600)},sendCheer:function(e){var o=this,s={forum_id:PageData.forum.forum_id,tbs:PageData.tbs};o.sending||(o.sending=!0,$.post("/gcf/vote",s,function(s){0==s.no?o.showBasicDialog("goodcheer",e):20003==s.no?o.showBasicDialog("notlike"):20005==s.no?o.showBasicDialog("block"):20006==s.no?o.showBasicDialog("sofast"):o.showBasicDialog("noreason")},"json"))},sendLikeCheer:function(){var e=this,o={fid:PageData.forum.forum_id,fname:PageData.forum.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs};$.post("/f/like/commit/add",o,function(o){0==o.no||221==o.no?($.stats.track("like_from_cheerForGEFC","platforum_activity"),e.sendCheer(!0)):8==o.no||9==o.no||220==o.no?e.showBasicDialog("block"):e.showBasicDialog("noreason")},"json")}}});_.Module.define({path:"frs/widget/platform_fansno",sub:{initial:function(s){try{this.data=s.frsstar,this.isFRS=s.isFRS,this._initFansno()}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/platform_fansno/platform_fansno.js",method:"",ln:15}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_fansno/platform_fansno.js",linenum:15}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_fansno/platform_fansno.js","linenum:15")}},_initFansno:function(){var s=this,a=this.data.fans,t=$("#star_nums .j_fans_wrapper");if(a.open)a.is_get?s._showFansNum(a):s._getFansNum();else{var e=a.open_time-this.data.cur_time;if(e>0&&36e4>e){s._initCountdown(),s._showCountdown(e);var n=setInterval(function(){e--,e>0?s._showCountdown(e):(clearInterval(n),s._getFansNum())},1e3)}else{var o=new Date(1e3*a.open_time),r={content:"周"+["日","一","二","三","四","五","六"][o.getDay()]+"（"+$.dateFormat(o,"MM月dd日")+"） "+$.dateFormat(o,"HH:mm")+"准点开抢，一定记得来抢个好号哦~",arrow_dir:"up",bubble_css:{top:30,right:-51,width:223,"text-align":"left"},arrow_pos:{left:30},attr:" id='tb_message_tip_n' ",wrap:$("#star_nums"),closeBtn:!1},i=new UiBubbleTipBase(r),l=t.find(".j_fans_content");l.css({display:"block"}),l.bind("mouseover",function(){i.showBubble(),$.stats.sendRequest("fr=tb0_forum&st_type=star_fans")}).bind("mouseout",function(){i.hideBubble()})}}},_getFansNum:function(){var s=this,a=$("#star_nums .j_fans_content"),t=$("#star_nums .j_fans_countdown");t.hide(),a.removeClass("fans_countdown_title").addClass("fans_content fans_num_get").html("点击领取全球唯一粉丝编号").css({display:"block"}).on("click",function(){try{return PageData.user.is_login?PageData.user.no_un?(TbCom.process("User","buildUnameFrame"),!1):(s._getDataOfFansNum(),!1):(TbCom.process("User","buildLoginFrame",null,null,null,"star_fans"),!1)}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/platform_fansno/platform_fansno.js",method:"",ln:99}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_fansno/platform_fansno.js",linenum:99}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_fansno/platform_fansno.js","linenum:99")}})},_getDataOfFansNum:function(){var s=this,a=PageData.user.balv||{};a.is_block?s._showErrorTip(8):a.is_black?s._showErrorTip(220):a.has_liked?s._postFansData():s._postLikeData()},_showSuccessTip:function(s){var a=this,t=new Array;t.push('<div class="success_tip_wrapper"></div>'),t.push('<p class="success_tip_name">恭喜你获得'+$.tb.subByte(PageData.forum.forum_name,14,"..")+"全球唯一</p>"),t.push('<p class="success_tip_num">');for(var e=this._getNo(s.num),n=0;n<e.length;n++)t.push('<span class="fansnum_'+e.charAt(n)+'"></span>');t.push("</p>"),t.push('<p class="success_tip_welcome">同时欢迎你成为'+$.tb.subByte(PageData.forum.forum_name,14,"..")+"吧的会员</p>"),t.push('<a href="#" class="success_tip_close"></a>');var o=new $.dialog({html:t.join(""),showTitle:!1,draggable:!1,width:350,height:265,holderClassName:"fansnum_bigtip"}),r=setTimeout(function(){a._showFansNum(s),o.close(),$.tb.location.reload()},8e3);$("a.success_tip_close").bind("click",function(){try{return clearTimeout(r),a._showFansNum(s),o.close(),$.tb.location.reload(),!1}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/platform_fansno/platform_fansno.js",method:"",ln:153}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_fansno/platform_fansno.js",linenum:153}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_fansno/platform_fansno.js","linenum:153")}})},_showFansNum:function(s){var a=$("#star_nums"),t=new Array,e=$.dateFormat(new Date(1e3*s.get_time),"yyyy年MM月dd日HH时mm分"),n=a.find(".j_fans_content");n.removeClass("fans_num_get").css({display:"block"}).html("我的粉丝编号："+this._getNo(s.num)),this.isFRS?t.push('<div class="fansnum_smalltip">'):t.push('<div class="fansnum_smalltip fansnum_smalltip_up">'),t.push('<p class="smalltip_title">'+$.tb.subByte(PageData.forum.forum_name,12,"..")+"全球唯一粉丝编号</p>"),t.push('<div class="smalltip_content">'),t.push('<a class="smalltip_head" target="_blank" href="/home/main?id='+PageData.user.portrait+'&fr=frs"><img src="http://tb.himg.baidu.com/sys/portrait/item/'+this.data.fans.portrait+'" width="40" height="40" onload="resizePic_temp(this, 40, 40,false);"/></a>'),t.push('<div class="smalltip_name">'+$.tb.subByte(PageData.user.user_name,16,"..")+"</div>"),t.push('<div class="smalltip_num">');for(var o=this._getNo(s.num),r=0;r<o.length;r++)t.push("<span>"+o.charAt(r)+"</span>");t.push("</div>"),t.push('<p class="smalltip_time">于'+e+"获得</p>"),t.push("</div>"),t.push("</div>");var i=$(t.join(""));a.append(i),n.unbind().bind("mouseover",function(){i.show()}).bind("mouseout",function(){i.hide()})},_getNo:function(s){var a="0000000";return s+="",a.substr(0,a.length-s.length)+s},_initCountdown:function(){var s=$("#star_nums .j_fans_wrapper"),a=s.find(".j_fans_content"),t=s.find(".j_fans_countdown");a.removeClass("fans_content").addClass("fans_countdown_title").html("粉丝编号开抢倒计时：");var e={0:"他",1:"她",2:"TA"},n=e[this.data.gender]||"TA",o="每一个"+PageData.forum.forum_name+"的粉丝编号，都代表着对"+n+"独一份的爱";t.tbattr("title",o).show()},_showCountdown:function(s){var a=Math.floor(s/3600),t=Math.floor(s%3600/60),e=s%60,n=$("#star_nums .j_fans_wrapper"),o=n.find(".j_countdown_h"),r=n.find(".j_countdown_m"),i=n.find(".j_countdown_s");a=10>a?"0"+a:a,t=10>t?"0"+t:t,e=10>e?"0"+e:e,o.html(a),r.html(t),i.html(e)},_postLikeData:function(){var s=this,a={fid:PageData.forum.forum_id,fname:PageData.forum.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs};$.tb.post("/f/like/commit/add",a,function(a){if(a)switch(a.no){case 0:s._postFansData();break;case 8:case 9:case 220:s._showErrorTip(a.no);break;default:s._showErrorTip()}else s._showErrorTip()})},_postFansData:function(){var s=this,a="/frsstar/cm/fans/get",t={fid:PageData.forum.forum_id,tbs:PageData.tbs};$.tb.post(a,t,function(a){a?0==a.no?s.isInvite?(s.starInvite._showInviteSuccessTip(a.data),s.starInvite._addInviteUser()):s._showSuccessTip(a.data):s._showErrorTip(a.no):s._showErrorTip()})},_showErrorTip:function(s){var a="";switch(s){case 8:case 9:a="你在本吧被封禁，暂时不能进行操作";break;case 220:a="你被吧主加入黑名单，暂时不能进行操作";break;case 120002:a="已领取成功，刷新页面看看呗";break;default:a="额，抱歉服务器好像抽风了，请你再点一下下"}var t=new Array;t.push('<div class="error_tip_text">'+a+"</div>"),t.push('<a class="error_tip_btn" href="#">刷新本页</a>');new $.dialog({html:t.join(""),showTitle:!1,draggable:!1,width:244,height:113});$("a.error_tip_btn").bind("click",function(){try{return $.tb.location.reload(),!1}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/platform_fansno/platform_fansno.js",method:"",ln:319}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_fansno/platform_fansno.js",linenum:319}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_fansno/platform_fansno.js","linenum:319")}})}}});_.Module.define({path:"frs/widget/PlatformWeal",sub:{initial:function(e){try{this.dataObj=e,this.forumInfo=this.dataObj.forum_info,this.wealNum="",this._bindEvents(),this._initBubble(),jx=this}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"frs:widget/platform_weal/platform_weal.js",method:"",ln:18}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_weal/platform_weal.js",linenum:18}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_weal/platform_weal.js","linenum:18")}},_bindEvents:function(){var e=this,a=(e.dataObj,e.forumInfo.forum_mis_info),l=$.tb.location.getHash(),s=null,t=['<img src="/tb/static-frs/img/weal_welcome.png" alt="群抢优惠券" class="weal_wel_img">','<p class="weal_wel_tip">本吧正在发送优惠券哟~不来一份么>_<</p>','<a href="#" id="weal_trigger_link" class="weal_trigger_link">我要领取</a>'];"#getweal"==l&&(s=new $.dialog({html:t.join(""),showTitle:!0,draggable:!1,closeable:!0,width:418,holderClassName:"weal_wel_holder"})),$("#weal_trigger_link").click(function(){try{$("#btn_getweal").trigger("click"),s.close()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_weal/platform_weal.js",method:"",ln:46}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_weal/platform_weal.js",linenum:46}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_weal/platform_weal.js","linenum:46")}}),$("#btn_getweal").on("click",function(l){try{if(l.preventDefault(),e._closeBubble(),$.stats.track("本吧福利按钮","平台化吧统计报表","","click"),1==PageData.user.is_login){if(PageData.user.no_un)return TbCom.process("User","buildUnameFrame"),!1;a&&a.weal_id?"1"==PageData.user.is_like?e._postWealData():e._postLikeData().always(function(){e._postWealData()}):"1"==PageData.user.is_like?e._showWealDialog(2):e._postLikeData()}else TbCom.process("User","buildLoginFrame",null,null,null,this.key||"");return!1}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/platform_weal/platform_weal.js",method:"",ln:83}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_weal/platform_weal.js",linenum:83}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_weal/platform_weal.js","linenum:83")}}),$("#wealtip_wrap").on("click",".wealtip_link",function(){try{$.stats.track("本吧福利浮层链接","平台化吧统计报表","","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_weal/platform_weal.js",method:"",ln:86}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_weal/platform_weal.js",linenum:86}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_weal/platform_weal.js","linenum:86")}})},_postLikeData:function(){var e=this,a=e.forumInfo.forum_mis_info,l={fid:PageData.forum.forum_id,fname:PageData.forum.forum_name,uid:PageData.user.name_url,ie:"gbk",tbs:PageData.tbs},s=$.post("/f/like/commit/add",l,function(l){var s=$.parseJSON(l);if(s)switch(s.no){case 0:$.stats.track("通过本吧福利喜欢本吧","平台化吧统计报表","","view"),a&&a.weal_id||e._showWealDialog(1);break;case 8:case 9:case 220:e._showErrorTip(s.no);break;default:e._showErrorTip()}else e._showErrorTip()});return s},_postWealData:function(){var e=this,a=e.forumInfo.forum_id,l=e.forumInfo.forum_mis_info;$.post("/gcf/receive",{forum_id:a,weal_id:l.weal_id,tbs:PageData.tbs}).always(function(a){var l=$.parseJSON(a);switch(null!==l.data&&(e.wealNum=l.data),l.no){case 0:e._showWealDialog(1);break;case 20008:e._showWealDialog(2);break;case 20001:TbCom.process("User","buildLoginFrame",null,null,null,this.key||"");break;case 20003:e._postLikeData();break;case 20004:case 20005:case 20006:case 20007:case 20009:e._showErrorTip(l.no);break;case 20010:e._showWealDialog(3)}})},_showErrorTip:function(e){var a="";switch(e){case 8:case 9:a="你在本吧被封禁，暂时不能进行操作";break;case 220:a="你被吧主加入黑名单，暂时不能进行操作";break;case 20005:a="用户被封禁";break;case 20006:case 20007:a="操作太频繁了，请稍作歇息，过会儿再来";break;case 20009:a="领取失败，请再试一次吧";break;default:a="服务器出错啦~请再试一次吧"}var l=new Array;l.push('<div style="text-align:center;color:#333333;font-size:14px;padding:10px 10px 0;">'+a+"</div>");new $.dialog({html:l.join(""),showTitle:!0,draggable:!1,width:300,height:40})},_showWealDialog:function(e){var a=this,l=a.forumInfo.forum_mis_info,s=l.weal_dialog_text,t=l.weal_dialog_pic,i=l.weal_dialog_link,o=l.weal_dialog_tip1,r=l.weal_dialog_tip3,n=new Array;$.stats.track("本吧福利浮层","平台化吧统计报表","","view"),n.push('<p id="wealtip_wrap" class="wealtip_wrap wealtip_wrap_theme'+e+'">'),""!=t&&(""!=i?(n.push('<a class="wealtip_link" href="'+i+'" target="_blank">'),n.push('<img src="'+t+'">'),n.push("</a>")):n.push('<img src="'+t+'">')),""!=s&&(""!=i?(n.push('<a class="wealtip_txt_link" href="'+i+'" target="_blank">'),n.push(s),n.push("</a>")):n.push('<span class="wealtip_txt_title">'+s+"</span>")),"1"!=PageData.user.is_like&&n.push('<span class="weal_status_tip">'+o+"</span>"),3==e?n.push('<span class="weal_num_wrap">'+r+"</span>"):""!=a.wealNum&&n.push('<span class="weal_num_wrap">你的福利：<em class="weal_num">'+a.wealNum+"</em></span>"),n.push("</p>");var c=new $.dialog({html:n.join(""),showTitle:!0,title:"提示",draggable:!1,width:360,height:"auto",holderClassName:"weal_dialog_holder"});1==e&&c.bind("onclose",function(){$.tb.location.reload()})},_initBubble:function(){var e={content:"点击这里领取本吧福利，不要错过哦！",arrow_dir:"down",bubble_css:{top:-5,right:-4,width:220},arrow_pos:{left:160},attr:" id='platform_weal_bubble' ",wrap:$(".btn_getweal_wrap"),closeBtn:!0},a=this;"1"!=$.cookie("plat_weal_bubb_"+PageData.forum.forum_id)&&(this._bubble=new UiBubbleTipBase(e),this._bubble.showBubble(),this._bubble.bind("onclose",$.proxy(a._closeBubble,a)))},_closeBubble:function(){$.cookie("plat_weal_bubb_"+PageData.forum.forum_id,"1"),this._bubble&&this._bubble.closeBubble()}}});_.Module.define({path:"frs/widget/platform_attention_recommend",sub:{initial:function(t){try{$.stats.track("platform_like_dialog_show","platform_like_recommend"),this.tbs=PageData.tbs,this.uid=t.uid,this.frs_access=t.frs_access,this.is_forum_fourth_manager=t.is_forum_fourth_manager,this.avatar=t.avatar,this.is_forum_manage=0,this.getList()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:20}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:20}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:20")}},getList:function(){var t=this,e={forum_id:PageData.forum.forum_id,tbs:t.tbs},a="";$.post("/gcf/getpop",e,function(e){if(e&&0==e.no){var n=e.data.list.length,o=e.data.list;t.is_forum_manage=e.data.is_manage;for(var s=0;s<Math.min(n,9);s++){var i="<li class='att_list'><a href='/f?ie=utf-8&kw="+encodeURIComponent(o[s].forum_name)+"' target='_blank'><img src="+o[s].avatar+" width=60 height=60></a>",r="";1==o[s].is_official&&(r="<span class='att_v'></span>"),list_top=i+r+"<div class='att_abs'><a class='recommend_forum_name' href='/f?ie=utf-8&kw="+encodeURIComponent(o[s].forum_name)+"' target='_blank'><p class='att_name'>"+$.tb.subByte(o[s].forum_name,8)+"吧</p></a>";var m="";m=0==o[s].is_like?$.tb.format('<a href="#" data-fid="#{forum_id}" data-fname="#{forum_name}" class="att_btn att_btn_able j_recommend"></a>',{forum_id:o[s].forum_id,forum_name:o[s].forum_name}):$.tb.format('<a href="#" data-fid="#{forum_id}" data-fname="#{forum_name}" class="att_btn att_btn_disable"></a>',{forum_id:o[s].forum_id,forum_name:o[s].forum_name});var l="";l=list_top+m+"</div></li>",a+=l}t.renderList(a)}else{var c="抱歉，异常错误，建议刷新页面重试一下";t.showAlert(c)}},"json")},renderList:function(t){var e="";e=1==this.is_forum_manage?"<div class='title'><img class='title_img' src='"+this.avatar+"' width=60 height=60><div class='title_txt'>HI~"+PageData.forum.forum_name+"吧向大家推荐以下这些贴吧哦，大家也可以关注看看：</div></div>":"<div class='title'><img class='title_img' src='"+this.avatar+"' width=60 height=60><div class='title_txt'>HI~关注了我的吧友大部分还关注了这些吧哦，大家也可以关注他们：</div></div>";var a="<div class='content_wrapper content_view'><ul class='list_info'>"+t+"</ul></div>",n="";this.is_forum_fourth_manager&&(n="<div class='manage_txt'><a href='#' class='manage_forum j_manage'>管理本吧推荐</a></div>");var o="<div class='recommend_info'>"+e+a+n+"</div>",s={title:"关注本吧的吧友还关注",width:524},i=$.dialog.open(o,s);i.bind("onclose",function(){$.tb.location.reload()}),this.frs_access&&this.isManage(),this.initHandleEvents()},isManage:function(){$(".dialogJtxt").text("管理本吧推荐"),$(".content_wrapper").removeClass("content_view"),$(".att_list").append("<span class='att_close j_close'></span>"),$(".att_btn").removeClass("j_recommend").removeClass("att_btn_disable").addClass("att_btn_able"),$(".title").html("<div class='title_set'><p>本吧推荐的吧：</p><p class='set_notice'>设置后将会对关注本吧的新粉丝推荐这些贴吧。</p></div>"),$(".manage_txt").addClass("manage_set"),$(".manage_txt").html("<div class='add_info'><input class='input_text' type='text' placeholder='请输入正确的吧名'><a href='#' class='add_btn j_add'></a><span class='att_notice_info'>最多只能添加九个吧</span></div><div class='att_manage_btn'><a href='#' class='save_btn j_save'></a><a href='#' class='cancle_btn j_cancle'></a></div>"),1!=this.is_forum_manage&&$(".list_info").html(""),this.isNineForum()},isNineForum:function(){var t=$(".att_list").length;9==t&&($(".add_info").css("display","none"),$(".manage_set").css("height","49px"))},initHandleEvents:function(){var t=this;$(".content_wrapper").delegate(".j_close","click",function(t){try{$(this).parent().remove();var e=$(".att_list").length;9>e&&($(".add_info").css("display","block"),$(".manage_set").css("height","98px"))}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:117}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:117}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:117")}}),$(".j_manage").click(function(e){try{t.isManage()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:120}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:120}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:120")}}),$(".recommend_info").delegate(".j_add","click",function(e){try{""==$(".input_text").val()?t.showAlert("请输入正确的吧名"):t.checkForum()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:127}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:127}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:127")}}),$(".recommend_info").delegate(".j_recommend","click",function(e){try{var a=$(this).tbattr("data-fid"),n=$.tb.unescapeHTML($(this).tbattr("data-fname")),o={fid:a,fname:n,uid:t.uid,ie:"utf-8",tbs:t.tbs},s=$(this);$.post("/f/like/commit/add",o,function(e){if(e&&0==e.no)$.stats.track("platform_like_recommend","platform_like_recommend"),s.addClass("att_btn_disable").removeClass("att_btn_able").removeClass("j_recommend");else{var a="";a=8==e.no||9==e.no?"你在本吧被封禁，暂时不能进行操作":220==e.no?"你被吧主加入黑名单，暂时不能进行操作":221==e.no?"你已like了本吧,请不要重复操作":"抱歉，异常错误，建议刷新页面重试一下",t.showAlert(a)}},"json")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:152}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:152}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:152")}}),$(".recommend_info").delegate(".j_cancle","click",function(t){try{$.tb.location.reload(!0)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:155}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:155}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:155")}}),$(".recommend_info").delegate(".j_save","click",function(e){try{t.saveForumSet()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",method:"",ln:158}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_attention_recommend/platform_attention_recommend.js",linenum:158}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_attention_recommend/platform_attention_recommend.js","linenum:158")}})},checkForum:function(){var t=this,e=$(".input_text").val(),a=PageData.forum.forum_id;data={forum_id:a,forum_name:e,tbs:this.tbs},$.post("/gcf/getfinfo",data,function(e){if(e&&0==e.no){var a=new Array;if($(".att_btn").each(function(){var t=$(this).tbattr("data-fid");t>0&&a.push(parseInt(t))}),-1!=$.inArray(e.data.forum_id,a))t.showAlert("此吧已在推荐列表中");else if(e.data.forum_id==PageData.forum.forum_id)t.showAlert("请推荐除了本吧以外的吧哦");else{var n="";1==e.data.is_official&&(n="<span class='att_v'></span>");var o="<li class='att_list'><img src='"+e.data.avatar+"' width=60 height=60> "+n+"<div class='att_abs'><p class='att_name'>"+$.tb.subByte(e.data.forum_name,8)+"吧</p><a href='#' data-fid='"+e.data.forum_id+"' data-fname='"+e.data.forum_name+"' class='att_btn att_btn_able'></a></div><span class='att_close j_close'></span></li>";$(".list_info").append(o)}t.isNineForum()}else{var s="请输入正确的吧名";t.showAlert(s)}},"json"),$(".input_text").val("")},saveForumSet:function(){{var t=this,e=new Array,a=$(".att_btn");a.length}$(".att_btn").each(function(){var t=$(this).tbattr("data-fid");t>0&&e.push(parseInt(t))}),0==e.length&&e.push(0);var n={forum_id:PageData.forum.forum_id,forum_ids:e,tbs:t.tbs};$.post("/gcf/setpop",n,function(e){if(e&&0==e.no)t.showSuccess("保存成功"),$.tb.location.reload(!0);else{var a="提交未成功，请重新尝试";t.showAlert(a)}},"json")},showSuccess:function(t){var e='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+t+"</div>";$.dialog.open(e,{title:"操作成功",width:380})},showAlert:function(t){var e='<div style="padding:20px 20px; text-align:cente; line-height:20px;font-size:13px;">'+t+"</div>";$.dialog.open(e,{title:"操作失败",width:380})}}});_.Module.define({path:"frs/widget/PlatformHead",sub:{_forumHeadAddTpl:['<div class="forum_head_add_container">','<ul class="forum_head_add_ul clearfix">',"<li>",'<img src="#{background_pic}" data-upload="#{background_pic}" class="image_wrapper" d-class="background_pic" width="490" height="90">','<div class="accept_pic_size">980&times;180像素</div>','<div class="add_pic">上传背景图','<div class="upload_container"></div>',"</div>","</li>","<li>",'<img src="#{head_pic}" data-upload="#{head_pic}" class="image_wrapper" d-class="head_pic" width="90" height="90">','<div class="accept_pic_size">150&times;150像素</div>','<div class="add_pic">上传头像','<div class="upload_container"></div>',"</div>","</li>","</ul>",'<div class="forum_head_add_submit_area">','<a href="#" class="ui_btn ui_btn_s forum_head_add_submit"><span><em>确认提交</em></span></a>','<span class="forum_head_add_error_tips"></span>',"</div>","</div>"].join(""),initial:function(t){try{this.data=t,this.$dialogContent=null,this._bindEvents(),this.initLikeTips(),this.initModuleStat(),"特斯拉汽车"==PageData.forum.forum_name&&this.teslaHandler(),this.setForumRecommend()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_head/platform_head.js",method:"",ln:45}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_head/platform_head.js",linenum:45}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_head/platform_head.js","linenum:45")}},setForumRecommend:function(){var t=this;$(".j_fourth_manage").click(function(e){try{_.Module.use("frs/widget/platform_attention_recommend",[{tbs:t.data.tbs,uid:t.data.uid,frs_access:!0,is_forum_fourth_manager:t.data.is_forum_fourth_manager,avatar:t.data.avatar}])}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"frs:widget/platform_head/platform_head.js",method:"",ln:56}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_head/platform_head.js",linenum:56}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_head/platform_head.js","linenum:56")}})},_bindEvents:function(){{var t=$(".platform_top_edit_btn").on("click",$.proxy(this._initDialog,this));setTimeout(function(){var e=1,a=7,i=setInterval(function(){a>e?t.css("background-position","0px -"+20*e++ +"px"):clearInterval(i)},200)},300)}},_initDialog:function(t){t&&t.preventDefault();var e,a=this,i=$(".j_platform_banner").getData();this.$dialogContent=$($.tb.format(this._forumHeadAddTpl,i)),e=new $.dialog({html:this.$dialogContent,title:"申请更改头部图片",width:640}),e.element.addClass("platform_head_edit_dialog").on("click",".forum_head_add_submit",function(t){try{t&&t.preventDefault();var i={forum_id:a.data.fid,tbs:a.data.tbs,module_id:1,m1_bigPic:e.element.find("[d-class=background_pic]").tbattr("data-upload").unescapeHTML(),m1_portrait:e.element.find("[d-class=head_pic]").tbattr("data-upload").unescapeHTML()};$.tb.post("/gcf/commit?ie=utf-8",i,function(t){0==t.no?$.tb.alert({heading:"",width:300,message:"编辑成功,新提交的图片将在1个工作日内审核~",buttons:[{text:"知道了",callback:function(){e.close(),$.tb.location.reload()}}]}).element.find(".dialogJclose").bind("click",function(){try{e.close(),$.tb.location.reload()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/platform_head/platform_head.js",method:"",ln:115}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_head/platform_head.js",linenum:115}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_head/platform_head.js","linenum:115")}}):$.dialog.alert("添加失败")},"json")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"frs:widget/platform_head/platform_head.js",method:"",ln:120}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"frs:widget/platform_head/platform_head.js",linenum:120}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:frs:widget/platform_head/platform_head.js","linenum:120")}}).find(".upload_container").each(function(){a._loadUploader($(this))})},_loadUploader:function(t){var e=this;_.Module.use("common/widget/image_uploader_manager",[{container:t,width:t.width(),height:t.height(),isAutoUp:!0,isFlash:!0}],function(a){a.bind("onStartUpload",function(){e._showError("")}),a.bind("onComplete",function(a,i){var o=i.imageList[0].response;o&&0==o.error_code?e._resuletHandler(o.info,t.closest("li").find(".image_wrapper")):e._showError("图片上传失败")}),a.bind("onError",function(t,a){e._showError(a.errorMessage)})})},_resuletHandler:function(t,e){var a={background_pic:{width:980,height:180},head_pic:{width:150,height:150}},i=e.tbattr("d-class")||"head_pic",o=a[i].width,s=a[i].height,r=o/s,d=t.fullpic_width,n=t.fullpic_height,l="http://imgsrc.baidu.com/forum/pic/item/"+t.pic_id_encode+".jpg";d/n==r&&d>=o&&n>=s?(this._showError(""),e.tbattr("data-upload",l).tbattr("src",l)):d==o&&n==s?(this._showError(""),e.tbattr("data-upload",l).tbattr("src",l)):this._showError("请上传尺寸为 "+o+"&times;"+s+"px 的图片")},_showError:function(t){var e=this.$dialogContent.find(".forum_head_add_error_tips");e.html(t)},initLikeTips:function(){"#dolike"==$.tb.location.getHash()&&1!=PageData.user.is_like&&_.Module.use("ucenter/widget/Balv",[{}],function(t){if(t.user.balv&&1!=t.user.balv.is_liked){var e=$.tb.alert({heading:"欢迎来到"+t.forum.forum_name+"吧",message:"关注成为本吧会员，福利多多哦！",buttons:[{text:"立即关注",callback:function(e,a){t.dolike(),a.close()}},{text:"下次再说",callback:function(t,e){e.close()}}]}),a=$(e.getElement());a.find(".tb_alert_title").css("text-align","center"),a.find(".tb_alert_message").css("text-align","center"),a.find(".tb_alert_btn_group .ui_btn").css("margin-right",10).last().removeClass("ui_btn_m").addClass("ui_btn_sub_m").css("margin-right",0)}})},initModuleStat:function(){var t=$(".star_collect_time_axis_body"),e=$(".plat_forum_gallery"),a=$(".platforum_aside_images"),i=$(".platforum_aside_videos");t.length&&t.on("mousedown",".j_link",function(){$.stats.track("timeaxis","platform_module_stats")}),e.length&&e.on("mousedown","li a",function(){$.stats.track("gallery","platform_module_stats")}),a.length&&a.on("mousedown","a",function(){$.stats.track("images","platform_module_stats")}),i.length&&i.on("mousedown","a",function(){$.stats.track("video","platform_module_stats")})},teslaHandler:function(){var t="33629",e="/gcf/pv?forum_id="+PageData.forum.forum_id,a=$.cookie("userFirstExperience");$.getJSON(e,function(e){"0"==e.no&&(t=e.data.length<6?"0"+e.data:e.data),_.Module.use("common/widget/RollNumber",[{numberString:t,dom:$(".tesla_pv_container")}])}),a||($.cookie("userFirstExperience",1,{expires:3650}),$("#tesla_iframe").tbattr("src","/tb/static-frs/swf/tesla/tour_tieba.html"))}}});