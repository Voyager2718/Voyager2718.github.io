_.Module.define({path:"pb/widget/Repost",sub:{initial:function(e,t){try{var s=this;this.like_list=e,this.is_overflow=t,this.user=PageData.user,this.can_submit=!0,$(".j_repost_btn").on("click",function(){try{var e=$(this).getData();return s.j_repost_btn_click=$(this),s.tid=e.tid,s.title=$(this).tbattr("data-title"),s.original_forum_id=e.fid,s.showDialog(),!1}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/repost/repost.js",method:"",ln:24}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:24}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:24")}}),$(".j_forum_link").on("mousedown",function(){({st_mod:"repost_forum",st_type:"enterba",st_from:PageData.product,st_uid:PageData.user.user_id,st_benba:encodeURIComponent(PageData.forum.forum_name),st_goto:encodeURIComponent($(this).text())})})}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/repost/repost.js",method:"",ln:36}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:36}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:36")}},resizePic:function(){this.j_pb_repost=$("#j_pb_repost"),this.j_pb_repost_content=this.j_pb_repost.find(".j_repost_content"),$("#j_pb_repost img").one("load",function(){$.resizePic($(this),500,9999)})},initScrollPanel:function(){var e=this;$.JsLoadManager.use("http://tieba.baidu.com/tb/static-common/lib/jquery-ui-1.10.0.draggable.min.js",function(){_.Module.use("common/widget/ScrollPanel",{container:"#j_pb_repost_detail",height:352,_scrollStep:120,content:""},function(t){e.scrollPanel=t,t.setContent(e.j_pb_repost_content[0])})})},initPager:function(){var e=this,t=this.j_pb_repost.find(".j_repost_btn"),s=t.getData()&&t.getData().tid;if(s){var a=this.j_pb_repost.find(".repost_pager"),o=a.getData().total_page;_.Module.use("common/component/JsPager",{container:a,current:1,amount:8,total:o},function(t){t.bind("pageChange",function(a,o){var i="/p/repost";$.ajax({url:i,type:"post",data:{t_id:s,pn:o},dataType:"json"}).done(function(s){if(0===s.no){for(var a='<ul class="repost_content j_repost_content">',i="",r=0;r<s.data.content_list.length;r++)i=s.data.content_list[r],a+=0===r?'<li class="repost_floor repost_floor_first clearfix">':'<li class="repost_floor clearfix">',a+=i.content,a+='<span class="floor_num">'+i.floor+"楼</span></li>";a+="</ul>",e.scrollPanel.setContent(a),$("#j_pb_repost img").one("load",function(){$.resizePic($(this),500,9999)}),t.initial({current:o})}})})})}},showDialog:function(){if(this.isLogin()){var e;PageData.user_forumlist.info?(this.initData(PageData.user_forumlist.info),0===this.like_forums_names.length?(e="亲，目前只能转发到你关注的吧哦，请先去“关注”你要转发到的吧。",this.showErrDialog(e)):1==this.like_forums_names.length&&this.like_forums_names[0]==PageData.forum.forum_name?(e="亲，只能转发到本吧之外你关注过的吧哦，请先去“关注”你要转发到的吧。",this.showErrDialog(e)):this.showRepostDialog()):(e="亲，目前只能转发到你关注的吧哦，请先去“关注”你要转发到的吧。",this.showErrDialog(e))}},initData:function(e){this.like_forums_names=[],this.can_post_forums=[];var t={},s=null;if(this.like_list)for(var a=0;a<this.like_list.length;a++)s=this.like_list[a],s.id=s.id,s.forum_name=$.tb.unescapeHTML(s.forum_name.replace(/\s/g," ")),this.like_forums_names.push(s.forum_name),this.can_post_forums.push(s.forum_name),t[s.forum_name]=s;else for(var a=0;a<e.length;a++)s=e[a],s.is_like&&(this.like_forums_names.push(s.forum_name),this.can_post_forums.push(s.forum_name),t[s.forum_name]=s);this.like_forums=t},showErrDialog:function(e){new $.dialog({html:'<span class="repost_err_dlg">'+e+"</span>",title:"转发提示",showShadow:!0,width:420})},showRepostDialog:function(){var e=this;this.dlg?(this.dlg.show(),this.dlg.setContent(this.getRepostHtml())):this.dlg=new $.dialog({html:e.getRepostHtml(),title:"转发",showShadow:!0,width:420,hideOnclose:!1}),this.getElement(),this.bindEvent()},getRepostHtml:function(){var e=['<div class="repost_dialog" id="j_repost_dialog">','<div class="repost_item repost_item_title ui-front clearfix">','<label for="j_repost_title" class="repost_label">贴子：</label><span class="repost_title">'+$.tb.subByte(PageData.thread.title,36)+"</span>","</div>",'<div class="repost_item repost_item_fname j_forum_name_wrap ui-front clearfix">','<label for="j_forum_name" class="repost_label">转发到：</label><input type="text" class="ui_textfield repost_text_fname" id="j_forum_name">',"</div>",'<div class="like_forums j_like_forums clearfix">'].join(""),t=[];for(var s in this.like_forums)if(this.like_forums[s].id!=this.original_forum_id&&this.like_forums[s].forum_name!=PageData.forum.forum_name){var a={id:this.like_forums[s].id,forum_name:this.like_forums[s].forum_name};t.push('<a href="javascript:void(0)" title="'+this.like_forums[s].forum_name+'" '+$.tb.dataField(a)+' class="like_forums_item j_like_forum_item"><span>'+this.like_forums[s].forum_name+"吧</span></a>")}t=t.join("");var o=["</div>",'<div class="repost_item repost_item_reason j_reason_wrap">','<label for="j_reason" class="repost_label">理由：</label><textarea class="ui_textfield repost_text_reason" id="j_reason"></textarea>',"</div>",'<a href="javascript:void(0)" class="ui_btn ui_btn_m" id="j_submit">',"<span><em>转 发</em></span>","</a>","</div>"].join("");return e+t+o},getElement:function(){var e=this.j_repost_dlg=$("#j_repost_dialog");this.j_dlg_content=e.parents(".dialogJcontent"),this.j_like_forums=e.find(".j_like_forums"),this.j_forum_name_wrap=e.find(".j_forum_name_wrap"),this.j_forum_name=e.find("#j_forum_name"),this.j_reason=e.find("#j_reason"),this.j_submit=e.find("#j_submit")},bindEvent:function(){var e=this;$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-common/js/jquery-ui-autocomplete.min.js",function(){e.j_forum_name.autocomplete({source:e.can_post_forums,minLength:0}),e.j_forum_name.bind("click",function(){try{$(this).autocomplete("search","")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/repost/repost.js",method:"",ln:246}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:246}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:246")}})}),this.bindPlaceholderEvent(),this.bindWordLimitEvent(),this.bindLikedForumsClickEvent(),this.bindSubmitEvent()},bindPlaceholderEvent:function(){_.Module.use("common/widget/Placeholder",["#j_forum_name","请选择你要转发到的吧"],function(){}),_.Module.use("common/widget/Placeholder",["#j_reason","这个活动很给力，小伙伴们不要错过哦！"],function(){})},bindWordLimitEvent:function(){var e=this,t={container:".j_reason_wrap",inputObj:"#j_reason",showLimit:280,maxNum:280,numStyle:{color:"red"}};_.Module.use("common/widget/WordLimit",[t],function(t){e.word_limit_instance=t,t.init()})},bindLikedForumsClickEvent:function(){var e,t=this;this.j_like_forums.delegate(".j_like_forum_item","click",function(){try{return e=$(this).getData(),t.j_forum_name.val(e.forum_name.replace(/\s/g," ")).trigger("change"),t.j_forum_name_wrap.find("a").remove(),t.j_forum_name_wrap.append($(this).clone()),t.j_like_forums.find("a").removeClass("disabled"),$(this).addClass("disabled"),t.j_forum_name.addClass("disabled").autocomplete({disabled:!0}),!1}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"pb:widget/repost/repost.js",method:"",ln:289}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:289}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:289")}}),this.j_forum_name_wrap.delegate(".j_like_forum_item","click",function(){try{return title=$(this).tbattr("title"),t.j_forum_name.val("").trigger("change"),t.j_like_forums.find('a[title="'+title.replace(/\s/g," ")+'"]').removeClass("disabled"),$(this).remove(),t.j_forum_name.removeClass("disabled").autocomplete({disabled:!1}),!1}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/repost/repost.js",method:"",ln:297}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:297}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:297")}})},bindSubmitEvent:function(){var e=this;this.j_submit.bind("click",function(){try{return e.isLogin&&(e.checkInputs(),e.can_submit&&e.initPostData()),!1}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/repost/repost.js",method:"",ln:309}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/repost/repost.js",linenum:309}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/repost/repost.js","linenum:309")}})},checkInputs:function(){var e=this,t=this.j_forum_name.val();return""===t?(this.can_submit=!1,this.msgDialog("FNAME IS NULL"),!1):($.get("/f/commit/share/fnameShareApi",{ie:"utf-8",fname:t.replace(/\s/g," ")},function(t){return t&&0!==t.no?(e.can_submit=!1,e.msgDialog("FNAME NOT EXSIT"),!1):void 0},"json"),-1!==$.inArray(t,this.like_forums_names)||this.is_overflow?e.word_limit_instance.exceed?(this.can_submit=!1,!1):(this.can_submit=!0,!0):(this.can_submit=!1,this.msgDialog("NOT LIKE"),!1))},initPostData:function(){var e=this,t=this.j_forum_name.val();this.target_fid=this.like_forums[t].id,this.repost_reason=this.j_reason.val()||"这个活动很给力，小伙伴们不要错过哦！",this.post_obj={ptid:e.tid,title:e.title,ftid:e.target_fid,content:e.repost_reason,ie:"utf-8",tbs:PageData.tbs,new_vcode:1,tag:11},this.postData()},showCaptchaDialog:function(e){var t=this,s=e.data.vcode.str_reason,a=e.data.vcode.thread_content;s=s.replace(/发贴/g,"转贴"),_.Module.use("common/component/CaptchaDialog",{title:"转发",message:s,vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:t.target_fid,postType:"thread",paramsCallback:function(){var e={title:t.title,content:t.repost_reason};return $.extend(e,a)}},function(e){t.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){t.post_obj.vcode=e.getInputValue(),t.post_obj.vcode_md5=e.getVCode(),t.postData()}),e.show()})},postData:function(){var e=this,t="/relay/commit";$.ajax({url:t,type:"post",data:e.post_obj,dataType:"json"}).done(function(t){if(0===t.no){e.showSuccess(t.new_thread_id,t.new_post_id);var s=e.j_repost_btn_click.closest(".j_repost_btn_wrap").find(".j_repost_count"),a=s.text();"(+1)"==a&&(a="0"),a=a.replace(/\d+/,function(e){return e=parseInt(e)+1,e+""}),s.text(a),setTimeout(function(){$.tb.location.reload()},200)}else 40===t.no?e.captchaDialog?(e.captchaDialog.setTip(t.data.vcode.str_reason),e.captchaDialog.updateCaptchaImg(t.data.vcode.captcha_vcode_str,t.data.vcode.captcha_code_type),e.captchaDialog.show(),e.captchaDialog.focus()):e.showCaptchaDialog(t):e.msgDialog(t.no)}).fail(function(){e.msgDialog("POST ERROR")})},isLogin:function(){return this.user.is_login?this.user.no_un?(TbCom.process("User","buildUnameFrame"),!1):!0:(_.Module.use("common/widget/LoginDialog",["","userBar"]),!1)},showSuccess:function(e,t){var s=this,a=(this.j_repost_dlg.parent().height(),"/p/"+e+(t?"?pid="+t+"#"+t:"")),o=['<div class="editor_tip_show j_repost_msg editor_tip_show_repost" style="top: 120px; left: 135px;">','<div class="editor_banned_tip_info">','<span style="display:block;height:17px;line-height:17px;font-weight:bold;"><img style="float:left;margin-right:4px;" src="http://static.tieba.baidu.com/tb/static-pb/img/success.gif" alt="ok"/>转发成功！</span>','<a class="repost_link" target="_blank" href="'+a+'">查看转贴</a>',"</div>","</div>"].join("");this.j_dlg_content.addClass("gray_wrap"),this.j_repost_dlg.append(o),setTimeout(function(){s.j_dlg_content.removeClass("gray_wrap"),s.j_repost_dlg.find(".j_repost_msg").remove(),s.dlg.hide()},3e3)},msgDialog:function(e){var t,s=this;switch(e){case"FNAME IS NULL":t="请选择要转发的吧";break;case"NOT LIKE":t="只能转发到你关注过的吧";break;case"FNAME NOT EXSIT":t="该吧不存在，请重新输入";break;case"POST ERROR":t="系统错误，请稍后重试";break;case 3001:t="用户名不存在";break;case 3002:t="不能转发到原贴所在的吧";break;case 3003:t="用户id不存在";break;case 3004:t="转发理由不能超过140个汉字";break;case 3005:case 3006:t="该贴吧不存在";break;case 3007:t="系统错误，请稍后重试";break;case 3008:t="原贴已被删除";break;case 3009:t="只有普通贴才可以转发";break;case 3011:t="没有有效like的吧";break;case 10:t="贴子内容包含太少的文字";break;case 11:t="贴子标题和内容太长";break;case 12:t="操作失败，您的账号因违规操作而被封禁&nbsp;&nbsp;<a href='/pmc/main?fid="+this.target_fid+'\' target="_blank">查看封禁信息</a>';break;case 13:t="您的网络地址由于非法操作被封";break;case 14:t="您发布的贴子已经存在";break;case 501:case 15:t="请不要发表含有不适当内容的留言<br>请不要发表广告贴";break;case 20:t="您发表的贴子的标题或正文包含太少的文字，请修改后再发表";break;case 17:t="本吧当前只能浏览，不能发贴！";break;case 9:case 22:t="您发表的贴子已经成功提交，但系统需要核实该贴子内容是否含有不良信息，贴子在审核通过后才能显示，请您耐心等待";break;case 33:t="您发贴太快了:) 请稍后再发";break;case 34:t="您说话太快了:) 请先停下来喝杯茶吧，或者可以去别的吧看看哦，一定会发现还有您感兴趣的话题";break;case 36:t="请不要发广告贴！";break;case 37:t="您已尝试提交多次了，请返回后刷新页面，方可重新发贴";break;case 38:t="验证码超时，请重新输入";break;case 39:t="由于您多次输错验证码，请您返回后刷新页面，方可重新发贴";break;case 41:t="您的贴子可能包含不合适的内容，请您确定后再提交";break;case 42:t="您的发贴行为被系统认为有发广告嫌疑，请您稍后再发";break;case 43:t="您的发贴行为或贴子内容有广告或不合适的特征，请您确定后再发送";break;case 44:t="对不起，本吧暂时限制部分用户发表主题贴子，您可以浏览或回复本吧其它内容，给您带来不便希望得到您的谅解。";break;case 100:t="对不起，本吧暂时限制部分用户使用完整的贴吧功能，您可以浏览本吧其它内容，给您带来不便希望得到您的谅解。";break;case 308:t="用户权限不足";break;case 701:case 901:t="为了减少恶意灌水和广告贴，本吧不允许未登录用户发贴，登录用户不受影响，给您带来的不便深表歉意";break;case 702:case 902:t="为了减少恶意灌水和广告贴，本吧限制部分用户发贴，给您带来的不便深表歉意";break;case 703:case 903:t="为了减少恶意灌水和广告贴，本吧被设置为仅本吧会员才能发贴，给您带来的不便深表歉意。<a href='/' target=_blank>点此申请加入</a>本吧会员";break;case 704:case 904:t="为了减少恶意灌水和广告贴，本吧被设置为仅本吧管理团队才能发贴，给您带来的不便深表歉意";break;case 705:case 905:t="本吧当前只能浏览，不能发贴！";break;case 45:t="抱歉，您提交的贴吧名称含特殊字符，目前无法创建，推荐您使用汉字、字母或数字作为贴吧名称";break;case 900:t="为抵御挖坟危害，本吧吧主已放出贴吧神兽--超级静止蛙，本贴暂时无法回复。";break;case 4010:t="您的账号存在安全风险暂不能转贴，请先进行手机绑定后再转贴吧。";break;case 3013:t="暂不支持转发到该吧，请换一个吧试试。";break;case 49992:t="您的操作太频繁，请稍候再试";break;default:t="发生未知错误"}var a,o=175-t.length%19*6;a=['<div class="editor_tip_show j_repost_msg" style="top: 120px; left: '+o+'px;">','<div class="editor_banned_tip_info">','<span style="font-weight:bold;">'+t+"</span>","</div>","</div>"].join(""),this.j_dlg_content.addClass("gray_wrap"),this.j_repost_dlg.append(a),setTimeout(function(){s.j_dlg_content.removeClass("gray_wrap"),s.j_repost_dlg.find(".j_repost_msg").remove()},1500)}}});_.Module.define({path:"common/component/SlideShow",sub:{defaultOptions:{delayLoadPic:false,effect:"slide",activeClass:"tbui_slideshow_active",baseZIndex:0,interval:5000,slide:{speed:500},fade:{speed:500},triggerHandler:"click"},initial:function(b){b=$.extend({},this.defaultOptions,b);var a=this;this.options=b;this.animating=false;this.current=0;this.vendorPrefix=false;this.$nav=$(b.nav);this.$navItem=this.$nav.children();this.total=this.$navItem.size()||b.total;this.$container=$(b.target);this.$list=this.$container.children(".tbui_slideshow_list");this.$tokens=this.$list.children();if(!b.width){b.width=this.$container.width()}if(!b.height){b.height=this.$container.height()}this.$container.add(this.$list).css({width:b.width,height:b.height});this.interval=b.interval||5000;this.picLoadedIndex={};this.$navItem.first().addClass(b.activeClass);this.$tokens.first().show();this.showOriPic(0);if(b.triggerHandler=="click"){this.$navItem.click(function(){var c=this;if(b.auto){a.stop()}this.delayHandler=setTimeout(function(){a.delayHandler=null;a.setActive($(c).index())},10)}).bind("mouseout",function(){if(b.auto){a.play()}if(this.delayHandler){clearTimeout(this.delayHandler)}})}else{if(b.triggerHandler=="hover"){this.$navItem.hover(function(){var c=this;if(b.auto){a.stop()}this.delayHandler=setTimeout(function(){a.delayHandler=null;a.setActive($(c).index())},200)},function(){if(b.auto){a.play()}if(this.delayHandler){clearTimeout(this.delayHandler)}})}}this.effectHandler=this["_"+b.effect];if(b.auto){this.play();this.$list.hover(function(){a.stop()},function(){a.play()})}if(b.next){$(b.next).click(function(c){c.preventDefault();c.stopPropagation();a.next()})}if(b.prev){$(b.prev).click(function(c){c.preventDefault();c.stopPropagation();a.prev()})}},setActive:function(a){if(!this.animating&&a!==this.current){this.$navItem.removeClass(this.options.activeClass).eq(a).addClass(this.options.activeClass);this.effectHandler(a);this.showOriPic(a);return true}else{return false}},next:function(){var a=this.current+1;if(a==this.total){a=0}this.setActive(a)},prev:function(){var a=this.current-1;if(a==-1){a=this.total-1}this.setActive(a)},play:function(){var a=this;if(this.autoHandler==null){this.autoHandler=setInterval(function(){a.next()},this.options.interval)}},showOriPic:function(c){if(this.options.delayLoadPic&&!this.picLoadedIndex["_"+c]){var f=this.$tokens.eq(c).find("img"),b,a=f.length;for(var d=0;d<a;d++){b=$(f[d]);var e=b.tbattr("orisrc");if(e){b.tbattr("src",e)}}this.picLoadedIndex["_"+c]=1}},stop:function(){clearInterval(this.autoHandler);this.autoHandler=null},_slide:function(f){var d,g,b,c,e,a,h;var i=this;this.animating=true;d=this.current;h=f>d?1:-1;g=f>d?-this.options.width:this.options.width;c=f;this.$tokens.eq(d).siblings().css({display:"none",left:0,zIndex:0+this.options.baseZIndex});this.$tokens.eq(c).css({display:"block",left:h*this.options.width,zIndex:10+this.options.baseZIndex});if(this.vendorPrefix){e=this.vendorPrefix;a=e+"Transform";b=e+"TransitionDuration";this.$list[0].style[a]="translateX("+g+"px)";this.$list[0].style[b]=this.options.slide.speed+"ms";this.$list.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){i.$list[0].style[a]="";i.$list[0].style[b]="";i.$tokens.eq(c).css({left:0});i.$tokens.eq(d).css({display:"none",left:0,zIndex:0});i.animating=false;i.current=c;i.$list.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd");i.trigger("animateEnd")})}else{i.$list.stop().animate({left:g},this.options.slide.speed,function(){i.$list.css({left:0});i.$tokens.eq(c).css({left:0});i.$tokens.eq(d).css({display:"none",left:0,zIndex:0});i.current=c;i.animating=false;i.trigger("animateEnd")})}},_fade:function(c){var a=this;var d,b;this.animating=true;d=this.current;b=c;this.$tokens.eq(b).css({display:"none",left:0,zIndex:10+this.options.baseZIndex});this.$tokens.eq(d).stop().fadeOut(this.options.fade.speed);this.$tokens.eq(b).stop().fadeIn(this.options.fade.speed,(function(){a.$tokens.eq(b).css({zIndex:0+a.options.baseZIndex});a.animating=false;a.current=b}))},_getVendorPrefix:function(){var a,b,c,d,e;a=document.body||document.documentElement;c=a.style;d="Transition";e=["Moz","Webkit","Khtml","O","ms"];b=0;while(b<e.length){if(typeof c[e[b]+d]==="string"){return e[b]}b++}return false}}});_.Module.define({path:"frs/widget/pic_sliding_window",sub:{_windowWidth:0,_jq_picsWrap:null,_jq_pics:null,_speed:"fast",_easing:"swing",initial:function(i){try{this._windowWidth=i.windowWidth,this._jq_pics=i.jq_pics,this._jq_picsWrap=i.jq_picsWrap,this._speed=i.speed||this._speed,this._easing=i.easing||this._easing}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"frs:widget/pic_sliding_window/pic_sliding_window.js",method:"",ln:15}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"frs:widget/pic_sliding_window/pic_sliding_window.js",linenum:15}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:frs:widget/pic_sliding_window/pic_sliding_window.js","linenum:15")}},slideNext:function(){for(var i=this._jq_picsWrap.position(),s=i.left,t=-s+this._windowWidth,e=0,_=0,n=!1,d=this._jq_pics.size(),p=0;d>p;p++){var o=$(this._jq_pics.get(p)),h=o.position(),a=h.left,r=o.width(),c=a+r;if(c>t){e=p,_=a;break}}this._windowWidth+_>this._jq_picsWrap.width()&&(_=this._jq_picsWrap.width()-this._windowWidth,n=!0),_>0&&(this._jq_picsWrap.animate({left:-_+"px"},this._speend,this._easing),n&&this.trigger("lastend"))},slidePrev:function(){for(var i=this._jq_picsWrap.position(),s=i.left,t=-s,e=0,_=-1,n=!1,d=this._jq_pics.size(),p=0;d>p;p++){var o=$(this._jq_pics.get(p)),h=o.position(),a=o.width(),r=h.left,c=r+a;if(r>=t){t=c-this._windowWidth,0>t&&(t=0),e=p;break}}for(var p=e;p>=0;p--){var o=$(this._jq_pics.get(p)),h=o.position(),a=o.width(),r=h.left,c=r+a;if(t>=r||0==p){e=p,_=r;break}}n=0==_,_>=0&&(this._jq_picsWrap.animate({left:-_+"px"},this._speend,this._easing),n&&this.trigger("firstend"))}}});_.Module.define({path:"pb/widget/meizhi_slide_window",requires:["common/component/SlideShow","frs/widget/pic_sliding_window"],sub:{_slideBigPic:null,_slideConfig:{nav:"#meizhi_img_pager",target:"#meizhi_slide_wrap",activeClass:"active",slide:{speed:200},fade:{speed:200},width:498,height:375,auto:!1},_animating:!1,initial:function(){try{this.getEle(),this._slideBigPic=this.use("common/component/SlideShow",this._slideConfig),this._slideSmallPic=this.use("frs/widget/pic_sliding_window",{windowWidth:510,jq_pics:this._imgPager.find("li"),jq_picsWrap:this._imgPager}),this.controlSmallBtn(0),this.controlBigBtn(),this.bindEvent(),this.addBubble()}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",method:"",ln:41}),$.se({msg:(i.message||i.description).replace(/\s+/g,"-"),locator:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",linenum:41}),console.log("errormsg:"+(i.message||i.description).replace(/\s+/g,"-"),"locator:pb:widget/meizhi_slide_window/meizhi_slide_window.js","linenum:41")}},getEle:function(){this._wrap=$("#meizhi_pb"),this._slideWrap=$("#meizhi_slide_wrap"),this._imgList=this._slideWrap.find(".meizhi_img_list"),this._bigPicPreBtn=this._slideWrap.find(".j_display_pre"),this._bigPicNextBtn=this._slideWrap.find(".j_display_next"),this._imgPager=$("#meizhi_img_pager"),this._smallPicPreBtn=this._wrap.find(".smallpic_display_pre"),this._smallPicNextBtn=this._wrap.find(".smallpic_display_next"),this._imgPagerCount=this._imgPager.find("li").length},addBubble:function(){var i="1"==$.cookie("meizhiHutouBubble");if(!i){var e=new UiBubbleTipBase({content:"已发起过妹纸认证，不能投妹纸票咯~",arrow_dir:"down",bubble_css:{top:4,left:-40,width:220},arrow_pos:{left:56},wrap:$(".anti_votemeizhi"),closeBtn:!0});e.j_bubble.css({"font-size":"12px","line-height":"18px"}),e.bind("onclose",function(){$.cookie("meizhiHutouBubble","1",{expires:365,path:"/"}),e.hideBubble()}),e.showBubble()}},bindEvent:function(){var i=this;this._bigPicPreBtn.click(function(){try{i._slideBigPic.prev(),i.controlActivPager("pre")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",method:"",ln:86}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",linenum:86}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/meizhi_slide_window/meizhi_slide_window.js","linenum:86")}}),this._bigPicNextBtn.click(function(){try{i._slideBigPic.next(),i.controlActivPager("next")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",method:"",ln:90}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",linenum:90}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/meizhi_slide_window/meizhi_slide_window.js","linenum:90")}}),this._smallPicPreBtn.click(function(){try{i._slideSmallPic.slidePrev(),i._smallPicNextBtn.show()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",method:"",ln:94}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",linenum:94}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/meizhi_slide_window/meizhi_slide_window.js","linenum:94")}}),this._smallPicNextBtn.click(function(){try{i._slideSmallPic.slideNext(),i._smallPicPreBtn.show()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",method:"",ln:98}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/meizhi_slide_window/meizhi_slide_window.js",linenum:98}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/meizhi_slide_window/meizhi_slide_window.js","linenum:98")}}),this._slideSmallPic.bind("firstend",function(){i._smallPicPreBtn.hide()}),this._slideSmallPic.bind("lastend",function(){i._smallPicNextBtn.hide()}),this._slideBigPic.bind("animateEnd",function(){i._animating||i.keepSmallPicVisible()})},keepSmallPicVisible:function(){var i=this,e=this._imgPager.find(".active"),t=e.position().left,s=this._imgPager.position().left,n=-1*s,l=-1*s+510-102;n>t?s-=t-n:t>l&&(s-=t-l),this._animating=!0,this._imgPager.animate({left:s+"px"},function(){i._animating=!1})},controlActivPager:function(i){var e=this,t=this._imgPager.find(".active"),s=t.position().left,n=this._imgPager.position().left;if(!(s>=-1*n&&-1*n+510-102>=s)){var l=-1*(102*this._imgPagerCount-510);"pre"==i?(n+=102,n>=102?n=l:n>0&&(n=0)):"next"==i&&(n-=102,l-102>=n?n=0:l>n&&(n=l)),this._animating=!0,this._imgPager.animate({left:n+"px"},function(){e._animating=!1}),this.controlSmallBtn(n)}},controlSmallBtn:function(i){0>i?this._smallPicPreBtn.show():this._smallPicPreBtn.hide(),i+this._imgPager.width()-510>0?this._smallPicNextBtn.show():this._smallPicNextBtn.hide()},controlBigBtn:function(){var i=this._imgList.find("li").length;1==i&&(this._bigPicPreBtn.hide(),this._bigPicNextBtn.hide())}}});_.Module.define({path:"pb/widget/platforum_activity_thread",requires:["common/component/SlideShow"],sub:{dialog:null,initial:function(t){try{this.option=t,this.option.user=PageData.user,this.lotteryData={tbs:this.option.tbs,activity_id:this.option.activity_id,forum_id:this.option.forum_id,thread_id:this.option.thread_id},this.initRoundAbout(),this.initWinners(),this.bindEvents(),this.gameBalance=this.option.rule[5]&&this.option.rule[5].chance_num>0}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:24}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:24}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:24")}},roundAbout:function(t,a){function e(a,e){i.animating=!0,setTimeout(function(){i.animating=!1},600),fixTimes=a+c,t.children("li").each(function(){var t=$(this),a=parseInt($(this).tbattr("data-idx"));idx=Math.abs((a+fixTimes)%c),$(this).tbattr("data-idx",idx);var i=$(this).data("data-showed")?600:300;subPositions[idx]?($(this).css("z-index",subPositions[idx].zIndex),$(this).css("position","absolute").animate(subPositions[idx],{duration:i,easing:"swing",complete:function(){t.css("border","2px solid #fff")}}),$(this).children("img").animate({width:subPositions[idx].width,height:subPositions[idx].height},{duration:i,easing:"swing"}),$(this).removeClass("act_award_hide").data("data-showed",!0).addClass(subMaskOpacityClass[idx]),subMaskOpacityClass[idx]!==subMaskOpacityClass[a]&&subMaskOpacityClass[a]&&$(this).removeClass(subMaskOpacityClass[a]),2==idx?$(this).addClass("roundabout-in-focus"):$(this).removeClass("roundabout-in-focus"),e()):$(this).data("data-showed")&&($(this).data("data-showed",!1).hide(),$(this).tbattr("style","").addClass("act_award_hide"),subMaskOpacityClass[a]&&$(this).removeClass(subMaskOpacityClass[a]))})}var i=this,s=t.parent().width(),o=224,n=t.children("li").eq(0).width(),r=t.children("li").eq(0).height(),l=.8,c=t.children("li").length;subMaskOpacityClass=["opacity_low","opacity_middle","opacity_high","opacity_middle","opacity_low"],subPositions=[{width:n*l*l,height:r*l*l,top:(o-r*l*l)/2,left:0,zIndex:100},{width:n*l,height:r*l,top:(o-r*l)/2,left:(s-n)/4,zIndex:200},{width:n,height:r,top:(o-r)/2,left:(s-n)/2,zIndex:300},{width:n*l,height:r*l,top:(o-r*l)/2,left:s-((s-n)/4+n*l),zIndex:200},{width:n*l*l,height:r*l*l,top:(o-r*l*l)/2,left:s-n*l*l-3,zIndex:100}],t.children("li").each(function(t){$(this).css("position","absolute"),subPositions[t]?($(this).addClass(subMaskOpacityClass[t]),$(this).css(subPositions[t]).data("data-showed",!0)):($(this).data("data-showed",!1),$(this).addClass("act_award_hide")),2==t&&$(this).addClass("roundabout-in-focus"),$(this).tbattr("data-idx",t)}),a(),t.on("click","li",function(){try{if(i.animating)return;if($(this).data("data-showed")){var t=parseInt($(this).tbattr("data-idx"));if(2==t)return;e(2-t,a)}}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:92}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:92}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:92")}}),$(".j_act_awards_prev").on("click",function(){try{if(i.animating)return;e(1,a)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:96}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:96}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:96")}}),$(".j_act_awards_next").on("click",function(){try{if(i.animating)return;e(-1,a)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:100}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:100}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:100")}})},initRoundAbout:function(){var t=function(){$(".j_act_awards_li").each(function(){$(this).find(".act_awards_modal, .act_awards_word").css($(this).hasClass("roundabout-in-focus")?{top:"185"}:{top:"220"})})};this.roundAbout($(".j_act_awards"),t),$(".j_act_awards_li").mouseenter(function(){$(this);$(this).hasClass("roundabout-in-focus")&&$(this).find(".act_awards_modal, .act_awards_word").animate({top:"0","padding-top":"20"})}).mouseleave(function(){$(this);$(this).hasClass("roundabout-in-focus")&&$(this).find(".act_awards_modal, .act_awards_word").animate({top:"185","padding-top":"0"})})},initWinners:function(){var t=$(".j_act_winners"),a=function(){t.animate({top:"-=24"},1e3,function(){t.css("top","0").find("li:first").appendTo(t),setTimeout(a,2500)})};t.children().length>2&&a()},seeRule:function(t){var a=this;t&&t.preventDefault();var e=this.option.rule,i="",s="";void 0!=e[0]&&0!=e[0].chance_num&&(i="<p class='act_rule_p'>活动初始：</p><p class='act_rule_p_indent' style='margin-bottom:20px;'>关注本吧后，每人可获得"+e[0].chance_num+"次抽奖机会</p>"),void 0!=e[1]&&0!=e[1].chance_num&&(s+="<li class='act_rule_p_indent'>每日在本吧进行签到，可获得"+e[1].chance_num+"次抽奖机会</li>"),void 0!=e[2]&&0!=e[2].chance_num&&(s+="<li class='act_rule_p_indent'>每次回复本贴，可获得"+e[2].chance_num+"次抽奖机会</li>"),void 0!=e[5]&&0!=e[5].chance_num&&(s+="<li class='act_rule_p_indent'>给游戏充值100元，即可获得"+e[5].chance_num+"次抽奖机会。<a href='#' class='j_pay_trigger'>立即充值</a></li>"),void 0!=e[3]&&0!=e[3].chance_num&&(s+="<li class='act_rule_p_indent'>每个活动每人每天的抽奖次数获得上限为"+e[3].chance_num+"次</li>"),void 0!=e[4]&&0!=e[4].chance_num&&(s+="<li class='act_rule_p_indent'>转发本活动到你关注的吧，即可获得"+e[4].chance_num+"次抽奖机会。<a href='#' class='j_repost_trigger'>立即转发</a></li>"),""!=s&&(i+="<p class='act_rule_p'>如何增加抽奖机会：</p>"+s),this.dialog&&this.dialog.close(),this.dialog=new $.dialog({title:"抽奖规则",html:'<ul class="act_rule_ul">'+i+"</ul>",width:420}),this.dialog.element.on("click",".j_repost_trigger",function(t){try{t.preventDefault(),a.dialog.close(),$(".j_repost_btn").trigger("click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:214}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:214}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:214")}}),this.dialog.element.on("click",".j_pay_trigger",function(t){try{window.open("http://wanba.baidu.com/reg_order.xhtml"),a.dialog.close(),t.preventDefault()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:219}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:219}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:219")}})},seeMyawards:function(t){t&&t.preventDefault();var a=this,e=$("#act_myaward_tpl").html();this.dialog&&this.dialog.close(),this.dialog=new $.dialog({title:"我的奖品",html:e,width:420}),this.dialog.element.on("click",".j_fillProfile",function(t){try{t.preventDefault(),a.showProfileDialog($(this).closest("tr").getData())}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:234}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:234}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:234")}})},bindEvents:function(){$(".j_seerule").on("click",$.proxy(this.seeRule,this)),$(".j_seemyawards").on("click",$.proxy(this.seeMyawards,this)),$(".j_lucky_button").on("click",$.proxy(this.amILucky,this)),$("#lottery_act_square_btn").bind("click",function(){try{$.stats.track("活动PB页","活动大厅","PB","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:242}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:242}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:242")}})},amILucky:function(t){t&&t.preventDefault();var a=this,e=a.option;return e.user.is_login?void(e.user.is_black||e.user.forbidden.isForbid?a.showBasicDialog("block"):e.user.is_like?e.remains<1?a.showBasicDialog(a.gameBalance?"nobalance":"nochance"):a.postLotteryData():a.showBasicDialog("notlike")):void _.Module.use("common/component/LoginDialog")},tpls:{block:'<p>你的账号已被封禁，无法参加活动哦~</p><br><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a>',goodsubmit:'<p>提交成功。要继续支持我们的活动哦~</p><br><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a>',notlike:'<p>参与抽奖需要先关注本吧哦~</p><br><a href="#" class="ui_btn ui_btn_m j_like"><span><em>关注本吧</em></span></a>',noreason:'<p>系统发生未知错误，请稍后再试试吧~</p><br><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a>',sofast:'<p>你的操作太频繁了，请喝杯茶再来吧~</p><br><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a>',majia:'<p>当前抽奖的人太多啦，请稍候再来！~</p><br><a href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a>',notlucky:'<div style="overflow:hidden;"><div class="act_dialog_bear_notlucky" style="text-align:left;"><div class="act_dialog_p_bigorange">哎呀呀~还差一点点就中奖了，再努力试试！</div><p>你还有<span class="act_dialog_p_bigorange">#{val}</span>次抽奖机会</p><p>据说<span style="color: #fd7d3d;">转发活动</span>不但可以攒人品，更可以增加抽奖机会哦！</p><a style="margin-left:0px;margin-top:33px;" href="#" class="ui_btn ui_btn_m j_repost_trigger"><span><em>立即转发</em></span></a><a style="margin-left:38px;margin-top:33px;" href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div></div>',notluckyBalance:['<div style="overflow:hidden;">','<div class="act_dialog_bear_notlucky" style="text-align:left;">','<div class="act_dialog_p_bigorange">哎呀呀~还差一点点就中奖了，再努力试试！</div>','<p>你还有<span class="act_dialog_p_bigorange">#{val}</span>次抽奖机会</p>','<p>据说<span style="color: #fd7d3d;">给游戏充值</span>不但可以攒人品，更能增加抽奖机会哦！</p>','<a style="margin-left:0px;margin-top:33px;" href="#" onclick="return false;" class="ui_btn ui_btn_m j_pay_trigger"><span><em>立即充值</em></span></a>','<a style="margin-left:38px;margin-top:33px;" href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div></div>'].join(""),nochance:'<div style="overflow:hidden;"><div class="act_dialog_bear_nochance" style="text-align:left;padding-top:18px;"><div class="act_dialog_p_bigorange">你的抽奖机会已用完</div><p>没关系~<span style="color: #fd7d3d;">转发活动</span>马上就可以获得更多抽奖机会！</p><p>想了解如何增加抽奖次数，细则请<a href="#" class="j_seerule">查看抽奖规则</a></p><a style="margin-left:0px;margin-top:33px;" href="#" class="ui_btn ui_btn_m j_repost_trigger"><span><em>立即转发</em></span></a><a style="margin-left:38px;margin-top:15px;" href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div></div>',nobalance:['<div style="overflow:hidden;">','<div class="act_dialog_bear_nochance" style="text-align:left;padding-top:18px;">','<div class="act_dialog_p_bigorange">你的抽奖机会已用完</div>','<p>没关系~<span style="color: #fd7d3d;">给游戏充值</span>马上就可以获得更多抽奖机会！</p>','<p>想了解如何增加抽奖次数，细则请<a href="#" class="j_seerule">查看抽奖规则</a></p>','<a style="margin-left:0px;margin-top:33px;" href="#" onclick="return false;" class="ui_btn ui_btn_m j_pay_trigger"><span><em>立即充值</em></span></a>','<a style="margin-left:38px;margin-top:15px;" href="#" class="ui_btn ui_btn_m j_close"><span><em>确定</em></span></a></div></div>'].join("")},postLotteryData:function(){var t=this;$.post("/actstage/lottery",t.lotteryData,function(a){switch(a.no){case 0:t.minusChance(),t.showProfileDialog(a.data);break;case 4001:t.minusChance(),t.showBasicDialog(t.gameBalance?"notluckyBalance":"notlucky");break;case 40:t.showCaptchaDialog(a);break;case 210001:t.minusChance(0),t.showBasicDialog(t.gameBalance?"nobalance":"nochance");break;case 220012:t.showBasicDialog("block");break;case 11e4:_.Module.use("common/component/LoginDialog",["",""]);break;case 340012:t.showBasicDialog("notlike");break;case 2344:t.showBasicDialog("sofast");break;case 7:t.showBasicDialog("majia");default:t.showBasicDialog("noreason")}},"json")},showCaptchaDialog:function(t){var a=this;_.Module.use("common/component/CaptchaDialog",{title:"抽奖",message:"请输入验证码完成抽奖~大奖等着你哦！",vCode:t.data.vcode.captcha_vcode_str,vCodeType:t.data.vcode.captcha_code_type,paramsCallback:function(){return a.lotteryData}},function(t){t.bind("onclose",function(){return t.hide(),!1}),t.bind("onaccept",function(){a.lotteryData.vcode=t.getInputValue(),a.lotteryData.vcode_md5=t.getVCode(),a.postLotteryData()}),t.show()})},showBasicDialog:function(t){var a=this,e=this.tpls[t];switch("notlucky"==t&&(e=$.tb.format(this.tpls[t],{val:this.option.remains})),"notluckyBalance"==t&&(e=$.tb.format(this.tpls[t],{val:this.option.remains})),this.dialog&&this.dialog.close(),this.dialog=new $.dialog({html:e,width:420}),this.dialog.element.addClass("pat-noTitle"),t){case"notlike":$.stats.track("like_from_activity_thread_show","platforum_activity"),this.dialog.element.on("click",".j_like",function(t){try{t.preventDefault(),a.dialog.close(),_.Module.use("ucenter/widget/Balv",[{}],function(t){t.dolike()}),$.stats.track("like_from_activity_thread","platforum_activity")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:395}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:395}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:395")}});break;case"notlucky":case"nochance":this.dialog.element.on("click",".j_seerule",function(t){try{t.preventDefault(),a.dialog.close(),a.seeRule()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:403}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:403}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:403")}});default:this.dialog.element.on("click",".j_close",function(t){try{t.preventDefault(),a.dialog.close()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:408}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:408}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:408")}})}this.dialog.element.on("click",".j_pay_trigger",function(t){try{a.dialog.close(),window.open("http://wanba.baidu.com/reg_order.xhtml"),t.preventDefault()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:415}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:415}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:415")}}),this.dialog.element.on("click",".j_repost_trigger",function(t){try{t.preventDefault(),a.dialog.close(),$(".j_repost_btn").trigger("click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:420}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:420}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:420")}})},showProfileDialog:function(t){var a=this,e="";this.dialog&&this.dialog.close(),e=a.renderProfileTpl(t),this.dialog=new $.dialog({html:e,width:420}),this.dialog.element.on("click",".cp_weal_btn",function(t){try{t.preventDefault(),a.copyWealNum($(this))}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:440}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:440}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:440")}}),this.dialog.element.addClass("pat-noTitle").on("click",".j_submit",function(e){try{e.preventDefault();var i={tbs:a.option.tbs,activity_id:a.option.activity_id,forum_id:a.option.activity_id,award_id:t.award_id,security_key:t.security_key},s={},o=["true_name","address","zcode","mobile","user_define"],n="",r=$(".act_dialog_awardtable"),l=null;if("1"==t.award_type)for(var c=0;c<o.length;c++)n=o[c],l=r.find(".j_profile_"+n),0!==l.length&&("user_define"==n?(s[n]=t.user_define,s.user_define_value=l.val().trim()):s[n]=l.val().trim());switch(Number(t.award_type)){case 1:i.address_info=s;break;case 2:return void a.dialog.close()}$.post("/actstage/uploadinfo?ie=utf-8",i,function(t){switch(t.no){case 0:case 5e3:a.dialog.close();break;default:a.showBasicDialog("noreason")}},"json")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",method:"",ln:496}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_thread/platforum_activity_thread.js",linenum:496}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_thread/platforum_activity_thread.js","linenum:496")}})},renderProfileTpl:function(t){var a=this,e="",i="",s="",o={true_name:"姓名",address:"邮寄地址",zcode:"邮编",mobile:"手机号"},n="";if("1"==t.award_type){if("address_info"in t){var r=["true_name","address","zcode","mobile","user_define","user_define_value"],l="",c={};if(""==t.address_info||0==t.address_info.length){for(index in a.option.award_info)if(c=a.option.award_info[index],t.award_id==c.award_id)for(var d=0;d<r.length;d++)l=r[d],l in c&&(t[l]=c[l]||"")}else for(var d=0;d<r.length;d++)l=r[d],l in t.address_info&&(t[l]=t.address_info[l]||"")}for(s in o)s in t&&(n="1"==t[s]?"":t[s],e+="<tr><td>"+o[s]+'：</td><td><input type="text" class="ui_textfield j_profile_'+s+'" value="'+n+'"></td></tr>');"user_define"in t&&(e+="user_define_value"in t?"<tr><td>"+t.user_define+'：</td><td><input type="text" class="ui_textfield j_profile_user_define" value="'+t.user_define_value+'"></td></tr>':"<tr><td>"+t.user_define+'：</td><td><input type="text" class="ui_textfield j_profile_user_define" value=""></td></tr>')}return i='<div class="act_dialog_bear_lucky" style="width:278px;clear:both;text-align:center;margin:10px 0 20px 0;"><div class="act_dialog_p_bigorange" style="text-align:left;margin-left:25px;">恭喜你抽中以下奖品！！</div><p style="padding-right:80px;"><img src="#{award_cover}" style="width:80px;height:80px;padding:4px;border:1px solid #d9d9d9; border-radius:3px;"></p><p style="padding-right:80px;">#{award_name}</p></div>'+(2==t.award_type?'<div class="vaward_wrap"><label for="award_v">奖品兑换码：</label><input type="text" id="award_v" readonly="true" placeholder="兑奖码" class="ui_textfield" value="#{award_v}" /><a href="#" class="cp_weal_btn">复制</a><label style="display:block;margin-top:13px;" for="exg_rule">兑换说明：</label><p class="exg_rule">#{vaward_desc}'+(t&&t.vaward_link?'<a class="vaward_link" href="#{vaward_link}" target="_blank">马上去兑奖</a>':"")+"</p></div>":'<div style="text-align:left;"><p class="act_dialog_p_orange">请填写以下信息方便发奖人员联系你</p><table class="act_dialog_awardtable" style="width:360px;">'+e+'</table><p style="padding: 9px 0px 0px 0px; color: #2d64b3;">&#8251;中奖后请尽快填写信息，活动截止仍未填写的中奖将失效。</p></div>')+'<a style="margin-top:20px;" href="#" class="ui_btn ui_btn_m j_submit"><span><em>确定</em></span>',$.tb.format(i,t)},copyWealNum:function(t){var a=$("#award_v"),e=a.val(),i={content:"",arrow_dir:"down",bubble_css:{top:0,right:0,width:160,"line-height":1.5},arrow_pos:{right:10},wrap:t,arrowReq:!0};$.browser.msie?(window.clipboardData.setData("Text",e),i.content="复制成功",i.bubble_css.width=80):i.content="您的浏览器不支持此功能<br />请手动复制";var s=new UiBubbleTipBase(i);s.showBubble({type:"delayClose",time:3e3,zIndex:$.getcurzIndex()})},minusChance:function(t){if(0!=this.option.remains){this.option.remains="number"==typeof t?0>t?0:t:this.option.remains<1?0:this.option.remains-1;for(var a=this.option.remains.toString(),e=a.length,i=177+32*e,s='<span class="act_mychance_line1 vjs"></span>',o=0;e>o;o++)s+='<span class="act_mychance_number">'+a.charAt(o)+"</span>";s+='<span class="act_mychance_line2"></span>',$(".j_act_mychance").css("width",i+"px").html(s)}}}});_.Module.define({path:"pb/widget/platform_pic_act_repost",requires:[],sub:{initial:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/platform_pic_act_repost/platform_pic_act_repost.js",method:"",ln:12}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/platform_pic_act_repost/platform_pic_act_repost.js",linenum:12}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/platform_pic_act_repost/platform_pic_act_repost.js","linenum:12")}}}});_.Module.define({path:"pb/widget/PlatforumActivityRepost",requires:[],sub:{version:"0.1",initial:function(){try{this.initAwardNews()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/platforum_activity_repost/platforum_activity_repost.js",method:"",ln:22}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/platforum_activity_repost/platforum_activity_repost.js",linenum:22}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/platforum_activity_repost/platforum_activity_repost.js","linenum:22")}},initAwardNews:function(){var t=$(".j_act_repost_award_news"),e=function(){t.animate({left:"-=128"},1e3,function(){t.css("left","0").find("li:first").appendTo(t),setTimeout(e,2500)})};t.children().length>2&&e()}}});_.Module.define({path:"pb/widget/ticket_thread",requires:[],sub:{conf:{},$el:null,PIAO_MAX_NUM:30,piaoNum:1,sendFlag:0,initial:function(e){try{$.extend(this.conf,e),this.$el=this.conf.$el,this.$tourBtn=$("#piao_info_tour_btn"),this.$mapBtn=$("#piao_info_map_btn"),this.$piaoDate=$("#piao_thread_date"),this.$piaoDateList=this.$piaoDate.find(".j_piao_date_item"),this.$piaoPrice=$("#piao_thread_price"),this.$piaoPriceList=this.$piaoPrice.find(".j_piao_price_item"),this.$piaoSubBtn=$("#piao_num_subtract_btn"),this.$piaoAddBtn=$("#piao_num_add_btn"),this.$piaoNumInput=$("#piao_num_input"),this.$piaoNumTip=$("#buy_num_limit"),this.$submitBtn=$("#piao_thread_buy_btn"),this.$msgArea=$("#piao_thread_buy_msg"),this.ticketThreadTongj(),this.$toKnowDetailBtn=$(".j_piao_thread_intro_detail"),this.listenEvent()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:40}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:40}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:40")}},listenEvent:function(){var e=this;this.$tourBtn.on("click",function(t){try{t.preventDefault(),e.showPiaoTour.call(e),$.stats.track("pb_查看巡演信息","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:51}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:51}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:51")}}),this.$mapBtn.on("click",function(t){try{t.preventDefault(),e.showPiaoMap.call(e),$.stats.track("pb_查看票区图","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:57}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:57}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:57")}}),this.$piaoDate.on("click",".j_piao_date_item",function(t){try{t.preventDefault(),e.selectPiaoDate.call(e,t),$.stats.track("pb_购买日期","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:63}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:63}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:63")}}),this.$piaoPrice.on("click",".j_piao_price_item",function(t){try{t.preventDefault(),e.selectPrice.call(e,t),$.stats.track("pb_购买票价","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:69}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:69}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:69")}}),this.$piaoSubBtn.on("click",function(t){try{t.preventDefault(),e.changePiaoNum.call(e,e.piaoNum-1),$.stats.track("pb_购买数量","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:75}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:75}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:75")}}),this.$piaoAddBtn.on("click",function(t){try{t.preventDefault(),e.changePiaoNum.call(e,e.piaoNum+1),$.stats.track("pb_购买数量","pc明星票务","pb","click")}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:80}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:80}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:80")}}),this.$piaoNumInput.on("keyup",function(t){t.preventDefault();var i=e.$piaoNumInput.val();e.changePiaoNum.call(e,i),$.stats.track("pb_购买数量","pc明星票务","pb","click")}),this.$submitBtn.on("click",function(t){try{t.preventDefault(),e.sendSubmit.call(e)}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:92}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:92}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:92")}}),this.$toKnowDetailBtn.on("click",function(e){try{$.stats.track("pb_了解详情","pc明星票务","pb","click")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/ticket_thread/ticket_thread.js",method:"",ln:96}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/ticket_thread/ticket_thread.js",linenum:96}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/ticket_thread/ticket_thread.js","linenum:96")}})},showPiaoTour:function(){var e=$("#piao_thread_tour_tpl").html(),t=$(e).width();new $.dialog({title:"巡演信息",html:e,draggable:!1,width:t+18,height:117})},showPiaoMap:function(){var e=new Image;e.src=this.conf.posterSrc+"?_t="+(new Date).valueOf(),e.onload=function(){new $.dialog({title:"票区图",html:e,draggable:!1,width:e.width+18,height:e.height})},e.onabort=function(){$.dialog.alert("图片加载失败，请重试")},e.onerror=function(){$.dialog.alert("图片加载失败，请重试")}},selectPiaoDate:function(e){$curEle=$(e.currentTarget),this.$piaoDateList.removeClass("j_piao_date_item_selected").removeClass("piao_thread_date_item_selected"),$curEle.addClass("j_piao_date_item_selected").addClass("piao_thread_date_item_selected");var t=parseInt($curEle.tbattr("attr-id"));this.changePriceTab(t)},changePriceTab:function(e){var t="#piao_price_data_"+e;$(".j_piao_price_date_item").removeClass("piao_thread_price_date_item_show"),$(t).addClass("piao_thread_price_date_item_show"),this.$piaoPriceList.removeClass("j_piao_price_item_selected").removeClass("piao_thread_price_item_selected")},selectPrice:function(e){$curEle=$(e.currentTarget);var t=$curEle.hasClass("j_piao_price_item_selected");this.$piaoPriceList.removeClass("j_piao_price_item_selected").removeClass("piao_thread_price_item_selected"),t||$curEle.addClass("j_piao_price_item_selected").addClass("piao_thread_price_item_selected"),this.hideMsg()},changePiaoNum:function(e){e=parseInt(e);var t=e,i=this,a=!(e>=0||0>e);e=1>e?1:e>this.PIAO_MAX_NUM?this.PIAO_MAX_NUM:a?1:e,this.piaoNum=e,this.$piaoNumInput.val(e),t>this.PIAO_MAX_NUM&&(i.$piaoNumTip.show(),setTimeout(function(){i.$piaoNumTip.hide()},1e3))},sendSubmit:function(){var e=$(".j_piao_price_item_selected").tbattr("attr-id")||0;e?this.sendFlag||this.sendRequest(e):this.showMsg()},sendRequest:function(e){var t=this;this.sendFlag=1,$.ajax({url:"/frsstar/ticket/checkPrice",type:"get",dataType:"json",data:{price_id:e,num:t.piaoNum,_t:(new Date).valueOf()},success:function(i){t.sendFlag=0,$.stats.track("pb_立刻购买","pc明星票务","pb","click"),0===i.no?setTimeout(function(){t.$piaoNumInput.val(1),$.tb.location.setHref("http://piao.baidu.com/order/pay?priceid="+e+"&num="+t.piaoNum+"&fr=tieba_piao")},1e3):($.dialog.alert(i.errmsg),$("#"+e).addClass("piao_thread_price_item_empty").removeClass("j_piao_price_item"))},error:function(){t.sendFlag=0,$.dialog.alert("操作异常")}})},showMsg:function(e){e=e||"请选择票价",this.$msgArea.text(e).show()},hideMsg:function(){this.$msgArea.hide()},ticketThreadTongj:function(){$.stats.track("pb_票务帖子","pc明星票务","pb","view")}}});_.Module.define({path:"common/component/JsPager",sub:{_cfg:{},_amount:0,_center_pos:0,_jwrapper:null,_isNew:true,_page_template:{normal:'<a href="#url#" index="#page#" #special#>#page#</a>',current:"<span #special#>#page#</span>",prev:'<a href="#url#" index="#page#" #special#>\u4e0a\u4e00\u9875</a>',next:'<a href="#url#" index="#page#" #special#>\u4e0b\u4e00\u9875</a>',head:'<a href="#url#" index="#page#" #special#>\u9996\u9875</a>',tail:'<a href="#url#" index="#page#" #special#>\u5c3e\u9875</a>',prev_disable:'<a href="#url#" index="#page#" #special#>\u4e0a\u4e00\u9875</a>',next_disable:'<a href="#url#" index="#page#" #special#>\u4e0b\u4e00\u9875</a>',head_disable:'<a href="#url#" index="#page#" #special#>\u9996\u9875</a>',tail_disable:'<a href="#url#" index="#page#" #special#>\u5c3e\u9875</a>',status:'<span #special#><span class="js_pager_idx">#page#</span>/<span class="js_pager_total">#total#</span></span>'},_default_cfg:{container:$("body"),amount:10,isHtml:false,current:1,total:10,mode:0,url:"##",openInNew:false,showStatus:false,statusPos:"head",showDisableItem:false,template:{},classname:{wrapper:"tbui_js_pager",normal:"",current:"current",prev:"prev",next:"next",head:"head",tail:"tail",status:"status",prev_disable:"prev_disable",next_disable:"next_disable",head_disable:"head_disable",tail_disable:"tail_disable"}},initial:function(c){var b=this;if(b._isNew){b._cfg=$.extend({},b._default_cfg,c);var a=b._cfg;a.template=$.extend({},b._page_template,a.template);a.amount=parseInt(a.amount);a.current=parseInt(a.current);a.total=parseInt(a.total);b._amount=a.total>a.amount?a.amount:a.total;b._center_pos=parseInt((b._amount+1)/2)}else{b._cfg=$.extend(b._cfg,c)}if(b._amount<=1){return}if(!b._cfg.isHtml){b._render()}b._isNew=false},_render:function(){var j=this;var g=j._cfg;var f=[],e="";if(g.showStatus&&g.statusPos==="head"){f.push(j._generateHtml("status",g.current,g.total))}if(g.current>1){f.push(j._generateHtml("head",1));f.push(j._generateHtml("prev",g.current-1))}else{if(g.showDisableItem){f.push(j._generateHtml("head_disable",1));f.push(j._generateHtml("prev_disable",g.current-1))}}if(j._amount){var a,c,b,h;a=g.current-parseInt((j._amount-1)/2);c=g.current+j._center_pos;if(a<1){b=1-a;a=1;c=c+b;c=c>g.total?g.total:c}else{if(c>g.total){b=c-g.total;c=g.total;a=a-b;a=a<1?1:a}}for(var d=a;d<=c;d++){h=d==g.current?"current":"normal";f.push(j._generateHtml(h,d))}}if(g.current<g.total){f.push(j._generateHtml("next",g.current+1));f.push(j._generateHtml("tail",g.total))}else{if(g.showDisableItem){f.push(j._generateHtml("next_disable",g.current+1));f.push(j._generateHtml("tail_disable",g.total))}}if(g.showStatus&&g.statusPos==="tail"){f.push(j._generateHtml("status",g.current,g.total))}e=f.join("");if(j._isNew){j._jwrapper=$("<div>",{"class":g.classname.wrapper});j._jwrapper.bind("click",function(i){if(i.target.nodeName=="A"){if($(i.target).tbattr("ok")!=="0"){j.trigger("pageChange",parseInt($(i.target).tbattr("index")))}if(g.mode==0){return false}}});if(!g.isHtml){var k=typeof g.container=="string"?$("#"+g.container):$(g.container);k.empty();k.append(this._jwrapper)}}if(g.isHtml){return e}else{j._jwrapper.html(e)}},_generateHtml:function(e,f,d){var c="";var a=this._cfg;c=a.template[e];c=c.replace(/#page#/g,f);c=c.replace(/#url#/g,a.url.replace(/\{page\}/g,f));if(typeof d!=="undefined"){c=c.replace(/#total#/g,d)}var b="";if(a.classname[e]){b+='class="'+a.classname[e]+'"'}if(a.openInNew){b+=" target=_blank"}if(e.indexOf("disable")!==-1){b+=' ok="0"'}c=c.replace(/#special#/,b);return c}}});_.Module.define({path:"props/component/PropsApi",requires:["common/component/JsPager"],sub:{initial:function(t){this.dataObj=t,this.initOptions(),this.bindEvents()},initOptions:function(){this.titleMap={"1070001_0":"他们对我使用了“魔拜”","1070001_1":"他们对贴使用了“魔拜”","1070002_0":"他们对我使用了“魔蛋”","1070002_1":"他们对贴使用了“魔蛋”"},this.urlMap={0:"/tbmall/getUserAppraise",1:"/tbmall/getPostAppraise"}},bindEvents:function(){var t=this,i=t.dataObj;$(".props_item_tail").live("click",function(){return t.propsData={props_id:$(this).data("propsid"),props_type:i.props_type},"0"==i.props_type&&(t.propsData.user_id=$(this).data("userid"),t.propsData.user_sex=$(this).data("usersex")),"1"==i.props_type&&(t.propsData.post_id=$(this).data("postid")),t.initPager=!0,t.showDialog(),!1})},getAttrsHtml:function(t){for(var i=null,s=[],a="",p=["user_id","user_sex","post_id","props_id"],e=0;e<p.length;e++)i=p[e],t[i]&&(a="data-"+i.replace(/_/,"")+'="'+t[i]+'"',s.push(a));return s.join(" ")},showUI:function(t){for(var i=[],s=t.props||{},a=null,p=0,e=["1070001","1070002"],r=0;r<e.length;r++)t.props_id=e[r],a=s[e[r]],a&&(i.push('<li class="props_item_split"><span class="userinfo_split"></span></li>'),i.push('<li class="props_item props_item_'+e[r]+'">'),i.push('<a href="#" '+this.getAttrsHtml(t)+' class="props_item_tail">'),i.push('<span class="props_item_icon"></span>'),i.push('<span class="props_item_plus">'+String.fromCharCode(215)+"</span>"),i.push('<span class="props_item_num">'+a.num+"</span></li>"),i.push("</a>"),p++);p>0&&t.wrap.html(i.join(""))},showDialog:function(){this.initDialogData(),this.initDialogUI(),this.showOrUpdateList()},initDialogData:function(){var t=this.propsData,i=t.props_id+"_"+t.props_type,s=this.titleMap[i];if(t.user_id!==PageData.user.id){var a=t.user_sex;s=s.replace(/我/,a)}this.dialogTitle=s,this.dataurl=this.urlMap[t.props_type],this.pn=0,this.pageSize=10,this.pageCount=8},initDialogUI:function(){var t=this;this.$wrap=$('<div class="props_userlist_wrap"></div>'),this.$userlist=$('<div class="props_userlist_main"></div>'),this.$wrap.append(this.$userlist),this.dialog=new $.dialog({title:t.dialogTitle,width:554,height:340,show:!1,html:this.$wrap})},showOrUpdateList:function(){var t=this,i=t.propsData,s={props_id:i.props_id,look_user_id:i.user_id||"",post_id:i.post_id||"",pn:t.pn,c:t.pageSize};$.tb.get(t.dataurl,s,function(i){i&&0==i.no?(t.list=i.data.list,t.updateList(),t.initPager&&i.data.total>1&&(t.initPager=!1,t.total=Math.ceil(i.data.total/t.pageSize),t.buildPager()),t.dialog.show()):t.showErrorDialog()})},showErrorDialog:function(){new $.dialog({title:"提示",width:300,height:50,html:'<p style="text-align:center;font-size:14px;line-height:40px;">网络错误，请重试</p>'})},buildPager:function(){var t=$('<div class="props_userlist_pager"></div>');this.$wrap.append(t);var i=this,s=this.use("common/component/JsPager",{container:t,current:1,amount:i.pageCount,total:i.total});s.bind("pageChange",function(t,a){s.initial({current:a}),i.pn=a,i.showOrUpdateList()}),this.pager=s},updateList:function(){var t=this.list,i=[],s=null;i.push('<ul class="props_userlist">');for(var a=0;a<t.length;a++)s=t[a],i.push('<li class="userlist_item">'),i.push('<a class="userlist_head" href="/home/main?id='+s.portrait+'&fr=props" target="_blank"><img src="http://tb.himg.baidu.com/sys/portrait/item/'+s.portrait+'"/></a>'),i.push('<a class="userlist_name" href="/home/main?id='+s.portrait+'&fr=props" target="_blank">'+s.user_name+"</a>"),i.push('<p class="userlist_time">'+this.getShowtime(s.create_time)+"</p>"),i.push("</li>");i.push("</ul>"),this.$userlist.html(i.join(""))},getShowtime:function(t){t*=1e3;var i=new Date($.dateFormat(new Date(Env.server_time),"yyyy-MM-dd 00:00:00")).getTime();return t=t>i?$.dateFormat(new Date(t),"HH:mm"):$.dateFormat(new Date(t),"yyyy-MM-dd")}}});_.Module.define({path:"props/widget/Residual",requires:[],sub:{initial:function(i){this.dataObj=i,this.initOptions()},initOptions:function(){this.options={1070001:"worship",1070002:"egg"}},getResidualKey:function(i){for(var e=i.props||{},s=null,n="",t=["1070002","1070001"],a=0;a<t.length;a++)if(s=e[t[a]],s&&s.num>0&&s.end_time>Env.server_time/1e3){n=this.options[t[a]];break}return n},showUI:function(i){var e=i.wrap,s="",n=null,t=i.key||this.getResidualKey(i);t&&(s="residual_wrap residual_wrap_"+t,n=e.find(".residual_wrap"),n[0]?n.removeClass().addClass(s):(n=$('<div class="'+s+'"></div>'),e.append(n)))}}});_.Module.define({path:"ueglibs/widget/Ban",sub:{initial:function(e,a,r,t,i,n){var o,s,f,p,l=PageData.user.forbidden;if(l)o=l.days_to_free,s=l.opgroup,f=l.isForbid,p=l.block_reason;else{var d=PageData.user.balv;o=d.days_tofree,s=d.opgroup,f=d.is_block,p=d.block_reason}var u=this,e=void 0!==e?e:PageData.product,a=void 0!==a?a:PageData.forum.forum_id,r=void 0!==r?r:o,t=void 0!==t?t:s,i=void 0!==i?i:f,n=void 0!==n?n:p,n=n&&"bawu"===t?"<span>封禁理由："+n+"</span>":"",c="bawu"===t?"；如果吧务不处理，就可以自动解封哦～":"";u.renderInfo={product:e,ban:i,fid:a,day:r,by:t,op:"bawu"!==t?"系统":"本吧吧务",page:"bawu"!==t?"system":"bawu",br:n,notice:c},$("body").off("click.ueg.pmclink").on("click.ueg.pmclink",".ueg_pmc-link",function(){var e=$(this),a=e.data("fr"),r=e.data("site");$.stats.track(r,"UEG-track",a,"click")})},ensure:function(e,a,r){for(var t,a=a.split(".");a.length>1;)t=a.shift(),e=e[t]=e[t]||{};if(t=a.shift(),void 0===t)throw"Please make sure you has one namespace like `scope.name.value` !";return void 0!==r&&(e[t]=r),e[t]},_tplRenders:{richPoster:function(e){if("system"==e.page)var a=e.ban?["您可能存在违规操作，已被#{op}封禁，去",'<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">申请恢复</a>',"#{notice}#{br}"].join(""):"";else var a=e.ban?["您已被#{op}封禁，#{br}",'您可以去<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">申请恢复</a>'].join(""):"";return $.tb.format(a,e)},simplePoster:function(e){if("system"==e.page)var a=e.ban?["您可能存在违规操作，已被#{op}封禁，去",'<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">申请恢复</a>'].join(""):"";else var a=e.ban?["您已被#{op}封禁，#{br}",'您可以去<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">申请恢复</a>'].join(""):"";return $.tb.format(a,e)},balvAside:function(e){var a=['<div style="width:205px;text-align:left;margin:6px 0px 6px 10px;">',"<div>你已被系统永久封禁，<br/>封禁期间不加经验，头衔和权限收回。</div>",'<div style="text-align:right;margin-right:5px;">','<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/index?fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">查看详细信息</a>',"</div>","</div>"].join(""),r=['<div style="width:205px;text-align:left;margin:6px 0px 6px 10px;">','<div style="width:205px;">',"<span>你已被#{op}封禁，#{br}</span>","<span>封禁期间不加经验，头衔和权限收回。</span>","</div>",'<div style="text-align:right;margin-right:5px;">','去<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site} j_appealLink"','target="_blank">申请恢复</a>',"</div>","</div>"].join(""),t=e.ban?e.day>0&&e.day<360?r:a:"";return $.tb.format(t,e)},oldPosterDialog:function(e){var a=e.ban?["操作失败，您的账号因违规操作而被封禁&nbsp;&nbsp;",'<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}" ','target="_blank">查看封禁信息</a>']:"";return $.tb.format(a,e)},balvLike:function(e){return $.tb.format("你已被#{op}封禁，暂时不能进行操作",e)},voteDialog:function(e){var a=e.ban?["操作失败，您的账号因违规操作而被封禁&nbsp;&nbsp;",'<a data-site="#{site}" ','data-fr="#{fr}" ','href="/pmc/#{page}?fid=#{fid}&fr=#{site}_#{fr}" ','class="ueg_pmc-link ueg_track-#{site}"','target="_blank">查看封禁信息</a>']:"";return $.tb.format(a,e)},delPost:function(e){var a=e.ban?"抱歉，您已被本吧封禁或者加入黑名单，暂不能删贴":"";return a},forumInfoManager:function(e){var a=e.ban?"您的账户被封禁，暂不能修改":"";return a},forumManagerApply:function(){var e="抱歉，您的帐号被封禁，暂时无法申请吧主。";return e}},_supports:{frs:{richPoster:"richPoster",simplePoster:"simplePoster",balvAside:"balvAside",balvLike:"balvLike",oldPosterDialog:"oldPosterDialog",voteDialog:"voteDialog",forumManagerApply:"forumManagerApply"},pb:{richPoster:"richPoster",simplePoster:"simplePoster",balvAside:"balvAside",oldPosterDialog:"oldPosterDialog",voteDialog:"voteDialog",forumManagerApply:"forumManagerApply",delPost:"delPost"},"forum-info":{forumManagerApply:"forumManagerApply"},tbmall2:{richPoster:"richPoster"}},assign:function(e,a,r,t){var i=this,n=(i._supports,i._tplRenders);if(!t&&"function"==typeof r){if(t=r,r=t.name,!r)return i.$error("Unknown render handler with an anonymous function"),!1;if(n[r])return i.$error("There exsits one render, place choice one another name"),!1;n[r]=t}e=support[e]=support[e]||{},e[a]=r},$error:function(){"tieba.baidu.com"!==$.tb.location.getHost()&&(arguments[0]="Console$>Error: "+(arguments[0]||""),(console&&console.error||function(){}).apply(console,arguments))},render:function(e){var a,r=this,t=r.renderInfo.product,i=r._supports,n=r._tplRenders,o=(i[t]||{})[e],s=$.tb.location.getSearchValue().fr||"";return o&&"function"==typeof n[o]?(r.renderInfo.site=e,r.renderInfo.fr=t+(s?"-"+s:""),a=n[o](r.renderInfo),r.renderInfo.site="",a):(r.$error("Don't support for this page named %s with the site named %s ,please hi li304207639",t,e),"")}}});_.Module.define({path:"pb/widget/Posts/VoteInfo",sub:{_vote_id:"",ele_id:"",initial:function(){try{}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/posts/vote_info.js",method:"",ln:14}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/vote_info.js",linenum:14}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/vote_info.js","linenum:14")}},rc:function(e,t,o,n){var s='<div class="'+t+'" id="'+e+'">	<div class="rc_top"><b></b><i></i></div>	<div class="rc_content">	<div class="title">'+o+'</div>	<div class="cnt">'+n+'</div>	</div>	<div class="rc_bottom"><b></b><i></i></div></div>';return s},render:function(e,t,o){this._vote_id=t,this.ele_id=o;var n="/i/data/user_data?type=double_follow&un="+e+"&alt=json&t="+(new Date).getTime().toString(32);$.get(n,function(e){var t=$.parseJSON(e);if(t&&0!==t.length){var o="/vote/data/user_options?alt=json";t.length>0&&$.post(o,VoteInfo.buildParams(t),function(e){var t,o,n=[],s="",i={},a="";if(0==e.errno&&(len=e.vote_options.length,len>0)){n.push("<table>");for(var r=0;len>r;r++)i=e.vote_options[r],t=new Date(1e3*parseInt(i.op_time)),a='<a target="_blank" href="/i/sys/jump?ie=utf-8&un='+encodeURIComponent(i.user_name)+'">'+i.user_name+"</a>",s='<tr><td valign="top"><nobr>'+a+"&nbsp;&nbsp;</nobr></td><td>"+Page.Date.format(t,"yyyy-MM-dd HH:mm")+'&nbsp;&nbsp;<span class="vote_options">投票给'+Page.escapeHTML(i.options)+"</span></td></tr>",n.push(s);n.push("</table>"),o=document.getElementById(VoteInfo.ele_id),o.innerHTML=VoteInfo.rc("","vote_detail_rc","",n.join("")),o.style.display="block"}},"json")}})},buildParams:function(e){var t=[];t.push("product_name=forum"),t.push("vote_id="+this._vote_id);for(var o=0,n=e.length;n>o;o++)t.push("user_id_"+(o+1)+"="+e[o].id);return t.join("&")}}});
;_.Module.define({path:"pb/widget/Posts/Tail",sub:{initial:function(){try{this._initJubao(),this._initTail()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/posts/tail.js",method:"",ln:19}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/tail.js",linenum:19}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/tail.js","linenum:19")}},_checkHeight:function(){var t=this.dAuthor.height(),i=this.dPostContent.height(),e=t-i-20;e>0&&this.tail.css("marginTop",e)},_initMallTail:function(){var t="";this.content.ptype&&7==this.content.ptype.length&&!this._fanAuthority(this.content.ptype)&&(t+='<a href="/tbmall/home" class="p_mall_tail" target="_blank" title="本楼层主使用了T秀特权功能"></a>'),this.tail.append(t)},_fanAuthority:function(t){var i=[1019001,1019002,1019003,1049001,1049002,1049003].join("|"),e=new RegExp("^("+i+")$");return e.test(t)},_initJubao:function(){$(".j_jb_ele").live("mouseover",function(){$(this).find(".super_jubao").show()}).live("mouseout",function(){$(this).find(".super_jubao").hide()})},_initFloorNumAndDate:function(){var t=new Array,i=this.content,e="";i.post_no?(e=i.post_no+"楼","1"==PageData.thread.thread_type?t.push('<li class="lzl_time">'+e+"</li>"):1==PageData.is_lzl&&t.push('<li><span class="">'+e+"</span></li>")):e="",t.push("<li><span>"+i.date+"</span></li>"),this.jtail.html(t.join(""))},_initTail:function(){$("a.p_tail_wap").live("mousedown",function(){var t=$(this).tbattr("href")||"",i="";i=t.indexOf("liulanqi.baidu.com")>-1?"baidu_browser_tongji":t.indexOf("youliao")>-1?"wap_youliao":"tbclient_post_link",Stats.sendRequest("fr=tb0_forum&st_type="+i+"&st_mod=pb")});var t,i;$(".p_tail_font").live("click",function(){try{t=setTimeout(function(){i.showBubble()},250)}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/posts/tail.js",method:"",ln:93}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/tail.js",linenum:93}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/tail.js","linenum:93")}}),$(".p_tail_wap,.p_tail_font").live("mouseenter",function(){var e={content:$(this).data().tip||"",arrow_dir:"down",bubble_css:{top:0,left:-40,width:250,"z-index":99,"line-height":"16px"},arrow_pos:{left:76},attr:" ",wrap:$(this).parent().find(".tip_bubble_con").eq(0),closeBtn:!1};i=new UiBubbleTipBase(e),$(this).parent().find(".j_ui_triangle").hide(),t=setTimeout(function(){i.showBubble()},500)}),$(".p_tail_wap,.p_tail_font").live("mouseleave",function(){clearTimeout(t),i.hideBubble()})}}});
;_.Module.define({path:"pb/widget/Posts",requires:["pb/widget/Posts/Concern","pb/widget/Posts/VoteInfo","pb/widget/Posts/Tail","pb/widget/User","pb/widget/Message","props/component/PropsApi","props/widget/Residual","ueglibs/widget/Ban"],sub:{initial:function(){try{var e=this;e.jdom=null,e.postObj=null,e.postList=new Array,e.postMap={},e.user=e.use("pb/widget/User"),e.message=e.use("pb/widget/Message"),e.propsApi=e.use("props/component/PropsApi",{props_type:"1"}),e.residual=e.use("props/widget/Residual"),e._bindEvents(),_.Module.use("ueglibs/widget/Ban",[],function(t){e.BanLib=t})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/posts/posts_main.js",method:"",ln:34}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/posts_main.js",linenum:34}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/posts_main.js","linenum:34")}},_bindEvents:function(){var e=this,t=$("#j_p_postlist");$(".p_post_del_my").live("click",function(){try{var t=$(this),a=t.getData()||{},s=a.delete_mine,o=a.user_name,i=a.index;if(s&&1==s){var n=i&&1==i?"主题":"回复",r=r=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">确认删除这条'+n+"?<div>",{showTitle:!1});i&&1==i?r.bind("onaccept",function(){e._delete_thread(o)}):r.bind("onaccept",function(){var a=e._get_delete_paras(t,!1);a.user_name=o,e._delete_post(a)})}return!1}catch(p){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:p.message||p.description,path:"pb:widget/posts/posts_main.js",method:"",ln:64}),$.se({msg:(p.message||p.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/posts_main.js",linenum:64}),console.log("errormsg:"+(p.message||p.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/posts_main.js","linenum:64")}}),t.delegate(".lzl_jb_in","click",function(){try{{var t=$(this),a=t.getData()||{},s=a.user_name;a.delete_mine}if(1!=a.delete_mine){var o=$(this).parents(".lzl_single_post").getData(),i=$(this).parents(".l_post").getData().content.post_id;return window.open("http://tieba.baidu.com/complaint/info?type=0&tid="+PageData.thread.thread_id+"&pid="+i+"&cid="+o.spid,"newwindow","height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no"),!1}var n=$.dialog.confirm('<div style="margin:15px auto 0;text-align:center;">确认删除这条回复?<div>',{showTitle:!1});return n.bind("onaccept",function(){var a=e._get_delete_paras(t,!0);a.user_name=s,e._delete_post(a,!0)}),!1}catch(r){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message||r.description,path:"pb:widget/posts/posts_main.js",method:"",ln:88}),$.se({msg:(r.message||r.description).replace(/\s+/g,"-"),locator:"pb:widget/posts/posts_main.js",linenum:88}),console.log("errormsg:"+(r.message||r.description).replace(/\s+/g,"-"),"locator:pb:widget/posts/posts_main.js","linenum:88")}}),t.delegate(".apc_src_wrapper a","mousedown",function(e){var t=e.currentTarget.href,a=t.replace(/\w*(:\/\/)?([^\/]+).*/g,"$2");$.stats.sendRequest("fr=tb0_forum&st_type=shenqi_pb_link&st_value="+encodeURIComponent(a))})},_delete_thread:function(e,t){var a=this,s={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,user_name:e,delete_my_post:0,delete_my_thread:1};t&&(s=$.extend(s,a._captcha)),PostHandler.execute("threadDelete",s,function(t){var s="";switch(t.no){case 0:$.tb.location.setHref("/f?kw="+PageData.forum.name_url);break;case 308:s=a.BanLib.render("delPost");break;case 871:s="抱歉，今天已达您删贴的最大限额，明天再来试试吧~";break;case 4011:a._getCaptcha.call(a,t,e);break;default:s="抱歉，系统繁忙，贴子删除失败。"}""!=s&&a.message.showMessage(s,"",!1)})},_delete_post:function(e,t,a){var s=this,o={ie:"utf-8",tbs:PageData.tbs,kw:PageData.forum.forum_name,fid:PageData.forum.forum_id,tid:PageData.thread.thread_id,user_name:e.user_name,delete_my_post:1,delete_my_thread:0,is_vipdel:PageData.power.lz_del?1:0};a&&(o=$.extend(o,s._captcha)),t?(o.pid=e.spid,o.is_finf=1):(o.pid=e.content_id,o.is_finf=!1),PostHandler.execute("postDelete",o,function(a){var o="";switch(a.no){case 0:$.tb.location.reload();break;case 308:o="抱歉，您已被本吧封禁或者加入黑名单，暂不能删贴";break;case 871:o="抱歉，今天已达您删贴的最大限额，明天再来试试吧~";break;case 4011:s._getCaptcha.call(s,a,e,t);break;default:o="抱歉，系统繁忙，贴子删除失败。"}""!=o&&s.message.showMessage(o,"",!1)})},_captcha:{},_getCaptcha:function(e,t,a){var s=this,o=1;"string"==typeof t&&(o=0),_.Module.use("common/component/CaptchaDialog",{title:"删除贴子",message:"删了那么多贴子，输个码验证下身份吧~",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,forumName:PageData.forum.forum_name,forumId:PageData.forum.forum_id,postType:"thread",paramsCallback:function(){return{}}},function(e){s.captchaDialog=e,e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){s._captcha.vcode=e.getInputValue(),s._captcha.vcode_md5=e.getVCode(),o?s._delete_post.call(s,t,a,1):s._delete_thread.call(s,t,1)}),e.show()})},_get_delete_paras:function(e,t){var a,s,o={};return t?(a=e.parents("li.j_lzl_s_p"),o=a.getData()):(a=e.parents("div.l_post"),s=a.getData(),o={author_name:s.author.user_name,content_id:s.content.post_id}),o},initPostData:function(e){var t=e.getData();if(791217039==t.author.id){var a=e.find(".BDE_Frame"),s='<iframe frameborder="no" scrolling="no" src="'+a.tbattr("src")+'" width="'+a.tbattr("width")+'" height="'+a.tbattr("height")+'"></iframe>';a.replaceWith(s)}this.postObj={jdom:e,author:t.author,content:t.content,lzl:null,concern:null};var o=this.postObj.content.post_id;return this.postMap[o]=this.postObj,this.postList.push(this.postObj),this.postObj},loadComponent:function(){this.use("pb/widget/Posts/Tail"),this.showUI()},showUI:function(){var e=this;$(".l_post").each(function(){var t=$(this);if("true"!=t.tbattr("is_showed")){var a=t.getData();t.tbattr("is_showed","true"),e.residual.showUI({wrap:t.find(".icon_relative"),props:a.author.props||{},post_id:a.content.post_id}),e.propsApi.showUI({wrap:t.find(".p_props_tail"),props:a.content.props||{},post_id:a.content.post_id})}})},_showVoteinfo:function(){$(".vote_crypt").each(function(){var e=$(this).getData(),t=this.use("pb/widget/Posts/VoteInfo");t.render(PageData.user.name_url,e.vote_crypt,"my_friends_vote_detail")})}}});!function(t){function a(a){if(PageData.user.is_login){t.stats.sendRequest("fr=tb0_forum&st_mod=idisk&st_type=download");var e=t(a);return t.post("/data/filepost?method=update_file_statistic",{fs_id:e.data("fsId"),thread_id:PageData.thread.thread_id,forum_id:PageData.forum.forum_id,stat_kind:0,tbs:PageData.tbs}),!0}return TbCom.process("User","buildLoginFrame"),!1}function e(a){if(PageData.user.is_login){t.stats.sendRequest("fr=tb0_forum&st_mod=idisk&st_type=forward");var e={31061:"文件已存在",31112:"百度云空间不足&nbsp;<a href='http://pan.baidu.com' target='_blank'>整理网盘</a> "},d=t(a);t.post("/data/filepost",{method:"archiveFile",src_uk:d.data("uk"),src_path:d.data("filePath"),dst_path:"/"+d.data("fileName"),tbs:PageData.tbs},function(a){var i;return a.status&&"-3"==a.status?void t.dialog.alert("<div style='padding: 20px 30px; text-align: center;'>操作失败了，刷新一下试试</div>",{width:300}):void(a.error_code?(i=e[a.error_code],i||(i="转存失败"),t.dialog.alert("<div style='padding: 20px 30px; text-align: center;'>"+i+"</div>",{width:300})):d.hide().after("<a class='file_link' target='_blank' href='http://pan.baidu.com'>已转存</a>"))},"json"),t.post("/data/filepost?method=update_file_statistic",{fs_id:d.data("fsId"),thread_id:PageData.thread.thread_id,forum_id:PageData.forum.forum_id,stat_kind:1,tbs:PageData.tbs})}else TbCom.process("User","buildLoginFrame");return!1}window.diskmanager={};var d=window.diskmanager;d.onClickDownload=a,d.onClickSaveToMine=e}(jQuery);_.Module.define({path:"comforum/widget/LoanAdFloor",sub:{initial:function(){this._bindEvent()},_loan_config_data_a:{amountNoType:{3:"3<span>万元</span>",5:"5<span>万元</span>",10:"10<span>万元</span>",15:"15<span>万元</span>",20:"20<span>万元</span>",25:"25<span>万元</span>",30:"30<span>万元</span>"},amountEnterprise:{3:"10<span>万元</span>",5:"20<span>万元</span>",10:"30<span>万元</span>",15:"50<span>万元</span>",20:"100<span>万元</span>",25:"200<span>万元</span>",30:"500<span>万元</span>"},amountBuyCar:{10:"10<span>万元</span>",15:"15<span>万元</span>",20:"20<span>万元</span>",30:"30<span>万元</span>",50:"50<span>万元</span>"},amountBuyHouse:{30:"30<span>万元</span>",50:"50<span>万元</span>",80:"80<span>万元</span>",100:"100<span>万元</span>",200:"200<span>万元</span>"},amountNormal:{5:"5<span>万元</span>",10:"10<span>万元</span>",15:"15<span>万元</span>",20:"20<span>万元</span>",25:"25<span>万元</span>",30:"30<span>万元</span>"},timeNoType:{3:"3<span>个月</span>",6:"6<span>个月</span>",12:"1<span>年</span>",18:"18<span>个月</span>",24:"2<span>年</span>",36:"3<span>年</span>",60:"5<span>年</span>",120:"10<span>年</span>"},timeEnterprise:{6:"6<span>个月</span>",12:"1<span>年</span>",18:"18<span>个月</span>",24:"2<span>年</span>",36:"3<span>年</span>",60:"5<span>年</span>",120:"10<span>年</span>"},timeBuyCar:{12:"1<span>年</span>",24:"2<span>年</span>",36:"3<span>年</span>"},timeBuyHouse:{36:"3<span>年</span>",60:"5<span>年</span>",120:"10<span>年</span>",180:"15<span>年</span>",240:"20<span>年</span>",300:"25<span>年</span>",360:"30<span>年</span>"},timeNormal:{6:"6<span>个月</span>",12:"1<span>年</span>",18:"18<span>个月</span>",24:"2<span>年</span>",36:"3<span>年</span>",60:"5<span>年</span>",120:"10<span>年</span>"}},_parseListTpl:function(a){var n=[];return $.each(a,function(a,s){n.push("<li data-id="+a+" >"+s+"</li>")}),n.join("")},_parseDoubleList:function(a,n){var s=$("ul#loan_amount_list_a"),t=$("ul#loan_time_list_a"),p=this._parseListTpl(a),i=this._parseListTpl(n);s.empty().append(p),t.empty().append(i)},_refreshTpl:function(a){switch(a){case"企业":this._parseDoubleList(this._loan_config_data_a.amountEnterprise,this._loan_config_data_a.timeEnterprise);break;case"购车":this._parseDoubleList(this._loan_config_data_a.amountBuyCar,this._loan_config_data_a.timeBuyCar);break;case"购房":this._parseDoubleList(this._loan_config_data_a.amountBuyHouse,this._loan_config_data_a.timeBuyHouse);break;case"消费":this._parseDoubleList(this._loan_config_data_a.amountNormal,this._loan_config_data_a.timeNormal);break;default:this._parseDoubleList(this._loan_config_data_a.amountNoType,this._loan_config_data_a.timeNoType)}},_bindEvent:function(){var a=this;$("#loan_ad_mod_a").on("click",function(n){var s=n.target,t=$(s);if(("loan_type_btn_a"==s.id||"loan_type_a"===s.id)&&t.closest(".input_box_a").find(".sub_select_a li").addClass("loan_type_list_a"),"P"===s.tagName||"inner_box_btn_a"===s.className){t.closest(".input_box_a").find(".sub_select_a").toggle(),t.closest(".loan_sub_item_a").siblings().find(".sub_select_a").hide();var p=$("p#loan_type_a").text();a._refreshTpl(p)}if("LI"===s.tagName&&($targetInputBox=t.closest(".input_box_a"),$targetInputBox.find("p").html($(n.target).html()),$targetInputBox.find("p").tbattr("data-id",t.tbattr("data-id")),$targetInputBox.find(".sub_select_a").hide()),"loan_type_list_a"===s.className){var i=$("p#loan_amount_a"),e=$("p#loan_time_a");switch(t.text()){case"企业":i.html("50<span>万元</span>").tbattr("data-id","50"),e.html("1<span>年</span>").tbattr("data-id","12");break;case"购车":i.html("10<span>万元</span>").tbattr("data-id","10"),e.html("1<span>年</span>").tbattr("data-id","12");break;case"购房":i.html("50<span>万元</span>").tbattr("data-id","50"),e.html("5<span>年</span>").tbattr("data-id","60");break;case"消费":i.html("10<span>万元</span>").tbattr("data-id","10"),e.html("3<span>个月</span>").tbattr("data-id","3");break;default:i.html("5<span>万元</span>").tbattr("data-id","3"),e.html("1<span>年</span>").tbattr("data-id","12")}}}),$("#loan_search_btn_a").on("click",function(){var a="http://www.haodai.com/"+$("#loan_type_a").tbattr("data-id")+"-"+$("#loan_amount_a").tbattr("data-id")+"x"+$("#loan_time_a").tbattr("data-id")+"-0x0x9999/?ref=hd_1101746";$("#loan_search_btn_a").tbattr("href",a),$.stats.track("pb一楼半金融吧好贷select广告","pb页","pb","click")})}}});_.Module.define({path:"comforum/widget/GameSpreadThread",_container:null,sub:{initial:function(t){this._container=$("#game_spread_thread_content_"+t),this._render(t),this._bindEvents(t)},_render:function(t){var e=PageUnit.load("forumListV3_game_spreads_swfs");if(e["l_"+t]&&e["l_"+t][0]){var a=e["l_"+t][0].split("|");new $.swf(a[0],{container:this._container,width:738,height:90});{$("<a />").tbattr({"class":"game_spread_anchor",href:a[1],target:"_blank"}).appendTo(this._container)}}},_bindEvents:function(t){var e=this,a=e._container.getData(),n=a.cookieId;$("#game_spread_thread_content_1").on("click",function(){$.stats.track("PB_第一楼下小通栏","PC端商业化游戏统计",PageData.product||"","点击",{obj_url:"-",obj_name:"-",obj_type:"游戏"})}),e._container.find("a").on("click",function(){e._stats(t,a,"点击"),n&&$.cookie(n,0,{expires:365})}),e._stats(t,a,"展现")},_stats:function(t,e,a){$.stats.track("下"+t,"PB页游戏统计","pb",a,{obj_id:e.id||"",obj_name:e.title||"",obj_url:e.pic||"",obj_type:e.type||"",obj_subtype:e.subtype||""})}}});_.Module.define({path:"comforum/widget/AdPost",sub:{initial:function(){}}});_.Module.define({path:"common/widget/WebpSupport",requires:[],sub:{total:4,webp:{features:{lossy:false,lossless:false,alpha:false,animation:false},supportCount:0,support:false},browser:{},sampling:Math.random()<0.01,initial:function(c){var b=this;b.finishedCallback=(c&&c.callback)||function(d){return true};this.processUA();var a="PC_WebP";$.stats.track("total",a);if(this.browser.chrome){this.checkSupport();this.initFinishedEvent()}window.tb_webp=this},checkSupport:function(){var a=this;var c=a.webp.features;a.checkedCount=0;for(var b in c){this.checkWebpFeature(b,function(e,d){c[e]=d;a.checkedCount++;if(a.checkedCount===a.total){a.trigger("finished")}})}},initFinishedEvent:function(){var a=this;this.bind("finished",function(){if(a.finishedCallback.call(a,a.webp)===false){return}a.processResult();a.doStats();a.setCookie();a.compactPb()})},setCookie:function(){var a=this,c=a.webp.support,b=$.cookie("tb_webp_cookie");if(c&&b!="1"){$.cookie("tb_webp_cookie",1)}},processResult:function(){var b=this;var d=b.webp.features;var a=0;for(var c in d){if(d[c]){a++}}b.webp.supportCount=a;b.webp.support=(a>0)},doStats:function(){var b=this;var a="PC_WebP";if(b.webp.support){$.stats.track("s",a);$.stats.track("s_v_"+b.browser.version,a)}else{$.stats.track("n_s",a);$.stats.track("n_s_v_"+b.browser.version,a)}if(b.webp.supportCount==4){$.stats.track("s_f",a);$.stats.track("s_f_v_"+b.browser.version,a)}if(b.sampling){var c=b.webp.features;for(key in c){if(c[key]){$.stats.track("s_"+key,a)}}}},processUA:function(){var a=navigator.userAgent.toLowerCase();this.browser.chrome=/chrome/.test(a);if(this.browser.chrome){a=a.substring(a.indexOf("chrome/")+7);a=a.substring(0,a.indexOf("."));this.browser.version=a;this.browser.safari=false}},compactPb:function(){var d=$("#j_p_postlist");var a="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==";var c=$('<img src="'+a+'" style="position:absolute; display:none; border:1px solid block;" height="1" width="1">');var b=null;d.on("mouseover",".BDE_Image, .j_user_sign, .BDE_Smiley",function(){var e=$(this);b=e;var h=e.offsetParent();c.css({display:"block",top:e.offset().top-h.offset().top,left:e.offset().left-h.offset().left,width:e.width()+"px",height:e.height()+"px",cursor:e.css("cursor")});c.tbattr("src",a);var g=e.tbattr("src"),f=g.lastIndexOf(".webp");if(f!=-1){g=g.slice(0,f)+".jpg"}c.tbattr("origin-src",g);c.appendTo(h)});c.on("click",function(f){f.preventDefault();if(b){b.trigger("click")}});c.on("contextmenu",function(f){c.tbattr("src",c.tbattr("origin-src"))});c.on("mouseover",function(){b.trigger("mouseover")});c.on("mouseleave",function(){b.trigger("mouseleave")})},checkWebpFeature:function(c,d){var a={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};var b=new Image();b.onload=function(){var e=(b.width>0)&&(b.height>0);d(c,e)};b.onerror=function(){d(c,false)};b.src="data:image/webp;base64,"+a[c]}}});_.Module.define({path:"pb/widget/Passive",sub:{initial:function(i){try{this.loaded_count=0,this.jdom=$("#j_p_postlist"),this.area_list=this.jdom.find("div.l_post"),this.callback=i,console.log(333),this.loadInViewArea(),this.bindEventOnWindowScroll()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/passive/passive.js",method:"",ln:19}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/passive/passive.js",linenum:19}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/passive/passive.js","linenum:19")}},bindEventOnWindowScroll:function(){var i=this;this.scroll_handler=function(){i.loadInViewArea()},$(window).bind("scroll",this.scroll_handler)},unbindEventOnWindowScroll:function(){$(window).unbind("scroll",this.scroll_handler)},loadInViewArea:function(){for(var i=$(window).scrollTop(),t=$(window).height()+10,s={min:Math.max(i-t,0),max:i+t},e=0;e<this.area_list.length;e++){var a=$(this.area_list[e]),n={min:a.offset().top,max:a.offset().top+a.height()};"loaded"!==a.tbattr("data-passive")&&Math.max(s.min,n.min)<Math.min(s.max,n.max)&&(a.tbattr("data-passive","loaded"),this.loaded_count++,this.callback(a))}this.loaded_count===this.area_list.length&&this.unbindEventOnWindowScroll()}}});_.Module.define({path:"album/component/initApiConfig",sub:{appid:"314406",xiangceUrl:"http://favo.xiangce.baidu.com/",uploadUrl:"http://up.xiangce.baidu.com/",tags:null,descript:null,cache:{},imgUrl:null,sourceURL:null,offset:{x:-72,y:6},likeButton:null,timer:null,currentQueryImgUrl:null,currentUpImgUrl:null,currentIndex:0,hasLogin:!1,hasNoUn:!1,area:[],descript:"",no_pic_pb:!1,sourceURL:"",tags:"",initial:function(t){var e=this;e.hasLogin=t.isLogin,e.hasNoUn=t.hasNoUn,e.area=t.conf.area,e.descript=t.conf.descript,e.no_pic_pb=t.conf.no_pic_pb,e.sourceURL=t.conf.sourceURL,e.tags=t.conf.tags},isImgMarked:function(t){return t in this.cache&&1==this.cache[t]},checkImgSize:function(t,e){return e.width>=$(t).width()||e.height>=$(t).height()?!1:!0},loginEvent:function(){TbCom.process("User","buildLoginFrame",null,null,null,"fav_img")},showLikeButton:function(){this.likeButton&&this.likeButton.show()},hideLikeButton:function(){this.likeButton&&this.likeButton.hide()},setLikeButtonPosition:function(t,e){{var i,n,o=this,r=$(t),s=r.offset(),u=s.left,a=s.top,c=r.outerHeight(),l=r.outerWidth(),d=o.likeButton;o.area[e]}d.find(".download").show();var h=d.outerHeight(),g=d.outerWidth();return(h+20>c||g+20>l)&&(d.find(".download").hide(),h=d.outerHeight(),g=d.outerWidth(),h+20>c||g+20>l)?!1:(i=a-parseInt(d.css("padding-top")),n=u+l-g+d.width(),d.css({top:i,left:n}),!0)},setImgConf:function(t){var e=this;if("IMG"!=t.tagName){var i=($(t).find("img")[0],$.parseJSON($(t).tbattr("favData")));if(!i.src)return!1;e.imgUrl=i.src,e.sourceURL=i.sourceURL,e.tags=i.tags,e.descript=i.descript}else e.imgUrl=t.src||"";var n=e.imgUrl.lastIndexOf(".webp");return-1!=n&&(e.imgUrl=e.imgUrl.slice(0,n)+".jpg"),!0},resetAndshowLikeButton:function(t,e){var i=this;return i.currentIndex=e,i.setImgConf(t)?i.setLikeButtonPosition(t,e)?(i.imgUrl in i.cache?(i.likeButton[i.isImgMarked(i.imgUrl)?"addClass":"removeClass"]("done"),i.showLikeButton()):i.queryAndshowLikeButton(),void 0):!1:!1},queryAndshowLikeButton:function(){var t=this,e=t.cache,i=t.imgUrl,n=t.likeButton;return t.hasLogin?t.currentQueryImgUrl==i?!1:(t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){var o=t.xiangceUrl+"opencom/picture/fav/query?app_id="+t.appid+"&url="+encodeURIComponent(i)+"&callback=?";$.stats.sendRequest("st_mod=fav_img&fr=tb0_forum&st_type=fav_btn_request&from=pic_forums"),t.currentQueryImgUrl=i,$.getJSON(o,function(o){0==o.errno&&o.data&&0!=o.data.status?(e[i]=1,n.addClass("done")):(e[i]=0,n.removeClass("done")),t.showLikeButton()})},200),void 0):(this.showLikeButton(),void 0)},setAreaConf:function(t,e,i){var n=this,o=n.area,r=null;for(var s in o)o[s].tag===t&&(r=o[s]);r[e]=i}}});_.Module.define({path:"album/widget/imgLikeAction",requires:["album/component/initApiConfig"],sub:{_defaultConfig:{sourceURL:"http://tieba.baidu.com/p/"+PageData.thread.thread_id,tags:"百度贴吧,"+PageData.forum.forum_name+"吧",descript:$.tb.subByte(PageData.thread.title,40,""),no_pic_pb:PageData.isPicBa?!1:!0,area:[{container:"#j_p_postlist",tag:".BDE_Image",offset:{x:-4,y:5},minSize:{width:170,height:80}},{container:"#j_p_postlist",tag:".j_user_sign",offset:{x:-4,y:5},minSize:{width:170,height:80}}]},initial:function(){var t=this;t.isLogin=PageData.user.is_login,t.hasNoUn=PageData.user.no_un,t.conf=t._defaultConfig,t.isEnabled=!0,t.initApiConf(),t.createLikeButton(),t.initEvent()},initApiConf:function(){var t=this;t.favConfig=t.use("album/component/initApiConfig",{isLogin:t.isLogin,hasNoUn:t.hasNoUn,conf:t.conf})},initEvent:function(){var t=this;t.bindImgEvent(),t.bindPostEvent(),t.addShareButton(),t.mobileDownloadClick(),t.initCustomEmotion()},initCustomEmotion:function(){var t=this,e=$.cookie("tb_lab"),a={};e&&(a=$.json.decode(e)),a.custom_emotion&&(t.favConfig.likeButton.find(".emotion").show(),t.favConfig.likeButton.on("click",".emotion",function(){_.Module.use("common/component/CustomEmotion",{},function(e){e.openDialog({forumId:PageData.forum.forum_id,url:t.favConfig.imgUrl})})}))},bindImgEvent:function(){var t=this;$.each(t.favConfig.area,function(e,a){var i=a.container||document.body,o=a.tag;$(i).on("mouseover",o,{index:e},function(e){t.containerMouseover(e)}),$(i).on("mouseleave",o,function(e){t.containerMouseout(e)})})},bindPostEvent:function(){var t=this,e=t.favConfig,a=e.likeButton;a.delegate(".mark","click",function(){if(!e.hasLogin)return e.loginEvent(),void 0;if(e.currentUpImgUrl==e.imgUrl)return!1;var i=e.uploadUrl+"opencom/picture/fav/upload?app_id="+e.appid+"&descript="+encodeURIComponent(e.descript)+"&uid="+PageData.user.user_id+"&source_url="+encodeURIComponent(e.sourceURL)+"&tags="+encodeURIComponent(e.tags)+"&url="+encodeURIComponent(e.imgUrl)+"&callback=?",o={top:parseInt(a.css("top"),10)-e.area[e.currentIndex].offset.y,left:a.offset().left+40};setTimeout(function(){a.addClass("done")},200),$.stats.sendRequest("st_mod=fav_img&fr=tb0_forum&st_type=fav_btn_click"),e.currentUpImgUrl=e.imgUrl,$.getJSON(i,function(a){switch(a.errno){case 0:t.markSuccess(o);break;case 20026:return e.loginEvent(),void 0;case 20028:return t.markFail(o,".n20028"),void 0;default:return t.markFail(o,".ndefault"),void 0}})}).mouseover(function(){if("undefined"==typeof bdRes2Exe){var t=document.getElementsByTagName("body").item(0),a=document.createElement("script");a.type="text/javascript",a.id="bdres2exejs",a["data-proxy"]="http://tieba.baidu.com/tb/static-album/proxy.html",a.src="http://m.baidu.com/static/as/res2exe/js/res2exe_1.0.4.min.js",a.setAttribute("data-proxy","http://tieba.baidu.com/tb/static-album/proxy.html"),t.appendChild(a)}e.showLikeButton()}).mouseout(function(){e.hideLikeButton()}),$("body").delegate(".sr-bdimgshare-layer","mouseover",function(){e.showLikeButton()}).delegate(".sr-bdimgshare-layer","mouseout",function(){e.hideLikeButton()})},markSuccess:function(t){var e=this;e.favConfig.cache[e.favConfig.imgUrl]=1,"1"!=$.cookie("ablum_hls")&&e.favConfig.likeButton.parent().find(".fav-success").fadeIn("fast",function(){var t=$(this);$.cookie("ablum_hls","1",{expires:30}),setTimeout(function(){t.fadeOut()},3e3)}).css(t)},markFail:function(t,e){var a=this;$fav_fail=a.favConfig.likeButton.parent().find(".fav-fail"),$fav_fail.find(".text").hide(),$fav_fail.find(e).show(),$fav_fail.fadeIn("fast",function(){var t=$(this);setTimeout(function(){t.fadeOut()},2e3)}).css(t)},closeBSharePanel:function(){bdShare&&bdShare.ImgShare&&bdShare.ImgShare.closeHoverPop()},addShareButton:function(){if(PageData&&("v3"==PageData.page||"pb_bright"==PageData.page)){var t=this,e=t.favConfig;window.bdShare_config_imgshare={type:"collection",pos:"top",hidden:"share collect",content:encodeURIComponent(document.title)},$.JsLoadManager.use("http://tb1.bdstatic.com/tb/static-common/js/pic_share/imgshare_shell.js",function(){e.likeButton.find(".share").show().mouseover(function(t){e.timer&&clearTimeout(e.timer),e.timer=setTimeout(function(){$.stats.sendRequest("st_mod=album&fr=tb0_forum&st_type=share_show");var a=$(t.target).offset();a.top+=24,bdShare.ImgShare.showHoverPop(e.imgUrl,a)},200)}).click(function(){$.stats.sendRequest("st_mod=album&fr=tb0_forum&st_type=share_click"),t.closeBSharePanel(),bdShare.ImgShare.showAllPop(e.imgUrl)}).mouseout(function(a){e.timer&&clearTimeout(e.timer);var i=t.getMouseHoverDirection.call(this,a);"bottom"!=i&&t.closeBSharePanel()})})}},containerMouseover:function(t){var e=this;if(e.isEnabled){e.closeBSharePanel();var a=t.currentTarget,i=t.data.index;e.favConfig.resetAndshowLikeButton(a,i)}},containerMouseout:function(){var t=this;t.favConfig.timer&&clearTimeout(t.favConfig.timer),t.favConfig.hideLikeButton()},mobileDownloadClick:function(){var t=this;$(".fav-toolbar .download").click(function(){$(this).tbattr({data_name:(new Date).getTime(),data_url:t.favConfig.imgUrl,data_size:1024,data_icon:t.favConfig.imgUrl});var e=[];$(".mobile_res").each(function(t,a){var i=bdRes2Exe.getPackageByDom(a);i&&e.push(i)}),bd_app_dl(e),$.stats.sendRequest("fr=tb0_forum&st_mod=picMobile&st_type=imgLikeAction")})},createLikeButton:function(){var t=this,e=['<div class="fav-wrapper" style="">','<div class="fav-toolbar" style="display:none">','<a href="#" onclick="return false" class="mark" title="收藏到百度相册"></a>','<a href="http://xiangce.baidu.com/opencom/picture/fav/rewrite" target="_blank" onclick="$.stats.sendRequest(\'fr=tb0_forum&st_mod=shoucang&st_value=xiangce\')" title="查看已收藏图片" class="marked"></a>','<a href="#" class="share j_shareImg" onclick="return false"></a>','<a class="download mobile_res"  title="下载图片到手机"  href="javascript:;" hidefocus="true" data_type="picture" data_url="" data_name="" data_icon="" data_size="1048576" data_from="1001714x" ></a>','<a class="mobile_res" data_type="apk" data_url="http://static.tieba.baidu.com/client/operate/android/tieba_pc_picdownload.apk" data_name="百度贴吧" data_icon="http://static.tieba.baidu.com/tb/static-album/img/tieba_client.png" data_size="12488145"  data_from="1001714x"  data_versionname="4.4.1"  data_versioncode="4" data_package="com.baidu.tieba" data_detail_type="soft" style="display:none" ></a>','<a href="javascript:void(0)" style="display: none;" class="emotion" title="添加到自定义表情"></a>',"</div>",'<div class="fav-success" style="display:none;">','<span class="ico"></span>','<span class="text">使用云相册收藏工具，批量收藏精美图片！<a target="_blank" href="http://xiangce.baidu.com/tool/shoucang/">立即安装</a></span>',"</div>",'<div class="fav-fail" style="display:none;">','<span class="ico"></span>','<span class="text ndefault">系统繁忙，请稍后再试！</span>','<span class="text n20028">抱歉，您没有权限进行该项操作</span>',"</div>",'<div id="album_hl_container" style="display:none;"></div>',"</div>"].join("");t.favConfig.likeButton=$(e).appendTo(document.body).find(".fav-toolbar")},getMouseHoverDirection:function(t){var e=t.target,a=e.offsetWidth,i=e.offsetHeight,o=$(e).offset(),n=(t.pageX-o.left-a/2)*(a>i?i/a:1),s=(t.pageY-o.top-i/2)*(i>a?a/i:1),r=Math.round((Math.atan2(s,n)*(180/Math.PI)+180)/90+3)%4,c=new Array("up","right","bottom","left");return c[r]||"bottom"},enableSelf:function(t){var e=this;e.isEnabled=t,t||e.favConfig.hideLikeButton()}}});_.Module.define({path:"pb/widget/pic_act_vote",requires:["common/component/force_login"],sub:{initial:function(e){try{this.option=e,this.voteData={tbs:PageData.tbs,word:PageData.forum.forum_name,forum_id:PageData.forum.forum_id},this.bindEvent()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/pic_act_vote/pic_act_vote.js",method:"",ln:20}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/pic_act_vote/pic_act_vote.js",linenum:20}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/pic_act_vote/pic_act_vote.js","linenum:20")}},bindEvent:function(){var e=this;$("body").delegate(".j_pic_act_vote_btn","click",function(t){try{var a=$(this),o=a.closest(".j_pic_act_vote_area"),i=o.find(".j_pic_act_vote_num"),c=Number(i.text());if(t.preventDefault(),e.repostData=o.getData(),!PageData.user.is_login){var n=$.tb.unescapeHTML($.tb.location.getHref());return _.Module.use("common/component/force_login",[n,"userbar","dialog","pic_act_vote"]),!1}if(PageData.user.is_like)e._postVoteData().done(function(t){"0"==t.no?(a.text("已投票"),a.addClass("act_voted_btn"),i.animate({"margin-top":"-10px"},300).animate({"margin-top":"0"},300).text(c+1)):"40"==t.no?e._showCaptchaDialog(t,a,i,c):"2130008"==t.no?e._showCanvaDialog():e._showErrorTip(t.no)});else{var s=new $.dialog({html:'<p>参与投票需要先关注本吧哦~</p><br><a href="#" class="ui_btn ui_btn_m j_like"><span><em>关注本吧</em></span></a>',width:420,holderClassName:"dialog_tip_holder"});s.element.on("click",".j_like",function(t){try{t.preventDefault(),_.Module.use("ucenter/widget/Balv",[{}],function(e){e.dolike()}),$.stats.track("vote","plat_like","pb","click",{obj_id:e.repostData.activity_id}),s.close()}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/pic_act_vote/pic_act_vote.js",method:"",ln:54}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"pb:widget/pic_act_vote/pic_act_vote.js",linenum:54}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:pb:widget/pic_act_vote/pic_act_vote.js","linenum:54")}})}}catch(p){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:p.message||p.description,path:"pb:widget/pic_act_vote/pic_act_vote.js",method:"",ln:71}),$.se({msg:(p.message||p.description).replace(/\s+/g,"-"),locator:"pb:widget/pic_act_vote/pic_act_vote.js",linenum:71}),console.log("errormsg:"+(p.message||p.description).replace(/\s+/g,"-"),"locator:pb:widget/pic_act_vote/pic_act_vote.js","linenum:71")}})},_postVoteData:function(){var e=this;e.voteData.activity_id=e.repostData.activity_id,e.voteData.post_id=e.repostData.post_id,e.voteData.user_id_ed=e.repostData.user_id,e.voteData.user_name_ed=e.repostData.user_name,e.voteData.thread_id=e.repostData.thread_id;var t=$.post("/actstage/photoVote?",e.voteData,function(){},"json");return t},_showCaptchaDialog:function(e,t,a,o){var i=this;_.Module.use("common/component/CaptchaDialog",{title:"投票",message:"请输入验证码完成投票~支持你喜欢的美图！",vCode:e.data.vcode.captcha_vcode_str,vCodeType:e.data.vcode.captcha_code_type,paramsCallback:function(){return i.voteData}},function(e){e.bind("onclose",function(){return e.hide(),!1}),e.bind("onaccept",function(){i.voteData.vcode=e.getInputValue(),i.voteData.vcode_md5=e.getVCode(),i._postVoteData().done(function(e){"0"==e.no?(t.text("已投票"),t.addClass("act_voted_btn"),a.animate({"margin-top":"-10px"},300).animate({"margin-top":"0"},300).text(o+1)):"40"==e.no?i._showCaptchaDialog(e):"2130008"==e.no?i._showCanvaDialog():i._showErrorTip(e.no)})}),e.show()})},_showCanvaDialog:function(){var e=this,t=['<div id="poster_canva_dialog" class="canva_dlg_wrap">','<h3 class="canva_msg_title">你今天已经投过票了</h3>','<p class="canva_msg_cnt">如果想支持TA，可以转贴到其他吧帮忙拉票哦！</p>','<div class="canva_btn_group">','<a href="#" id="canva_repost_btn" '+$.tb.dataField(e.repostData)+' class="ui_btn ui_btn_m j_pic_act_repost"><span><em>转发拉票</em></span></a>','<a href="#" id="canva_cancel_btn" class="ui_btn ui_btn_sub_m"><span><em>下次再说</em></span></a>',"</div>","</div>"].join(""),a=new $.dialog({html:t,width:380,draggable:!0,closeable:!0,holderClassName:"pat-noTitle"});a.element.on("click","#canva_repost_btn",function(e){try{e.preventDefault(),a.hide()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/pic_act_vote/pic_act_vote.js",method:"",ln:147}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/pic_act_vote/pic_act_vote.js",linenum:147}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/pic_act_vote/pic_act_vote.js","linenum:147")}}).on("click","#canva_cancel_btn",function(e){try{e.preventDefault(),a.close()}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/pic_act_vote/pic_act_vote.js",method:"",ln:150}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/pic_act_vote/pic_act_vote.js",linenum:150}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/pic_act_vote/pic_act_vote.js","linenum:150")}})},_showErrorTip:function(e){var t="";switch(Number(e)){case 8:case 9:case 220012:t="你在本吧被封禁，暂时不能进行操作";break;case 220:t="你被吧主加入黑名单，暂时不能进行操作";break;case 3110003:t="同时有太多人在投票，请稍后再来~";break;default:t="服务器出错啦~请再试一次吧"}var a=new Array;a.push('<div style="text-align:center;color:#333333;font-size:14px;padding:10px 10px 0;">'+t+"</div>");new $.dialog({html:a.join(""),showTitle:!0,draggable:!1,width:300,height:40})}}});_.Module.define({path:"common/widget/Icons",requires:["IconCard","IconsBookView","IconsBookTip","IconsBookControl"],sub:{initial:function(a){this._buySlot=$(".j_icon_slot_buy");this._icon_book_wrap=$(".j_book_icon");if(!a){this.bindEvents()}},getPreIconHtml:function(e,d){var c=["\u8d34\u5427\u4f1a\u5458","\u8d34\u5427\u9ad8\u7ea7\u4f1a\u5458"];var f;var a="";var b=Math.round(new Date().getTime()/1000);if(Env.server_time>1396281600000&&Env.server_time<1396368000000&&d!=4){a='<div class="pre_icon_wrap pre_icon_wrap_theme1">';f=2;a+='<a class="icon_tbworld tbworld_lv'+f+'" href="/tbmall/home" target="_blank" title="'+c[f-1]+'"></a>';a+="</div>";return a}if(e&&e.level&&e.level["end_time"]>b){a='<div class="pre_icon_wrap pre_icon_wrap_theme1">';f=e.level.props_id;a+='<a class="icon_tbworld tbworld_lv'+f+'" href="/tbmall/home" target="_blank" title="'+c[f-1]+'"></a>';a+="</div>"}return a},_getIconsHtml:function(j,h){var h=h||1;var k=j.iconinfo;var b=PageUnit.load("icons_cfg");var p=50;var e="";if(k&&k.length>0){e='<div class="icon_wrap icon_wrap_theme1">';var q=null,o,m,a,f,l,d;for(var g=0;g<k.length;g++){q=k[g];l=b[q.name+"_"+q.value];o=q.sprite[q.value];if(!o){for(var n in q.sprite){if(q.sprite[n]){o=q.sprite[n];l=b[q.name+"_1"];break}return e}}m=o.split(",");a=m[0];f=m[1];d='style="background: url(http://static.tieba.baidu.com/tb/cms/com/icon/icon_sprite.png?stamp='+a+") no-repeat -"+f*p+"px  -"+(h-1)*p+'px;"';switch(q.name){case"meizhi_level":var c=q.value;c=c?c:0;if(c>=2){c-=2;e+="<a "+d+' class="maizhi_link" href="/p/'+q.meizhi_thread_id+'" target="_blank" title="\u8d34\u5427\u59b9\u7eb8\u8ba4\u8bc1"><span class="icon_meizhi meizhi_level_'+c+'"></span></a>'}break;case"is_member":e+="<a "+d+' target="_blank"  class=" icon_fanclub" ></a>';break;default:if(l){if(l[1]){e+="<a "+d+' target="_blank" href="'+l[1]+'" title="'+l[0]+'" locate="'+q.name+"_"+q.value+'"></a>'}else{e+="<span "+d+' title="'+l[0]+'" locate="'+q.name+"_"+q.value+'"></span>'}}}}e+="</div>";return e}},getIconsHtml:function(c,b,h){var b=b||1;var h=h?h:5;var e=c.new_iconinfo;var f=0;for(var a in e){f++}var d='<div class="icon_wrap  icon_wrap_theme1">';var i=0;if(!e){var k=c.iconinfo;if(k){var g=k[0];d+=this._getIconHtml(g,1)}}for(var l in e){var m=e[l];if(i==h){break}if($.isEmptyObject(m)){if(l=="1"){var k=c.iconinfo;if(!$.isEmptyObject(k)){var g=this._getReplaceIcon(k,e);if(!g){continue}d+=this._getIconHtml(g,1);i++}}}else{d+=this._getIconHtml(m,1);i++}}d+="</div>";return d},_getReplaceIcon:function(c,a){if($.isEmptyObject(a)){return c[0]}else{for(var b=0;b<c.length;b++){var d=c[b];if(!this._judgeIconInNewiconinfo(a,d)){return d}}return null}},_judgeIconInNewiconinfo:function(a,c){if($.isEmptyObject(a)){return false}if($.isEmptyObject(c)){return false}else{for(var b in a){var d=a[b];if(d&&d.name==c.name){return true}}return false}},_getIconHtml:function(l,g){var g=g||1;var b=PageUnit.load("icons_new_cfg");var m=50;var e="";var k,i,a,f,h,d;h=b[l.name+"_"+l.value];k=l.sprite[l.value];if(!k){for(var j in l.sprite){if(l.sprite[j]){k=l.sprite[j];h=b[l.name+"_1"];break}return e}}i=k.split(",");a=i[0];f=i[1];d='style="background: url(http://static.tieba.baidu.com/tb/cms/com/icon/icon_sprite.png?stamp='+a+") no-repeat -"+f*m+"px  -"+(g-1)*m+'px;"';switch(l.name){case"meizhi_level":var c=l.value;c=c?c:0;if(c>=2){c-=2;e+="<a "+d+' class="maizhi_link" href="/p/'+l.meizhi_thread_id+'" target="_blank" title="\u8d34\u5427\u59b9\u7eb8\u8ba4\u8bc1"><span class="icon_meizhi meizhi_level_'+c+'"></span></a>'}break;case"is_member":e+="<a "+d+' target="_blank"  class=" icon_fanclub" ></a>';break;default:if(h){if(h[1]){e+="<a "+d+' target="_blank" href="'+h[1]+'" title="'+h[0]+'" locate="'+l.name+"_"+l.value+'"></a>'}else{e+="<span "+d+' title="'+h[0]+'" locate="'+l.name+"_"+l.value+'"></span>'}}}return e},bindEvents:function(){var a=this}}});_.Module.define({path:"pb/widget/sub_list/postTail",requires:[],sub:{thread:{},power:{},initial:function(a){try{this.tailList=a.tailList,this.thread=PageData.thread,this.power=PageData.power,this.user=PageData.user,this.tailList=a.tailList,this.isLocal58=a.isLocal58}catch(s){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:s.message||s.description,path:"pb:widget/sub_list/post_tail.js",method:"",ln:18}),$.se({msg:(s.message||s.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/post_tail.js",linenum:18}),console.log("errormsg:"+(s.message||s.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/post_tail.js","linenum:18")}},getPostTailTpl:function(a,s){var t='<div class="core_reply_tail '+(a.is_saveface?"save_card_reply_tail":"")+'">';return this.isLocal58||(t+=1==a.post_no?'<ul class="p_reply"><li><a href="#" class="p_reply_first">回复</a></li></ul>':["<div class=\"j_lzl_r p_reply\" data-field=\"{'pid':'"+a.post_id+"','total_num':'"+a.comment_num+"'}\">",'<a href="#" class="lzl_link_unfold" style="display:'+(a.comment_num>0?"none":"")+';">回复',a.comment_num>0?"("+a.comment_num+")":"","</a>",'<span class="lzl_link_fold" style="display:'+(a.comment_num>0?"":"none")+'">收起回复</span>',"</div>"].join("")),t+='<ul class="p_tail">'+this.showFloorNumAndDate(a)+"</ul>",t+=this.isLocal58?'<ul class="p_58cp"><li><a class="j_58_cp" href="#" onclick="return false;">投诉</a></li></ul>':['<ul class="p_mtail">',this.getJubaoHtml(a,s,1),this.showTail(a),this.loadAdmin(a,s),"</ul>"].join(""),this.power.can_op_as_4thmgr&&(t+='<ul class="p_print_flower"><li data-uid="'+s.user_id+'" data-pid="'+a.post_id+'" class="print_reward j_print_reward">印花奖励 <span class="print_seperator">|</span></li></ul>'),t+='<ul class="p_props_tail props_appraise_wrap"></ul>',t+=this.showMallTail(a),t+="</div>"},showFloorNumAndDate:function(a){var s=a.post_no+"楼",t="";return t+="1"==this.thread.thread_type?'<li class="lzl_time">'+s+"</li>":"<li><span>"+s+"</span></li>",t+="<li><span>"+a.date+"</span></li>"},getJubaoHtml:function(a,s){var t="",l=this.thread,i=this.power,e=this.user;if(!(1==l.thread_type&&1==a.post_no||(i.can_mask_delete||i.lz_del)&&1!=a.post_no)){var n=i.can_vip_jubao?"vip举报":"举报";if(e.user_id!=s.user_id||a.is_anonym){var p="window.open('http://tieba.baidu.com/complaint/info?type={type}&cid=0&tid="+l.thread_id+"&pid="+a.post_id+"','newwindow', 'height=900, width=800, toolbar =no, menubar=no, scrollbars=yes, resizable=yes, location=no, status=no');return false;";t='<li class="j_jb_ele"><a href="#" onclick="'+p.replace("{type}",0)+'" class="complaint complaint-opened" data-checkun="un">'+n+'</a>&nbsp;|<span class="super_jubao" style="display:none"><a href="#" onclick="'+p.replace("{type}",1)+'">个人企业举报</a><a href="#" onclick="'+p.replace("{type}",2)+'">垃圾信息举报</a></span></li>'}else{var _="{'delete_mine':'1','index':'2','user_name':'"+s.user_name+"'}";n="删除",t='<li class="j_jb_ele"><a href="#" data-field='+_+' class="jb_in p_post_del_my post_del_href" data-checkun="un">'+n+"</a>&nbsp;|</li>"}}return t},showTail:function(a){var s=a.open_id,t=a.open_type,l=this.tailList,i={1:"1",4:"1",5:"1",6:"1",youliao:"1"};"wap"!==s||i.openType||"sharexc"==t||"webipad"==t||(t="phone");var e=s+"_"+t,n=l[e]?l[e]:[],p=n[0],_=n[1],o=n[2],r="";return p&&(r="xiangce"===t?'<li><span class="p_tail_txt">通过</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+p+'</a><span class="p_tail_txt">上传</span></li>':"shenqi"===t?'<li><span class="p_tail_txt">通过</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+p+'</a><span class="p_tail_txt">上传</span></li>':_&&o?'<li><span class="p_tail_txt">来自</span><span class="tip_bubble_con"></span><a data-tip="'+o+'" class="p_tail_wap" href="'+_+'" target="_blank">'+p+"</a></li>":_?'<li><span class="p_tail_txt">来自</span><a class="p_tail_wap" data-tip="'+o+'" href="'+_+'" target="_blank">'+p+"</a></li>":o?'<li><span class="p_tail_txt"></span><span class="tip_bubble_con"></span><a data-tip="'+o+'" class="p_tail_font"  >本楼含有'+p+"</a></li>":'<li><span class="p_tail_txt">来自</span>'+p+"</li>"),r},loadAdmin:function(a,s){var t=this.power,l=this.user,i="",e="&nbsp;|",t=this.power,l=this.user;return a.is_anonym?t.can_filter_ip&&(i+='<li><a class="p_post_ban_anonym" href="#">封</a>'+e+"</li>"):t.can_filter_id&&(i+='<li><a class="p_post_ban" href="#">封</a>'+e+"</li>"),1!=a.post_no&&(t.can_mask_delete||t.lz_del&&!l.forbidden.isForbid&&!l.is_black)&&(i+='<li><a class="p_post_del" href="#">删除</a>'+e+"</li>"),t.can_super&&!a.is_anonym&&(i+='<li><a class="p_tieba_manage" href="/f?ct=503316480&cm=6000&tn=bdUserManager&un='+encodeURIComponent(s.user_name)+'" target="_blank">贴吧管理</a>&nbsp;|</li>'),i},showMallTail:function(a){var s="",t={1019001:"1",1019002:"1",1019003:"1",1049001:"1",1049002:"1",1049003:"1"};return(a.is_bub||a.ptype&&7==a.ptype.length&&!t[a.ptype])&&(s='<a href="/tbmall/home" class="p_mall_tail" target="_blank"></a>'),s}}});
;_.Module.define({path:"pb/widget/ForumListV3/Lzl",requires:["pb/widget/Admin","common/widget/Icons"],sub:{editor_entry:null,_reach_limit:!1,_new_reply_num:0,initial:function(t){try{if(Page.checkLoadedModules("lzlHasLoad"))return;this.postJdom=t,this.wapperDOM=$("#j_p_postlist"),this.icons=this.use("common/widget/Icons"),this._admin=this.use("pb/widget/Admin");var e=$("#voice_data_container");this.voiceData={show:e.data("show"),showDesc:e.data("showdesc"),descContent:e.data("desccontent")},this._init()}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:36}),$.se({msg:(i.message||i.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:36}),console.log("errormsg:"+(i.message||i.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:36")}},_init:function(){this._showJubao(),this._bindEditorEntry(),this._bindFoldClick(),this._bindClick()},_showLzlJubao:function(t){if(!PageData.power.can_mask_delete&&!PageData.power.lz_del){var e,e=(PageData.power.can_vip_jubao?"vip举报":"举报",t.find("li.j_lzl_s_p"));e.each(function(){var t=$(this).find("a").filter(function(){return $(this).tbattr("username")}).tbattr("username"),e="";if(PageData.user.user_name==t)var i="删除",e=$.json.encode({delete_mine:1,user_name:t}),s='<a href="#" class="lzl_jb_in" data-checkun="un">'+i+"</a>&nbsp;|&nbsp;";else{var l=$(this).data("field");if(l)var i=PageData.power.can_vip_jubao?"vip举报":"举报",a="",s='<a href="#" class="lzl_jb_in" onclick="'+a.replace("{type}",0)+'">'+i+"</a>&nbsp;|&nbsp;";else s=""}$(this).find(".lzl_jb").html(s).tbattr("delete-data",e)})}},_bindFoldClick:function(){var t=this;this.wapperDOM.delegate(".lzl_link_unfold","click",function(e){try{var i=e.srcElement||e.target;return PageData.user.is_login?(t._loadLzlContent($(i)),t._unfoldLzl($(i))):TbCom.process("User","buildLoginFrame",null,null,null,"lzl_reply"),!1}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:103}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:103}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:103")}}).delegate(".lzl_link_fold","click",function(e){try{var i=e.srcElement||e.target;t._foldLzl($(i))}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:106}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:106}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:106")}})},_loadLzlContent:function(t){var e=t.parents(".l_post");LzlEditor.cur_optdom.postJdom=e;e.find(".j_lazy_lzl");LzlEditor.cur_optdom.jdom=e.find(".j_lzl_wrapper"),LzlEditor.cur_optdom.mainDom=LzlEditor.cur_optdom.jdom.find("div.j_lzl_container"),LzlEditor.cur_optdom.tailDom=LzlEditor.cur_optdom.jdom.find("div.j_lzl_r"),LzlEditor.cur_optdom.mainData=LzlEditor.cur_optdom.mainDom.getData(),LzlEditor.cur_optdom.tailData=LzlEditor.cur_optdom.tailDom.getData(),AntiAnswerLzl=new CaptchaReqCom({forumName:PageData.forum.name_url,forumId:PageData.forum.forum_id,tid:PageData.thread.thread_id,postType:"reply"})},_updateReplyNum:function(t){var e=0;if(t)e=t;else{this._new_reply_num++;var e=1*this.tailData.total_num+this._new_reply_num}this.tailDom.find("a.lzl_link_unfold").html("回复("+e+")")},_foldLzl:function(t){var e=t.parents(".l_post").find(".j_lzl_container");if(LzlEditor.cur_sec){var i=LzlEditor.cur_sec;i.find("span.close").click(),LzlEditor._s_p._ie6RelativeHack()}e.slideUp("normal",function(){t.hide(),t.parent().find("a.lzl_link_unfold").show()})},_unfoldLzl:function(t){var e=this;if(e.target=t,t.hide(),t.parent().find("span.lzl_link_fold").show(),LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid){var i="";LzlEditor._s_p._se&&(i=LzlEditor._s_p._se.getHtml()),LzlEditor._lzl=null,LzlEditor._hide(),LzlEditor.cur_sec.empty(),LzlEditor.init(e),LzlEditor._s_p._se&&LzlEditor._s_p._se.on("initcomplete",function(){LzlEditor._s_p._se.execCommand("inserthtml",i)}),LzlEditor._s_p._ie6RelativeHack(),CaptchaLzl&&!CaptchaLzl.needUpdate&&CaptchaLzl.reload(),LzlEditor.cur_sec.parent().show(),e.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover()})}else LzlEditor.init(e),LzlEditor._s_p._ie6RelativeHack(),LzlEditor.cur_sec.parent().show(),e.mainDom.slideDown("normal",function(){LzlEditor._s_p._ie6RelativeRecover()});$.stats.sendRequest("fr=tb0_forum&st_type=lzl_unfold")},_showJubao:function(){this.wapperDOM.delegate(".j_lzl_s_p","mouseover",function(){$(this).find(".lzl_jb").show()}).delegate(".j_lzl_s_p","mouseout",function(){$(this).find(".lzl_jb").hide()})},asyncImage:function(t,e){var i=t.find("img."+e);return 0==i.length?!1:void $.each(i,function(t,e){e.src=e.getAttribute("data-passive")||e.getAttribute("src")})},_bindClick:function(){var t=this;this.wapperDOM.delegate(".j_lzl_m","click",function(){try{if(PageData.user.is_login){var e=$(this).parents(".j_lzl_m_w");return t.asyncImage($("#"+$(this).tbattr("lzlid")),"forasync"),e.find(".lzl_post_hidden").slideDown(),e.find(".j_pager").show(),e.find(".lzl_more").hide(),$.stats.sendRequest("fr=tb0_forum&st_type=lzl_more"),!1}return _.Module.use("common/component/force_login",["","userbar","dialog","pb_lzl_more"]),!1}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:245}),$.se({msg:(i.message||i.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:245}),console.log("errormsg:"+(i.message||i.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:245")}}).delegate(".lzl_s_r","click",function(e){try{var i=e.target||e.srcElement;return PageData.user.is_login?(t._loadLzlContent($(i)),t._fastReply($(i))):TbCom.process("User","buildLoginFrame",null,null,null,"lzl_interact"),!1}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:254}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:254}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:254")}}).delegate(".j_pager a","click",function(){try{if($(this).parent().hasClass("j_pager")){window.global&&"function"==typeof window.global.shieldPost&&window.global.shieldPost();var e=$(this).parent().parent().getData(),i=$.tb.unescapeHTML($(this).tbattr("index"));if(!i){var s=$.tb.unescapeHTML($(this).tbattr("href")).split("#");i=parseInt(s[1])}var l="fr=tb0_forum&st_type=lzl_pager&pn="+i;return i==e.total_page&&(l+="&st_value=last"),$.stats.sendRequest(l),t.mainDom=$(this).parents(".j_lzl_container"),t.mainData=t.mainDom.getData(),t.postJdom=$(this).parents(".l_post"),t._turnPage(t,i,$(this).parents(".core_reply_content")),!1}}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:278}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:278}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:278")}})},_bindEditorEntry:function(){var t=this;t.wapperDOM.delegate("p.j_lzl_p","click",function(){try{return t.editor_entry=$(this),PageData.user.is_login?(LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid&&"none"!=LzlEditor.cur_sec.css("display")?LzlEditor._s_p._getHtml()?LzlEditor._s_p._se.setHtml(""):LzlEditor._hide():(t._loadLzlContent($(this)),LzlEditor.init(t)),!1):(TbCom.process("User","buildLoginFrame",null,null,null,"too_reply"),!1)}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/sub_list/sub_list_main.js",method:"",ln:303}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_main.js",linenum:303}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_main.js","linenum:303")}})},_fastReply:function(t){var e=t.parents(".j_lzl_s_p"),i=e.getData(),s="回复&nbsp;"+i.user_name+"&nbsp;:";LzlEditor._lzl&&LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid?LzlEditor._s_p._se&&(LzlEditor._s_p._se.empty(),LzlEditor._show(),LzlEditor._s_p._se.execCommand("inserthtml",s)):(LzlEditor.init(this),LzlEditor._s_p._se&&(LzlEditor._s_p._se.empty(),LzlEditor._s_p._se.on("initcomplete",function(){LzlEditor._s_p._se.execCommand("inserthtml",s)}))),LzlEditor._s_p._setData(i),$.stats.sendRequest("fr=tb0_forum&st_type=lzl_interact")},_turnPage:function(t,e,i){var s=new Date;s=s.getTime(),$.ajax({url:"/p/comment",data:{tid:PageData.thread.thread_id,pid:t.mainData.pid,pn:e,t:s},dataType:"html",success:function(e){t._ajaxSucc(e,i),$.tb.location.setHash("noExistHash"),$.tb.location.setHash(t.mainData.pid+"l")},error:function(e){t._ajaxErr(e)}})},_ajaxSucc:function(t,e){var i=this;if(t&&t.length>200){var s=$(t);s.find(".voice_player .time").each(function(){$(window).trigger("initvoicelength",this)}),1!=this.voiceData.show?s.find(".voice_player").html("[语音]"):1!=this.voiceData.showDesc?s.find(".voice_player_desc").remove():s.find(".voice_player_desc").html(this.voiceData.descContent),this.mainDom.find("ul.j_lzl_m_w").html(s),i._showLzlJubao(e),this._admin.loadLzlAdmin(e),s.find(".lzl_cnt").each(function(){var t=$(this),e=t.getData().iconArr,s=t.getData().free_flag,l=e?i.icons.getPreIconHtml(e,s):"";t.prepend(l)}),$.browser.msie&&$.browser.version<=7&&this.postJdom.tbattr("class",$.tb.unescapeHTML(this.postJdom.tbattr("class")))}else{var l='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;宋体&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;黑体&quot;;">服务器很忙</td></tr></tbody></table>请刷新页面，稍后再试</div>',a=$.dialog.alert(l,{width:410,height:95,title:"错误提示"});a.bind("onclose",function(){return!0})}},_ajaxErr:function(){var t='<div style="margin: 0px 30px 0px 30px;font-size:14px;line-height:20px;text-align:left;font-family: &quot;宋体&quot;;"><table style="width:90%"><tbody><tr><td width="60"><img style="border:none;" src="http://tb2.bdstatic.com/tb/img/errorFace.gif"></td><td valign="middle" style="font-size:20px;line-height:22px;font-family: &quot;黑体&quot;;">服务器很忙</td></tr></tbody></table>请刷新页面，稍后再试</div>',e=$.dialog.alert(t,{width:410,height:95,title:"错误提示"});e.bind("onclose",function(){return!0})}}});
;var LzlEditor={_lzl:null,default_options:{autoFocus:!0,autoEnable:!0,height:"40px",width:"527px",maxHeight:"40",wrapperClassName:"lzl_simple_wrapper",enableRefer:!0},options:{},cur_sec:null,cur_optdom:{},_s_p:null,init:function(i,l){LzlEditor.options={},$.extend(LzlEditor.options,LzlEditor.default_options),l&&$.extend(LzlEditor.options,l),LzlEditor._buildEditor(i)},_buildEditor:function(i){if(LzlEditor._lzl){if(LzlEditor._lzl.mainData.pid==LzlEditor.cur_optdom.mainData.pid)return LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),LzlEditor.cur_sec.show(),LzlEditor._s_p._se&&LzlEditor._s_p._se.focus(),!1;var l=LzlEditor.cur_sec;l.find("span.close").click();var t=l.find(".tb-editor-editarea");t[0]&&t.html().length>0&&l.bindData({txt:t.html()}),LzlEditor._hide(),LzlEditor.cur_sec.empty(),LzlEditor._s_p=null;var o=LzlEditor._lzl.mainDom.find("li.j_lzl_s_p");0==o.length&&(LzlEditor._lzl.tailDom.find(".lzl_link_fold").hide(),LzlEditor._lzl.tailDom.find(".lzl_link_unfold").show(),LzlEditor._lzl.mainDom.hide())}LzlEditor._lzl=i,$.extend(LzlEditor._lzl,LzlEditor.cur_optdom);var l=i.jdom.find("div.j_lzl_e_c"),_=PageData.thread.topic;LzlEditor.cur_sec=l;var e=$.extend({container:l[0],uid:PageData.user.user_id},LzlEditor.options);LzlEditor._lzl._reach_limit=LzlEditor._limitCheck()||LzlEditor._lzl._reach_limit?!0:!1;var r={_can_post:PageData.power.can_post,_forum_type:PageData.forum_type,_no_un:PageData.user.no_un,_is_block:PageData.user.forbidden.isForbid?!0:!1,_reach_limit:LzlEditor._lzl._reach_limit,_login:PageData.user.is_login,_thread_topic_type:_.is_topic?"1":"0",_thread_topic_subtype:_.is_topic&&"2"==_.topic_type?"3":"0",data:LzlEditor._lzl.mainData,tpl_id:"j_simpleeditor_tpl"},d=new SimplePostor(r,e);d.bind("toTop",function(){$(window).scrollTop(0)},!0),d.bind("onsuccess",function(){LzlPostor._appendNew()},!0),d.bind("onclose",function(){LzlEditor._lzl._updateReplyNum(2e4),LzlEditor._lzl._reach_limit=!0,LzlEditor.init(LzlEditor._lzl)},!0),d.bind("hide",function(){LzlEditor._hide()},!0),LzlEditor._s_p=d;var n=l.getData();if(null!=n){var t=l.find(".tb-editor-editarea");t.html(n.txt)}LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),l.show(),l.parent().find("input.j_lzl_e_f_h").show().focus().hide()},_limitCheck:function(){var i=!1,l=LzlEditor._lzl.jdom.find("li.j_lzl_l_p");if(0==l.length)return i;var t=l.getData();return t.total_num>=2e4&&(i=!0),i},_hide:function(){LzlEditor.cur_sec&&(LzlEditor.cur_sec.find("span.close").click(),LzlEditor.cur_sec.hide()),LzlEditor._lzl&&LzlEditor._lzl.editor_entry&&LzlEditor._lzl.editor_entry.show()},_show:function(){LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").length>0&&1==$.tb.Storage.get("VoicePostorAdClosed")&&LzlEditor.cur_sec.find(".j_lzl_p_sv .new_icon").remove(),LzlEditor.cur_sec&&LzlEditor.cur_sec.show()}};
;var LzlPostor={_appendNew:function(){var e=LzlEditor._lzl.jdom.find("ul.j_lzl_m_w");if(0==e.length){var a=LzlEditor._lzl.jdom.find("div.j_lzl_c_b_a");a.prepend($('<div class="lzl_big_splitline"></div>')),e=$('<ul class="j_lzl_m_w"></ul>'),a.prepend(e)}e.show();var t=$('<li class="lzl_single_post j_lzl_s_p"></li>');t.bindData({user_name:PageData.user.user_name});var l=$.tb.dataField({un:PageData.user.user_name}),i=' username="'+PageData.user.user_name+'"'+l,s="/home/main/?un="+encodeURIComponent(PageData.user.user_name)+"&fr=pb&ie=utf-8",r="";r+='<div class="lzl_p_p">',r+='  <a class="j_user_card" href="'+s+'" '+i+'><img src="http://tb.himg.baidu.com/sys/portrait/item/'+PageData.user.portrait+'" style="visibility:hidden;" onload="Page.resizePic(this, 32, 32, true);"/></a>',r+="</div>",r+='<div class="lzl_cnt">',_.Module.use("common/widget/Icons",null,function(e){r+=e.getPreIconHtml(PageData.user.mParr_props,PageData.user.free_flag)}),r+='  <a class="at j_user_card" href="'+s+'" '+i+">"+(PageData.user.is_official?PageData.user.user_nickname:PageData.user.user_name)+"</a>",r+=PageData.user.is_official?'<img style="vertical-align: middle;margin-top: -3px;" src="http://tb2.bdstatic.com/tb/img/itieba_vip.gif" title="贴吧官方认证" width="11" height="18" class="verified_icon">':"",r+='   :<span class="lzl_content_main">',r+=LzlEditor._s_p._getHtml(),r+="    </span>",r+='  <div class="lzl_content_reply">',r+='    <span class="lzl_time">'+LzlPostor.getCurrentTime()+"</span>",r+='    <a href="#" class="lzl_s_r">回复</a>',r+="  </div>",r+="</div>",t.html(r),t.insertBefore(e.find("li.j_lzl_l_p")),LzlEditor._lzl._updateReplyNum()},getCurrentTime:function(){function e(e){return 10>1*e?"0"+e:e}var a=new Date,t="";return t+=a.getFullYear()+"-",t+=a.getMonth()+1+"-",t+=a.getDate()+"&nbsp;",t+=e(a.getHours())+":",t+=e(a.getMinutes())}},AntiAnswerLzl,CaptchaLzl;
;_.Module.define({path:"pb/widget/sub_list/subListTotal",requires:["common/widget/UserHead","common/widget/MemberApi","pb/widget/sub_list/postTail","common/component/JsPager"],sub:{initial:function(e){try{this._isAdThread=e.isAdThread,this._searchCid=e.searchCid,this._searchPic=e.searchPid,this._userList=e.userList,this._tailList=e.tailList,this._voiceControl=e.voiceControl,this._commentList=e.commentList,this._voiceDescControl=e.voiceDescControl,this._userHead=this.use("common/widget/UserHead"),this._memberApi=this.use("common/widget/MemberApi"),this._postTail=this.use("pb/widget/sub_list/postTail",{tailList:e.tailList,isLocal58:e.isLocal58})}catch(t){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:t.message||t.description,path:"pb:widget/sub_list/sub_list_total.js",method:"",ln:30}),$.se({msg:(t.message||t.description).replace(/\s+/g,"-"),locator:"pb:widget/sub_list/sub_list_total.js",linenum:30}),console.log("errormsg:"+(t.message||t.description).replace(/\s+/g,"-"),"locator:pb:widget/sub_list/sub_list_total.js","linenum:30")}},showLzlPost:function(e){var t=this,e=$(e),s=e.closest(".l_post").getData();e.html(t._getAnchor(s.content)+t._postTail.getPostTailTpl(s.content,s.author)+t._getSubContent(s.content)),e.removeAttr("style")},_getAnchor:function(){var e="";return this._isAdThread&&(e+='<a href="http://yingxiao.baidu.com/zhuanti/103.html?id=13" class="d_tuiguang" target="_blank"></a>'),e},_getSubContent:function(e){var t=e.comment_num>0?"":"none";e.page={total_page:Math.floor(e.comment_num/10)+1,cur_page:1};var s=["<div class=\"j_lzl_container core_reply_wrapper\" data-field=\"{'pid':'"+e.post_id+"','floor_num':'"+e.post_no+'\'}" style="display:'+t+'">','<div class="core_reply_border_top"></div>','<div class="j_lzl_c_b_a core_reply_content">','<ul class="j_lzl_m_w" style="display:'+t+'">',this._getSubPostList(e),"</ul>",'<div class="lzl_editor_container j_lzl_e_c lzl_editor_container_s" style="display:none;"></div>','<input type="text" class="j_lzl_e_f_h" style="display:none;" />',"</div>",'<div class="core_reply_border_bottom"></div>',"</div>"].join("");return s},_getSubPostList:function(e){for(var t,s,a="",i=this._commentList[e.post_id],l="",n=0;n<i.length;n++){if(t=i[n],s=this._userList[t.user_id]||{},this._searchPid!=e.post_id&&5==n){var _="lzl_hidden_"+e.post_index;l+='<ul class="lzl_post_hidden" id="'+_+'">',a=!0}s.nickname=s.is_verify||s.is_official?s.nickname:s.user_name,l+=['<li class="lzl_single_post j_lzl_s_p '+(0==n?"first_no_border":"")+"\" data-field=\"{'pid':'"+e.post_id+"','spid':'"+t.comment_id+"','user_name':'"+s.user_name+"','portrait':'"+s.portrait+"'}\" >",this._face_link(s),'<div class="lzl_cnt">',this._getPreIconHtml(s),'<a class="at j_user_card '+this._memberApi.getMemberNameClass(s.mParr_props)+"\" data-field=\"{'un':'"+s.user_name+'\'}" alog-group="p_author" target="_blank" href="/home/main?un='+s.user_name+'&fr=pb" username="'+s.user_name+'">'+s.nickname+"</a>","1"==s.is_verify||"1"==s.is_official?'<img style="vertical-align: middle;margin-top: -3px;" src="http://tb2.bdstatic.com/tb/img/itieba_vip.gif" title="贴吧实名认证" width="11" height="18" class="verified_icon" />':"",':&nbsp;<span class="lzl_content_main">',this._searchCid==t.comment_id?"<b>"+t.content+"</b>":t.content,this._getVoiceHtml(t),"</span>",this._getReplyHtml(t,s),"</div>","</li>"].join("")}return l+=a?"</ul>":"",l+=this._getLzlPager(e,_),delete this._commentList[e.post_id],l},_getLzlPager:function(e,t){var s='<li class="lzl_li_pager j_lzl_l_p lzl_li_pager_s" data-field="{total_num:'+e.comment_num+",total_page:"+e.page.total_page+'}" >';return s+='<p class="j_lzl_p"><a href="##">我也说一句</a></p>',e.comment_num>5?(s+='<p class="lzl_more">',s+="<span>还有"+(e.comment_num-5)+"条回复，</span>",s+='<a href="#" class="j_lzl_m" lzlid="'+(t?t:"")+'">点击查看</a>',s+="</p>",s+='<p class="j_pager l_pager pager_theme_2 lzl_pager" style="display:none">',e.comment_num>10?(this._pager=this.use("common/component/JsPager",{current:1,total:e.page.total_page,mode:1,url:"#",isHtml:!0,classname:{current:"tP"}}),s+=this._pager._render()):s+="&nbsp",s+="</p>"):s+="<p>&nbsp;</p>",s+="</li>"},_face_link:function(e){var t="/home/main?un="+e.user_name+"&fr=pb",s='src="'+this._userHead.getHeadUrl(e)+'"',a="<img "+s+"/>";return $html="<a data-field=\"{'un':'"+e.user_name+'\'}" target="_blank" class="j_user_card lzl_p_p" href="'+t+'" username="'+e.user_name+'">'+a+"</a>"},_getForbiddenTip:function(e){var t="";return e.exist_forbidden_tip&&(t='<p class="lzl_thread_forbidden_tip j_lzl_thread_forbidden_tip" >本楼包含部分广告等违规内容的回复，已经被屏蔽，暂不可见。<span class="lzl_forbidden_tip_close j_lzl_forbidden_tip_close">×</span></p>'),t},_getVoiceHtml:function(e){var t,s,a=this,i="";return e.ptype&&("1"==a._voiceControl?(t=e.during_time?Math.floor(e.during_time/60):"0",s=e.during_time?e.during_time%60:"0",i=['<br/><div class="voice_player voice_player_mini voice_player_lzl">','<a href="#" class="voice_player_inner">','<span class="before">&nbsp;</span><span class="middle"><span class="speaker speaker_animate">&nbsp;</span>','<span class="time">',t>0?'<span class="minute">'+t+"</span>&#039;":"",s>0||t>0?'<span class="second">'+s+"</span>&quot;":"","</span>","</span>",'<span class="after">&nbsp;</span>',"</a>","</div>"].join("")):i="<br />[语音]"),i},_getReplyHtml:function(e,t){var s="",a=PageData.power,i=PageData.user;return s+='<div class="lzl_content_reply"><span class="lzl_jb"  style="display:none">',a.can_mask_delete||a.lzl_del||(s+=t.user_name==i.user_name?"<a href=\"#\" data-field=\"{'delete_mine':'1','user_name':'"+t.user_name+'\'}" class="lzl_jb_in" >删除</a>&nbsp;|':"<a href=\"#\" data-field=\"{'delete_mine':'0','user_name':'"+t.user_name+'\'}" class="lzl_jb_in" >'+(a.can_vip_jubao?"vip举报":"举报")+"</a>&nbsp;|&nbsp;"),s+='</span><span class="lzl_op_list j_lzl_o_l">',s+=this._loadLzlAdmin(t,a,i),s+='</span><span class="lzl_time">'+this._getTime(e.now_time)+'</span><a href="#" class="lzl_s_r">回复</a>',s+="</div>"},_loadLzlAdmin:function(e,t,s){var a="",i="&nbsp;|&nbsp;";return(t.can_filter_ip||t.can_filter_id)&&(a+='<a href="#" class="j_lzl_ban">封</a>'+i),(t.can_mask_delete||t.lz_del&&!s.forbidden.isForbid&&!s.is_black)&&(a+='<a href="#" class="j_lzl_del">删除</a>'+i),t.can_super&&(a+='<a href="/f?ct=503316480&cm=6000&tn=bdUserManager&un="'+e.user_name+' class="j_lzl_manage p_tieba_manage" target="_blank">贴吧管理</a>'+i),a},_getTime:function(e){function t(e){return 10>1*e?"0"+e:e}var s;s=void 0==e?new Date:new Date(1e3*e);var a="";return a+=s.getFullYear()+"-",a+=s.getMonth()+1+"-",a+=s.getDate()+"&nbsp;",a+=t(s.getHours())+":",a+=t(s.getMinutes())},_getPreIconHtml:function(e){var t=e.mParr_props;if(null==t)return"";var s={1:"贴吧会员",2:"高级贴吧会员"},a="";return t.level&&t.level.end_time>Env.server_time/1e3&&(a='<div class="pre_icon_wrap pre_icon_wrap_theme1 lzl_name_icon">',a+='<a class="icon_tbworld tbworld_lv'+t.level.props_id+'" href="/tbmall/tshow" data-field="\'user_id\':\''+e.user_id+'\'" target="_blank" title="'+s[t.level.props_id]+'"></a>',a+="</div>"),a}}});_.Module.define({path:"tbmall/widget/TshowJoinVipLayer",sub:{_body:null,_agreeKnown:!0,_dataMap:{},_badgeLv:"month_v2",_monthNum:3,_use_left_bean:0,_all_scores:0,_user_scores:0,_packet_id:0,_tbs:"",_price:"0",_dialog:null,_badge1_tpl:['	<div class=" tshow_join_vip_block_btn tshow_join_vip_badge_btn "  data-id="month_v1">','<div class="tshow_join_vip_block_btn_info">','<img class="tshow_join_vip_badge_icon" src="http://tieba.baidu.com/tb/cms/tbmall/jzxz_icon.png" /><span class="badge_lv1 ">贴吧会员</span></div>',"</div>"].join(""),_badge2_tpl:['<div class="tshow_join_vip_block_btn tshow_join_vip_badge_btn badge_lv2  tshow_join_vip_block_btn_active "  data-id="month_v2">','<div class="tshow_join_vip_block_btn_info">','<img class="tshow_join_vip_badge_icon" src="http://tieba.baidu.com/tb/cms/tbmall/wxxz_icon.png" /><span class="badge_lv1 ">高级贴吧会员</span>',"</div>",'<div class="tshow_join_vip_recommend_tip"></div>',"</div>"].join(""),initial:function(){this._tbs=PageData.tbs,this._bindEvent()},getMemberDialog:function(){return PageData.user.is_login?(this._flowRateTest(),!1):(_.Module.use("common/widget/LoginDialog"),!1)},_bindEvent:function(){var _=this;$("body").off("click.j_join_vip"),$("body").delegate(".j_tbmall_join_vip_btn","click.j_join_vip",function(){return _.getMemberDialog(),!1}).delegate(".tshow_join_vip_badge_btn","click.j_join_vip",function(){_._badgeBtnClickAction(this)}).delegate(".tshow_join_vip_month_count_btn","click.j_join_vip",function(){_._monthBtnClickAction(this)}).delegate(".j_tshow_join_vip_use_leave","click.j_join_vip",function(){_._useLeftBtnClickAction(this)}).delegate("#j_agree_known","click",function(){_._agreeKnown=$(this)[0].checked,1==_._agreeKnown?$(".tshow_join_vip_open_btn_disable").removeClass("tshow_join_vip_open_btn_disable").addClass("tshow_join_vip_open_btn"):$(".tshow_join_vip_open_btn").removeClass("tshow_join_vip_open_btn").addClass("tshow_join_vip_open_btn_disable")}).delegate(".tshow_join_vip_open_btn_content .tshow_join_vip_open_btn","click.j_join_vip",function(){_._getOrderId()}).delegate(".tshow_join_vip_j_charge_success_btn","click.j_join_vip",function(){_._dialog.close(),_._confirmChargeState()}).delegate(".tshow_join_vip_j_charge_fail_btn","click.j_join_vip",function(){_._dialog.close()})},_badgeBtnClickAction:function(_){_=$(_),$(".tshow_join_vip_badge_btn").removeClass("tshow_join_vip_block_btn_active"),this._badgeLv=_.tbattr("data-id"),$(_).addClass("tshow_join_vip_block_btn_active");var t=this;this._getBadgeInfo("need_bean",function(_){t._updatePriceAction(_)})},_monthBtnClickAction:function(_){_=$(_),$(".tshow_join_vip_month_count_btn").removeClass("tshow_join_vip_block_btn_active"),this._monthNum=_.tbattr("data-id"),$(_).addClass("tshow_join_vip_block_btn_active");var t=this;this._getBadgeInfo("need_bean",function(_){t._updatePriceAction(_)})},_useLeftBtnClickAction:function(){var _=this;_._use_left_bean=$(".tshow_join_vip_use_leave")[0].checked?1:0,this._getBadgeInfo("need_bean",function(t){_._updatePriceAction(t)})},_updatePriceAction:function(_){this._price=_,$(".j_cost_total").html(_);var t;this._use_left_bean=$(".tshow_join_vip_use_leave")[0].checked?1:0,t=this._use_left_bean?Math.max(0,_-this._dataMap.use_scores):_,$(".tshow_join_vip_red").html(Math.ceil(t/1e3))},_initDataMap:function(){var _=this;$.get("/tbmall/bwstshow",function(t){if(0==t.no){_._dataMap=t.data;var i=$(".j_month_content"),o=$(".j_badge_content");$(".j_tshow_join_vip_block_use_scores").html(_._dataMap.use_scores),$(".j_tshow_join_vip_block_all_scores").html(_._dataMap.all_scores);for(var n=0;n<t.data.month_v1.length;n++)i.append('	<div class="tshow_join_vip_block_btn tshow_join_vip_month_count_btn '+(3==n?"tshow_join_vip_block_btn_active":"")+'"  data-id="'+t.data.month_v1[n].month_num+'" >'+t.data.month_v1[n].month_num+"个月"+(3==n?'<div class="tshow_join_vip_recommend_tip"></div>':"")+"</div>");_._dataMap.user.Parr_props&&_._dataMap.user.Parr_props.level&&2==_._dataMap.user.Parr_props.level.props_id&&1e3*_._dataMap.user.Parr_props.level.end_time>(new Date).getTime()||o.append(_._badge1_tpl),o.append(_._badge2_tpl),_._use_left_bean=$(".badge_lv2").trigger("click"),$(".tshow_join_vip_month_count_btn").eq(3).trigger("click")}else _._showDialog("错误提示","获取信息失败",200)})},_build:function(){var _=['<div id="tshow_join_vip_wrapper">','<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title">开通会员类型：</div>','<div class="tshow_join_vip_block_content j_badge_content">',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title">开通时长：</div>','<div class="tshow_join_vip_block_content j_month_content">',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom"></div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<span class="contsigncard_tip"><span class="red_sign">*</span>开通12个月高级会员赠送<span class="orange_txt">连续签到卡3张</span></span>',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom">总价：</div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<div class="tshow_join_vip_block_info"><span class="j_cost_total tshow_cost_total">360000</span>T豆 <input type="checkbox" class="tshow_join_vip_use_leave j_tshow_join_vip_use_leave" name="use_leave" /><span class="tshow_join_vip_block_tip" >使用T豆余额(可用余额<span class="j_tshow_join_vip_block_use_scores" >加载中..</span> 总余额<span  class="j_tshow_join_vip_block_all_scores" >加载中..</span>)</span></div >',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom">需要花费：</div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<div class="tshow_join_vip_block_info"><span class="tshow_join_vip_info"><span class="tshow_join_vip_red">360</span>百度点券(1点券 = 1000T豆 = 1元人民币)</span></div >',"</div>","</div>",'<div class="tshow_join_vip_block tshow_join_vip_open_btn_section">','<div class="tshow_join_vip_open_btn_content clearfix">','<div class="tshow_join_vip_open_btn"><i  class="tshow_join_vip_open_btn_left"></i>立即开通</div>','<div class="tshow_join_vip_open_btn_tip"><input type="checkbox" checked id="j_agree_known" name="agree" /><a href="/tb/tdouprecautions.html" target="_blank">同意T豆使用须知</a></div>',"</div>","</div>","</div>",'<div class="tshow_cont_sign_intro"><div class="question"><span class="question-icon"></span>什么是连续签到卡</div> <div class="answer">使用连续签到卡,可把某个吧所有的签到天数连续在一起!</div></div> '].join("");this._body=$(_),this._showDialog("开通贴吧会员",this._body,650)},_chargingDialog:function(){var _="<p class='tshow_join_vip_dialog_content'>请在新打开的页面上完成开通会员的支付操作</p><p class='tshow_join_vip_dialog_second_content'>支付完成前&nbsp;&nbsp;&nbsp;&nbsp;请勿关闭窗口</p><div class='tshow_join_vip_dialog_btn_wrap'><a class='tshow_join_vip_charge_btns tshow_join_vip_j_charge_success_btn'>支付成功</a><a class='tshow_join_vip_charge_btns tshow_join_vip_j_charge_fail_btn'>支付失败</a></div>";this._showDialog("充值T豆",_,500)},_getBadgeInfo:function(_,t){for(var i=0;i<this._dataMap[this._badgeLv].length;i++)if(this._dataMap[this._badgeLv][i].month_num==this._monthNum){if(!t)return this._dataMap[this._badgeLv][i][_];t(this._dataMap[this._badgeLv][i][_]);break}},_getOrderId:function(){var _=this,t=_._price<=_._dataMap.all_scores&&_._use_left_bean;if(this._dialog.close(),!t){this._chargingDialog();var i=window.open("about:blank")}this._getBadgeInfo("packet_id",function(t){_._packet_id=t});var o={ie:"utf-8",tbs:this._tbs,packet_id:this._packet_id};o.use_left_bean=_._use_left_bean,$.ajax({type:"POST",url:"/tbmall/buytshow",dataType:"json",data:o,success:function(o){switch(o.no){case 0:!t&&o.data.dubi_url?(_._order_id=o.data.order_id,i.location=o.data.dubi_url):_._bubble=_._showBubble("<span class='tshow_join_vip_charge_btns success_bubble_icon' ></span><span class='small_bubble_content'>已成功开通会员",1500,"canClose",function(){$.tb.location.reload()});break;default:_._showDialog("操作失败",o.no,200)}}})},_confirmChargeState:function(){var _=this,t=6;this._bubble=this._showBubble("正在验证支付中，请稍候"+t+"秒...");var i=setInterval(function(){if(t--,_._bubble.html("正在验证支付中，请稍候"+t+"秒..."),t%2==0){var o={ie:"utf-8",tbs:_._tbs,order_id:_._order_id};$.ajax({type:"POST",url:"/tbmall/checkorder",dataType:"json",data:o,success:function(o){switch(o.no){case 0:1e4==o.data.result_code&&(_._closeBubble(_._bubble),_._bubble=_._showBubble("<span class='tshow_join_vip_charge_btns success_bubble_icon' ></span><span class='small_bubble_content'>已成功开通会员",1500,"canClose",function(){$.tb.location.reload()}),clearInterval(i)),0>=t&&(_._closeBubble(_._bubble),_._bubble=_._showBubble("<span class='tshow_join_vip_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>抱歉,开通会员没有成功</span>",1500,"canClose"),clearInterval(i));break;case 1:case 2:default:0>=t&&(_._closeBubble(_._bubble),_._bubble=_._showBubble("<span class='tshow_join_vip_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>抱歉,系统出现异常,请刷新页面查看交易记录</span>",1500,"canClose"),clearInterval(i))}},error:function(){_._bubble.html("<p>未知错误</p>"),clearInterval(i)}})}0>=t&&clearInterval(i)},1e3)},_showDialog:function(_,t,i){this._dialog=new $.dialog({html:t,title:_,width:i,hideOnclose:!1,draggable:!1,closeable:!0})},_showBubble:function(_,t,i,o){var n=$("<div class='small_bubble_block'  ></div>");return n.append(_),$("body").append(n),n.css({left:$(window).width()/2-n.width()/2,top:$(window).height()/2}),$(window).resize(function(){n.css({left:$(window).width()/2-n.width()/2,top:$(window).height()/2})}),i&&n.click(function(){$(this).remove()}),t?void this._closeBubble(n,t,o):n},_closeBubble:function(_,t,i){t&&t>0?setTimeout(function(){_.fadeOut("normal",function(){_.remove(),"function"==typeof i&&i()})},t):_.fadeOut("normal",function(){_.remove()})},_flowRateTest:function(){var _=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=1",function(t){t.data&&(_.location.href=t.data)})}}});_.Module.define({path:"pb/widget/spreadadPb",sub:{initial:function(e,a,d){try{var o=$("#spreadad_"+e),s=o.data("good_id"),r=o.data("task_id"),t=o.data("good_id");o.on("click","a",function(a){try{var d=$($.event.fix(a).currentTarget),o="pb_spreadad_floor_"+e+"_"+s;$.cookie(o,1,{expires:1});var p=d.data("locate"),i={obj_type:"分发",obj_name:r,obj_url:t};$.stats.track(p,"分发系统一期",i)}catch(a){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:a.message||a.description,path:"pb:widget/spreadad_pb/spreadad_pb.js",method:"",ln:29}),$.se({msg:(a.message||a.description).replace(/\s+/g,"-"),locator:"pb:widget/spreadad_pb/spreadad_pb.js",linenum:29}),console.log("errormsg:"+(a.message||a.description).replace(/\s+/g,"-"),"locator:pb:widget/spreadad_pb/spreadad_pb.js","linenum:29")}}),$.stats.track("pb_推广位","分发系统一期","pb","展现",{obj_type:"分发",obj_name:r,obj_url:t});var p=function(){var e=o.find(".spreadad_iframe"),a=e.width(),d=e.height(),s=e.data("src")+"&barname="+window.encodeURIComponent(window.PageData.forum.forum_name)+"&barcid="+window.encodeURIComponent(window.PageData.forum.first_class+"^"+window.PageData.forum.second_class);e.append($('<iframe src="'+s+'" style="width:'+a+"px;height:"+d+'px" scrolling="no" frameborder="0"></iframe>'))};a&&(d?p():$(window).on("load",p))}catch(i){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:i.message||i.description,path:"pb:widget/spreadad_pb/spreadad_pb.js",method:"",ln:49}),$.se({msg:(i.message||i.description).replace(/\s+/g,"-"),locator:"pb:widget/spreadad_pb/spreadad_pb.js",linenum:49}),console.log("errormsg:"+(i.message||i.description).replace(/\s+/g,"-"),"locator:pb:widget/spreadad_pb/spreadad_pb.js","linenum:49")}}}});_.Module.define({path:"comforum/widget/wangmengFeedAd",sub:{initial:function(e){try{this.data=e;var a=this.data.id;$.JsLoadManager.use(["http://cbjs.baidu.com/js/m.js"],function(){var e=PageData.forum?PageData.forum.forum_id:0;BAIDU_CLB_addOrientation("tbid",e+""),BAIDU_CLB_fillSlotAsync(a,"BAIDU_CLB_AD_IFRAME_"+a)})}catch(n){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:n.message||n.description,path:"frs:widget/wangmeng_feed_ad/wangmeng_feed_ad.js",method:"",ln:16}),$.se({msg:(n.message||n.description).replace(/\s+/g,"-"),locator:"frs:widget/wangmeng_feed_ad/wangmeng_feed_ad.js",linenum:16}),console.log("errormsg:"+(n.message||n.description).replace(/\s+/g,"-"),"locator:frs:widget/wangmeng_feed_ad/wangmeng_feed_ad.js","linenum:16")}}}});_.Module.define({path:"pb/widget/related_threads_inside",sub:{initial:function(){try{this.$DOM=$("#related_threads_inside"),this._bindEvents()}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/related_threads_inside/related_threads_inside.js",method:"",ln:12}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/related_threads_inside/related_threads_inside.js",linenum:12}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/related_threads_inside/related_threads_inside.js","linenum:12")}},_bindEvents:function(){this.$DOM.on("click",".related_thread_link",function(){try{$.stats.sendRequest("fr=tb0_forum&st_mod=pb&st_type=related_threads_click&st_value=thread")}catch(e){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:e.message||e.description,path:"pb:widget/related_threads_inside/related_threads_inside.js",method:"",ln:16}),$.se({msg:(e.message||e.description).replace(/\s+/g,"-"),locator:"pb:widget/related_threads_inside/related_threads_inside.js",linenum:16}),console.log("errormsg:"+(e.message||e.description).replace(/\s+/g,"-"),"locator:pb:widget/related_threads_inside/related_threads_inside.js","linenum:16")}})}}});