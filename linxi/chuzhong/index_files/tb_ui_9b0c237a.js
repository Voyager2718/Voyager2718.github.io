var UiBubbleTipBase=function(b){var a={content:"",arrow_dir:"up",bubble_css:{width:170},arrow_pos:{},attr:"",wrap:$("body"),closeBtn:false,level:1,arrowReq:true};this._option=$.extend(true,a,b);this._event={};this.init()};UiBubbleTipBase.bubbles={};UiBubbleTipBase.count=0;UiBubbleTipBase.prototype={constructor:UiBubbleTipBase,init:function(a){this.buildBubble()},buildBubble:function(){var a=this._option;_html=this.genericTpl(),wrap=a.wrap;this.j_bubble=$(_html);wrap.append(this.j_bubble);this.j_bubble.css(a.bubble_css);this.j_bubble.find(".j_ui_triangle").css(a.arrow_pos);this.setContent(a.content);if(a.arrow_dir=="up"||a.arrow_dir=="down"){this.j_bubble.find(".j_content").css({width:a.bubble_css["width"]})}else{this.j_bubble.find(".j_content").css({width:(a.bubble_css["width"]-7)})}if(a.closeBtn){this.j_bubble.find(".j_close").show()}if(!a.arrowReq){this.hideArrow()}this._bindEvent();this.cid="bubble_"+UiBubbleTipBase.count;UiBubbleTipBase.count++},_bindEvent:function(){var b=this._option,a=this;if(b.closeBtn){this.j_bubble.find(".j_close").click(function(){var c=a.triggerEvent("onclose");if(!c){return}a.closeBubble()})}},bind:function(b,a,c){var d={stat:c?true:false,fun:a};if(this._event[b]){this._event[b].push(d)}else{this._event[b]=[];this._event[b].push(d)}},triggerEvent:function(a){var d=true;if(this._event[a]){var c=this._event[a];for(var b=0;b<c.length;b++){if(c[b].fun){c[b].fun()}if(!c[b].stat){d=false}}}return d},genericTpl:function(){var a=this._option.attr,b=this._option.arrow_dir;_html='<div class="ui_bubble_wrap j_wrap" '+a+' style="display:none;"><div class="j_content ui_bubble_content ui_bubble_'+b+'"><div class="ui_bubble_body j_body"></div><div class="ui_bubble_closed j_close"></div></div><div class="j_ui_triangle ui_triangle ui_triangle_'+b+'"><div class="ui_triangle_outter ui_arrow_o_'+b+'" ><em>\u25c6</em></div><div class="ui_triangle_inner ui_arrow_i_'+b+'" ><em>\u25c6</em></div></div></div>';return _html},closeBubble:function(){this.j_bubble.remove();delete UiBubbleTipBase.bubbles[this.cid]},hideArrow:function(){this.j_bubble.find(".ui_triangle").hide()},hideBubble:function(){this.j_bubble.hide()},showBubble:function(a){if(a){if(a.zIndex){this._getBubbleInfo(a.zIndex);this.j_bubble.css({"z-index":a.zIndex});this.showByTime(a.type,a.time)}else{this._getBubbleInfo();var b=this._handleCover();if(!b){this.showByTime(a.type,a.time)}}}else{this._getBubbleInfo();var b=this._handleCover();if(!b){this.j_bubble.show()}}},showByTime:function(b,c){var a=this;if(b=="delayShow"){setTimeout(function(){a.j_bubble.show()},c)}else{if(b=="delayClose"){a.j_bubble.show();setTimeout(function(){a.closeBubble()},c)}else{a.j_bubble.show()}}},_getBubbleInfo:function(d){var b=this,h=b.j_bubble,c=h.width();h.width(0);h.show();var g=h.offset(),f=g.top,e=g.left,a=h.find(".j_body").height()+12;h.hide();h.width(c);b.minL=e;b.maxL=e+c+7;b.minT=f;b.maxT=f+a;if(d){b.bubbleType="inter"}UiBubbleTipBase.bubbles[b.cid]=b},_isCover:function(){var d=this,f=d.cid,c=UiBubbleTipBase.bubbles,b=d;for(var e in c){if(e==f||d.bubbleType=="inter"||c[e].j_bubble.get(0).style.display=="none"){}else{var a=c[e];if(b.minL<a.maxL&&b.maxL>a.minL&&b.minT<a.maxT&&b.maxT>a.minT){return a}}}return false},_handleCover:function(){var d=this._isCover(),b=this;if(d){var c=d._option.level,a=b._option.level;if(a>c){d.j_bubble.fadeOut("slow");return false}else{return true}}return false},setBubblePosition:function(a){if(a&&(a.top||a.left)){this.j_bubble.css(a)}},setBubbleFixed:function(){if(!($.browser.msie&&$.browser.version=="6.0")){this.j_bubble.addClass("ui_bubble_wrap_fixed")}else{this.j_bubble.addClass("ui_bubble_fixed_hack")}},setBubbleNormal:function(){if(!($.browser.msie&&$.browser.version=="6.0")){this.j_bubble.removeClass("ui_bubble_wrap_fixed")}else{this.j_bubble.removeClass("ui_bubble_fixed_hack")}},setFixedForMessage:function(){var a=this,c;var b=null;if(c){clearTimeout(c)}$(window).bind("scroll",function(){if(c){clearTimeout(c)}if(b==null){b={top:parseInt(a.j_bubble.css("top"))||a.j_bubble.position().top}}c=setTimeout(function(){a._bubleFixedSet(b)},10)})},setContent:function(a){this.j_bubble.find(".j_body").html(a)},_bubleFixedSet:function(b){var a=this,c=$(window).scrollTop(),d=this._option;if(c>b.top){a.setBubbleFixed();if(!($.browser.msie&&$.browser.version=="6.0")){a.j_bubble.css({top:-5})}a.j_bubble.find(".ui_triangle").hide()}else{a.setBubbleNormal();a.j_bubble.css({top:b.top});a.j_bubble.find(".ui_triangle").show()}}};;var PopWindow=function(b){var a={styleId:1,templateObj:{title:"\u65e0",content:"\u65e0",button:"\u65e0",note:"\u65e0",link:"#"}};this._option=$.extend(true,a,b);this._event={}};PopWindow.prototype={constructor:PopWindow,bind:function(b,a,c){var d={stat:c?true:false,fun:a};if(this._event[b]){this._event[b].push(d)}else{this._event[b]=[];this._event[b].push(d)}},trigger:function(a){if(this._event[a]){var c=this._event[a];for(var b=0;b<c.length;b++){if(c[b].fun){c[b].fun()}if(!c[b].stat){return false}}}return true},_buildHtml:function(){var b=this;if($("#pop_frame").length>0){return false}var e=this._option;var d=$("#j_popWindow_tpl_"+e.styleId).html();var c=e.templateObj.title;e.templateObj.title=c+b._sayHi();var a=$.tb.format(d,e.templateObj);this.PopupContainer=document.createElement("div");this.PopupContainer.id="pop_frame";this.PopupContainer.innerHTML=a;document.body.appendChild(this.PopupContainer);setTimeout(function(){b._setAnimation();b._eventInit()},200)},_setAnimation:function(){var a=$("#pop_animate"),b=a.outerHeight();$("#pop_frame").css({height:(b+2)+"px"});a.css({height:b+"px",top:b+"px"}).animate({top:"0px"},"slow")},_sayHi:function(){var a="";var b=new Date().getHours();if(b>=0&&b<5){a="\uff1a"}else{if(b>=5&&b<9){a="\uff0c\u65e9\u4e0a\u597d\uff1a"}else{if(b>=9&&b<12){a="\uff0c\u4e0a\u5348\u597d\uff1a"}else{if(b>=12&&b<14){a="\uff0c\u4e2d\u5348\u597d\uff1a"}else{if(b>=14&&b<18){a="\uff0c\u4e0b\u5348\u597d\uff1a"}else{if(b>=18&&b<24){a="\uff0c\u665a\u4e0a\u597d\uff1a"}}}}}}return a},_eventInit:function(){var c=this,b=$("#pop_frame");b.find(".pop_close").click(function(){var d=c.trigger("closeSuccess");if(!d){return}$("#pop_frame").remove();return false});var a=b.find(".pop_button");a.click(function(){var d=c.trigger("clickBtn");if(!d){return}$("#pop_frame").remove()});a.mousedown(function(){$(this).removeClass("pop_button_normal pop_button_hover").addClass("pop_button_down");$(this).find("span").removeClass("btn_right_part_normal btn_right_part_hover").addClass("btn_right_part_down")});a.hover(function(){$(this).removeClass("pop_button_normal pop_button_hover").addClass("pop_button_hover");$(this).find("span").removeClass("btn_right_part_normal btn_right_part_down").addClass("btn_right_part_hover")},function(){$(this).removeClass("pop_button_down pop_button_hover").addClass("pop_button_normal");$(this).find("span").removeClass("btn_right_part_hover btn_right_part_down").addClass("btn_right_part_normal")})},showPop:function(){var a=this;a._buildHtml()}};;var Enum={FileStatus:{NONE:0,RUNNING:1,ERROR:2,COMPLETE:3},ProcessorStatus:{NOTSTART:0,RUNNING:1,PAUSE:2,COMPLETE:4,ERROR:5},ProcessorCommand:{PAUSE:0,STOP:1,NONE:2},Error:{NONE:{no:0,msg:""},FILE_SIZE_OVERFLOW:{no:1,msg:"\u6587\u4ef6\u5927\u5c0f\u8d85\u51fa\u9650\u5236"},NETWORK_ERROR:{no:2,msg:"\u7f51\u7edc\u9519\u8bef"},JSON_PARSE_ERROR:{no:3,msg:"\u6570\u636e\u8f6c\u6362\u5931\u8d25"}}};var Compressor=function(){var b=null;var c=null;var a=function(){b=document.createElement("canvas");c=b.getContext("2d")};this.compress=function(j){var f=!!j.quality?j.quality:1;var m=!!j.imageType?j.imageType:"image/jpeg";var l=1;var i=j.image.width;var o=j.image.height;if(!!j.maxWidth&&j.maxHeight){var g=i/j.maxWidth;var n=o/j.maxHeight;l=g>n?1/g:1/n}l=!!j.rate?j.rate:l;var h=j.isIos?d(j.image,i,o):1;b.width=i*l;b.height=o*l;c.clearRect(0,0,i,o);c.scale(l,l/h);c.drawImage(j.image,0,0);var k=b.toDataURL(m,f);var p=((k.length-814)/1.37);if(!!j.maxSize&&j.maxSize<p){f=j.maxSize/p;k=b.toDataURL(m,f)}return k};var e=function(){};var d=function(i,f,n){b.width=1;b.height=n;c.drawImage(i,0,0);var h=c.getImageData(0,0,1,n).data;var l=0;var j=n;var m=n;while(m>l){var g=h[(m-1)*4+3];if(g===0){j=m}else{l=m}m=(j+l)>>1}var k=(m/n);return(k===0)?1:k};a()};var MImage={};MImage._createImage=function(b){var a=new Image();a.size=b.file.size||0;a.name=b.file.name||"";a.type=b.file.type||"";a.percent=0;a.status=Enum.FileStatus.NONE;a.response="";a.errorCode=0;a.errorMessage="";a.onLoaded=b.onLoaded;a.id="img_"+(new Date()).getTime()+"_"+a.type;a.getData=function(){return MImage._getImageData(a.src)};a.getPostData=function(){return MImage._getPostData(a)};return a};MImage._getPostData=function(a){return{file:{filename:a.name,type:a.type,content:a.getData()}}};MImage._getImageData=function(a){return a.split(",")[1]};MImage._calImageSize=function(a){return((a.length-814)/1.37)};MImage._readImage=function(b,c){var a=new FileReader();a.onload=function(d){if(!!c){c(d.target.result)}};a.readAsDataURL(b)};MImage._compressImage=function(e,b,d,c,f){var a=new Compressor();if(e.width>d||e.height>c){return a.compress({image:e,maxWidth:d,maxHeight:c,maxSize:f})}return e.src};MImage.create=function(d){var a=new Compressor();var b=false;var c=null;c=MImage._createImage(d);c.onload=function(){if(!b&&!!d.maxWidth&&!!d.maxHeight&&(c.width>d.maxWidth||c.height>d.maxHeight)){c.src=MImage._compressImage(c,c.type,d.maxWidth,d.maxHeight,d.maxSize);c.size=MImage._calImageSize(c.src);b=true}else{if(!!c.onLoaded){c.onLoaded(c);c.onLoaded=null}b=false}};MImage._readImage(d.file,function(e){c.src=e});return c};var Queue=function(){this._queue=[];this._index=0;this.push=function(a){if(typeof a!="Array"){this._queue.push(a)}else{this._queue.concat(a)}};this.pop=function(){return this._queue[this._index++]};this.remove=function(a){this._queue.splice(a,1)};this.insert=function(b,a){this._queue.splice(b,a,0)};this.clear=function(){this._queue=[];this._index=0};this.length=function(){return this._queue.length};this.remainLength=function(){return this._queue.length-this._index};this.get=function(a){return this._queue[a]};this.toArray=function(){return this._queue}};var ImageQueue=function(c){Queue.call(this);var d=0;var a=c.maxLength||10;var l=c.maxWidth||0;var j=c.maxSize||5242880;var k=c.maxHeight||0;var i=this;var f=c.onLoaded||null;var e=c.onItemLoaded||null;var g=function(){};var b=function(m){m.status=Enum.FileStatus.NONE;i.push(m);if(!!e){e(m)}if(d==i.length()){if(!!f){f(i.toArray())}}};var h=function(m){if(i.length()<a){MImage.create({file:m,maxWidth:l,maxHeight:k,maxSize:j,onLoaded:b});return true}else{alert("The queue is exceeded!");return false}};this.pop=function(){var m=null;while(this._index<this._queue.length){m=this._queue[this._index++];if(m.status==Enum.FileStatus.NONE){return m}}return null};this.concat=function(n){d+=n.length;for(var m=0;m<n.length;m++){if(h(n[m])){continue}else{break}}};this.isComplete=function(){var n=0;for(var m=0;m<this.length();m++){if(this.get(m).status!=Enum.FileStatus.NONE&&this.get(m).status!=Enum.FileStatus.RUNNING){n++}}return n==this.length()};this.getCompleteItems=function(){var m=[];for(var n=0;n<this.length();n++){if(this.get(n).status!=Enum.FileStatus.NONE&&this.get(n).status!=Enum.FileStatus.RUNNING){m.push(this.get(n))}}return m};this.remove=function(m){this._queue.splice(m,1);d--};this.reset=function(){this.clear();d=0}};var FilePoster=function(d,j){var a=null;var b=d||{timeout:100};var f=this;var c=function(){a=new XMLHttpRequest();i()};var i=function(){if(!a.sendAsBinary){a.sendAsBinary=function(l){var k=Array.prototype.map.call(l,function(m){return m.charCodeAt(0)&255});a.send(new Uint8Array(k).buffer)}}};var e=function(n){var m=new FormData();for(var l in n){m.append(l,n[l])}return m};var h=function(o){var p="----WebKitFormBoundary"+Math.random();var l="--"+p;var n=[];for(var m in o){n.push(l);if(typeof o[m]=="object"){n.push('Content-Disposition: form-data; name="'+m+'"; filename="'+o[m].filename+'"');n.push("Content-Type: "+o[m].type);n.push("");n.push(atob(o[m].content))}else{n.push('Content-Disposition: form-data; name="'+m+'"');n.push("");n.push(o[m])}}n.push(l+"--");return{boundary:p,payload:n.join("\r\n")}};var g=function(m){if(!m){return}for(var l in m){f.bind(l,m[l])}};this.bind=function(l,m){a[l]=m;if(l=="onprogress"){a.upload[l]=m}};this.sendAsBinary=function(k,n,l){var m=h(n);g(l);a.open("POST",k,true);a.setRequestHeader("Content-Type","multipart/form-data; boundary="+m.boundary);a.sendAsBinary(m.payload)};this.sendAsForm=function(k,n,l){var m=e(n);g(l);a.open("POST",k,true);a.send(m)};c();g(j)};var Processor=function(){this.conf={};this.handler={onPause:null,onContinue:null,onStop:null,onProcessing:null,onComplete:null,onError:null};this._command=Enum.ProcessorCommand.NONE;this._status=Enum.ProcessorStatus.NOTSTART;this.bind=function(a,b){this.handler[a]=b};this.runHandler=function(a,b){if(!!a){a(b)}};this.process=function(){this._status=Enum.ProcessorStatus.RUNNING;this._command=Enum.ProcessorCommand.NONE};this.pause=function(){this._command=Enum.ProcessorCommand.PAUSE};this.goOn=function(){this._status=Enum.ProcessorStatus.RUNNING;this._command=Enum.ProcessorCommand.NONE};this.stop=function(){this._command=Enum.ProcessorCommand.STOP};this.extend=function(c,b){for(var a in b){c[a]=b[a]}}};var Uploador=function(h,k){Processor.call(this);var l=null,j=this,e=null,b=null;$.extend(this.conf,{timeout:300,url:""});j.extend(this.conf,{timeout:h.timeout||300,url:h.url||""});j.extend(this.handler,k);var f=function(){b=new FilePoster({timeout:j.timeout},{onprogress:g,onload:d,ontimeout:i,onabort:c,onerror:c})};var a=function(m,n){j.runHandler(m,n)};var g=function(n){var m=n.lengthComputable?n.loaded/n.total:1;l.percent=m;a(j.handler.onProcessing,l)};var d=function(m){l.response=null;try{l.response=JSON.parse(m.target.responseText);l.status=Enum.FileStatus.COMPLETE;j._status=Enum.ProcessorStatus.COMPLETE;if(!!j.handler.onComplete){a(j.handler.onComplete,l)}}catch(m){j._status=Enum.ProcessorStatus.ERROR;l.status=Enum.FileStatus.ERROR;l.errorCode=Enum.Error.JSON_PARSE_ERROR.no;l.errorMessage=Enum.Error.JSON_PARSE_ERROR.msg;j.runHandler(j.handler.onError,l)}};var i=function(m){j._status=Enum.ProcessorStatus.ERROR;l.status=Enum.FileStatus.ERROR;l.errorCode=Enum.Error.NETWORK_ERROR.no;l.errorMessage=Enum.Error.NETWORK_ERROR.msg;j.runHandler(j.handler.onError,l)};var c=function(m){j._status=Enum.ProcessorStatus.ERROR;l.status=Enum.FileStatus.ERROR;l.errorCode=Enum.Error.NETWORK_ERROR.no;l.errorMessage=Enum.Error.NETWORK_ERROR.msg;j.runHandler(j.handler.onError,l)};this.process=function(o){var m=!!o.url?o.url:h.url;m=m+"&r="+Math.random();var n=o.file.getData();l=o.file;l.status=Enum.FileStatus.RUNNING;this._status=Enum.ProcessorStatus.RUNNING;b.sendAsBinary(m,l.getPostData())};f()};var UploadorPool=function(f,q){Processor.call(this);var i=null,n=[],j=this;var e=0;j.extend(j.conf,{maxLength:f.maxLength||2,url:f.url||""});j.extend(j.handler,{onItemComplete:null,onItemStart:null,onItemError:null,onItemProcessing:null,onComplete:null,onStart:null,onError:null,onPause:null,onProcessing:null});if(!!q){j.extend(j.handler,q)}var d=function(r){j.runHandler(j.handler.onItemComplete,r);l();b();g()};var c=function(r){j.runHandler(j.handler.onItemError,r);j.runHandler(j.handler.onError,r);l();b();g()};var o=function(r){j.runHandler(j.handler.onItemProcessing,r);e=h();j.runHandler(j.handler.onProcessing,{percent:e,imageList:i.toArray()})};var h=function(){var r=i.toArray();var t=0;for(var s=0;s<r.length;s++){t+=r[s].percent}return r.length<=0?1:t/r.length};var p=function(r){return new Uploador({url:j.conf.url,id:n.length},{onComplete:d,onProcessing:o,onError:c})};var m=function(){var r=null;for(var s=0;s<n.length;s++){if(n[s]._status!=Enum.ProcessorStatus.RUNNING){r=n[s];break}}if(r==null&&n.length<j.conf.maxLength){r=p();n.push(r)}return r};var k=function(){var s=0;for(var r=0;r<n.length;r++){if(n._status!=Enum.ProcessorStatus.RUNNING){s++}}return s==n.length};var b=function(){if(j._status!=Enum.ProcessorStatus.COMPLETE&&j._command==Enum.ProcessorCommand.NONE){j.process({queue:i})}};var g=function(){if(j._command==Enum.ProcessorCommand.PAUSE&&j._status==Enum.ProcessorStatus.RUNNING&&k()){j._status=Enum.ProcessorStatus.PAUSE;j.runHandler(j.handler.onPause,{percent:e,imageList:i.toArray()})}};var l=function(){if(i.isComplete()&&j._status!=Enum.ProcessorStatus.COMPLETE){j._status=Enum.ProcessorStatus.COMPLETE;j.runHandler(j.handler.onComplete,{percent:100,imageList:i.toArray()});return true}return false};var a=function(){if(!i){return}j._command=Enum.ProcessorCommand.NONE;j._status=Enum.ProcessorStatus.RUNNING;if(l()){return}while(i.remainLength()>0){var s=m();if(s!=null){var r=i.pop();if(!!r){j.runHandler(j.handler.onItemStart,r);s.process({file:r})}}else{break}}};this.process=function(r){j.conf.url=r.url||j.conf.url;i=r.queue;j.runHandler(j.handler.onStart,i.toArray());a()};this.pause=function(){this._command=Enum.ProcessorCommand.PAUSE};this.goOn=function(){a()};this.bind=function(r,s){j.handler[r]=s};this.reset=function(){this._command=Enum.ProcessorCommand.NONE;this._status=Enum.ProcessorStatus.NOTSTART;e=0}};var MultiUploador=function(e,k){Processor.call(this);var h=this,g=null,d=null,l=null;h.extend(h.conf,{maxWidth:0,maxHeight:0,maxSize:5242880,container:null,isAutoUp:false,queueLen:10,maxParallel:1,postType:0,postUrl:""});h.extend(h.handler,{onFileSelected:null,onStartUpload:null,onProgressListen:null,onStopUpload:null,onError:null,onComplete:null,onImageLoaded:null});if(!!k){h.extend(h.handler,k)}var b=function(){l=$("<input type='file' accept='image/*' />").css({opacity:"0",width:h.conf.container.width()+"px",height:h.conf.container.height()+"px"}).attr("multiple","multiple");l.appendTo(h.conf.container);l.bind("change",a);d=new UploadorPool({maxLength:h.conf.maxParallel,url:h.conf.postUrl});f()};var f=function(){d.bind("onComplete",function(m){h.runHandler(h.handler.onComplete,m);g.reset()});d.bind("onProcessing",function(m){h.runHandler(h.handler.onProgressListen,m)});d.bind("onError",function(m){h.runHandler(h.handler.onError,m)});d.bind("onPause",function(m){h.runHandler(h.handler.onStopUpload,m)})};var a=function(m){if(!g){g=new ImageQueue({maxLength:h.conf.queueLen,onLoaded:i,onItemLoaded:j,maxWidth:h.conf.maxWidth,maxHeight:h.conf.maxHeight,maxSize:h.conf.maxSize})}g.concat(m.target.files);c()};var c=function(){l.val("")};var j=function(m){if(m.size>h.conf.maxSize){m.status=Enum.FileStatus.ERROR;m.errorCode=Enum.Error.FILE_SIZE_OVERFLOW.no;m.errorMessage=Enum.Error.FILE_SIZE_OVERFLOW.msg;h.runHandler(h.handler.onError,m)}h.runHandler(h.handler.onImageLoaded,m)};var i=function(m){h.runHandler(h.handler.onFileSelected,{percent:0,imageList:m});if(h._command==Enum.ProcessorCommand.NONE&&h.conf.isAutoUp){h.startUpload()}};this.start=function(m){this.runHandler(h.handler.onStartUpload,{percent:0,imageList:g.toArray()});d.process({queue:g})};this.stop=function(){d.pause()};this.goOn=function(){d.process({queue:g})};this.clearList=function(){g.reset()};this.deleteFile=function(o){var m=g.toArray();for(var n=0;n<m.length;n++){if(!!m[n].id&&m[n].id==o){g.remove(n)}}};b()};var Html5Uploader={Enum:Enum,MImage:MImage,Queue:Queue,ImageQueue:ImageQueue,FilePoster:FilePoster,Processor:Processor,Uploador:Uploador,UploadorPool:UploadorPool,MultiUploador:MultiUploador};;_.Module.define({path:"common/component/Select",sub:{_attrs:{},_defaultAttrs:{cid:0,trigger:null,classPrefix:"ui-select",template:[].join(""),triggerTpl:'<a href="#"></a>',className:"",name:"",value:"",length:0,selectedIndex:-1,multiple:false,disabled:false,maxHeight:null,selectSource:null},selectTpl:['<div id="<%=classPrefix%>-cid-<%=cid%>" class="<%=classPrefix%>">','<ul class="<%=classPrefix%>-content">',"<% for (var i = 0, len = select.length; i < len; i++ ) {%>",'<li class="<%=classPrefix%>-item <%=select[i]["selected"] ? classPrefix + "-selected" : "" %>" data-index="<%=i%>" data-value="<%=select[i]["value"]%>"><%=select[i]["text"]%></li>',"<% } %>","</ul>","</div>"].join(""),initial:function(a){if(a.trigger.length===0){throw"trigger is not found";return}this._mergeAttr(a)},render:function(){var e=this;var c=e._attrs;var b=c.trigger;var d="";if(b[0].tagName.toLowerCase()==="select"){this._bindObserve();var a=b.tbattr("name");if(a){this.set("name",a)}this.set("disabled",b.tbattr("disabled"));d=e._getClassName(c.classPrefix,"trigger");b.addClass(d);this.set("selectSource",b);var f=$(e.get("triggerTpl")).addClass(d);this.set("trigger",f);b.after(f).hide();e.set("model",e.convertSelect(b[0],e.get("classPrefix")));e._bindEvents()}},updateSelect:function(b,a){var c=this.convertSelect(b[0],a);this.set("model",c)},convertSelect:function(n,p){var d,f=[],q=n.options,b=q.length,h=false,k=this.get("cid");for(d=0;d<b;d++){var c,a={},e=q[d];var g=["text","value","defaultSelected","selected","disabled"];for(c in g){var m=g[c];a[m]=e[m]}if(e.selected){h=true}f.push(a)}if(!h&&f.length){f[0].selected="true"}return{cid:k,select:f,classPrefix:p}},set:function(a,c){var b=this.get(a);if(!this._isEqual(b,c)){this.fire("change-cid-"+this.get("cid")+":"+a,{prev:b,value:c});this._attrs[a]=c}},get:function(a){return this._attrs[a]},asyncSelect:function(c){var b=this.get("selectSource");var e="";for(var d=0,a=c.select.length;d<a;d++){e+="<option "+(c.select[d]["selected"]?"selected":"")+' value="'+c.select[d]["value"]+'">'+c.select[d]["text"]+"</option>"}b.html(e).trigger("change")},_bindObserve:function(){var a=this;this.observe("change-cid-"+this.get("cid")+":model",function(k,d){var b=d.value;var l=baidu.template;var c=a.get("trigger");if(!a.get("options")||a.get("options").length==0){var h=l(a.selectTpl,b);a.set("options",$(h).appendTo("body"))}var f=null;for(var g=0,j=b.select.length;g<j;g++){if(b.select[g].selected){f=b.select[g]}}c.html(f.text);a.asyncSelect(b)});this.observe("change-cid-"+this.get("cid")+":visiable",function(f,i){var c=i.value;var b=a.get("classPrefix");var j=a.get("cid");var d=a.get("trigger");var h=d.offset();var g=a.get("options");g.css({width:d.outerWidth(),top:h.top+d.height(),left:h.left}).toggle(c)})},_bindEvents:function(){var b=this;var c=b.get("trigger");c.on("click",function(f){f.preventDefault();var d=$(this);if(!b.get("disabled")){b.set("visiable",!b.get("visiable"))}}).on("mouseenter",function(f){var d=$(this);if(!d.data("disabled")){d.addClass(b.get("classPrefix")+"-trigger-hover")}}).on("mouseleave",function(){var d=$(this);if(!d.data("disabled")){d.removeClass(b.get("classPrefix")+"-trigger-hover")}});var a=this.get("classPrefix");this.get("options").on("click",".ui-select-item",function(){var f=b.get("model");var e=$(this).data("index");var h=$.extend(true,{},f);for(var g=0,d=h.select.length;g<d;g++){h.select[g].selected=false}h.select[e].selected=true;b.set("model",h);b.set("visiable",false)});$("body").on("click",function(g){var f=$(g.target);var d=f.tbattr("class");if(!d||d.indexOf(a)==-1){b.set("visiable",false)}})},_getClassName:function(a,c){if(!a){return this.get("className")}var b=this.get("className")+" "+a+"-"+c;if(this.get("disabled")){b+=" "+a+"-"+c+"-disabled"}return b},_isType:function(a){return function(b){return({}).toString.call(b)=="[object "+a+"]"}},_isEmptyAttrValue:function(f){var a=this._isType("String");var b=this._isType("Array");var e=Object.prototype.toString;var c=function(g){return g!=null&&g==g.window};var d=function(h){if(!h||e.call(h)!=="[object Object]"||h.nodeType||c(h)||!h.hasOwnProperty){return false}for(var g in h){if(h.hasOwnProperty(g)){return false}}return true};return f==null||(a(f)||b(f))&&f.length===0||d(f)},_isPlainObject:function(g){var f=Object.prototype.toString;var a=Object.prototype.hasOwnProperty;var b=function(e){return e!=null&&e==e.window};if(!g||f.call(g)!=="[object Object]"||g.nodeType||b(g)){return false}try{if(g.constructor&&!a.call(g,"constructor")&&!a.call(g.constructor.prototype,"isPrototypeOf")){return false}}catch(d){return false}var c;for(c in g){}return c===undefined||a.call(g,c)},_isEqual:function(e,c){if(e===c){return true}if(this._isEmptyAttrValue(e)&&this._isEmptyAttrValue(c)){return true}var i=Object.prototype.toString;var g=i.call(e);if(g!=i.call(c)){return false}switch(g){case"[object String]":return e==String(c);case"[object Number]":return e!=+e?c!=+c:(e==0?1/e==1/c:e==+c);case"[object Boolean]":return +e==+c;case"[object Array]":var d=e.toString();var f=c.toString();return d.indexOf("[object")===-1&&f.indexOf("[object")===-1&&d===f}if(typeof e!="object"||typeof c!="object"){return false}if(this._isPlainObject(e)&&this._isPlainObject(c)){if(!this._isEqual(this._keys(e),this._keys(c))){return false}for(var h in e){if(e[h]!==c[h]){return false}}return true}return false},_mergeAttr:function(a){this._attrs=$.extend(true,{},this._defaultAttrs);for(var b in this._defaultAttrs){if(a.hasOwnProperty(b)){this._attrs[b]=a[b]}}},_keys:function(d){var c=Object.keys;if(!c){var a=[];for(var b in d){if(d.hasOwnProperty(b)){a.push(b)}}return a}else{return c(d)}}}});;_.Module.define({path:"common/widget/tchargeDialog",sub:{_dialog:null,_bubble:null,_order_id:null,_scores_total:0,_scores_need:100,_tbs:"",_type:0,_dubi:0,_packet_id:0,_order_id:0,_username:"",initial:function(){if(!PageData.user.is_login){TbCom.process("User","buildLoginFrame");return false}if(PageData.user.superboy==="tbmall2"||true){this._flowRateTest();return false}this._tbs=PageData.tbs;this._username=PageData.user.user_name||PageData.user.name;this._show()},_show:function(){this._type=0;this._chargeBeansDialog();this._bindEvent()},_bindEvent:function(){var a=$("#tcharge_dialog");var b=this;a.delegate(".charge_bean_interaction_j_charge_now_btn ","click",function(){if(!b._packet_id){b._showBubble("\u8bf7\u9009\u62e9\u5145\u503c\u7c7b\u578b","2000",true);return}b._dialog&&b._closeDialog(b._dialog);b._getOrderId();b._chargingDialog()}).delegate(".charge_bean_interaction_charge_type_options","click",function(){b._packet_id=$(this).tbattr("value");if(b._packet_id){$(".charge_bean_interaction_no_charge_btns").addClass("charge_bean_interaction_charge_btns").removeClass("charge_bean_interaction_no_charge_btns");$(".charge_bean_interaction_charge_type_options").removeClass("charge_bean_interaction_charge_type_options_select");$(this).addClass("charge_bean_interaction_charge_type_options_select")}b._dubi=$(this).tbattr("data-dubi");$(".j_dubi_show").each(function(){$(this).html(b._dubi)})})},_chargeBeansDialog:function(){var a=this;var b="";this._packet_id=0;b="<div id='tcharge_dialog'><div class='charge_bean_interaction_dialog_content_item clearfix'><span class='charge_bean_interaction_dialog_content_charge_user_name'>\u5145\u503c\u5e10\u6237 : <span class='j_charge_username' >"+this._username+"</span></span></div><div class='charge_bean_interaction_dialog_content_charge_type' ><p class='charge_bean_interaction_dialog_data_loading'>\u52a0\u8f7d\u4e2d......</p></div><div class='charge_bean_interaction_dialog_btn_wrap'><a class='charge_bean_interaction_no_charge_btns charge_bean_interaction_j_charge_now_btn'>\u7acb\u5373\u5145\u503c</a></div></div>";this._showDialog("\u5145\u503cT\u8c46",b,650);$(".charge_bean_interaction_j_charge_now_btn").hide();a._loadChargeData($(".charge_bean_interaction_dialog_content_charge_type"))},_chargingDialog:function(){var a=this;var b="<div id='tcharge_result_dialog'><p class='charge_bean_interaction_dialog_content'>\u8bf7\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e0a\u5b8c\u6210\u652f\u4ed8</p><p class='charge_bean_interaction_dialog_second_content'>\u652f\u4ed8\u5b8c\u6210\u524d&nbsp;&nbsp;&nbsp;&nbsp;\u8bf7\u52ff\u5173\u95ed\u7a97\u53e3</p><div class='charge_bean_interaction_dialog_btn_wrap'><a class='charge_bean_interaction_charge_btns charge_bean_interaction_j_charge_success_btn'>\u652f\u4ed8\u6210\u529f</a><a class='charge_bean_interaction_charge_btns charge_bean_interaction_j_charge_fail_btn'>\u652f\u4ed8\u5931\u8d25</a></div></div>";this._showDialog("\u5145\u503cT\u8c46",b,500);$("#tcharge_result_dialog").delegate(".charge_bean_interaction_j_charge_success_btn","click",function(){a._dialog&&a._closeDialog(a._dialog);a._confirmChargeState()}).delegate(".charge_bean_interaction_j_charge_fail_btn","click",function(){a._dialog&&a._closeDialog(a._dialog);var c=a._killChareDialogCall();$.tb.location.setHref(c)})},_loadChargeData:function(c){var a={};var b={ie:"utf-8",tbs:this._tbs,type:this._type};$.ajax({type:"POST",url:"/tbmall/bwsbean",dataType:"json",data:b,success:function(f){switch(f.no){case 0:a=f;var e="<div class='charge_bean_interaction_dialog_content_item'>\u5145\u503c\u6570\u91cf : </div><div      class='charge_bean_interaction_dialog_content_item'>";var g="";for(var d=a.data["bean_info"].length-1;d>=0;d--){e+="<div class='charge_bean_interaction_charge_type_options id_"+a.data["bean_info"][d]["packet_id"]+" '  data-dubi='"+a.data["bean_info"][d]["need_money"]/100+"' value='"+a.data["bean_info"][d]["packet_id"]+"'  ><input type='radio' data-dubi='"+a.data["bean_info"][d]["need_money"]/100+"' value='"+a.data["bean_info"][d]["packet_id"]+"' id='radio_bean_"+a.data["bean_info"][d]["packet_id"]+"'  name='radio_bean' /><label  "+(a.data["bean_info"][d]["free_bean"]==0?"":"class='free_beans_type'")+"for='radio_bean_"+a.data["bean_info"][d]["packet_id"]+"'><span class='charge_bean_interaction_tdou_items' >"+a.data["bean_info"][d]["bean_num"]+"</span>"+(a.data["bean_info"][d]["free_bean"]==0?"":"<br /><span class='charge_bean_interaction_free_beans_tip '>&nbsp;&nbsp;&nbsp;&nbsp;\u8d60"+a.data["bean_info"][d]["free_bean"]+"</span>")+"</label></div>";if(a.data["bean_info"][d]["bean_num"]==30000){g=".id_"+a.data["bean_info"][d]["packet_id"]}}e+="<br class='clear'/></div><div class='charge_bean_interaction_dialog_content_item'>\u9700\u8981\u82b1\u8d39 : <span class='charge_bean_interaction_orange_tip' ><span class='j_dubi_show'>0</span></span>\u767e\u5ea6\u70b9\u5238<span class='charge_bean_interaction_dubi_tip'>(<span class='j_dubi_show'>0</span>RMB)</span></div>";$(".charge_bean_interaction_dialog_content_charge_type").html(e);$(".charge_bean_interaction_j_charge_now_btn").show();g=$(g);g.find("input").trigger("click");g.append("<div class='charge_bean_interaction_recommend_price'></div>")}}})},_getOrderId:function(){var b=this;var a=window.open("about:blank");var c={ie:"utf-8",tbs:this._tbs,type:this._type,packet_id:this._packet_id};$.ajax({type:"POST",url:"/tbmall/buybean",dataType:"json",data:c,success:function(d){switch(d.no){case 0:b._order_id=d.data.order_id;a.location=d.data.dubi_url;break;default:b._showDialog("\u64cd\u4f5c\u5931\u8d25",d.no,200)}}})},_killChareDialogCall:function(){var b="http://"+$.tb.location.getHost()+$.tb.location.getPathname()+"?";var a=$.tb.location.getSearchValue();if(a){for(var c in a){if(c=="chargeTdou"){a[c]=""}b+=c+"="+a[c]+"&"}}return b},_notEnoughDialog:function(b,a){var c="<p class='charge_bean_interaction_dialog_content'>\u5f88\u62b1\u6b49\uff0c\u60a8\u76ee\u524d\u7684T\u8c46\u4e3a <span class='charge_bean_interaction_orange_tip' >"+b+"</span>\uff0c\u672c\u9053\u5177\u9700\u8981<span class='charge_bean_interaction_orange_tip' >"+a+"</span>T\u8c46</p><div class='charge_bean_interaction_dialog_btn_wrap'><a class='charge_bean_interaction_charge_btns charge_bean_interaction_j_charge_btn'>\u5145\u503cT\u8c46</a><a class='charge_bean_interaction_charge_btns charge_bean_interaction_j_close_dialog'>\u53d6\u6d88</a></div>";this._showDialog("\u63d0\u793a",c,440)},_confirmChargeState:function(){var d=this;var b=6;var a=0;this._bubble=this._showBubble("\u6b63\u5728\u9a8c\u8bc1\u652f\u4ed8\u4e2d\uff0c\u8bf7\u7a0d\u5019"+b+"\u79d2...");var c=setInterval(function(){b--;d._bubble.html("\u6b63\u5728\u9a8c\u8bc1\u652f\u4ed8\u4e2d\uff0c\u8bf7\u7a0d\u5019"+b+"\u79d2...");if(b%2==0){var e={ie:"utf-8",tbs:d._tbs,order_id:d._order_id};$.ajax({type:"POST",url:"/tbmall/checkorder",dataType:"json",data:e,success:function(f){switch(f.no){case 0:if(10000==f.data.result_code){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='charge_bean_interaction_charge_btns success_bubble_icon' ></span><span class='small_bubble_content'>\u5df2\u6210\u529f\u5145\u503c <span class='charge_bean_interaction_orange_tip'>"+f.data.scores+"</span>T\u8c46"+(f.data.given_scores==0?"":"\uff0c\u540c\u65f6\u83b7\u8d60<span class='charge_bean_interaction_orange_tip'>"+f.data.given_scores+"</span>T\u8c46</span>"),1500,"canClose",function(){$.tb.location.reload()});clearInterval(c)}if(b<=0){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='charge_bean_interaction_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>\u62b1\u6b49,T\u8c46\u6ca1\u6709\u5145\u503c\u6210\u529f</span>",1500,"canClose");clearInterval(c)}break;case 1:case 2:default:if(b<=0){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='charge_bean_interaction_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>\u62b1\u6b49,T\u8c46\u6ca1\u6709\u5145\u503c\u6210\u529f</span>",1500,"canClose");clearInterval(c)}break}},error:function(){d._bubble.html("<p>\u672a\u77e5\u9519\u8bef</p>");clearInterval(c)}})}if(b<=0){clearInterval(c)}},1000)},_showBubble:function(c,e,a,d){var b=$("<div class='small_bubble_block'  ></div>");b.append(c);$("body").append(b);b.css({left:$(window).width()/2-b.width()/2,top:$(window).height()/2});$(window).resize(function(){b.css({left:$(window).width()/2-b.width()/2,top:$(window).height()/2})});if(a){b.click(function(){$(this).remove()})}if(e){this._closeBubble(b,e,d)}else{return b}},_closeBubble:function(a,c,b){if(c&&c>0){setTimeout(function(){a.fadeOut("normal",function(){a.remove();if(typeof b=="function"){b()}})},c)}else{a.fadeOut("normal",function(){a.remove()})}},_convertScore:function(a){return a>99999999?(Math.floor(a/(10000*100))/100)+"\u4ebf":(a>9999999?(Math.floor(a/100000)/100)+"\u5343\u4e07":(a>999999?(Math.floor(a/10000)/100)+"\u767e\u4e07":(a>99999?(Math.floor(a/100)/100)+"\u4e07":a)))},_showDialog:function(c,a,b){this._dialog=new $.dialog({html:a,title:c,width:b,draggable:false,closeable:true})},_closeDialog:function(a){a.close();a=null},_flowRateTest:function(){var a=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=2",function(b){if(b.data){a.location.href=b.data}})}}});;_.Module.define({path:"common/widget/wallet_dialog",requires:["common/component/Card","common/component/JsPager"],sub:{_dialog:null,_html:null,_pushPager:null,_popPager:null,_options:null,_pager_option:{container:null,amount:3,current:1,total:0,mode:0,showDisableItem:true,template:{prev:'<a href="#url#" index="#page#" #special#>&lt;</a>',next:'<a href="#url#" index="#page#" #special#>&gt;</a>',prev_disable:'<a href="#url#" index="#page#" #special#>&lt;</a>',next_disable:'<a href="#url#" index="#page#" #special#>&gt;</a>',head:"",tail:"",head_disable:"",tail_disable:""},classname:{wrapper:"tbui_js_pager wallet_js_pager",normal:"normal",current:"current",prev:"prev j_wallet_list_prev",next:"next j_wallet_next_prev",status:"status",prev_disable:"prev_disable",next_disable:"next_disable"}},initial:function(){},show:function(b){var a=this;a._options=b||{};if(!a._dialog){a._buildCard()}else{a._dialog.show()}},hide:function(){if(this._dialog){this._dialog.hide()}},_buildCard:function(){var a=this;$.ajax({url:"/tbmall/history?ie=utf8&c="+1+"&pn="+1+"&_t="+(new Date).valueOf(),type:"get",dateType:"json",success:function(b){if(b.no===0){a._buildInitHtml(b.data.user);var c={html:a._html,title:"\u6211\u7684T\u8c46\u94b1\u5305",draggable:false,width:700,hideOnclose:true};a._dialog=new $.dialog(c);a._buildPager(1,$("#wallet_dialog_msg_pop_pager"),a._popPager,a._popChange,b);a._buildPager(1,$("#wallet_dialog_msg_push_pager"),a._pushPager,a._pushChange);$("#wallet_dialog_tab").on("click",".j_wallet_dialog_tab_item",function(f){var g=$(f.currentTarget);$(".j_wallet_dialog_tab_item").removeClass("wallet_dialog_tab_current");g.addClass("wallet_dialog_tab_current");var d=g.tbattr("attr-show");$(".j_wallet_dialog_msg_list").hide();$(d).show()});$("#wallet_dialog_go_explain").on("click",function(d){d.preventDefault();$("#wallet_dialog_main").hide();$("#wallet_dialog_rules").show()});$("#wallet_dialog_return").on("click",function(d){d.preventDefault();$("#wallet_dialog_main").show();$("#wallet_dialog_rules").hide()});$("#wallet_dialog_medal").on("click",".j_wallet_dialog_medal_btn",function(d){d.preventDefault();_.Module.use("common/widget/JoinVipDialog",[],function(e){e.getMemberDialog()});a.hide()});$("#j_wallet_tcharge_dialog").on("click",function(){a.hide();_.Module.use("common/widget/tcharge_dialog")})}else{}},error:function(){}})},_popChange:function(a,e,b){var c=this;var d=10;if(b){c._buildPopPage.call(c,b);e(Math.ceil(b.data.total_count/d));return}$.ajax({url:"/tbmall/history?ie=utf8&c="+d+"&pn="+a+"&_t="+(new Date).valueOf(),type:"get",dateType:"json",success:function(f){if(f.no===0){c._buildPopPage.call(c,f,a);e(Math.ceil(f.data.total_count/d))}else{}},error:function(){}})},_buildPopPage:function(c,d){var f=c.data.order_info||[];var b=[];for(var e=0;e<f.length;e++){var a=f[e];var g=new Date(a.create_time*1000);var h=[];h.push(g.getFullYear()+"\u5e74");h.push(parseInt(g.getMonth()+1)+"\u6708");h.push(g.getDate()+"\u65e5&nbsp;");h.push(g.getHours()+":");h.push(g.getMinutes());h=h.join("");b.push('<li class="wallet_dialog_msg_list_item wallet_dialog_msg_list_item_pop">');b.push('\u60a8\u6d88\u8d39\u4e86<span class="wallet_dialog_msg_tbean">'+a.scores+"T\u8c46</span>\uff0c");b.push('\u8d2d\u4e70\u4e86\u9053\u5177<span class="wallet_dialog_msg_buy">'+a.props_name+"</span>");b.push('<span class="wallet_dialog_msg_list_date">'+h+"</span>");b.push("</li>")}if(f.length==0&&d==1){b.push('<div class="wallet_dialog_msg_empty">');b.push("\u60a8\u8fd8\u6ca1\u8d2d\u4e70\u8fc7\u4e1c\u897f\u54e6~\uff0c<br>\u8d34\u5427\u65b0\u73a9\u6cd5\u4ece\u9177\u70ab\u7279\u6743\u9053\u5177\u5f00\u59cb\u3002<br>");b.push('<a target="_blank" href="/tbmall/home">\u8fdb\u5165\u5546\u57ce\u8d2d\u4e70&gt;&gt;</a>');b.push("</div>")}b=b.join("");$("#wallet_pop_list_main").html(b)},_pushChange:function(a,d){var b=this;var c=5;$.ajax({url:"/tbmall/bwsdubiorder?ie=utf8&c="+c+"&pn="+a+"&_t="+(new Date).valueOf(),type:"get",dateType:"json",success:function(e){if(e.no===0){b._buildPushPage.call(b,e,a);d(Math.ceil(e.data.total_num/c))}else{}},error:function(){}})},_buildPushPage:function(c,d){var f=c.data.order||[];var b=[];for(var e=0;e<f.length;e++){var a=f[e];var g=new Date(a.create_time*1000);var h=[];h.push(g.getFullYear()+"\u5e74");h.push(parseInt(g.getMonth()+1)+"\u6708");h.push(g.getDate()+"\u65e5&nbsp;");h.push(g.getHours()+":");h.push(g.getMinutes());h=h.join("");b.push('<li class="wallet_dialog_msg_list_item wallet_dialog_msg_list_item_push">');b.push("\u8ba2\u5355\u53f7\uff1a"+a.order_id);b.push('\u6d88\u8d39<span class="wallet_dialog_msg_tbean">'+a.db_money/100+"</span>\u767e\u5ea6\u70b9\u5238");b.push('\u5145\u503c<span class="wallet_dialog_msg_tbean">'+a.scores+"T</span>");if(parseInt(a.given_scores)){b.push('\u83b7\u8d60<span class="wallet_dialog_msg_tbean">'+a.given_scores+"T</span><br>")}b.push('<span class="wallet_dialog_msg_list_date">'+h+"</span>");b.push("</li>")}if(f.length==0&&d==1){b.push('<div class="wallet_dialog_msg_empty">');b.push("\u60a8\u8fd8\u6ca1\u6709T\u8c46\u5145\u503c\u8bb0\u5f55\uff0c<br>T\u8c46\u53ef\u4ee5\u8d2d\u4e70\u8d34\u5427\u4f1a\u5458\u4ee5\u53ca\u4f17\u591a\u9177\u70ab\u7279\u6743\u9053\u5177\u3002<br>");b.push('<a target="_blank" href="/tbmall/home">\u67e5\u770b\u7279\u6743\u9053\u5177&gt;&gt;</a>');b.push("</div>")}b=b.join("");$("#wallet_push_list_main").html(b)},_buildPager:function(b,f,a,e,c){var d=this;if(typeof e!=="function"){return}e.call(d,b,function(h,g){if(!(h>1)){return}a=d.use("common/component/JsPager",$.extend(d._pager_option,{current:b,total:h,container:f}));a.bind("pageChange",function(k,j){d._buildPager.call(d,j,f,a,e)});var i=['<div class="wallet_js_pager_skip">','<input type="text" class="wallet_pager_skip_text j_wallet_pager_skip_text" placeholder="\u8df3\u8f6c\u5230" value="'+b+'"/>','<a class="wallet_pager_skip_btn j_wallet_pager_skip_btn" href="#">\u8df3\u8f6c</a>',"</div>"].join("");pagerTotal='<div class="wallet_js_pager_total">\u5171'+h+"\u9875</div>";$(pagerTotal).prependTo(f);$pagerSkip=$(i);$pagerSkip.on("click",".j_wallet_pager_skip_btn",function(k){k.preventDefault();var j=parseInt($pagerSkip.find(".j_wallet_pager_skip_text").val());if(j>h||!(j>0)){$pagerSkip.find(".j_wallet_pager_skip_text").val(b);return}d._buildPager.call(d,j,f,a,e)})})},_buildInitHtml:function(h){var l=this;var f=h.Parr_scores||[];var b=h.Parr_props?(h.Parr_props["level"]?h.Parr_props["level"]:[]):[];var c=!b.end_time?0:parseInt((new Date).valueOf()/1000)>b.end_time?0:b.props_id;var a=h.setpass;var j=[];j.push('<div id="wallet_dialog_medal" class="wallet_dialog_medal clearfix">');if(!c){j.push('<a href="#" class="wallet_dialog_medal_open_btn  j_wallet_dialog_medal_btn"><span class="showicon showicon_high"></span>\u5f00\u901a\u4f1a\u5458</a>');j.push('<span class="wallet_dialog_medal_text">\u5c0a\u4eab\u7279\u6743</span>')}else{if(b.props_id==1){j.push('<span class="wallet_dialog_medal_text"><span class="showicon showicon_low"></span>\u4f1a\u5458\u4e13\u5c5e\u7279\u6743</span>');j.push('<a class="wallet_dialog_continue_btn  j_wallet_dialog_medal_btn" href="#">\u7eed\u8d39</a>')}else{j.push('<span class="wallet_dialog_medal_text"><span class="showicon showicon_high"></span>\u4f1a\u5458\u4e13\u5c5e\u7279\u6743</span>');j.push('<a class="wallet_dialog_continue_btn  j_wallet_dialog_medal_btn" href="#">\u7eed\u8d39</a>')}}j.push("</div>");j=j.join("");var i=this._getInfoHtml(f,a);var k=this._getIntroHtml();var d=this._getMsgHtml();var g=this._getRuleHtml();var e=['<div class="wallet_dialog_main clearfix" id="wallet_dialog_main">','<div class="wallet_dialog_user">',i,'<div class="wallet_dialog_user_power">',j,k,"</div>","</div>",d,"</div>",g];this._html=e.join("")},_getIntroHtml:function(){var a=['<div class="wallet_dialog_power_list clearfix">','<a href="/tbmall/tshow?tab=detail&c=0"   target="_blank" class="wallet_dialog_power_item power_identity">\u5c0a\u8d35\u8eab\u4efd</a>','<a href="/tbmall/tshow?tab=detail&c=112" target="_blank" class="wallet_dialog_power_item power_nameplate">\u4e2a\u6027\u94ed\u724c</a>','<a href="/tbmall/tshow?tab=detail&c=110" target="_blank" class="wallet_dialog_power_item power_dress">\u70ab\u9177\u88c5\u626e</a>','<a href="/tbmall/tshow?tab=detail&c=103" target="_blank" class="wallet_dialog_power_item power_post">\u8da3\u5473\u53d1\u8d34</a>','<a href="/tbmall/tshow?tab=detail&c=108" target="_blank" class="wallet_dialog_power_item power_magic">\u9b54\u6cd5\u9053\u5177</a>',"</div>"].join("");return a},_parseInt:function(a){a=parseInt(a);return a>0?a:a<=0?a:0},_getInfoHtml:function(f,d){var c=this._parseInt(f.scores_money);var e=this._parseInt(f.scores_other);var b=this._parseInt(c+e);var a=['<div class="wallet_dialog_user_info clearfix">','<div class="wallet_dialog_my_tbean">','<span class="wallet_dialog_tbean_label">\u6211\u7684T\u8c46\uff1a</span>','<span class="wallet_dialog_tbean_num"><span class="wallet_dialog_tbean_icon"></span>'+b+"</span>","</div>",'<p class="wallet_dialog_sub_tbean">',"<?/*fetch money other\u5404\u81ea\u5bf9\u5e94\u54ea\u4e2a*/?>","\u8c46\u7968&nbsp;"+this._parseInt(f.scores_fetch),"<span>|</span>","\u8c46\u7968\u4e0a\u9650"+this._parseInt(f.limit)+"&nbsp;&nbsp;",'<a href="#" id="wallet_dialog_go_explain">\u83b7\u53d6\u89c4\u5219</a>',"</p>",'<div class="wallet_dialog_recharge">','<p class="wallet_dialog_recharge_desc">',"\u8bf4\u660e\uff1a\u8c46\u7968\u53ef\u62b5\u7528\u90e8\u5206T\u8c46\u5728\u6d88\u8d39\u65f6\u4f7f\u7528","</p>",'<a href="javascript:;" id="j_wallet_tcharge_dialog" class="wallet_dialog_recharge_btn">\u7acb\u5373\u5145\u503c</a>','<a href="/tbmall/pass/set" class="wallet_dialog_paykey_set_btn" target="_blank">'+(d?"\u4fee\u6539\u5bc6\u7801":"\u8bbe\u7f6e\u652f\u4ed8\u5bc6\u7801")+"</a>","</div>","</div>"].join("");return a},_getMsgHtml:function(){var a=['<div class="wallet_dialog_msg">','<div class="wallet_dialog_tab clearfix" id="wallet_dialog_tab">','<a class="j_wallet_dialog_tab_item wallet_dialog_tab_item wallet_dialog_tab_current" attr-show="#wallet_pop_list">\u652f\u51fa\u8bb0\u5f55</a>','<a class="j_wallet_dialog_tab_item wallet_dialog_tab_item" attr-show="#wallet_push_list">\u5145\u503c\u8bb0\u5f55</a>',"</div>",'<div class="wallet_dialog_tbody">','<div class="j_wallet_dialog_msg_list wallet_dialog_msg_list wallet_pop_list clearfix" id="wallet_pop_list">','<ul id="wallet_pop_list_main">',"</ul>",'<div class="clearfix"></div>','<div class="wallet_dialog_msg_pager clearfix" id="wallet_dialog_msg_pop_pager"></div>',"</div>",'<div class="j_wallet_dialog_msg_list wallet_dialog_msg_list wallet_push_list " id="wallet_push_list">','<ul id="wallet_push_list_main">',"</ul>",'<div class="clearfix"></div>','<div class="wallet_dialog_msg_pager " id="wallet_dialog_msg_push_pager"></div>',"</div>","</div>","</div>"].join("");return a},_getRuleHtml:function(){var a=['<div class="wallet_dialog_rules" id="wallet_dialog_rules">','<a class="wallet_dialog_change_link" id="wallet_dialog_return" href="#">\u8fd4\u56de\u6211\u7684T\u8c46\u94b1\u5305&gt;</a>',"<br><br>","<h4>1.\u8c46\u7968\u8bf4\u660e</h4><hr>","<p>\u8c46\u7968\u53ef\u4ee5\u8d2d\u4e70\u90e8\u5206\u8d34\u5427T\u8c46\u5546\u57ce\u5546\u54c1\uff0c\u5177\u4f53\u53ef\u89c1\u5546\u57ce\u8d2d\u4e70\u65f6\u63d0\u793a\u3002</p><hr>","<p>\u8c46\u7968\u53ef\u4f5c\u4e3a\u90e8\u5206\u8d34\u5427\u5546\u54c1(\u5305\u62ec\u8d34\u5427\u4f1a\u5458)\u7684\u62b5\u4ef7\u5238\u3002</p><hr>","<h4>2.\u5728\u7ebf\u65f6\u95f4</h4><hr>","<p>\u7528\u6237\u5728\u8d34\u5427\u6b63\u5e38\u5728\u7ebf\uff08\u6709\u6d4f\u89c8\u5668\u884c\u4e3a\uff09\uff0c\u5373\u53ef\u6309\u5728\u7ebf\u7684\u65f6\u957f\u83b7\u5f97\u5bf9\u5e94\u7684\u8c46\u7968</p><hr>","<table>","<tbody>",'<tr><td class="no_rb">\u5728\u7ebf\u65f6\u957f</td><td class="no_rb">\u8c46\u7968\u83b7\u53d6\u6570\u91cf</td><td>\u8c46\u7968\u83b7\u53d6\u65e5\u4e0a\u9650</td></tr>',"<tr>","<td>10\u5206\u949f</td>",'<td><span class="tbean"></span>10</td>','<td rowspan="4"><span class="tbean"></span>100</td>',"</tr>","<tr>","<td>30\u5206\u949f</td>",'<td><span class="tbean"></span>20</td>',"</tr>","<tr>","<td>50\u5206\u949f</td>",'<td><span class="tbean"></span>30</td>',"</tr>","<tr>","<td>90\u5206\u949f</td>",'<td><span class="tbean"></span>40</td>',"</tr>","</tbody>","</table><hr>",'<p class="explain">\u8bf4\u660e\uff1a\u5728\u5173\u6ce8\u7684\u5427\u5185\uff0c\u53f3\u4fa7\u4e2a\u4eba\u4fe1\u606f\u680f\u4e2d\u5f00\u542f\u5728\u7ebf\u793c\u5305\uff0c\u5373\u53ef\u83b7\u5f97\u5956\u52b1\u8c46\u7968\u3002</p><hr>','<img src="http://tb1.','bdstatic.com/tb/zt/tshow/wallet_dialog_explain_img.jpg" alt=""><hr>',"<h4>3.\u968f\u673a\u5f69\u86cb</h4><hr><hr>","<p>\u6d4f\u89c8\u8d34\u5427\u6216\u6d4f\u89c8\u5176\u4ed6\u4f1a\u5458\u7684\u4e3b\u9875\uff0c\u90fd\u6709\u673a\u4f1a\u83b7\u5f97\u8c46\u7968\u5f69\u86cb\uff0c\u6bcf\u65e5\u4e0a\u9650170\u8c46\u7968\u3002</p><hr>","<h4>4.\u53d1\u8d34\u56de\u8d34</h4><hr>","<p>\u7528\u6237\u6bcf\u5929\u7684\u53d1\u8d34/\u56de\u8d34\u884c\u4e3a\u90fd\u53ef\u83b7\u5f97\u4e00\u5b9a\u7684\u8c46\u7968</p><hr>","<table>","<tbody>",'<tr><td class="no_rb">\u53d1\u8d34/\u56de\u8d34</td><td class="no_rb">\u83b7\u5f97\u8c46\u7968</td><td>\u8c46\u7968\u83b7\u53d6\u65e5\u4e0a\u9650</td></tr>',"<tr>","<td>PC\u9996\u6b21\u53d1\u8d34</td>",'<td><span class="tbean"></span>10</td>','<td rowspan="2"><span class="tbean"></span>15</td>',"</tr>","<tr>","<td>PC\u9996\u6b21\u56de\u8d34</td>",'<td><span class="tbean"></span>5</td>',"</tr>","<tr>","<td>\u591a\u6b21\u53d1\u8d34</td>",'<td><span class="tbean"></span>1/\u8d34\uff08PC\uff09<br><span class="tbean"></span>2/\u8d34\uff08\u79fb\u52a8\u7aef\uff09</td>','<td><span class="tbean"></span>10</td>',"</tr>","</tbody>","</table><hr>",'<p class="explain">\u8bf4\u660e\uff1a\u6bcf\u5929\u53d1\u8d34\u7684\u8ba1\u7b97\u8d77\u6b62\u65f6\u95f4\u4e3a00:00--23:59</p><hr>',"<h4>5.\u70ed\u95e8\u8d34\u5956\u52b1</h4><hr>","<p>\u7528\u6237\u6240\u53d1\u4e3b\u9898\u8d34\u8fbe\u5230\u70ed\u95e8\u8d34\u8981\u6c42\uff0c\u53ef\u83b7\u5f97\u5956\u52b1\u8c46\u7968\uff0c\u6700\u9ad8\u53ef\u8fbe20\u8c46\u7968\u3002</p><hr>",'<p class="explain">\u70ed\u95e8\u8d34\u8bf4\u660e\uff1a\u6709\u6548\u56de\u590d\u8fbe\u5230\u4e00\u5b9a\u6570\u91cf\uff0c\u5177\u4f53\u6570\u91cf\u7531\u6240\u5728\u5427\u7684\u6d3b\u8dc3\u7528\u6237\u6570\u51b3\u5b9a\u3002</p><hr>','<p class="explain">\uff08\u5373\u5927\u578b\u8d34\u5427\u7684\u70ed\u95e8\u8d34\u6240\u9700\u56de\u590d\u6570\u5927\u4e8e\u5c0f\u578b\u8d34\u5427\uff09</p><hr>',"<h4>5.\u79fb\u52a8\u7aef\u53d1\u8d34\u56de\u8d34</h4><hr>","<p>\u5728\u79fb\u52a8\u7aef\u767b\u5f55\u540e\u6d3b\u8dc3\uff08\u53d1\u8d34\uff0c\u56de\u8d34\uff09\u5373\u53ef\u83b7\u5f9715\u8c46\u7968/\u5929\uff0c\u6b64\u9879\u4e0e\u7b2c3\u9879\u5956\u52b1\u4e0d\u51b2\u7a81\u3002</p><hr>","<h4>\u8c46\u7968\u4e0a\u9650\u8bf4\u660e</h3><hr>","<p>1.\u6d3b\u8dc3\u83b7\u53d6\u8c46\u7968\u6bcf\u65e5\u603b\u83b7\u53d6\u4e0a\u9650\u4e3a330\u8c46\u7968/\u5929</p><hr>","<p>2.\u6d3b\u8dc3\u8c46\u7968\u83b7\u53d6\u4e0a\u9650\u4e3a8000\uff0c\u82e5\u65e0\u6d88\u8017\u5c06\u4e0d\u518d\u83b7\u5f97\u6d3b\u8dc3\u8c46\u7968</p>","</div>"].join("");return a}}});;_.Module.define({path:"common/widget/JoinVipDialog",sub:{_body:null,_agreeKnown:true,_dataMap:{},_badgeLv:"month_v2",_monthNum:3,_use_left_bean:0,_all_scores:0,_user_scores:0,_packet_id:0,_tbs:"",_price:"0",_dialog:null,_badge1_tpl:['	<div class=" tshow_join_vip_block_btn tshow_join_vip_badge_btn "  data-id="month_v1">','<div class="tshow_join_vip_block_btn_info">','<img class="tshow_join_vip_badge_icon" src="http://tieba.baidu.com/tb/cms/tbmall/jzxz_icon.png" /><span class="badge_lv1 ">\u8d34\u5427\u4f1a\u5458</span></div>',"</div>"].join(""),_badge2_tpl:['<div class="tshow_join_vip_block_btn tshow_join_vip_badge_btn badge_lv2  tshow_join_vip_block_btn_active "  data-id="month_v2">','<div class="tshow_join_vip_block_btn_info">','<img class="tshow_join_vip_badge_icon" src="http://tieba.baidu.com/tb/cms/tbmall/wxxz_icon.png" /><span class="badge_lv1 ">\u9ad8\u7ea7\u8d34\u5427\u4f1a\u5458</span>',"</div>",'<div class="tshow_join_vip_recommend_tip"></div>',"</div>"].join(""),initial:function(){this._tbs=PageData.tbs;this._bindEvent()},getMemberDialog:function(){var a=this;if(!PageData.user.is_login){_.Module.use("common/widget/LoginDialog");return false}this._flowRateTest();return false},_bindEvent:function(){var a=this;$("body").off("click.j_join_vip");$("body").delegate(".j_tbmall_join_vip_btn","click.j_join_vip",function(){a.getMemberDialog();return false}).delegate(".tshow_join_vip_badge_btn","click.j_join_vip",function(b){a._badgeBtnClickAction(this)}).delegate(".tshow_join_vip_month_count_btn","click.j_join_vip",function(b){a._monthBtnClickAction(this)}).delegate(".j_tshow_join_vip_use_leave","click.j_join_vip",function(b){a._useLeftBtnClickAction(this)}).delegate("#j_agree_known","click",function(){a._agreeKnown=$(this)[0].checked;if(a._agreeKnown==true){$(".tshow_join_vip_open_btn_disable").removeClass("tshow_join_vip_open_btn_disable").addClass("tshow_join_vip_open_btn")}else{$(".tshow_join_vip_open_btn").removeClass("tshow_join_vip_open_btn").addClass("tshow_join_vip_open_btn_disable")}}).delegate(".tshow_join_vip_open_btn_content .tshow_join_vip_open_btn","click.j_join_vip",function(){a._getOrderId()}).delegate(".tshow_join_vip_j_charge_success_btn","click.j_join_vip",function(){a._dialog.close();a._confirmChargeState()}).delegate(".tshow_join_vip_j_charge_fail_btn","click.j_join_vip",function(){a._dialog.close()})},_badgeBtnClickAction:function(b){b=$(b);$(".tshow_join_vip_badge_btn").removeClass("tshow_join_vip_block_btn_active");this._badgeLv=b.tbattr("data-id");$(b).addClass("tshow_join_vip_block_btn_active");var a=this;this._getBadgeInfo("need_bean",function(c){a._updatePriceAction(c)})},_monthBtnClickAction:function(b){b=$(b);$(".tshow_join_vip_month_count_btn").removeClass("tshow_join_vip_block_btn_active");this._monthNum=b.tbattr("data-id");$(b).addClass("tshow_join_vip_block_btn_active");var a=this;this._getBadgeInfo("need_bean",function(c){a._updatePriceAction(c)})},_useLeftBtnClickAction:function(b){var a=this;a._use_left_bean=$(".tshow_join_vip_use_leave")[0].checked?1:0;this._getBadgeInfo("need_bean",function(c){a._updatePriceAction(c)})},_updatePriceAction:function(b){this._price=b;$(".j_cost_total").html(b);var a;this._use_left_bean=$(".tshow_join_vip_use_leave")[0].checked?1:0;if(this._use_left_bean){a=Math.max(0,b-this._dataMap.use_scores)}else{a=b}$(".tshow_join_vip_red").html(Math.ceil(a/1000))},_initDataMap:function(){var a=this;$.get("/tbmall/bwstshow",function(e){if(0==e.no){a._dataMap=e.data;var b=$(".j_month_content");var c=$(".j_badge_content");$(".j_tshow_join_vip_block_use_scores").html(a._dataMap.use_scores);$(".j_tshow_join_vip_block_all_scores").html(a._dataMap.all_scores);for(var d=0;d<e.data.month_v1.length;d++){b.append('	<div class="tshow_join_vip_block_btn tshow_join_vip_month_count_btn '+(d==3?"tshow_join_vip_block_btn_active":"")+'"  data-id="'+e.data.month_v1[d]["month_num"]+'" >'+e.data.month_v1[d]["month_num"]+"\u4e2a\u6708"+(d==3?'<div class="tshow_join_vip_recommend_tip"></div>':"")+"</div>")}if(!(a._dataMap.user.Parr_props&&a._dataMap.user.Parr_props.level&&a._dataMap.user.Parr_props.level.props_id==2&&a._dataMap.user.Parr_props.level.end_time*1000>new Date().getTime())){c.append(a._badge1_tpl)}c.append(a._badge2_tpl);a._use_left_bean=$(".badge_lv2").trigger("click");$(".tshow_join_vip_month_count_btn").eq(3).trigger("click")}else{a._showDialog("\u9519\u8bef\u63d0\u793a","\u83b7\u53d6\u4fe1\u606f\u5931\u8d25",200)}})},_build:function(){var a=['<div id="tshow_join_vip_wrapper">','<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title">\u5f00\u901a\u4f1a\u5458\u7c7b\u578b\uff1a</div>','<div class="tshow_join_vip_block_content j_badge_content">',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title">\u5f00\u901a\u65f6\u957f\uff1a</div>','<div class="tshow_join_vip_block_content j_month_content">',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom"></div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<span class="contsigncard_tip"><span class="red_sign">*</span>\u5f00\u901a12\u4e2a\u6708\u9ad8\u7ea7\u4f1a\u5458\u8d60\u9001<span class="strong_txt">\u8fde\u7eed\u7b7e\u5230\u53613\u5f20</span></span>',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom">\u603b\u4ef7\uff1a</div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<div class="tshow_join_vip_block_info"><span class="j_cost_total tshow_cost_total">360000</span>T\u8c46 <input type="checkbox" class="tshow_join_vip_use_leave j_tshow_join_vip_use_leave" name="use_leave" /><span class="tshow_join_vip_block_tip" >\u4f7f\u7528T\u8c46\u4f59\u989d(\u53ef\u7528\u4f59\u989d<span class="j_tshow_join_vip_block_use_scores" >\u52a0\u8f7d\u4e2d..</span> \u603b\u4f59\u989d<span  class="j_tshow_join_vip_block_all_scores" >\u52a0\u8f7d\u4e2d..</span>)</span></div >',"</div>","</div>",'<div class="tshow_join_vip_block clearfix">','<div class="tshow_join_vip_block_title tshow_join_vip_block_bottom">\u9700\u8981\u82b1\u8d39\uff1a</div>','<div class="tshow_join_vip_block_content tshow_join_vip_block_bottom">','<div class="tshow_join_vip_block_info"><span class="tshow_join_vip_info"><span class="tshow_join_vip_red">360</span>\u767e\u5ea6\u70b9\u5238(1\u70b9\u5238 = 1000T\u8c46 = 1\u5143\u4eba\u6c11\u5e01)</span></div >',"</div>","</div>",'<div class="tshow_join_vip_block tshow_join_vip_open_btn_section">','<div class="tshow_join_vip_open_btn_content clearfix">','<div class="tshow_join_vip_open_btn"><i  class="tshow_join_vip_open_btn_left"></i>\u7acb\u5373\u5f00\u901a</div>','<div class="tshow_join_vip_open_btn_tip"><input type="checkbox" checked id="j_agree_known" name="agree" /><a href="/tb/tdouprecautions.html" target="_blank">\u540c\u610fT\u8c46\u4f7f\u7528\u987b\u77e5</a></div>',"</div>","</div>","</div>",'<div class="tshow_cont_sign_intro"><div class="question"><span class="question-icon"></span>\u4ec0\u4e48\u662f\u8fde\u7eed\u7b7e\u5230\u5361</div> <div class="answer">\u4f7f\u7528\u8fde\u7eed\u7b7e\u5230\u5361,\u53ef\u628a\u67d0\u4e2a\u5427\u6240\u6709\u7684\u7b7e\u5230\u5929\u6570\u8fde\u7eed\u5728\u4e00\u8d77!</div></div> '].join("");this._body=$(a);this._showDialog("\u5f00\u901a\u8d34\u5427\u4f1a\u5458",this._body,650)},_chargingDialog:function(){var a="<p class='tshow_join_vip_dialog_content'>\u8bf7\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e0a\u5b8c\u6210\u5f00\u901a\u4f1a\u5458\u7684\u652f\u4ed8\u64cd\u4f5c</p><p class='tshow_join_vip_dialog_second_content'>\u652f\u4ed8\u5b8c\u6210\u524d&nbsp;&nbsp;&nbsp;&nbsp;\u8bf7\u52ff\u5173\u95ed\u7a97\u53e3</p><div class='tshow_join_vip_dialog_btn_wrap'><a class='tshow_join_vip_charge_btns tshow_join_vip_j_charge_success_btn'>\u652f\u4ed8\u6210\u529f</a><a class='tshow_join_vip_charge_btns tshow_join_vip_j_charge_fail_btn'>\u652f\u4ed8\u5931\u8d25</a></div>";this._showDialog("\u5145\u503cT\u8c46",a,500)},_getBadgeInfo:function(b,c){for(var a=0;a<this._dataMap[this._badgeLv].length;a++){if(this._dataMap[this._badgeLv][a]["month_num"]==this._monthNum){if(c){c(this._dataMap[this._badgeLv][a][b])}else{return this._dataMap[this._badgeLv][a][b]}break}}},_getOrderId:function(){var b=this;var c=b._price<=b._dataMap.all_scores&&b._use_left_bean;this._dialog.close();if(!c){this._chargingDialog();var a=window.open("about:blank")}this._getBadgeInfo("packet_id",function(e){b._packet_id=e});var d={ie:"utf-8",tbs:this._tbs,packet_id:this._packet_id};d.use_left_bean=b._use_left_bean;$.ajax({type:"POST",url:"/tbmall/buytshow",dataType:"json",data:d,success:function(e){switch(e.no){case 0:if(!c&&e.data.dubi_url){b._order_id=e.data.order_id;a.location=e.data.dubi_url}else{b._bubble=b._showBubble("<span class='tshow_join_vip_charge_btns success_bubble_icon' ></span><span class='small_bubble_content'>\u5df2\u6210\u529f\u5f00\u901a\u4f1a\u5458",1500,"canClose",function(){$.tb.location.reload()})}break;default:b._showDialog("\u64cd\u4f5c\u5931\u8d25",e.no,200)}}})},_confirmChargeState:function(){var d=this;var b=6;var a=0;this._bubble=this._showBubble("\u6b63\u5728\u9a8c\u8bc1\u652f\u4ed8\u4e2d\uff0c\u8bf7\u7a0d\u5019"+b+"\u79d2...");var c=setInterval(function(){b--;d._bubble.html("\u6b63\u5728\u9a8c\u8bc1\u652f\u4ed8\u4e2d\uff0c\u8bf7\u7a0d\u5019"+b+"\u79d2...");if(b%2==0){var e={ie:"utf-8",tbs:d._tbs,order_id:d._order_id};$.ajax({type:"POST",url:"/tbmall/checkorder",dataType:"json",data:e,success:function(f){switch(f.no){case 0:if(10000==f.data.result_code){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='tshow_join_vip_charge_btns success_bubble_icon' ></span><span class='small_bubble_content'>\u5df2\u6210\u529f\u5f00\u901a\u4f1a\u5458",1500,"canClose",function(){$.tb.location.reload()});clearInterval(c)}if(b<=0){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='tshow_join_vip_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>\u62b1\u6b49,\u5f00\u901a\u4f1a\u5458\u6ca1\u6709\u6210\u529f</span>",1500,"canClose");clearInterval(c)}break;case 1:case 2:default:if(b<=0){d._closeBubble(d._bubble);d._bubble=d._showBubble("<span class='tshow_join_vip_charge_btns fail_bubble_icon' ></span><span class='small_bubble_content'>\u62b1\u6b49,\u7cfb\u7edf\u51fa\u73b0\u5f02\u5e38,\u8bf7\u5237\u65b0\u9875\u9762\u67e5\u770b\u4ea4\u6613\u8bb0\u5f55</span>",1500,"canClose");clearInterval(c)}break}},error:function(){d._bubble.html("<p>\u672a\u77e5\u9519\u8bef</p>");clearInterval(c)}})}if(b<=0){clearInterval(c)}},1000)},_showDialog:function(c,a,b){this._dialog=new $.dialog({html:a,title:c,width:b,hideOnclose:false,draggable:false,closeable:true})},_showBubble:function(c,e,a,d){var b=$("<div class='small_bubble_block'  ></div>");b.append(c);$("body").append(b);b.css({left:$(window).width()/2-b.width()/2,top:$(window).height()/2});$(window).resize(function(){b.css({left:$(window).width()/2-b.width()/2,top:$(window).height()/2})});if(a){b.click(function(){$(this).remove()})}if(e){this._closeBubble(b,e,d)}else{return b}},_closeBubble:function(a,c,b){if(c&&c>0){setTimeout(function(){a.fadeOut("normal",function(){a.remove();typeof b=="function"&&b()})},c)}else{a.fadeOut("normal",function(){a.remove()})}},_flowRateTest:function(){var a=window.open("");$.get("/tbmall/getPayUrl?terminal=pc&pay_type=1",function(b){if(b.data){a.location.href=b.data}})}}});;