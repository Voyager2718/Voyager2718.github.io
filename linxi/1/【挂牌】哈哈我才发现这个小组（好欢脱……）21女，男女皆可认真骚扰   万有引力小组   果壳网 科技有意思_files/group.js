/* @generated */G.def("tmpl",function(){function a(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var b={entities:a};return function(c,d){/\W/.test(c)||(c=document.getElementById(c).innerHTML);var e=new Function("funcs, obj","var p=[],print=function(){p.push.apply(p,arguments);};with(funcs){with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',entities($1),'").replace(/\t:=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}}return p.join('');");return d?e(b,d):function(a){return e(b,a)}}}),G.def("Base",function(){"use strict";var a=function(){};return a.extend=function(a,b){var c=b||this;for(var d in c)c.hasOwnProperty(d)&&d!=="prototype"&&(a[d]=c[d]);for(var e in c.prototype)c.prototype.hasOwnProperty(e)&&(a.prototype[e]=c.prototype[e])},a}),G.def("Event",["Base"],function(a){function c(){}"use strict";var b=Array.prototype.slice;return c.prototype.on=function(a,b,c,d){return this.eventQueue=this.eventQueue||{},this.eventQueue[a]=this.eventQueue[a]||[],this.eventQueue[a].push({callback:b,context:c,once:d}),this},c.prototype.off=function(a,b){this.eventQueue=this.eventQueue||{};if(this.eventQueue[a]==null)return;return b?(this.eventQueue[a]=G.filter(this.eventQueue[a],function(a,c){return a.callback!==b}),this.eventQueue[a].length===0&&delete this.eventQueue[a]):delete this.eventQueue[a],this},c.prototype.fire=function(a,c){this.eventQueue=this.eventQueue||{};var d=this.eventQueue[a],e=!0;if(d){var f=b.call(arguments,1);G.each(d,function(b){b.callback.apply(b.context,f)===!1&&(e=!1),b.once&&this.off(a,b.callback)},this)}return e},a.extend(c),c}),G.def("Menu",["tmpl","Event"],function(a,b){function d(b,d,e,f){G.isFun(e)||(f=e,e=null),this.$menu=$(a(c,{list:d,useFocus:f.useFocus,convert:f.convert,className:f.className||""})),this.$list=this.$menu.find("li"),this.selected=-1,this.data=d,this.doneCallBack=e;var g=this;g.$menu.appendTo(b).delegate("li","mouseenter",function(){var a=g.$list.index(this);if(g.selected===a)return;g.select(a,f.disableMouseChangeEvent)}).delegate("li","click",function(){var a=g.$list.index(this);g.selected=a,g.done()}).mouseleave(function(){g.select(-1,f.disableMouseChangeEvent)});if(f.useFocus){var h=g.$menu.children("a");h.keydown(function(a){a.preventDefault();switch(a.which){case 13:g.done();break;case 27:g.hide();break;case 40:g.down();break;case 38:g.up()}}).focus(function(){g.show(),g.selected===-1&&g.select(0)}),this.focus=function(){return h.focus(),this}}}"use strict";var c='<div class="gui-menu <%=className%>">                        <% if (useFocus) { %>                            <a href="#" tabindex="0" hidefocus="true" class="gui-menu-focus">&nbsp;</a>                        <% } %>                        <ul class="gui-menu-list">                            <% for (var i=0;i<list.length;i++) { %>                            <li>                                <% if (typeof convert !== "undefined") { %>                                    <%:=convert(list[i])%>                                <% } else { %>                                    <%=list[i]%>                                <% } %>                            </li>                            <% } %>                        </ul>                    </div>';return b.extend(d),d.prototype.up=function(){var a=this.selected-1;return a<0&&(a=this.data.length-1),this.select(a),this},d.prototype.down=function(){var a=this.selected+1;return a>this.data.length-1&&(a=0),this.select(a),this},d.prototype.select=function(a,b){if(a==null)return this.data[this.selected];if(a<-1||a>=this.data.length)a=-1;return!b&&this.selected!==a&&!this.fire("change",this.data[a])?this:(this.selected=a,this.$list.removeClass("selected"),this.selected!==-1&&$(this.$list[this.selected]).addClass("selected"),this)},d.prototype.remove=function(){if(!this.fire("remove"))return;this.$menu&&this.$menu.remove(),delete this.$menu,delete this.$list,delete this.selected,delete this.data,delete this.doneCallBack},d.prototype.show=function(){return this.$menu.show(),this},d.prototype.hide=function(){return this.fire("hide")?(this.$menu.hide(),this):this},d.prototype.onChange=function(a){return this.on("change",a,this),this},d.prototype.onRemove=function(a){return this.on("remove",a,this),this},d.prototype.onHide=function(a){return this.on("hide",a,this),this},d.prototype.done=function(){return this.doneCallBack&&this.doneCallBack.call(this,this.data[this.selected]),this},d}),G.def("autoComplete",["Menu","Event"],function(a,b){function d(a,b,c){var d,e,f=!1,g=!1,h=this,i=c.zIndex||1,j='<div style="position:relative;z-index:'+i+';_zoom:1;" class="gui-autocomplete"></div>',k,l=c.interval||1e3,m;this.$input=a,this.option=c,this.api=b,this.isSelected=c.isSelected?!0:!1,this.$container=$('<div style="position:'+(c.isRelative?"relative":"absolute")+';z-index:9999;display:none;">'+(c.tip?'<div style="color: #666;margin-bottom: -1px;background:#FFF;position: relative;z-index:1;border:1px solid #C5C5C5;border-bottom:none;">                                 <div style="margin:0 5px;padding: 5px 0;overflow: hidden;zoom:1;border-bottom: 1px dotted #CCC;">                                     <p class="fl">'+c.tip+'</p>                                     <a class="icon-close fr" href="javascript:void 0;" data-operation="closeMenu">X</a>                                 </div>                             </div>':"")+"</div>"),this.oldAutoCompleteAttr=this.$input.attr("autoComplete"),this._close=!1,this.option.limit=c.limit||c.limit===0?c.limit:2,this.isMenuUpDown=!1,this.oldValue="",this.ajax=null,this.lastMatchValue="",h.$input.wrap(j),m=a.parent(),d=h.$input.position(),e=h.option.width||h.$input.outerWidth(),h.$container.insertAfter(h.$input),h.option.isRelative||h.$container.css({top:d.top+h.$input.outerHeight(),left:d.left}),h.$container.css({width:e}).mouseenter(function(){f=!0}).mouseleave(function(){f=!1;if(g)return;h.menu&&(h.menu.remove(),h.menu=null)}),h.oldAutoCompleteAttr!=="off"&&h.$input.attr("autoComplete","off"),h.$input.keydown(function(a){if(h._close)return;switch(a.which){case 27:h.hide();break;case 13:h.menu&&h.menu.select()&&(a.preventDefault(),h.menu.done());break;case 40:h.menu&&(a.preventDefault(),h.menu.down());break;case 38:h.menu&&(a.preventDefault(),h.menu.up());break;default:}}).blur(function(a){if(h._close||f)return;k&&(clearTimeout(k),k=null),g=!1,h.hide()}).focus(function(){function a(){h._autoComplete(function(){k=setTimeout(a,l)})}if(h._close)return;h.lastMatchValue!==h.$input.val()&&h.reset(),h.show(function(b){a()}),g=!0}),m.delegate("[data-operation=closeMenu]","click",function(a){a.preventDefault(),h.close()}),$("body").click(function(a){if(h._close)return;$.contains(m[0],a.target)||h.hide()}),c.afterSetup&&c.afterSetup.call(this)}"use strict";var c="gui-autocomplete-menu";return b.extend(d),d.prototype.reset=function(){this.menu&&this.menu.remove(),this.menu=null,this.oldValue=""},d.prototype.close=function(){return this.fire("close"),this._close=!0,this.$input.attr("autoComplete",this.oldAutoCompleteAttr),this.hide(),this},d.prototype.open=function(){return this.fire("open"),this._close=!1,this.oldAutoCompleteAttr!=="off"&&this.$input.attr("autoComplete","off"),this},d.prototype._autoComplete=function(a){var b=this;if(b._close)return this;var c=b.$input.val(),d=!0;return c.length>=b.option.limit&&(d=!1),!d&&b.oldValue!==c?b.forceUseApi(a):b.oldValue===c?a&&a.call(b):(b.oldValue=c,b.hide(),a&&a.call(b)),this},d.prototype.forceUseApi=function(b){function f(b){d.option.filter&&(b=d.option.filter.call(d,b));if(!b||b.length===0)d.hide();else{var f=d.option.convert;d.menu&&d.menu.remove(),d.menu=(new a(d.$container,b,function(a){if(!d.fire("select",a))return;d.option.done?d.option.done.apply(this,arguments):d.$input.val(f?f(a):a)},{convert:f,className:c})).onRemove(function(){d.hide()}),d.isSelected&&d.menu.select(0),d.lastMatchValue=e,d.$container.show()}}var d=this,e=d.$input.val();d.oldValue=e,d.ajax&&d.ajax.abort(),d.ajax=d.api(e,function(a){f(a),b&&b.call(d)})},d.prototype.show=function(a){this.fire("show");var b=this;return b._close?this:(b.menu?(b.$container.show(),a&&a.call(b)):b._autoComplete(a),this)},d.prototype.hide=function(){return this.fire("hide"),this.$container.hide(),this},function(a,b,c){return new d(a,b,c)}}),G.def("cookies",{get:function(a){"use strict";if(document.cookie.length>0){var b,c=document.cookie.indexOf(a+"=");if(c!=-1)return c=c+a.length+1,b=document.cookie.indexOf(";",c),b==-1&&(b=document.cookie.length),unescape(document.cookie.substring(c,b))}return""},set:function(a,b,c,d){return"use strict",document.cookie=a+"="+escape(b)+(c==null?"":";expires="+c.toGMTString())+";path="+(d||"/"),this},remove:function(a,b){"use strict";var c=new Date;c.setTime(c.getTime()-1);var d=this.get(a);d!=null&&(document.cookie=a+"="+d+";expires="+c.toGMTString()+";path="+(b||"/"))}}),G.def("jquery/easing",function(){jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e)==1)return c+d;g||(g=e*.3);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;g||(g=e*.3*1.5);if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return f==undefined&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?jQuery.easing.easeInBounce(a,b*2,0,d,e)*.5+c:jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*.5+d*.5+c}})}),G.def("scrollTo",["jquery/easing"],function(a){function c(a){var b=window.scrollX||window.pageXOffset||document.documentElement.scrollLeft,c=window.scrollY||window.pageYOffset||document.documentElement.scrollTop,d=c+(window.innerHeight||document.documentElement.clientHeight),e=b+(window.innerWidth||document.documentElement.clientWidth),f=a.scrollLeft,g=a.scrollTop,h=f+(a.width||0),i=g+(a.height||0),j=!1,k=!1;if(f!=null&&f<b||h>e)j=!0;if(g!=null&&g<c||i>d)k=!0;return j&&k?3:k?2:j?1:0}"use strict";var b=$("html,body");return function(a,d,e,f){function m(){b.animate(i,k||1e3,"easeInOutCirc",d?function a(){a.exed&&d(),a.exed=!0}:null)}var g=typeof a=="number",h=g?{top:a,left:a}:a.offset?a.offset():a,i={},j,k,l;typeof e=="number"?(k=e,l=typeof f=="string"?f:"top"):typeof e=="string"?(k=1e3,l=e):(k=1e3,l=g?"top":"all");switch(l){case"all":i.scrollTop=h.top,i.scrollLeft=h.left;break;case"top":i.scrollTop=h.top;break;case"left":i.scrollLeft=h.left;break;default:return}a.jquery&&(i.width=a.width(),i.height=a.height()),j=c(i),a.jquery&&(delete i.width,delete i.height);switch(j){case 0:return d&&d(),!1;case 1:return delete i.scrollTop,m(),!0;case 2:return delete i.scrollLeft,m(),!0;case 3:return m(),!0;default:}}}),G.def("toolTip",["scrollTo"],function(a){"use strict";var b='<div class="{klass}" style="position:absolute;z-index:{zIndex};">                    {msg}                    <b class="{klassArrow}" style="{pointBStyle}"><s class="{klassArrow}" style="{pointSStyle}"></s></b>                </div>',c={up:"left",down:"left",right:"top",left:"top"},d={up:"top:-20px;border-bottom-style:solid;",down:"bottom:-20px;border-top-style:solid;",right:"right:-20px;border-left-style:solid;",left:"left:-20px;border-right-style:solid;"},e={up:"top:-8px;left:-9px;border-bottom-style:solid;",down:"top:-10px;left:-9px;border-top-style:solid;",right:"top:-9px;left:-10px;border-left-style:solid;",left:"top:-9px;left:-8px;border-right-style:solid;"},f=function(f,g,h){function r(){q.css({top:j[0],left:j[1],width:n}),$("b",q).css(c[l],m),o.append(q)}function s(){q.remove(),h&&h()}var i=g.msg,j=g.position,k=$(g.coordinates),l=g.direction||"up",m=g.offset||0,n=g.width,o=$(f),p=o.offset(),q=$(G.format(b,{msg:i,direction:l,zIndex:g.zIndex||999,klass:g.klass||"tooltip",klassArrow:(g.klass||"tooltip")+"-"+l,pointSStyle:"position:absolute;border-width:9px;border-color:transparent;border-style:dashed;width:0;height:0;font-size:0;"+e[l],pointBStyle:"position:absolute;border-width:10px;border-color:transparent;border-style:dashed;width:0;height:0;font-size:0;"+d[l]}));return o.css("position","relative"),k.length&&(k=k.position(),j[0]+=k.top,j[1]+=k.left),r(),g.noscroll||a({top:j[0]+p.top+(l==="up"?-10:0),left:j[1]+p.left+(l==="left"?-10:0)}),{remove:s,$toolTip:q}};return f}),G.def("./group/searchGroup",["../lib/autoComplete","../lib/cookies","../lib/toolTip"],function(a,b,c){function f(a,b){return $.ajax({url:"/apis/group/group.json?retrieve_type=by_search",type:"get",data:{name:a,limit:5},success:function(a){if(a.ok){var c=[];for(var d in a.result)c.push({name:a.result[d].name,url:a.result[d].url});b(c)}},dataType:"json"})}function g(){var a=b.get("rank")?!1:!0;a&&h()}function h(){if(ukey)var a=$(".sub-nav-link li:eq(2)");else var a=$(".sub-nav-link li:eq(1)");var b=c(a,{msg:'<div class="tip">                            <h5>加入小组</h5>                            <p class="tip-txt">在这里发现更多有意思的小组。</p>                            <p class="gpack">                                <a href="javascript:void 0;" class="tip-btn" id="guideKnowBtn">知道了</a>                            </p>                            <a href="javascript:void 0;" class="tip-close" id="guideCloseBtn"></a>                        </div>',klass:"tooltip-new",position:[42,-8],direction:"up",zIndex:998,offset:39,width:300,noscroll:!0},function(){return!1});$("#guideCloseBtn").bind("click",function(){b.remove(),i()}),$("#guideKnowBtn").bind("click",function(){b.remove(),i()})}function i(){var a=new Date,c=365;a.setTime(a.getTime()+c*24*3600*1e3),b.set("rank",1,a)}var d=$("#groupSearch p"),e=$("#word");return d.length&&e.focus(function(){d.addClass("focus")}).blur(function(){d.removeClass("focus")}),g(),{auto:function(b){autoC=a(b,f,{done:function(a){window.open(a.url,"_blank")},convert:function(a){return G.ua.isIE6?G.ellipsis(a.title,22):a.name},width:256,limit:1,zIndex:900})}}}),G.def("nameCard",["toolTip","tmpl"],function(toolTip,tmpl){function init(a,b,c,d,e){a=a,options=b,elemData=c,where=d||g_page_name,options.isGroup?getGroupData(e):getUserData(e)}function userFocus(a){var a=a;a.ukey&&(a.ukey===window.ukey?a.isMe=!0:$.ajax({url:"/apis/community/relationship/follow.json?retrieve_type=is_following&ukey="+a.ukey,async:!1,success:function(b){a.isFollowing=b.result.is_following},dataType:"json"}));if(window.ukey){a.isMe?nameCardToolTip.$toolTip.find('a[data-operation="follow"]').remove():a.isFollowing&&nameCardToolTip.$toolTip.find('a[data-operation="follow"]').replaceWith('<a class="card-focus_complete-btn" data-operation="unfollow" href="javascript: void 0;" data-login="yes"><span>已关注</span></a>');var b=follow();b.bind(nameCardToolTip.$toolTip,a.ukey)}}function showTooltip(a,b){var c=$(container),d=elemData.triggerElem,e=$(window).height(),f=$(window).width(),g=elemData.triggerTopViewArea,h=elemData.triggerRightViewArea,i=d.offset().left,j=d.offset().top,k=parseInt(d.css("height")),l=parseInt(d.css("width")),m=[j+k+12,i],n=g>e/2?"down":"up",o=options.offset||10,p=options.width||300,q=options.klass||"name_card";isGroup=options.isGroup||!1,i>f/2&&f-h<p-20&&(m[1]=i-p+50,o=p-o-20);if(window.nameCardShowOrder===b){nameCardToolTip=toolTip(c,{msg:a.resultHtml,position:m,direction:n,offset:o,width:p,klass:q},function(){return!1});if(n==="up")nameCardToolTip.$toolTip.css({display:"block"});else if(n==="down"){var r=parseInt(nameCardToolTip.$toolTip.css("height"));nameCardToolTip.$toolTip.css({top:j-r-17,display:"block"})}if(isGroup){if(window.ukey){var s=follow();s.bind(nameCardToolTip.$toolTip)}}else userFocus(a)}}function getGroupData(a){window.groupInfoCache=window.groupInfoCache||{};var b=elemData.triggerElem.attr("data-group_id"),c={resultHtml:""};groupInfoCache[b]?(c.resultHtml=formatHtml(groupInfoCache[b]),showTooltip(c,a)):$.ajax({url:"/apis/group/group.json",data:{retrieve_type:"by_id",group_id:b},success:function(c){var c=c.result[0],d={};for(var e in c)d[e]=c[e];d.icon=c.icon.large,groupInfoCache[b]=d;if(!d.is_publicly_readable)return;$.ajax({url:"/apis/group/post.json",data:{retrieve_type:"digest_post_by_group",group_id:b,limit:3},success:function(c){groupInfoCache[b].digests=c.result;var d=formatHtml(groupInfoCache[b]),e={resultHtml:d};showTooltip(e,a)},dataType:"json"})},dataType:"json"})}function getUserData(a){window.userInfoCache=window.userInfoCache||{};var b="",c="",d={resultHtml:"",ukey:"",isFollowing:!1,isMe:!1};if(elemData.ukey)b=elemData.ukey,d.ukey=elemData.ukey,c="/apis/community/user/"+b+".json";else if(elemData.nickname)b=elemData.nickname,c="/apis/community/user.json?retrieve_type=by_nickname&nickname="+b;else return d.resultHtml=notExistHtml,showTooltip(d,a),!1;/^group/.test(where)?(d.resultHtml=nameCardHtml+groupFootmark,userInfoCache[b]?(d.resultHtml=formatHtml(userInfoCache[b],d.resultHtml),showTooltip(d,a)):$.ajax({url:c,success:function(b){var c=b.result;b.result.hasOwnProperty("ukey")||c[decodeURI(elemData.nickname)]&&c[decodeURI(elemData.nickname)].hasOwnProperty("ukey")?(d.ukey=c.ukey||c[decodeURI(elemData.nickname)].ukey,elemData.ukey?userInfoCache[d.ukey]=c:elemData.nickname&&(userInfoCache[d.ukey]=c[decodeURI(elemData.nickname)]),$.ajax({url:"/apis/group/user_info.json?ukey="+d.ukey,success:function(b){var c=b.result;for(var e in c)userInfoCache[d.ukey][e]=c[e];d.resultHtml=formatHtml(userInfoCache[d.ukey],d.resultHtml),showTooltip(d,a)},error:function(){d.resultHtml=notExistHtml,showTooltip(d,a)},dataType:"json"})):(d.resultHtml=notExistHtml,showTooltip(d,a))},error:function(){d.resultHtml=notExistHtml,showTooltip(d,a)},dataType:"json"})):/^ask/.test(where)?(d.resultHtml=nameCardHtml+askFootmark,userInfoCache[b]?(d.resultHtml=formatHtml(userInfoCache[b],d.resultHtml),showTooltip(d,a)):$.ajax({url:c,success:function(b){var c=b.result;b.result.hasOwnProperty("ukey")||c[decodeURI(elemData.nickname)]&&c[decodeURI(triggerElemData.nickname)].hasOwnProperty("ukey")?(d.ukey=c.ukey||c[decodeURI(elemData.nickname)].ukey,elemData.ukey?userInfoCache[d.ukey]=c:elemData.nickname&&(userInfoCache[d.ukey]=c[decodeURI(elemData.nickname)]),d.resultHtml=formatHtml(userInfoCache[d.ukey],d.resultHtml),showTooltip(d,a)):(d.resultHtml=notExistHtml,showTooltip(d,a))},error:function(){d.resultHtml=notExistHtml,showTooltip(d,a)},dataType:"json"})):where==="site"&&(d.resultHtml=nameCardHtml+siteFootMark,userInfoCache[b]?(d.resultHtml=formatSiteHtml(userInfoCache[b],d.resultHtml),showTooltip(d,a)):$.ajax({url:c,success:function(b){var c=b.result;b.result.hasOwnProperty("ukey")||c[decodeURI(elemData.nickname)]&&c[decodeURI(triggerElemData.nickname)].hasOwnProperty("ukey")?(d.ukey=c.ukey||c[decodeURI(elemData.nickname)].ukey,elemData.ukey?userInfoCache[d.ukey]=c:elemData.nickname&&(userInfoCache[d.ukey]=c[decodeURI(elemData.nickname)]),$.ajax({url:"/apis/minisite/article.json?retrieve_type=by_ukey&limit=3&ukey="+d.ukey,success:function(b){var c=b.result;userInfoCache[d.ukey]._new_articles=c,d.resultHtml=formatSiteHtml(userInfoCache[d.ukey],d.resultHtml),showTooltip(d,a)},error:function(){d.resultHtml=notExistHtml,showTooltip(d,a)},dataType:"json"})):(d.resultHtml=notExistHtml,showTooltip(d,a))},error:function(){d.resultHtml=notExistHtml,showTooltip(d,a)},dataType:"json"}))}function formatHtml(a,b){var c=a.level==="active"?'class="super-group-name"':"";if(!options.isGroup){var d="";a.introduction&&a.introduction.length>65&&(a.introduction=a.introduction.substr(0,65)+"...");if(a.admin_group&&a.admin_group.length>0){var e='<a href="<%=url%>"><%=title%></a>，';d+="<p>管理的小组：";for(var f=0;f<a.admin_group.length;f++)d+=tmpl(e,{url:a.admin_group[f][1],title:a.admin_group[f][0]});d=d.substr(0,d.length-1),d+="</p>"}var g=tmpl(userAchieveHtml,{badge_counts_gold:a.badge_counts.gold,badge_counts_silver:a.badge_counts.silver,badge_counts_copper:a.badge_counts.copper}),h=a.is_title_authorized?tmpl('<a class="gicon-sai" target="_blank" title="果壳达人:<%=title%>" href="http://www.guokr.com/nuts/">ψ</a>',{title:a.title}):"",i=tmpl(userNutHtml,{is_title_authorized:h});console.log(a),userFollow=tmpl(userFollowHtml,{followings_count:a.followings_count,followings_url:a.url+"followings/",followers_count:a.followers_count,followers_url:a.url+"followers/"}),b=tmpl(b,{url:a.url,avatar_normal:a.avatar.normal,nickname:a.nickname,title:tmpl("<%=title%><%:=br%>",{title:a.title.trim()?a.title:"",br:a.title.trim()?"<br />":""}),userNut:i,nutKlass:c,achieveHtml:g,followHtml:userFollow,introduction:a.title.trim()?a.introduction.trim()?"简介："+a.introduction:"":a.introduction.trim()?"简介："+a.introduction:"简介：这家伙很懒，还没有写简介",posts_count:a.posts_count,digest_posts_count:a.digest_posts_count,post_replies_count:a.post_replies_count,admin_group:d,questions_count:a.questions_count,answers_count:a.answers_count,answer_supports_count:a.answer_supports_count})}else{a.introduction_summary&&a.introduction_summary.length>65&&(a.introduction_summary=a.introduction_summary.substr(0,65)+"...");if(a.is_application_required)var j=a.is_membership_applied?groupAppliedHtml:groupApplyHtml;else var j=a.is_member?groupUnfollowHtml:groupFollowHtml;followStr=tmpl(j,{memberNum:a.members_count,url:a.url,groupId:a.id}),groupAchieve=tmpl(groupAchieveHtml,{groupPostNum:a.posts_count});var k=a.level==="active"?tmpl('<a class="gicon-super" title="此小组处于高维空间，拥有更多功能与玩法" href="<%=url%>"></a>',{url:a.url}):"",b=tmpl(nameCardHtml,{avatar_normal:a.icon,nickname:a.name,nutKlass:c,achieveHtml:groupAchieve,userNut:k,followHtml:followStr,introduction:a.introduction_summary,title:"",url:a.url,groupId:a.id});digestsHtml="",digests=a.digests;if(digests){var l='<li class="gellipsis"><a href="<%=url%>"><%=title%></a></li>';for(var m=0;m<digests.length;m++){var n=digests[m];digestsHtml+=tmpl(l,{url:n.url,title:n.title})}var o=tmpl(groupFoot,{postDigests:digestsHtml});b+=o}}return b}function formatSiteHtml(a,b){var c="",d='<a href="<%=url%>"><%=title%></a><br/>',e=a._new_articles;if(e&&e.length>0){c+='<div class="card-footmark">                            <p class="card-footmark-tit"><span>主题站最新文章</span></p>                            <div class="card-footmark-info">';for(var f=0;f<e.length;f++)c+=tmpl(d,{url:e[f].url,title:e[f].title});c=c.substr(0,c.length-1),c+="</div></div>"}a.introduction&&a.introduction.length>65&&(a.introduction=a.introduction.substr(0,65)+"...");var g=tmpl(userAchieveHtml,{badge_counts_gold:a.badge_counts.gold,badge_counts_silver:a.badge_counts.silver,badge_counts_copper:a.badge_counts.copper}),h=a.is_title_authorized?tmpl('<a class="gicon-sai" target="_blank" title="果壳达人:<%=title%>" href="http://www.guokr.com/nuts/">ψ</a>',{title:a.title}):"",i=tmpl(userNutHtml,{is_title_authorized:h});return userFollow=tmpl(userFollowHtml,{followings_count:a.followings_count,followings_url:a.url+"followings/",followers_count:a.followers_count,followers_url:a.url+"followers/"}),b=tmpl(b,{url:a.url,avatar_normal:a.avatar.normal,nickname:a.nickname,title:tmpl("<%=title%><%:=br%>",{title:a.title.trim()?a.title:"",br:a.title.trim()?"<br />":""}),userNut:i,nutKlass:"",achieveHtml:g,followHtml:userFollow,introduction:a.title.trim()?a.introduction.trim()?"简介："+a.introduction:"":a.introduction.trim()?"简介："+a.introduction:"简介：这家伙很懒，还没有写简介",site_articles:c}),b}function follow(){return{mouseEvents:function(a){function b(a){a.removeClass().addClass("card-focus_cancel-btn").html("<span>取消</span>")}function c(a){if(options.isGroup)var b="<span>已加入</span>";else var b="<span>已关注</span>";a.removeClass().addClass("card-focus_complete-btn").html(b)}a.delegate(".card-focus_complete-btn","mouseenter",function(){b($(this))}),a.delegate(".card-focus_cancel-btn","mouseleave",function(){c($(this))})},followApi:function(a,b,c){$.ajax({url:"/apis/community/relationship/follow.json",data:{ukey_following:a},type:b,success:function(a){a.ok&&c&&c()},dataType:"json"})},joinApi:function(id,type,cb){$.ajax({url:"/apis/group/member.json",data:{group_id:id},type:type,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017?alert("你是这个小组的管理员，不能退出"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})},doFollow:function(a,b){var c=this,d=a.data("operation");if(options.isGroup){var e=d==="join"?"post":"delete",f=a.data("group_id");this.joinApi(f,e,function(){e==="post"?a.replaceWith(tmpl('<a class="card-focus_complete-btn" data-operation="unjoin" href="javascript: void 0;" data-login="yes" data-group_id="<%=id%>"><span>已加入</span></a>',{id:f})):a.replaceWith(tmpl('<a class="card-focus-btn" data-operation="join" href="javascript: void 0;" data-login="yes" data-group_id="<%=id%>"><span>加入</span></a>',{id:f}))})}else{var e=d==="follow"?"post":"delete";this.followApi(b,e,function(){e==="post"?a.replaceWith('<a class="card-focus_complete-btn" data-operation="unfollow" href="javascript: void 0;" data-login="yes"><span>已关注</span></a>'):a.replaceWith('<a class="card-focus-btn" data-operation="follow" href="javascript: void 0;" data-login="yes"><span>关注</span></a>')})}},bind:function(a,b){var c=this;a.doOnce(function(){a.delegate("a[data-operation]","click",function(){c.doFollow($(this),b)}),c.mouseEvents($(this))})}}}var nameCardHtml='<div class="card-head">                    <a href="<%=url%>" class="card-user_pic"><img src="<%=avatar_normal%>" title="<%=nickname%>"></a>                    <div class="card-user_info">                        <div class="card-user_info-name">                            <a href="<%=url%>" <%:=nutKlass%> ><%=nickname%></a><%:=userNut%>                        </div>                        <div class="card-achieve-stat"><%:=achieveHtml%></div>                    </div>                </div>                <div class="card-focus"><%:=followHtml%></div>                <div class="card-desp"><%:=title%><%=introduction%></div>',userNutHtml='<span class="card-user_info-nuts"><%:=is_title_authorized%></span>',userAchieveHtml=' <span class="card-achieve-num"><i class="card-achieve-icon-gold"></i><%=badge_counts_gold%></span>                            <span class="card-achieve-num"><i class="card-achieve-icon-silver"></i><%=badge_counts_silver%></span>                            <span class="card-achieve-num"><i class="card-achieve-icon-copper"></i><%=badge_counts_copper%></span>',groupAchieveHtml='<span class="card-achieve-small"><%=groupPostNum%>&nbsp;帖子</span>',userFollowHtml='<a href="javascript:void 0;" class="card-focus-btn" data-operation="follow" data-login="yes"><span>关注</span></a>                            <a href="<%=followings_url%>" class="card-focus-num">关注&nbsp;&nbsp;&nbsp;<span><%=followings_count%></span></a>|                            <a href="<%=followers_url%>" class="card-focus-num">被关注&nbsp;&nbsp;&nbsp;<span><%=followers_count%></span></a>',groupFollowHtml='<a href="javascript:void 0;" class="card-focus-btn" data-operation="join" data-login="yes" data-group_id="<%=groupId%>"><span>加入</span></a>                            <a href="<%=url%>members/" class="card-focus-num">成员&nbsp;&nbsp;&nbsp;<span><%=memberNum%></span></a>',groupUnfollowHtml='<a href="javascript:void 0;" class="card-focus_complete-btn" data-operation="unjoin" data-login="yes" data-group_id="<%=groupId%>"><span>已加入</span></a>                            <a href="<%=url%>members/" class="card-focus-num">成员&nbsp;&nbsp;&nbsp;<span><%=memberNum%></span></a>',groupApplyHtml='<a href="<%=url%>" class="card-focus-btn" data-login="yes"><span>申请</span></a>                        <a href="<%=url%>members/" class="card-focus-num">成员&nbsp;&nbsp;&nbsp;<span><%=memberNum%></span></a>',groupAppliedHtml='<span class="card-focus_complete-btn"><span>已加入</span></span>                            <a href="<%=url%>members/" class="card-focus-num">成员&nbsp;&nbsp;&nbsp;<span><%=memberNum%></span></a>',groupFootmark='<div class="card-footmark">                            <p class="card-footmark-tit"><span>小组足迹</span></p>                            <div class="card-footmark-info">                                <p>                                    发帖：<span><%=posts_count%></span>                                    精华：<span><%=digest_posts_count%></span>                                    回帖：<span><%=post_replies_count%></span>                                </p>                                <%:=admin_group%>                            </div>                        </div>',askFootmark='<div class="card-footmark">                            <p class="card-footmark-tit"><span>问答足迹</span></p>                            <div class="card-footmark-info">                                <p>                                    提问：<span><%=questions_count%></span>                                    回答：<span><%=answers_count%></span>                                    获得支持：<span><%=answer_supports_count%></span>                                </p>                            </div>                        </div>',groupFoot='<div class="card-footmark">                        <p class="card-footmark-tit"><span>最新精华帖</span></p>                        <ul class="card-footmark-info">                            <%:=postDigests%>                        </ul>                    </div>',siteFootMark="<%:=site_articles%>",notExistHtml='<div class="card-head">抱歉，该用户不在这个位面。</div>',nameCardToolTip=null,container="body",options={},elemData={},where="",showOrder=window.nameCardShowOrder||0,ukey=ukey,nameCard=function(a,b,c,d,e){init(a,b,c,d,e)};return nameCard}),G.def("bdShare",function(){var a='分享到：                            <a data-cmd="douban" class="gicon-share-db" href="#" title="分享到豆瓣">豆瓣</a>                            <a data-cmd="tsina" class="gicon-share-sina" href="#" title="分享到新浪微博">新浪微博</a>                            <a data-cmd="qzone" class="gicon-share-qzone" href="#" title="分享到QQ空间">QQ空间</a>                            <a data-cmd="weixin" class="gicon-share-weixin" href="#" title="分享到微信">微信</a>                            <a data-cmd="tqq" class="gicon-share-qqmb" href="#" title="分享到腾讯微博">腾讯微博</a>                            <div class="counter"><b><s></s></b><span class="bds_count share_counter" data-cmd="count"></span></div>',b;return function(c,d){b=$(c);var e=d||a;b.html(e)}}),G.def("support",function(){"use strict";var a=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),b="Webkit Moz O ms Khtml".split(" "),c=document.createElement("div");return{fixed:function d(){if(typeof d.r!="undefined")return d.r;var a=!0;if(G.ua.isIpad||G.ua.isIphone)a=navigator.userAgent.match(/[5-9]_[0-9]/)!==null;else{var b=document.createElement("div"),c=document.createElement("div");b.style.position="absolute",b.style.top="200px",c.style.position="fixed",c.style.top="100px",b.appendChild(c),document.body.appendChild(b),c.getBoundingClientRect&&c.getBoundingClientRect().top==b.getBoundingClientRect().top&&(a=!1),document.body.removeChild(b),b=null,c=null}return d.r=a,a},touchEvent:function e(){if(typeof e.r!="undefined")return e.r;var a=!0,b=["touchstart","touchmove","touchend","touchcancel"];for(var d=0,f=b.length;d<f;d++){var g=b[d];g="on"+g;var h=g in c;h||(c.setAttribute(g,"return;"),h=typeof c[g]=="function");if(!h){a=!1;break}}return e.r=a,a},cssanimation:function f(){if(typeof f.r!="undefined")return f.r;var a=!1,d=c.style,e="animationName",g=e.charAt(0).toUpperCase()+e.substr(1),h=(e+" "+b.join(g+" ")+g).split(" ");for(var i in h)if(d[h[i]]!==undefined){a=!0;break}return f.r=a,a}}}),G.def("Overlay",["support","Event"],function(a,b){function r(a){var b,c;a?(b=(g.height()-l.height())/2+(document.documentElement.scrollTop||window.pageYOffset||0),c=(g.width()-l.width())/2+(document.documentElement.scrollLeft||window.pageXOffset||0)):(b=(g.height()-l.height())/2,c=(g.width()-l.width())/2),l.css({top:b,left:c})}function s(a,b){o&&o.length&&o.css({opacity:a||.5,"background-color":b||"#000"}).show()}function t(){o&&o.length&&o.hide()}function u(){o.css({top:document.documentElement.scrollTop||window.pageYOffset||0,left:document.documentElement.scrollLeft||window.pageXOffset||0})}function v(){o.css({width:g.width(),height:g.height()})}function w(){G.ua.isIE6&&o&&o.length&&(o.css({position:"absolute",bottom:"auto",right:"auto"}),v(),u())}function x(b){if(x.inited)return;x.inited=!0,d=b||"gui",e='<div id="blockWindow" class="'+d+'-block">                           <div class="'+d+'-block-b">                               <h4 class="'+d+'-block-hd">                                   <span id="blockTitle"></span>                                   <a class="blockClose '+d+'-block-close" href="#" title="关闭">X</a>                               </h4>                               <div id="blockContent" class="'+d+'-block-bd"></div>                           </div>                       </div>',l=$(e),l.appendTo("body"),m=$(h),n=$(i),q=[l,m],navigator.userAgent.match(/iPad|iPhone/i)!==null?k=navigator.userAgent.match(/[5-9]_[0-9]/)!==null:(k=a.fixed(),g.resize(function(){p&&p.pos()})),G.ua.isIE6&&g.resize(function(){o&&o.length&&p&&v()}).scroll(function(){o&&o.length&&p&&u()}),l.delegate(j,"click",function(a){a.preventDefault(),p&&p.close()})}function y(a,b,c,d){this._isOpen=!1,x.call(this,d),this._fixed=k,this._coverNeedShowed=!1,this._initedCover=!1,a&&!d&&this.open(a,b,c)}"use strict";var c=0,d,e='<div id="blockWindow" class="gui-block">                           <div class="gui-block-b">                               <h4 class="gui-block-hd">                                   <span id="blockTitle"></span>                                   <a class="blockClose gui-block-close" href="#" title="关闭">X</a>                               </h4>                               <div id="blockContent" class="gui-block-bd"></div>                           </div>                       </div>',f='<iframe src="{v}" id="blockIframe" frameborder="0" width="100%"></iframe>',g=$(window),h="#blockContent",i="#blockTitle",j=".blockClose",k,l,m,n,o,p,q;return y.prototype={openCallBack:function(a){return a&&this.on("open",a,this),this},closeCallBack:function(a){return a&&this.on("close",a,this),this},afterClose:function(a){return a&&this.on("afterClose",a,this),this},afterOpen:function(a){return a&&this.on("afterOpen",a,this),this},isOpen:function(){return this._isOpen},close:function(){return this._isOpen?this.fire("close",q)?(l.hide(),this._isOpen=!1,p=null,this.fire("afterClose",q),this):this:this},open:function(a,b,c){return this.fire("open",q)?(p&&p!==this&&p.close(),p=this,this.undelegate(),b&&this.delegate(b),a&&!G.isHtml(a)&&(a=G.format(f,a)),m.html(a||""),this._title&&n.html(this._title),this._width&&l.width(this._width),l.css("position",!this._fixed||!k?"absolute":"fixed"),this.pos(),l.show(),this._isOpen=!0,c&&c.call(this,m),this.fire("afterOpen",q),this):this},delegate:function(a){if(!a.length){m.delegate(a.selector,a.event,a.func);return}return G.each(a,function(a){this.delegate(a.selector,a.event,a.func)},m),this},undelegate:function(){return m.undelegate(),this},pos:function(){return r(!this._fixed||!k),G.ua.isIE6&&this._cover&&this._cover.length&&this._cover.css(),this},title:function(a){return this._title=a,this._isOpen&&n.html(a),this},width:function(a){return this._width=a,this._isOpen&&(l.width(a),this.pos()),this},pin:function(){if(this._fixed||!k)return;return this._fixed=!0,this._isOpen&&(l.css("position","fixed"),this.pos()),this},unpin:function(){if(!this._fixed)return;return this._fixed=!1,this._isOpen&&(l.css("position","absolute"),this.pos()),this},showCover:function(a,b){if(!o||!o.length)o=$('<div style="position:fixed;top:0;left:0;right:0;bottom:0;display:none;z-index:'+((parseInt(l.css("z-index"),10)||0)-1)+';"></div>').appendTo("body"),w();if(!this._initedCover){var c=this;this.on("afterClose",function(){c._coverNeedShowed&&t()}).on("afterOpen",function(){c._coverNeedShowed&&s(c._coverOpacity,c._coverColor)}),this._initedCover=!0}return typeof a=="string"&&(b=a,a=null),a&&(this._coverOpacity=a),b&&(this._coverColor=b),s(a||this._coverOpacity,b||this._coverColor),this._coverNeedShowed=!0,this},hideCover:function(){return t(),this._coverNeedShowed=!1,this}},b.extend(y),y}),G.def("placeholder",function(){function b(a,b){var c=a.attr("type");if(a.val()==="")if(c!=="password")a.data("origColor",a.css("color")).val(b).css("color","#BBB");else{var d=parseInt(a.css("margin-right")),e=parseInt(a.css("border-right-width")),f=parseInt(a.css("padding-right")),g=a.width(),h=d+e+f+g,i=a.css("font-size"),j=a.outerHeight(),k=$('<span class="_input_placeholder">'+b+"</span>").insertAfter(a).css({color:"#BBB",fontSize:i,lineHeight:j+"px",height:j+"px",marginLeft:"-"+h+"px"});k.css("margin-right",h-k.width()+"px")}}function c(a,b){var c=a.attr("type"),d=a.val();c!=="password"&&d===b?a.val("").css("color",a.data("origColor")):c=="password"&&d===""&&a.next("span._input_placeholder").remove()}"use strict";var a=document.createElement("textarea").placeholder==="";return{init:function(d){if(!a){var e=$(d),f=e.attr("placeholder");b(e,f),e.focus(function(){c(e,f)}).blur(function(){b(e,f)})}return this},submit:function(b,c,d){var e=$(b),f=$(c);return a?f.submit(d):f.submit(function(){var a=e.attr("placeholder"),b=e.val();return b===a&&e.val(""),d.apply(this,arguments)}),this},support:a}}),G.def("toolBar",["bdShare","scrollTo","toolTip","Overlay","tmpl","placeholder"],function(bdShare,scrollTo,toolTip,Overlay,tmpl,placeholder){return toolBar=function($container,groups,questions,homesite){var resultHtml='<ul id="toolBar" class="toolBar-wrap">',html='<li class="tool-{class}"><a {gaevent} id="{id}Tool" class="{class}" href="javascript:void(0);" title="{title}"></a></li>',gaevent="";if(groups)for(var a in groups){if(typeof g_page_name!==undefined&&g_page_name==="groupPostContentPage")switch(a){case"commentTitle":gaevent='data-gaevent="post_toolbar_new:post"';break;case"gotopTitle":gaevent='data-gaevent="post_toolbar_top:post"';break;case"mygroupsTitle":gaevent='data-gaevent="post_toolbar_love:post"';break;case"replyTitle":gaevent='data-gaevent="post_toolbar_comment:post"';break;case"shareTitle":gaevent='data-gaevent="post_toolbar_share:post"'}resultHtml+=html.replace("{title}",groups[a]).replace(/{class}/g,a.substr(0,a.length-5)).replace("{id}",a.substr(0,a.length-5)).replace("{gaevent}",gaevent)}else if(questions)for(var a in questions){if(typeof g_page_name!==undefined&&g_page_name==="askContentPage")switch(a){case"questionTitle":gaevent='data-gaevent="question_toolbar_ask:question"';break;case"shareTitle":gaevent='data-gaevent="question_toolbar_share:question"';break;case"gotopTitle":gaevent='data-gaevent="question_toolbar_top:question"'}resultHtml+=html.replace("{title}",questions[a]).replace(/{class}/g,a.substr(0,a.length-5)).replace("{id}",a.substr(0,a.length-5)).replace("{gaevent}",gaevent)}else if(homesite)for(var a in homesite){if(typeof g_page_name!==undefined&&g_page_name==="articlePage")switch(a){case"casualTitle":gaevent='data-gaevent="article_toolbar_random:article"';break;case"gotopTitle":gaevent='data-gaevent="article_toolbar_backtop:article"';break;case"replyTitle":gaevent='data-gaevent="article_toolbar_comment:article"';break;case"shareTitle":gaevent='data-gaevent="article_toolbar_share:article"'}resultHtml+=html.replace("{title}",homesite[a]).replace(/{class}/g,a.substr(0,a.length-5)).replace("{id}",a.substr(0,a.length-5)).replace("{gaevent}",gaevent)}resultHtml+="</ul>",$container.append(resultHtml);if($(window).width()<1100){var window_w=$(window).width()-59;$("#toolBar").css({left:window_w,"margin-left":"0","margin-right":"5"})}$("#toolBar").hide(),$(window).scroll(function(){$(document).scrollTop()>1200?$("#toolBar").show():$("#toolBar").hide()}),$(".tool-share").bind("mouseenter",function(){var a='<a data-cmd="douban" class="gicon-share-db" href="#" title="分享到豆瓣">豆瓣</a>                            <a data-cmd="tsina" class="gicon-share-sina" href="#" title="分享到新浪微博">新浪微博</a>                            <a data-cmd="qzone" class="gicon-share-qzone" href="#" title="分享到QQ空间">QQ空间</a>                            <a data-cmd="weixin" class="gicon-share-weixin" href="#" title="分享到微信">微信</a>                            <a data-cmd="tqq" class="gicon-share-qqmb" href="#" title="分享到腾讯微博">腾讯微博</a>';tooltip=toolTip($(".tool-share"),option={position:[0,-236],width:205,klass:"bdsharebuttonbox"}),$(".tool-share .bdsharebuttonbox").attr("data-tag","shareMain"),window._bd_share_main.init(),bdShare(".tool-share .bdsharebuttonbox",a)}),$(".tool-share").mouseleave(function(){$(".tool-share .bdsharebuttonbox").remove()}),$("#gotopTool").click(function(a){a.preventDefault(),scrollTo(0)}),$("#casualTool").attr("href","http://www.guokr.com/article/goodluck");if(!ukey)return $("#commentTool").attr("data-login","yes"),$("#mygroupsTool").attr("data-login","yes"),$("#replyTool").attr("data-login","yes"),$("#questionTool").attr("data-login","yes"),!1;$("#questionTool").attr({href:"/questions/new",target:"_blank"}),$("#commentTool").click(function(){function join(){var a='<div class="gui-block-apply">                            <p class="fl" style="color:red"></p>                            <p class="text">只有加入这个小组才能获得发帖权限</p>                            <p class="fr">                                <a href="javascript: void 0;" class="join-btn" id="joinBtn">确认加入并发帖</a>                                <a href="javascript: void 0;" class="blockClose">取消</a>                            </p>                         </div>',b=new Overlay;b.open(a,null,function(){b.title("提示"),$("#joinBtn").click(function(a){a.preventDefault(),b.close(),joinGroup(),window.open(tool_bar_data.create_url,"_blank")})})}function joinGroup(cb){$.ajax({url:"/apis/group/member.json",data:{group_id:g_group_id},type:"POST",async:!1,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017?alert("你是这个小组的管理员，不能退出"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})}function applyJoinGroup(a,b){$.ajax({url:"/apis/group/member_application.json",data:{group_id:g_group_id,annotation:a},type:"POST",success:function(a){a.ok&&b&&b()},dataType:"json"})}function joinBt(){var a={applyBlock:'<div class="gui-block-apply">                                <textarea class="gttxt" placeholder="说点什么给管理员..." id="applyDetail"></textarea>                                <p class="fl" style="color:red"></p>                                <p class="fr">                                    <a href="javascript: void 0;" class="gnbtn" id="applyBtn">提交</a>                                    <a href="javascript: void 0;" class="blockClose">取消</a>                                </p>                             </div>',applied:'<span class="state-btn">已申请，待审核</span>'},b={applyTextTooLong:"申请不能超过250个字！",applyEmpty:"说点什么，让管理员了解你"},c=new Overlay;c.open(a.applyBlock,null,function(){return c.title("加入这个小组需要审核哦，说说你的理由吧"),placeholder.init("#applyDetail"),$("#applyBtn").click(function(d){d.preventDefault();var e=$("#applyDetail"),f=e.val();applyTip=$(this).parent().prev(),placeholder.support||f===e.attr("placeholder")&&(e.val(""),f="");if(f.length>250)return applyTip.text(b.applyTextTooLong),!1;if(!f.length)return applyTip.text(b.applyEmpty),!1;applyJoinGroup(f,function(){c.close(),$("#joinBt").replaceWith(a.applied)})}),!0})}g_join_option=="all"&&g_is_member==0?join():g_join_option=="apply"&&g_is_member==0?joinBt():window.open(tool_bar_data.create_url,"_blank")}),$("#replyTool").attr("href","#commentsReplyer");var mygroupsHtml;(function(){$.ajax({url:"/apis/group/favorite.json?offset&limit=12",type:"GET",success:function(a){var b=a.result,c,d,e;myGroupsHtml='<div class="myGroups-wrap">';if(b.length>0)for(var f=0;f<b.length;f++)c=b[f].name,d=b[f].url,e='<a href="<%=groupsUrl%>"><%=groupsName%></a>',e=tmpl(e,{groupsUrl:d,groupsName:c}),myGroupsHtml+=e;else myGroupsHtml+='<a class="add-groups" href="http://www.guokr.com/group/all/">加入一些有趣的小组</a>';myGroupsHtml+='<a class="mygroups-set" target="_blank" href="/group/user/joined/">设置常去的小组</a></div>'},dataType:"json"})})(),$(".tool-mygroups").bind("mouseenter",function(){toolTip($("#toolBar .tool-mygroups"),option={msg:myGroupsHtml,position:[0,-236],width:215}),$(".tooltip .tooltip-up").remove()}),$(".tool-mygroups").mouseleave(function(){$(".tool-mygroups .tooltip").remove()})},toolBar}),G.def("./group/indexPage",["../lib/autoComplete","./searchGroup","../lib/nameCard","../lib/toolBar"],function(a,b,c,d){return{all:function(){function e(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10,isGroup:!0},{triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}function f(){var a='<div class="submit-tip-box icon-hot-tip"><div class="submit-tip">正在热烈讨论的帖子<b class="gnarrow-up"></b></div></div>',b='<div class="submit-tip-box icon-best-tip"><div class="submit-tip">被组长设为精华的帖子<b class="gnarrow-up"></b></div></div>';$(".gicon-hot").hover(function(){$(this).css("position","relative").html(a)},function(){$(this).css("position","static").html("")}),$(".gicon-best").hover(function(){$(this).css("position","relative").html(b)},function(){$(this).css("position","static").html("")})}$("#groupsRefresh").doOnce(function(){var a=$("#groups").find("ul"),b=a.length,c=0;$(this).click(function(){var d=a.eq(c),e;c++,c%=b,e=a.eq(c),d.hide(),e.show()})}),$("#newGroupsRefresh").doOnce(function(){var a=$("#newGroups").find("ul"),b=a.length,c=0;$(this).click(function(){var d=a.eq(c),e;c++,c%=b,e=a.eq(c),d.hide(),e.show()})});var a=function(){var a=$("#changeBtn :first-child"),b=$("#changeBtn :last-child"),c=$("#postsList ul"),d=c.length,e=0,f=function(a){c.addClass("ghide"),c.eq(a).removeClass("ghide")},g=function(){a.click(function(a){e=e<=0?d-1:--e,f(e),a.preventDefault()}),b.click(function(){e=e>=d-1?0:++e,f(e),event.preventDefault()})};g()};a();var b=null;$(".gwrap").delegate("a[data-group_id]","mouseenter",function(){var a=$(this),d=this.getBoundingClientRect().top,f=this.getBoundingClientRect().right;b=window.setTimeout(e(a,d,f,c),500)}),$(".gwrap").delegate("a[data-group_id]","mouseleave",function(){clearTimeout(b),b=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(b)},function(){$(this).remove(),window.nameCardShowOrder++})}),tool_bar_data!==null&&d($(".gwrap"),{commentTitle:"发布一个新帖子 ",mygroupsTitle:"常去的小组 ",gotopTitle:"回到顶部 "},null,null),f()}}}),G.def("Anime",["support"],function(a){return"use strict",{addCssString:function(a){var b=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(b),b.setAttribute("type","text/css"),b.styleSheet?b.styleSheet.cssText=a:b.innerHTML+=a},loading:function(a){a.jquery||(a=$(a))},flipping:function(b,c,d,e){function h(){e&&e(b)}c=c||500,d=d||0;var f=".flip-container {                        -webkit-perspective: 1000;                        -moz-perspective: 1000;                        -o-perspective: 1000;                        perspective: 1000;                    }                    .gui-anime-flipping {                        -webkit-transform: rotateY(180deg);                        -moz-transform: rotateY(180deg);                        -o-transform: rotateY(180deg);                        transform: rotateY(180deg);                    }                    .flipper {                        -webkit-transition: <t>s;                        -webkit-transform-style: preserve-3d;                        -moz-transition: <t>s;                        -moz-transform-style: preserve-3d;                        -o-transition: <t>s;                        -o-transform-style: preserve-3d;                        transition: <t>s;                        transform-style: preserve-3d;                        position: relative;                    }                    .front, .back {                        -webkit-backface-visibility: hidden;                        -moz-backface-visibility: hidden;                        -o-backface-visibility: hidden;                        backface-visibility: hidden;                        position: absolute;                        top: 0;                        left: 0;                    }                    .front {                        z-index: 2;                    }                    .back {                        -webkit-transform: rotateY(180deg);                        -moz-transform: rotateY(180deg);                        -o-transform: rotateY(180deg);                        transform: rotateY(180deg);                }";if(!a.cssanimation()){b.children(":visible").fadeOut(c/2,function(){$(this).siblings().fadeIn(c/2)}),e&&e(b);return}if(!this.flippingCssAdded){try{this.addCssString(G.format(f,{t:c/1e3,d:d/1e3},/<([^<>]+)>/g))}catch(g){e&&e(b);return}this.flippingCssAdded=!0}b.find(".hide").removeClass("hide"),b.hasClass("gui-anime-flipping")?(b.removeClass("gui-anime-flipping"),setTimeout(function(){b.find(".back").addClass("hide")},c/2)):(b.addClass("gui-anime-flipping"),setTimeout(function(){b.find(".front").addClass("hide")},c/2)),setTimeout(h,c+d)},focusing:function(b,c,d,e){function g(){b.removeClass("gui-anime-focusing"),c&&c(b)}if(!a.cssanimation()){c&&c(b);return}d=d||500,e=e||0;if(!this.focusingCssAdded){try{this.addCssString(G.format("@-webkit-keyframes guiFocusing {                            0%{-webkit-transform: scale(4); opacity:0;}                            100%{-webkit-transform: scale(1); opacity:1;}                        }                        @-moz-keyframes guiFocusing {                            0%{-moz-transform: scale(4); opacity:0;}                            100%{-moz-transform: scale(1); opacity:1;}                        }                        @-o-keyframes guiFocusing {                            0%{-o-transform: scale(4); opacity:0;}                            100%{-o-transform: scale(1); opacity:1;}                        }                        @-ms-keyframes guiFocusing {                            0%{-ms-transform: scale(4); opacity:0;}                            100%{-ms-transform: scale(1); opacity:1;}                        }                        @keyframes guiFocusing {                            0%{transform: scale(4); opacity:0;}                            100%{transform: scale(1); opacity:1;}                        }                        .gui-anime-focusing {                            -webkit-animation-name: guiFocusing;                            -webkit-animation-duration: <t>s;                            -webkit-animation-delay: <d>s;                            -webkit-animation-timing-function: ease-out;                            -moz-animation-name: guiFocusing;                            -moz-animation-duration: <t>s;                            -moz-animation-delay: <d>s;                            -moz-animation-timing-function: ease-out;                            animation-name: guiFocusing;                            animation-duration: <t>s;                            animation-delay: <d>s;                            animation-timing-function: ease-out;                        }",{t:d/1e3,d:e/1e3},/<([^<>]+)>/g))}catch(f){c&&c(b);return}this.focusingCssAdded=!0}b.addClass("gui-anime-focusing"),setTimeout(g,d+e)},shaking:function(b,c,d,e){function g(){b.removeClass("gui-anime-shaking"),b.removeClass("gui-anime-shaking-inline"),c&&c(b)}if(!a.cssanimation()){c&&c(b);return}d=d||500,e=e||0;if(!this.shakingCssAdded){try{this.addCssString(G.format("@-webkit-keyframes guiShaking {                            0% { -webkit-transform: translate(2px, 1px) rotate(0deg);transform: translate(2px, 1px) rotate(0deg); }                            10% { -webkit-transform: translate(-1px, -2px) rotate(-1deg);transform: translate(-1px, -2px) rotate(-1deg); }                            20% { -webkit-transform: translate(-3px, 0px) rotate(1deg);transform: translate(-3px, 0px) rotate(1deg); }                            30% { -webkit-transform: translate(0px, 2px) rotate(0deg);transform: translate(0px, 2px) rotate(0deg); }                            40% { -webkit-transform: translate(1px, -1px) rotate(1deg);transform: translate(1px, -1px) rotate(1deg); }                            50% { -webkit-transform: translate(-1px, 2px) rotate(-1deg);transform: translate(-1px, 2px) rotate(-1deg); }                            60% { -webkit-transform: translate(-3px, 1px) rotate(0deg);transform: translate(-3px, 1px) rotate(0deg); }                            70% { -webkit-transform: translate(2px, 1px) rotate(-1deg);transform: translate(2px, 1px) rotate(-1deg); }                            80% { -webkit-transform: translate(-1px, -1px) rotate(1deg);transform: translate(-1px, -1px) rotate(1deg); }                            90% { -webkit-transform: translate(2px, 2px) rotate(0deg);transform: translate(2px, 2px) rotate(0deg); }                            100% { -webkit-transform: translate(1px, -2px) rotate(-1deg);transform: translate(1px, -2px) rotate(-1deg); }                          }                          @-moz-keyframes guiShaking {                            0% { -moz-transform: translate(2px, 1px) rotate(0deg);transform: translate(2px, 1px) rotate(0deg); }                            10% { -moz-transform: translate(-1px, -2px) rotate(-1deg);transform: translate(-1px, -2px) rotate(-1deg); }                            20% { -moz-transform: translate(-3px, 0px) rotate(1deg);transform: translate(-3px, 0px) rotate(1deg); }                            30% { -moz-transform: translate(0px, 2px) rotate(0deg);transform: translate(0px, 2px) rotate(0deg); }                            40% { -moz-transform: translate(1px, -1px) rotate(1deg);transform: translate(1px, -1px) rotate(1deg); }                            50% { -moz-transform: translate(-1px, 2px) rotate(-1deg);transform: translate(-1px, 2px) rotate(-1deg); }                            60% { -moz-transform: translate(-3px, 1px) rotate(0deg);transform: translate(-3px, 1px) rotate(0deg); }                            70% { -moz-transform: translate(2px, 1px) rotate(-1deg);transform: translate(2px, 1px) rotate(-1deg); }                            80% { -moz-transform: translate(-1px, -1px) rotate(1deg);transform: translate(-1px, -1px) rotate(1deg); }                            90% { -moz-transform: translate(2px, 2px) rotate(0deg);transform: translate(2px, 2px) rotate(0deg); }                            100% { -moz-transform: translate(1px, -2px) rotate(-1deg);transform: translate(1px, -2px) rotate(-1deg); }                          }                          @keyframes guiShaking {                            0% { transform: translate(2px, 1px) rotate(0deg); }                            10% { transform: translate(-1px, -2px) rotate(-1deg); }                            20% { transform: translate(-3px, 0px) rotate(1deg); }                            30% { transform: translate(0px, 2px) rotate(0deg); }                            40% { transform: translate(1px, -1px) rotate(1deg); }                            50% { transform: translate(-1px, 2px) rotate(-1deg); }                            60% { transform: translate(-3px, 1px) rotate(0deg); }                            70% { transform: translate(2px, 1px) rotate(-1deg); }                            80% { transform: translate(-1px, -1px) rotate(1deg); }                            90% { transform: translate(2px, 2px) rotate(0deg); }                            100% { transform: translate(1px, -2px) rotate(-1deg); }                          }                          .gui-anime-shaking-inline,                          .gui-anime-shaking {                            display:block;                            position: relative;                            -webkit-animation-name: guiShaking;                            -webkit-animation-duration: <t>s;                            -webkit-animation-delay: <d>s;                            -webkit-transform-origin:50% 50%;                            -webkit-animation-iteration-count: 1;                            -webkit-animation-timing-function: linear;                            -moz-animation-name: guiShaking;                            -moz-animation-duration: <t>s;                            -moz-animation-delay: <d>s;                            -moz-transform-origin:50% 50%;                            -moz-animation-iteration-count: 1;                            -moz-animation-timing-function: linear;                            animation-name: guiShaking;                            animation-duration: <t>s;                            animation-delay: <d>s;                            transform-origin:50% 50%;                            animation-iteration-count: 1;                            animation-timing-function: linear;                          }                          .gui-anime-shaking-inline {                            display: inline-block;                        }",{t:d/1e3,d:e/1e3},/<([^<>]+)>/g))}catch(f){c&&c(b);return}this.shakingCssAdded=!0}b.css("display")==="inline"?b.addClass("gui-anime-shaking-inline"):b.addClass("gui-anime-shaking"),setTimeout(g,d+e)}}}),G.def("Count",["Anime"],function(a){function c(a,c,d,e){var f=b.exec(a.text()),g;g=+f[2]+c,d!=null&&(g=Math.max(d,g)),e!=null&&(g=Math.min(e,g)),a.text(f?(f[1]||"")+g+(f[3]||""):"")}function d(a,c,d,e){var f=b.exec(a.text());d!=null&&(c=Math.max(d,c)),e!=null&&(c=Math.min(e,c)),a.text(f?(f[1]||"")+c+(f[3]||""):"")}"use strict";var b=/([^\-0-9]+)?([\-0-9]+)([\w\W]+)?/;return function(b,e,f){var g=$(b);this.add=function(b,d){return c(g,b,e,f),d&&a[d](g),this},this.set=function(a){return d(g,a,e,f),this}}}),G.def("./group/listPage",["../lib/Count","../lib/toolTip","../lib/Overlay","../lib/placeholder","./searchGroup"],function(Count,toolTip,Overlay,placeholder,searchGroup){return{joinGroup:function(type,id,cb){$.ajax({url:"/apis/group/member.json",data:{group_id:id},type:type,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017?alert("你是这个小组的管理员，不能退出"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})},applyJoinGroup:function(a,b,c){$.ajax({url:"/apis/group/member_application.json",data:{group_id:b,annotation:a},type:"POST",success:function(a){a.ok&&c&&c()},dataType:"json"})},login:function(){var a={join:function(a,b){return'<a class="focus-btn follow-btn" href="javascript:void 0;" data-id="'+a+'" data-method="'+b+'" data-operation="quit"><span class="gnicon-tick"></span>已加入</a>'},quit:function(a,b,c,d){return'<a class="gnbtn-plat follow-btn" href="javascript:void 0;" data-id="'+a+'" data-operation="'+b+'" data-method="'+c+'"><span>+</span>'+d+"</a>"},applyBlock:'<div class="gui-block-apply">                                <textarea class="gttxt" placeholder="说点什么给管理员..." id="applyDetail"></textarea>                                <p class="fl" style="color:red"></p>                                <p class="fr">                                    <a href="javascript: void 0;" class="gnbtn" id="applyBtn">提交</a>                                    <a href="javascript: void 0;" class="blockClose">取消</a>                                </p>                             </div>',applied:'<span class="focus-btn follow-btn"><span class="gnicon-tick"></span>已申请</span>'},b={applyTextTooLong:"申请理由不能超过250个字！",applyEmpty:"说点什么，让管理员了解你"},c={join:1,quit:-1},d={join:"POST",quit:"DELETE"},e=this.joinGroup,f=this.applyJoinGroup,g=new Overlay;$(".join-list").delegate("a.focus-btn","mouseenter",function(){var a=$(this);a.removeClass("focus-btn").addClass("gnbtn-frame").html('<span class="gnicon-cancel">-</span>退出')}),$(".join-list").delegate("a.gnbtn-frame","mouseleave",function(){var a=$(this);a.removeClass("gnbtn-frame").addClass("focus-btn").html('<span class="gnicon-tick"></span>已加入')}),$(".join-list").delegate("a[data-operation]","click",function(){var h=$(this),i=h.data("operation"),j=h.attr("data-method"),k=h.attr("data-id"),l=j==="apply"?"申请":"加入",m=new Count(h.parent().find(".join-list-desc span"));i==="quit"?e(d[i],k,function(){h.replaceWith(a.quit(k,j,j,l)),m.add(c[i])}):i==="join"?e(d[i],k,function(){h.replaceWith(a.join(k,j)),m.add(c[i])}):g.open(a.applyBlock,null,function(){return g.title("加入这个小组需要申请哦，说说你的理由吧"),placeholder.init("#applyDetail"),$("#applyBtn").click(function(c){c.preventDefault();var d=$("#applyDetail"),e=d.val();applyTip=$(this).parent().prev(),placeholder.support||e===d.attr("placeholder")&&(d.val(""),e="");if(e.length>250)return applyTip.text(b.applyTextTooLong),!1;if(!e.length)return applyTip.text(b.applyEmpty),!1;f(e,k,function(){g.close(),h.replaceWith(a.applied)})}),!0})})},unlogin:function(){},all:function(){var a=function(a,b){var c=$(a).find("ul"),d=c.length,e=0;b.click(function(){var a=c.eq(e),b;e++,e%=d,b=c.eq(e),a.hide(),b.show()})};$("#refreshHot").doOnce(function(){a("#hotGroups",$(this))}),$("#refreshNew").doOnce(function(){a("#newGroups",$(this))})}}}),G.def("./group/singlePage",["../lib/Count","../lib/toolTip","../lib/scrollTo","../lib/Overlay","../lib/placeholder","./searchGroup","../lib/nameCard","../lib/toolBar","../lib/tmpl"],function(Count,toolTip,scrollTo,Overlay,placeholder,searchGroup,nameCard,toolBar,tmpl){return{joinGroup:function(type,g_group_id,cb){$.ajax({url:"/apis/group/member.json",data:{group_id:g_group_id},type:type,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017?alert("你是这个小组的管理员，不能退出"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})},applyJoinGroup:function(a,b,c){$.ajax({url:"/apis/group/member_application.json",data:{group_id:b,annotation:a},type:"POST",success:function(a){a.ok&&c&&c()},dataType:"json"})},invite:function(a,b){$.ajax({url:"/apis/group/member/invite.json",data:{group_id:g_group_id,operation:a},type:"POST",success:function(a){a.ok&&b&&b()},dataType:"json"})},login:function(){var a={join:function(a,b,c){return c?'<a id="joinBt" class="state-btn" href="javascript:void 0;" data-id="'+a+'" data-method="'+b+'" data-operation="quit">已加入&nbsp;/&nbsp;退出</a>':'<a class="focus-btn follow-btn" href="javascript:void 0;" data-id="'+a+'" data-method="'+b+'" data-operation="quit"><span class="gnicon-tick"></span>已加入</a>'},quit:function(a,b,c,d,e){return e?'<a id="joinBt" data-gaevent="group_one_button_join:group" class="gnbtn-primary" href="javascript:void 0;" data-id="'+g_group_id+'" data-operation="'+b+'">'+d+"</a>":'<a class="gnbtn-plat follow-btn" href="javascript:void 0;" data-id="'+a+'" data-operation="'+b+'" data-method="'+c+'"><span>+</span>'+d+"</a>"},applyBlock:'<div class="gui-block-apply">                                <textarea class="gttxt" placeholder="说点什么给管理员..." id="applyDetail"></textarea>                                <p class="fl" style="color:red"></p>                                <p class="fr">                                    <a href="javascript: void 0;" class="gnbtn" id="applyBtn">提交</a>                                    <a href="javascript: void 0;" class="blockClose">取消</a>                                </p>                             </div>',mainApplied:'<span class="state-btn">已申请，待审核</span>',applied:'<span class="focus-btn follow-btn"><span class="gnicon-tick"></span>已申请</span>'},b={applyTextTooLong:"申请不能超过250个字！",applyEmpty:"说点什么，让管理员了解你"},c={join:1,quit:-1},d={join:"POST",quit:"DELETE"},e=this.joinGroup,f=this.applyJoinGroup,g=this.invite,h=new Overlay;$("#joinBt, .ranks a[data-operation]").live("click",function(g){g.preventDefault();var i=$(this),j=i.data("operation"),k=i.attr("data-method"),l=i.attr("data-id"),m=i.attr("id")==="joinBt"?!0:!1,n=k==="apply"?"申请":"加入",o=m?new Count("#memberCounter"):new Count(i.parent().find(".group-members"));j==="quit"?(e(d[j],l,function(){i.replaceWith(a.quit(l,k,k,n,m)),o.add(c[j])}),m&&(g_is_member=!1)):j==="join"?(e(d[j],l,function(){i.replaceWith(a.join(l,k,m)),o.add(c[j])}),m&&(g_is_member=!0)):h.open(a.applyBlock,null,function(){return h.title("加入这个小组需要审核哦，说说你的理由吧"),placeholder.init("#applyDetail"),$("#applyBtn").click(function(c){c.preventDefault();var d=$("#applyDetail"),e=d.val();applyTip=$(this).parent().prev(),placeholder.support||e===d.attr("placeholder")&&(d.val(""),e="");if(e.length>250)return applyTip.text(b.applyTextTooLong),!1;if(!e.length)return applyTip.text(b.applyEmpty),!1;f(e,l,function(){h.close(),m?$("#joinBt").replaceWith(a.mainApplied):i.replaceWith(a.applied)})}),!0})}),$("#invite").delegate("a","click",function(){var b=$(this),d=b.data("operation"),e=b.attr("data-method"),f=b.attr("data-id"),h=!0,i=e==="apply"?"申请":"加入",j=new Count("#memberCounter");g(d,function(){d=="accept"?($("#invite").replaceWith(a.join(f,e,h)),j.add(c.join),g_is_member=!0):d=="refuse"&&($("#invite").replaceWith(a.quit(f,e,e,i,h)),j.add(c.quit),g_is_member=!1)})}),$("#newPost").doOnce(function(){this.click(function(a){if(!g_is_member){a.preventDefault();var b=$(this).parent();b.css("overflow","visible").css("z-index","999").addClass("gclear");var c=toolTip(b,{msg:'<p style="color:#666;font-size:12px;line-height:1.5;text-align:left;">只有小组成员才能发言，先加入小组吧<a style="margin-left:2em;" class="sw_btn-ext" id="tipClose" href="javascript:void 0;">知道了</a></p>',position:[-68,485],direction:"down",offset:120,width:150},function(){return!1});b.find("s").css("background-color","transparent").css("color","#BDBDBD").css("zoom","1"),$("#tipClose").click(function(){c.remove(),scrollTo($(".main-info"))})}})}),$(".ranks").delegate("a.focus-btn","mouseenter",function(){var a=$(this);a.removeClass("focus-btn").addClass("gnbtn-frame").html('<span class="gnicon-cancel">-</span>退出')}),$(".ranks").delegate("a.gnbtn-frame","mouseleave",function(){var a=$(this);a.removeClass("gnbtn-frame").addClass("focus-btn").html('<span class="gnicon-tick"></span>已加入')})},unlogin:function(){},all:function(){function f(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10},{ukey:e,nickname:f,triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}function g(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10,isGroup:!0},{triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}function h(){var a='<div class="submit-tip-box icon-hot-tip"><div class="submit-tip">正在热烈讨论的帖子<b class="gnarrow-up"></b></div></div>',b='<div class="submit-tip-box icon-best-tip"><div class="submit-tip">被组长设为精华的帖子<b class="gnarrow-up"></b></div></div>';$(".gicon-hot").hover(function(){$(this).css("position","relative").html(a)},function(){$(this).css("position","static").html("")}),$(".gicon-best").hover(function(){$(this).css("position","relative").html(b)},function(){$(this).css("position","static").html("")})}$("#tabMenu").length&&$(document).click(function(a){$.contains($("#tabMenu")[0],a.target)?$("#tabMenuBtn").next().toggle():$("#tabMenuBtn").next().hide()});var a=$("#postsSelect");if(a.length){var b=a.find(".tab-options");$(document).click(function(c){$.contains(a[0],c.target)?b.toggle():b.hide()})}var c=$("#groupContentSearch p"),d=$("#contentSearch");c.length&&d.focus(function(){c.addClass("focus")}).blur(function(){c.removeClass("focus")});var e=null;$(".gwrap").delegate('a[href*="/i/"][data-ukey]',"mouseenter",function(){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;e=window.setTimeout(f(a,b,c,nameCard),500)}),$(".gwrap").delegate('a[href*="/i/"][data-ukey]',"mouseleave",function(){clearTimeout(e),e=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(e)},function(){$(this).remove(),window.nameCardShowOrder++})}),$(".gwrap").delegate('a[href*="/n/"]',"mouseenter",function(){if(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/.test($(this).attr("href"))){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;e=window.setTimeout(f(a,b,c,nameCard),500)}}),$(".gwrap").delegate('a[href*="/n/"]',"mouseleave",function(){/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/.test($(this).attr("href"))&&(clearTimeout(e),e=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(e)},function(){$(this).remove(),window.nameCardShowOrder++}))}),$(".gwrap").delegate("a[data-group_id]","mouseenter",function(){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;e=window.setTimeout(g(a,b,c,nameCard),500)}),$(".gwrap").delegate("a[data-group_id]","mouseleave",function(){clearTimeout(e),e=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(e)},function(){$(this).remove(),window.nameCardShowOrder++})}),toolBar($(".gwrap"),{mygroupsTitle:"常去的小组 ",gotopTitle:"回到顶部 "},null,null),h();if(g_is_admin){var i=[],j=[],k='<div id="op_area" class="op-area ghide"><div class="set-topic"><span>设置分类</span><%:=topics%></div></div>',l='<a class="topic-name" data-topic_id="<%=id%>" onclick="javascript:void(0)"><%=name%></a>';$(".group-single-page ul.titles").delegate("li","click",function(){if(i.length==0)return;$("#op_area").remove(),$(this).after(k),$("#op_area").slideDown().attr("data-post_id",$(this).attr("data-post_id"))}).delegate(".op-area .set-topic a.topic-name","click",function(){var a=$(this).attr("data-topic_id"),b=$(this).parent().parent().attr("data-post_id");$.ajax({type:"PUT",url:"/apis/group/post.json",data:{topic_id:a,post_id:b},success:function(){var c=j[a],d=$("li[data-post_id="+b+"]").find(".titles-txt");d.find(".topic-name").remove(),d.prepend('<span class="topic-name">'+c.name+"</span>"),$("#op_area").slideUp()}})}),$(function(){$.get("/apis/group/topic_setting.json",{retrieve_type:"by_group",group_id:g_group_id},function(a){i=a.result;for(var b=0;b<i.length;b++){var c=i[b];j[c.id]=c}var d=[];for(var b=0;b<i.length;b++)d.push(tmpl(l,i[b]));k=tmpl(k,{topics:d.join("")})})})}}}}),G.def("draftNew",function(){function a(a,b,c){function f(){d._sendDraft(function(){d._timer=setTimeout(f,e)})}var d=this,e=c.interval||3e4;this._bodyLimit=c.bodyLimit||30,this._titleLimit=c.titleLimit||15,this._checkTitle=c.checkTitle||!0,this._isTitleChange=!1,this._isBodyChange=!1,this._prefix=c.prefix||"日志",this._isAsk=c.isAsk||!1,this._$title=c.$title||null,this._success=c.success||null,this._editor=a,this._api=b,this._timer=null,this._markBodyChange=function(){d._isBodyChange=!0},this._markTitleChange=function(){d._isTitleChange=!0},d._checkTitle&&this._$title.bind("keyup",function(){d._markTitleChange()}),this._editor.on("keyup",d._markBodyChange),f()}return"use strict",a.prototype._sendDraft=function(a){var b=this,c={},d=b._editor.getContent({format:"text"}),e=b._$title.val()||b._$title.text();c.body=b._editor?b._editor.getContent():"",c.type=b._prefix,c.location=window.location.href.split("?")[0].split("#")[0]+"#replyer",b._isBodyChange&&d.length>b._bodyLimit||b._isTitleChange&&e.length>b._titleLimit?(c.title=b._$title?$.trim(b._$title.val()||b._$title.text()):"未命名草稿",c.title||(c.title="未命名草稿"),b._api(c,function(){b._success(),b._isTitleChange=!1,b._isBodyChange=!1,a&&a.call(b)})):a&&a.call(b)},a.prototype.destory=function(){var a=this;a._timer&&(clearTimeout(a._timer),a._timer=0),a.checkTitle&&a._$title.unbind(),a._editor.off("keyup",a._markChange)},function(b,c,d){return new a(b,c,d)}}),G.def("AliasUtils",["toolTip"],function(a){function c(a){var c=a!==undefined;if(b!==undefined){if(c){a(b);return}return b}$.ajax({url:"/apis/auth/external_oauth2.json",type:"GET",async:c,success:function(e){if(e.ok){(g_page_name==="postEditPage"||g_page_name==="askContentPage")&&d();var f=e.result,g={is_disabled:f.weibo===undefined},h={is_disabled:f.douban===undefined},i={is_disabled:!1,is_expired:!1};g.is_expired=g.is_disabled?!0:!f.weibo.access_token,h.is_expired=h.is_disabled?!0:!f.douban.access_token,b={weibo:g,douban:h,activity:i},c&&a(b)}},dataType:"json"});if(!c)return b}function d(){ukey&&$.ajax({url:"/apis/flowingboard/item/white_list.json",type:"GET",async:!0,success:function(a){if(a.ok){var c=a.result;for(var d in c)if(ukey===c[d].ukey){!b.weibo.is_disabled&&!b.weibo.is_expired&&$("#shareXl").attr("checked",!0),!b.douban.is_disabled&&!b.douban.is_expired&&$("#shareDb").attr("checked",!0);break}}},dataType:"json"})}"use strict";var b;return{checkAlias:function(b){var d=c();if(d===undefined)return;var e,f,g,h,i,j=$(b),k=!1;G.each(d,function(a,b){(a.is_disabled||a.is_expired)&&$("input[value="+b+"]",j).length&&(k=!0)}),k&&(f='<p style="margin-bottom:2px;line-height:1.5">{msg}</p>                                 <p>                                    <a href="{url}" target="_blank" class="sw_btn-ext" style="margin-right:5px;color: #666;">确定</a>                                    <a href="javascript:void 0;" class="closeBindTip" style="color:#666;">关闭</a>                                 </p>',e={weibo:{disabled:"去新浪微博授权后才可以发布，点击确定前往相应页面。",expired:"新浪微博授权已过期，点击确定前往相应页面重新授权。"},douban:{disabled:"去豆瓣网授权后才可以发布，点击确定前往相应页面。",expired:"豆瓣网授权已过期，点击确定前往相应页面重新授权。"}},h={weibo:weibo_signin,renren:renren_signin,douban:douban_signin},j.css("position","relative").delegate("label,:checkbox","click",function(b){function o(){g.remove(),d[k]={is_disabled:!1,is_expired:!1},c.sign=!1}function p(){g.remove(),c.sign=!1}var c=this,g,k,l,m,n;m=$(this),m.is("label")?n=$("#"+m.attr("for")):(n=m,m=$("label[for="+n.attr("id")+"]",j)),k=n.val(),l=d[k];if(l.is_disabled||l.is_expired){if(c.sign){b.preventDefault();return}c.sign=!0,b.preventDefault(),i=j.css("margin-bottom"),j.css("margin-bottom","100px"),g=a(j,{msg:G.format(f,{msg:e[k][l.is_disabled?"disabled":"expired"],url:h[k]}),width:200,offset:20,position:[30,-10],coordinates:n},function(){j.css("margin-bottom",i)}),$(".closeBindTip",g.$toolTip).one("click",p).prev().one("click",o)}}))},makeShareTmpl:function(a){var b=c(),d=g_page_name=="editBlogPage"||g_page_name=="postEditPage"?"checked":"";if(b===undefined)return"";var e,f,g=!1;return G.each(b,function(a,b){g=!0}),g?(e="<p>同时分享到：",f={weibo:'&nbsp;&nbsp;<input id="shareXl" type="checkbox" value="weibo" name="share_opts" /><label class="gicon-share-lsina" for="shareXl">新浪微博</label>',douban:'&nbsp;&nbsp;<input id="shareDb" type="checkbox" value="douban" name="share_opts" /><label class="gicon-share-ldb" for="shareDb">豆瓣网</label>',activity:'&nbsp;&nbsp;<input id="shareAc" type="checkbox" value="activity" name="share_opts"'+d+' /><label for="shareAc">动态</label>'},G.each(f,function(a,b){e+=a||""}),e+="</p>"):e=G.format('绑定其他帐号：<a class="gicon-share-lsina" target="_blank" href="{weibo}" title="绑定新浪微博帐号">新浪微博</a><!--<a class="gicon-share-lrr" target="_blank" href="{renren}" title="绑定人人网帐号">人人网</a>--><a class="gicon-share-ldb" target="_blank" href="{douban}" title="绑定豆瓣网帐号">豆瓣网</a>',{weibo:weibo_signin,renren:renren_signin,douban:douban_signin}),a&&$(a).html(e),e},makeRecoTmpl:function(a){var b=c();if(b===undefined)return"";var d,e,f=!1;return G.each(b,function(a,b){b!=="activity"&&!a.is_disabled&&!a.is_expired&&(f=!0)}),f?(d="同时分享到：",e={weibo:'&nbsp;&nbsp;<input id="recoXl" type="checkbox" class="recoShare" value="weibo" name="weibo" /><label class="gicon-share-lsina" for="recoXl">新浪微博</label>',douban:'&nbsp;&nbsp;<input id="recoDb" type="checkbox" class="recoShare" value="douban" name="douban" /><label class="gicon-share-ldb" for="recoRr">豆瓣网</label>'},G.each(b,function(a,b){!a.is_disabled&&!a.is_expired&&(d+=e[b]||"")}),a&&$(a).html(d),d):""}}}),G.def("ValidateUtils",function(){"use strict";var a=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,b=/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@\?\^=%&:\/~\+#]*[\w\-@?\^=%&\/~\+#])?/;return{isEnglishAndNumber:function(a){return!a||/[^\x00-\xff]/ig.test(a)},isNickname:function(a){return!a||!a.match(/[^\u3400-\u4db5\u4e00-\u9fcbA-Za-z0-9._\-]/)},isNicknameLen:function(a){if(!a)return!0;var b=a.match(/[^\x00-\xff]/ig),c=a.length+(b==null?0:b.length);return c<=20},isEmail:function(b){return!b||a.test(b)},isUrl:function(a){return!a||b.test(a)},hasAngleBrackets:function(a){return!a||a.indexOf(">")===-1&&a.indexOf("<")===-1},isVcode:function(a){return!a||/^[0-9a-zA-Z]{4}$/.test(a)},isCJKWithSpace:function(a){return!a||!a.match(/[^\u3400-\u4db5\u4e00-\u9fcb\s\u3000]/)}}}),G.def("validate",["ValidateUtils"],function(a){function b(a){return a._isLive?$(a._selector):(a._$inputs||(a._$inputs=$(a._selector)),a._$inputs)}function c(a,b,c,d,e){var f=!0;for(var g in c){if(g.slice(0,1)==="_")continue;var h,i=c[g],j=c._desc,k=d[g];if(!k)continue;h=k.call(b,i,c,a);switch(h){case!0:break;case!1:e(!1,b,g,c),c._isValidated=!1;return;default:c._asyncValidateError=0,f=!1}}c._isValidated=!0,e(f||null,b,g,c)}function d(a,c){for(var d in c){var e=c[d],f=b(e);if(f.filter(a).length!==0)return e._isLive&&(e._$inputs=f),e}}function e(a,e,f,g,h){function i(a){var b=a.target,i=d(b,f);if(!i)return;if(e.beforeValidate&&!e.beforeValidate.call(null,b))return;c(b,i._$inputs,i,g,h),e.afterValidate&&e.afterValidate.call(null,b)}a.focusout(i).delegate("input","focus",function(a){var b=this,c=d(b,f);if(!c)return;c._isValidated=!1}).delegate("input","keydown",function(a){a.keyCode===13&&i(a)}).delegate("input:checkbox","change",function(a){i(a)}).submit(function(a){var d=this;if(d.sign===!0)return a.preventDefault(),!1;d.sign=!0;if(e.beforeFormValidate&&!e.beforeFormValidate.call(null,d))return a.preventDefault(),d.sign=!1,!1;var i,j,k=!0;for(i in f){j=f[i];if(j._isValidated&&j._asyncValidateError===0)continue;if(j._isValidated===!1||j._asyncValidateError!==0){k=!1;continue}c(null,b(j),j,g,h),j._isValidated===!1&&(k=!1)}if(k===!1)return a.preventDefault(),d.sign=!1,!1;if(e.afterFormValidate&&!e.afterFormValidate.call(null,d))return a.preventDefault(),d.sign=!1,!1;e.showAsyncMsg=!1,d.sign=!1})}function f(a,b){return function(){return b&&!b.apply(null,arguments)?!1:a.apply(null,arguments)}}function g(a,b){return function(){return a.apply(this,arguments)?b?b.apply(this,arguments):!0:!1}}return"use strict",function(d,h,i){var j={},k={showAsyncMsg:!0,msgClass:{error:"tip",success:"success"},msgPlace:function(a){return a.next()}},l={},m={pattern:function(a,b,c){return(new RegExp(a)).test(this.val())},required:function(a,b,c){return!a||!!this.val()},email:function(b,c,d){return a.isEmail(this.val())},url:function(b,c,d){return a.isUrl(this.val())},eq:function(b,c,d){var e=this;return l[b]||(l[b]=!0,j.afterValidate(function(a){$(a).is("#"+b)&&j.validate(d,e,c)})),e.val()===$("#"+b).val()},min:function(a){var b=this.val();return!b||parseInt(b,10)<=a},max:function(a){var b=this.val();return!b||parseInt(b,10)>=a},minlength:function(a,b,c){return this.val().length>=a},maxlength:function(a,b,c){return this.val().length<=a},nickname:function(){return a.isNickname(this.val())},nicknameLen:function(){return a.isNicknameLen(this.val())},async:function(a,b,c){var d=this.val(),e={},f=this;if(!d)return!0;e[a.param]=d,$.ajax({type:a.type||"POST",url:a.url,data:e,dataType:a.dataType||"json",success:function(c){j.asyncTrigger(a.success?a.success(c):c,f,"async",b,G.isFun(a.msg)?a.msg(c):a.msg)},error:function(){a.error&&a.error.call(f)}})}},n={pattern:"{desc}格式不正确",required:"{desc}是必填的",email:"{desc}格式不正确",url:"{desc}格式不正确",eq:"两次输入的{desc}不一致",min:"{desc}必需大于{arg}",max:"{desc}必需小于{arg}",minlength:"{desc}太短，至少{arg}个字",maxlength:"太长了，不能超过{arg}个字",nickname:"仅限中英文、数字、“.”、“-”及“_”",nicknameLen:"太长，最多10个汉字或者20个英文、数字"},o=$(d),p={};return j.validate=function(a,b,d){return c(a,b,d,m,j.trigger),this},j.getMsgPlace=function(a,b){var c=b._msgPlace;return c||(c=b._msgPlace=k.msgPlace(a)),c},j.trigger=function(a,b,c,d,e,f){var g=j.getMsgPlace(b,d),h=k.msgClass,i=d[c],l=d._desc;return e=n[c]||e,a==null?k.clearCallBack?k.clearCallBack.call(null,g,e,i,l):g.removeClass(h.error).removeClass(h.success).text(""):a===!0?(k.successCallBack?k.successCallBack.call(null,g,e,i,l):g.removeClass(h.error).addClass(h.success).html("&nbsp;"),f&&(d._asyncValidateError=0)):a===!1&&(k.errorCallBack?k.errorCallBack.call(null,g,e,i,l):g.removeClass(h.success).addClass(h.error).text(e.replace("{desc}",l).replace("{arg}",i)),f&&(d._asyncValidateError=1)),this},j.asyncTrigger=function(a,b,c,d,e){return d._isValidated&&k.showAsyncMsg&&j.trigger(!!a,b,c,d,e,!0),this},j.method=function(a,b,c){return m[a]=b,n[a]=c,this},j.rules=function(a){if(!a)return;var b,c;for(c in a)b=a[c],b._isValidated=null,b._asyncValidateError=0,b._selector||(b._selector="#"+c);return $.extend(p,a),this},j.afterFormValidate=function(a){var b=k.afterFormValidate;return k.afterFormValidate=f(a,b),this},j.beforeFormValidate=function(a){var b=k.beforeFormValidate;return k.beforeFormValidate=g(a,b),this},j.beforeValidate=function(a){var b=k.beforeValidate;return k.beforeValidate=g(a,b),this},j.afterValidate=function(a){var b=k.afterValidate;return k.afterValidate=function(){b&&b.apply(this,arguments),a.apply(this,arguments)},this},o.attr("novalidate",!0),$.extend(k,i),j.rules(h),e(o,k,p,m,j.trigger),j}}),G.def("Select",function(){var a=!1;return Select=function(a,b,c,d){this.selectId=a,this.optTmp=b||'<li><a href="javascript: void 0;" optId="{optionId}">{optName}</a></li>',this.option=c,this.callBack=d,this.init()},Select.prototype={constructor:Select,init:function(){this.buildSelect(),this.bindHover(),this.bindClick(),this.setOptions()},buildSelect:function(){var a=this,b=a.option,c=b.length,d="",e=$("#"+a.selectId);e.append('<ul class="options"></ul>');for(var f=0;f<c;f++)d+=a.optTmp.replace("{optionId}",b[f].id).replace("{optName}",b[f].name);e.find(".options").html(d)},bindHover:function(){$(document).delegate(".gselect","hover",function(){$(this).css({cursor:"pointer"})})},bindClick:function(){var b=this;$("#"+b.selectId).delegate(".gselect-box","click",function(){var c=$("#"+b.selectId),d=c.find(".options"),e=d.css("display");return e=="none"?(a&&$(".options").hide(),d.css("display","block"),a=!0):(d.css("display","none"),a=!1),!1}),$("body").click(function(){if(a)return $(".options").hide(),a=!1,!1})},setOptions:function(){var a=this,b=$("#"+a.selectId);b.delegate(".options li a","click",function(){a.setOption($(this)),a.callBack($(this))}),a.setOption(b.find(".options li:eq(0) a"))},setOption:function(a){var b=this,c=$("#"+b.selectId),d=a.html(),e=c.find(".gselected");e.html(d),c.find("ul a").removeClass("select-act"),a.addClass("select-act")}},Select}),G.def("Trie",function(){function b(a,b){var c=[];for(var d=0,e=a.length;d<e;d++)a[d].indexOf(b)!==-1&&c.push(a[d]);return c}function c(a){var b=[],c={},d;for(var e=0,f=a.length;e<f;e++)d=a[e],c[d]||(b.push(d),c[d]=!0);return b}function d(d,e,f,g){function i(c,d,f){if(c.length===0){j(f,a-d);return}var g;(g=f[c.slice(0,1)])?(g.$&&c.length===1&&(h=h.concat(g.$)),i(c.slice(1),d,g)):f.$&&(h=h.concat(b(f.$,e)))}function j(a,b){if(b===0)return;var c;for(var d in a)c=a[d],c.$&&(h=h.concat(c.$)),j(c,b-1)}var h=[];e=new String(e),g&&(e=g(e)),i(e,e.length,d),f(c(h))}"use strict";var a=G.ua.isIE6?3:5;return function(b,c,e){var f,g=!1,h=!1,i,j,k="";typeof g_obj_id!="undefined"&&(k=g_obj_id),G.isFun(b)?g||(g=!0,b(a,G.ua.isIE6?"":k,function(a){g=!1,f=e?e(a):a,i&&j&&d(f,i,j,c)},function(){h=!0,g=!1,e&&e()})):f=b,this.calculate=function(a,b){if(!a||h){b();return}g?(i=a,j=b):d(f,a,b,c)},this.isLoading=function(){return g},this.isFailed=function(){return h}}}),G.def("TextUtils",function(){function l(a,b){var c=typeof a[b];return c==="function"||c=="object"&&!!a[b]||c=="unknown"}function m(b,c){return typeof b[c]!=a}function n(a,b){return typeof a[b]=="object"&&!!a[b]}function o(a){window.console&&window.console.log&&window.console.log("TextInputs module for Rangy not supported in your browser. Reason: "+a)}function p(b,c,d){return c<0&&(c+=b.value.length),typeof d==a&&(d=c),d<0&&(d+=b.value.length),{start:c,end:d}}function q(a,b,c){return{start:b,end:c,length:c-b,text:a.value.slice(b,c)}}function r(){return n(document,"body")?document.body:document.getElementsByTagName("body")[0]}function u(a,b){return function(){var c=this.jquery?this[0]:this,d=c.nodeName.toLowerCase();if(c.nodeType==1&&(d=="textarea"||d=="input"&&c.type=="text")){var e=[c].concat(Array.prototype.slice.call(arguments)),f=a.apply(this,e);if(!b)return f}if(b)return this}}"use strict";var a="undefined",b,c,d,e,f,g,h,i,j,k,s=document.createElement("textarea");r().appendChild(s);if(m(s,"selectionStart")&&m(s,"selectionEnd")&&l(s,"setSelectionRange"))b=function(a){var b=a.selectionStart,c=a.selectionEnd;return q(a,b,c)},c=function(a,b,c){var d=p(a,b,c);a.focus(),a.setSelectionRange(d.start,d.end)},j=function(a,b){b?a.selectionEnd=a.selectionStart:a.selectionStart=a.selectionEnd};else{if(!(l(s,"createTextRange")&&n(document,"selection")&&l(document.selection,"createRange"))){r().removeChild(s),o("No means of finding text input caret position");return}b=function(a){a.focus();var b=0,c=0,d,e,f,g,h=document.selection.createRange();return h&&h.parentElement()==a&&(f=a.value.length,d=a.value.replace(/\r\n/g,"\n"),e=a.createTextRange(),e.moveToBookmark(h.getBookmark()),g=a.createTextRange(),g.collapse(!1),e.compareEndPoints("StartToEnd",g)>-1?b=c=f:(b=-e.moveStart("character",-f),b+=d.slice(0,b).split("\n").length-1,e.compareEndPoints("EndToEnd",g)>-1?c=f:(c=-e.moveEnd("character",-f),c+=d.slice(0,c).split("\n").length-1))),q(a,b,c)};var t=function(a,b){return b-(a.value.slice(0,b).split("\r\n").length-1)};c=function(a,b,c){var d=p(a,b,c),e=a.createTextRange(),f=t(a,d.start);e.collapse(!0),d.start==d.end?e.move("character",f):(e.moveEnd("character",t(a,d.end)),e.moveStart("character",f)),e.select()},j=function(a,b){var c=document.selection.createRange();c.collapse(b),c.select()}}r().removeChild(s),e=function(a,b,d,e){var f;b!=d&&(f=a.value,a.value=f.slice(0,b)+f.slice(d)),e&&c(a,b,b)},d=function(a){var c=b(a);e(a,c.start,c.end,!0)},i=function(a){var d=b(a),e;return d.start!=d.end&&(e=a.value,a.value=e.slice(0,d.start)+e.slice(d.end)),c(a,d.start,d.start),d.text},k=function(a,b){b==null&&(b=a.value.length),c(a,b,b)},f=function(a,b,d,e){var f=a.value,g;a.value=f.slice(0,d)+b+f.slice(d),e&&(g=d+b.length,c(a,g,g))},g=function(a,d){var e=b(a),f=a.value;a.value=f.slice(0,e.start)+d+f.slice(e.end);var g=e.start+d.length;c(a,g,g)},h=function(a,d,e){var f=b(a),g=a.value;a.value=g.slice(0,f.start)+d+f.text+e+g.slice(f.end);var h=f.start+d.length,i=h+f.length;c(a,h,i)},$.fn.extend({getSelection:u(b,!1),setSelection:u(c,!0),collapseSelection:u(j,!0),deleteSelectedText:u(d,!0),deleteText:u(e,!0),extractSelectedText:u(i,!1),insertText:u(f,!0),replaceSelectedText:u(g,!0),surroundSelectedText:u(h,!0),insertCaret:u(k,!0)})}),G.def("at",["tmpl","Menu","Trie","TextUtils"],function(a,b,c,d){function u(a){!$.contains(j[0],a.target)&&k[0]!==a.target&&y()}function v(a,b,c,d){$.ajax({type:"get",url:"/apis/community/relationship/following_nickname.json",success:function(a){a.ok&&c(a.result)},error:d,dataType:"json"})}function w(){if(w.inited)return;i=$("body"),j=$(e).appendTo(i),k?j.css("marginTop","30px"):k=j.prepend(f).find("input"),l=j.children("div"),q=new c(v,function(a){return a.toLowerCase().replace(s,"")},function(b){return l.html(a(g,{tip:b==null?null:t.tip,noneTip:b==null?t.loadFailTip:null})),p&&p.remove(),b});var b=!1;k.keydown(function(a){switch(a.which){case 13:a.preventDefault(),y(k.val()),b=!1;break;case 27:a.preventDefault(),y(),b=!1;break;case 40:p&&(b=!0,a.preventDefault(),p.down());break;case 38:p&&(b=!0,a.preventDefault(),p.up());break;case 8:k.val().length===0&&(a.preventDefault(),y()),b=!1;break;default:setTimeout(function(){var a=k.val();a&&a.slice(a.length-1).match(r)&&(a=a.replace(r,""),y(a))}),b=!1}}),window.addEventListener?k[0].addEventListener("input",function(){x(k.val())},!1):window.attachEvent&&k[0].attachEvent("onpropertychange",function(){!b&&window.event.propertyName=="value"&&x(k.val())}),w.inited=!0}function x(c){var d=null,e=null;q.calculate(c,function(c){q.isFailed()?d=t.loadFailTip:q.isLoading()?e=t.loadingTip:c==null?e=t.tip:c.length===0&&(d=t.noneTip),l.html(a(g,{tip:e,noneTip:d})),p&&p.remove(),c&&c.length>0&&(c=c.slice(0,10),p=(new b(l,c,function(a){y(a)},{useFocus:!0,disableMouseChangeEvent:!0})).onChange(function(a){k.val(a)}).onHide(function(){k.insertCaret()}))})}function y(a){a==="妹子"&&alert("﹁_﹁，出门右转是性情！"),j.css("left",-99999),a?m(a+" "):n(),i.unbind("click",u),h&&h.unbind("click",u),o=!1}"use strict";var e='<div class="gui-at"><div></div></div>',f='<input class="gbtxt"/>',g='<% if(tip) { %><p><%=tip%></p><% } %><% if (noneTip) { %><p class="gui-at-none"><%=noneTip%></p><% } %>',h,i,j,k,l,m,n,o=!1,p,q,r=/[^\u3400-\u4db5\u4e00-\u9fcba-zA-Z0-9._\-]/g,s=/[^\u3400-\u4db5\u4e00-\u9fcba-z0-9]/g,t={tip:"输入对方昵称来@TA",loadFailTip:"获取失败，请刷新页面重试",loadingTip:"获取用户列表中...",noneTip:"关注列表无匹配，回车键确认输入"};return function(b,c,d,e,f){if(o)return;o=!0,m=c,n=d,e&&(h=e),f&&(k=f),setTimeout(function(){w(),j.css({top:b.top,left:b.left,display:"block"}),f||k.val(""),k.focus(),x(k.val()),i.click(u),h&&h.click(u)})}}),G.def("./group/postEditPage",["../lib/draftNew","../lib/AliasUtils","../lib/ValidateUtils","../lib/validate","../lib/Select","../lib/at","./searchGroup"],function(a,b,c,d,e,f,g){return{login:function(){function p(a){var b=$("#captcha");a=a.target;if(a.sign===!0)return!1;a.sign=!0;var d=$.trim(g.val()).length,e=c.getContent({format:"text"}),f=e.trim().length,h=c.getContent().trim().length,i;if(d===0)return alert("标题不能为空"),a.sign=!1,!1;if(d>l)return alert("标题字数不能超过"+l+"字"),a.sign=!1,!1;if(h===0)return alert("内容不能为空"),a.sign=!1,!1;if(f>n)return alert("内容字数不能超过"+n+"字"),a.sign=!1,!1;i=G.unique(e.match(o));if(i&&i.length>20)return alert("对不起，不能@超过20个人"),a.sign=!1,!1;if(b.length&&b.attr("type")==="text"&&!b.val())return alert("验证码不能为空"),a.sign=!1,!1}function q(){$(".submit")[0].click()}function r(a,b){h.html('<i class="gicon-draft-save"></i>正在保存').css({visibility:"visible",cursor:"default"}),$.ajax({url:"/apis/community/draft.json",type:"post",data:a,success:function(a){a.ok&&b&&(j=a.result.id,i++,b())},error:function(){i=0,b&&b()},dataType:"json"})}function s(){i?(h.html('<i class="gicon-draft-save"></i>已保存').css({visibility:"visible",cursor:"pointer"}),i===1&&h.hover(function(){$(this).html('<i class="gicon-draft-del"></i>删除草稿').css("cursor","pointer")},function(){$(this).html('<i class="gicon-draft-save"></i>已保存')}).click(function(a){k&&confirm("确定要删除草稿并清空编辑框吗？")&&(k=!1,$.ajax({url:"/apis/community/draft.json",type:"delete",data:{ids:j},success:function(a){g.val(""),c.setContent(""),k=!0,i=0,h.unbind()},dataType:"json"}),$(this).css("visibility","hidden"))})):(h.html('<i class="gicon-draft-save"></i>正在保存').css({visibility:"visible",cursor:"default"}),h.unbind())}var c,d,g=$("#title"),h=$("#draftTip"),i=0,j,k=!0,l=50,m=g_page_name==="postEdit",n=1e4,o=/@[\u3400-\u4db5\u4e00-\u9fcba-zA-Z0-9\._\-]+/g;window.initEditor("#postEdit textarea:first",{width:608,content_css:tinymce_content_css,plugins:"-autoresize -autolink -link -gkimage -video -lists -fullscreen -paste -formula -gkindent -poll -at -gkpatch",toolbar:"bold italic | gkimage video link formula | blockquote bullist numlist | removeformat poll | fullscreen",submit_form_selector:"#postEdit",setup:function(b){c=b;var d={success:function(){s()},interval:2e4,$title:$("#title"),prefix:"帖子"};b.on("init",function(){var b=a(c,r,d);$(window).delegate("#stop","click",function(){b&&b.destory()})})},atFunc:f}),g.keydown(function(a){a.which===9&&(a.preventDefault(),c&&c.focus())}).insertCaret(),d=$("#checkAlias"),d.html(b.makeShareTmpl()).css("margin-top","0"),b.checkAlias(d),$("#is_anon").doOnce(function(){$(".anon-op").delegate("#is_anon","click",function(){var a=$(this),b=a.attr("checked"),c=$("#shareAc");b?(c.attr("disabled","true"),c.removeAttr("checked")):c.removeAttr("disabled").attr("checked","true")})}),$("#postEdit").submit(p),$("#captchaImage").doOnce(function(){function e(b){b.preventDefault(),a.attr("src",c+"?v="+d++)}var a=$("#captchaImage"),b=$("#changeCaptchaImage"),c=a.attr("src"),d=1;b.click(e),a.click(e)}),$(".submit").hover(function(){$(".submit-tip-box").show()},function(){$(".submit-tip-box").hide()}),typeof g_error!="undefined"&&g_error&&alert(g_error),$("#topic").doOnce(function(){var a=function(a){var b=$("#topic"),c=a.attr("topicId");b.find('option[value="'+c+'"]').attr("selected","selected")},b=function(){var a=document.getElementById("topic"),b=a.options[a.selectedIndex].innerHTML;$("#selectTopic .gselected").html(b),$("#selectTopic ul li a").removeClass("select-act"),$('#selectTopic ul a:contains("'+b+'")').addClass("select-act")};g_topics.unshift({id:"__None",name:"选择类别"}),$("#topic").hide();var c=g_topics,d='<li><a href="javascript: void 0;" topicId="{optionId}">{optName}</a></li>',f=new e("selectTopic",d,c,a);b()})}}}),G.def("./group/latestPage",["./searchGroup"],function(a){return{all:function(){}}}),G.def("screenTop",["support","scrollTo"],function(a,b){function i(){var b=f.height();if(g>b*2){a.fixed()||c.css("top",g+b-h);if(e)return;d||(c.appendTo("body"),h+=c.outerHeight(),d=!0),c.show(),e=!0}else e&&(c.hide(),e=!1)}"use strict";var c=$('<a class="gui-screen-top" href="#"><s></s><b></b>返回顶部</a>'),d=!1,e=!1,f=$(window),g,h;return a.fixed()||c.css("bottom","auto"),function(d){a.fixed()||(h=d||80),f.scroll(function(){g=f.scrollTop(),setTimeout(i)}),g=f.scrollTop(),c.click(function(a){a.preventDefault(),b(0)}),i()}}),G.def("Recommend",["Overlay","placeholder","AliasUtils","Count"],function(a,b,c,d){"use strict";var e=function(){return{timerOut:0,url:"/apis/community/user/recommend.json",recommendApi:function(a,b,c){var d=this;$.ajax({url:d.url,type:"POST",data:a,success:function(a){a.ok&&b&&b()},error:function(){c?c():alert("出错啦！")},dataType:"json"})},show:function(b,d,e){var f=this,g={done:"已推荐",tips:{tooLong:"推荐文字不能超过100个字",repeat:"1010分钟之内只能推荐1次"},title:"推荐给关注我的人",placeholder:"说几句话，向关注我的人推荐本文",timer:3e3,successTitle:"推荐成功"},h=new a;$.extend(g,e);var i='<div class="gui-block-reco">                                                <textarea class="t_txt" id="recommendText" placeholder="'+g.placeholder+'"></textarea>                                                <p class="recoShareBox fl">'+c.makeRecoTmpl()+'</p><p class="fr"><a id="recoBt" href="javascript:void 0;" data-operation="ok" class="gbtn" title="确定">确定</a><a class="blockClose sw_btn" href="javascript:void 0;" title="关闭">关闭</a></p>                                              </div>',j='<div class="gui-block-reco">                                            <p class="gui-block-reco-txt">关注你的人会在最新动态里看到你的推荐</p>                                            <p class="fr">                                                <a href="'+activity_url+'" class="gui-block-reco-link" title="查看动态" target="_blank">查看动态</a>                                                <a href="javascript:void 0;" title="关闭" class="blockClose sw_btn">关闭</a>                                            </p>                                        </div>';h.open(i,{event:"click",selector:"[data-operation=ok]",func:function(){return f.sendRecommend(h,b,j,d,g),this}},function(){h.title(g.title)}).closeCallBack(function(){f.timerOut&&clearTimeout(f.timerOut)})},sendRecommend:function(a,b,c,e,f){var g=this,h=$.trim($("#recommendText").val()),i=$(".recoShareBox").find("input:checked"),j=["activity"],k=new d(e);if(h.length>=100)return alert(f.tips.tooLong),!1;i.length&&i.each(function(a){j.push($(this).val())}),b.comment=h,b.target=j,g.recommendApi(b,function(){k.add(1),a.open(c).title(f.successTitle),e.html(e.html().replace(/^推荐/,"已推荐")),g.autoClose(a,f.timer)})},autoClose:function(a,b){var c=this;c.timerOut=setTimeout(function(){a.close()},b)}}};return e}),G.def("beforeLogin",function(){function b(b){if(a)return;var d="成为果壳青年，一起记录科技时代",e=b||1e3,f='<div class="guokr-layer-beforelogin">                            <div class="guokr-layer-bl-con">                                <div class="guokr-layer-mobile-qrcode"></div>                                <div class="guokr-layer-mobile-text">                                    扫描下载果壳网官方App                                    <div>果壳精选，科学走着瞧</div>                                </div>                                <a class="guokr-layer-mobile-icon" href="http://www.guokr.com/mobile/" title="移动应用"></a>                                <div class="guokr-layer-slogan">'+d+'</div>                                <div class="guokr-layer-bl-btn">                                    <a class="gl-weibo" href="'+weibo_signin+'" data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                </div>                                <div class="guokr-layer-bl-btn">                                    <a class="gl-qq" href="'+qq_signin+'"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                </div>                                <div class="guokr-layer-bl-btn">                                    <a class="gl-douban" href="'+douban_signin+'"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                </div>                                <div class="guokr-layer-bl-reg">                                    <a href="javascript: void 0;" data-login="yes" data-gaevent="footer_login:v1.1.1.1:login">登录</a><span>或直接</span>                                </div>                                <div class="guokr-layer-bl-btn">                                    <a class="gl-reg" href="'+url_signup+'"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                </div>                                <div class="gclear"></div>                            </div>                            <div class="guokr-beforelogin-close"><a href="javascript:void(0)">关闭</a></div>                        </div>';$("body").append($(f)),$(".guokr-beforelogin-close").click(function(){c(e)}),$(".guokr-layer-beforelogin").fadeIn(e),a=!0}function c(b){if(!a)return;var c=b||1e3;$(".guokr-layer-beforelogin").fadeOut(c)}"use strict";var a=!1;return function(a,d){var e=d||1e3,f=a||2e3,g=!1;return $(window).one("scroll",function(){b(e)}),setTimeout(function(){b(e)},a),{delLayer:c}}}),G.def("loginGuide",["beforeLogin"],function(a){function i(a,c){if(b)return;b=!0;var e=k(f,a),h=a.posts,i="",j,m,n=4,o=Math.min(n,h.length);for(var p=0;p<o;++p){var q=Math.random()*h.length>>>0,j=h[q];j.image.indexOf("/image/")!==-1?(j.image=j.image.replace(/image/,"thumbnail"),m=j.image.split("."),m[m.length-2]=m[m.length-2]+"_135x90",j.image=m.join(".")):j.image=j.image.replace(/_(\d+)x(\d+)\./,"_135x90."),i+=g.replace(/{post_url}/g,j.url).replace("{post_img}",j.image).replace("{post_title}",j.title),h.splice(q,1)}e=e.replace("{layer_spreads}",i),$("body").append($(e)),$(".guokr-loginGuide-close").click(function(){d=!0,l($(this).parent(),c)}),$(".guokr-layer-loginSpread").fadeIn(c)}function j(a,b,c){var d=e.groupSpread.replace("{id}",a.id);$.ajax({url:d,type:"get",success:function(a){a.ok&&b&&b(a)},error:function(){c&&c()},dataType:"json"})}function k(a,b){return a.replace("{url_signup}",url_signup).replace("{layer_str}",b.layer_str).replace("{img}",b.img).replace("{name}",b.name).replace(/{group_url}/g,b.url).replace("{weibo_signin}",weibo_signin).replace("{qq_signin}",qq_signin).replace("{renren_signin}",renren_signin).replace("{douban_signin}",douban_signin).replace("{renren_signin}",url_signup).replace("{renren_signin}",url_signup)}function l(a,c){if(!b)return;var d=c||1e3;a.fadeOut(d)}"use strict";var b=!1,c=!1,d=!1,e={groupSpread:"/apis/flowingboard/flowingboard/group_spread_{id}.json"},f='<div class="guokr-layer-loginSpread">                            <div class="guokr-layer-bl-con gclear">                                <div class="guokr-layer-login gclear">                                    <div class="guokr-layer-bl-btn">                                        <a class="gl-reg" href="{url_signup}"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                    </div>                                    <div class="guokr-layer-info">或</div>                                    <div class="guokr-layer-bl-reg">                                        <a href="javascript: void 0;" data-login="yes" data-gaevent="footer_login:v1.1.1.1:login">直接登录</a>                                    </div>                                    <div class="gclear"></div>                                    <div class="guokr-layer-slogan">5秒钟登录：</div>                                    <div class="guokr-layer-bl-btn">                                        <a class="gl-weibo" href="{weibo_signin}" data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                    </div>                                    <div class="guokr-layer-bl-btn">                                        <a class="gl-qq" href="{qq_signin}"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                    </div>                                    <div class="guokr-layer-bl-btn">                                        <a class="gl-douban" href="{douban_signin}"  data-gaevent="footer_login:v1.1.1.1:login" target="_blank"></a>                                    </div>                                </div>                                <div class="guokr-layer-spread">                                    {layer_spreads}                                </div>                            </div>                            <div class="guokr-loginGuide-close"><a href="javascript:void(0)">关闭</a></div>                        </div>',g='<div class="guokr-layer-spread-img">                                <a href="{post_url}" target="_blank" class="guokr-layer-img-url" data-gaevent="post_sex:post"><img src="{post_img}"></a>                                <div class="guokr-layer-spread-title"><a href="{post_url}">{post_title}</a></div>                            </div>',h={layer_str:"与百万网友一起玩转",id:g_group_id,img:g_group_img,name:g_group_name,url:g_group_url};return function(b,c,d){var e=d||1e3,f=c||2e3,g=!1,k;b==="post"&&(k=h,j(k,function(a){k.posts=a.result.items,$(window).one("scroll",function(){i(k,e)}),setTimeout(function(){i(k,e)},c)},a))}}),G.def("./censor/report",["Overlay","tmpl"],function(a,b){function d(){var a=$("#reportReasons").find(":checked").next(),b=a.next(),c=b.length?b.val():a.text();return c}function e(a,b,e,f,g){function h(b){b.preventDefault();var e=d();if(!e){alert("请填写举报理由");return}if(e.length<2){alert("多写几个字又不会怀孕");return}if(e.length>140){alert("删除理由不能超过100个字");return}f(a,e,function(){c.close(),g()})}c.open(e,[{event:"click",selector:"#reportSure",func:h},{event:"click",selector:"#reportCancel",func:function(a){a.preventDefault(),c.close()}}]),c.title(b)}function h(a,c,d){if(a.attr("data-report")!="yes")return;var h=a.attr("data-url"),i=a.attr("data-type"),j=a.attr("data-title"),k=a.attr("data-img"),l={url:h,type:i,img:k,title:j},m=b(f,l),n="举报"+i;e(h,n,m,g.reportAdmin,function(){a.text("举报成功"),a.attr("data-report","no")})}var c=new a,f='<div class="block-report-content">                         <% if (img) { %>                         <img src="<%=img%>" width="48" height="48"/>                         <% } %>                         <% if (title) { %>                             <a href="<%=url%>" target="_blank"><%=title%></a>                         <% } %>                     </div>                     <div class="block-report-reasons">                         <h5>举报理由：</h5>                         <ul id="reportReasons">                             <li><input type="radio" id="reason1" name="reason" /><label for="reason1">垃圾广告</label></li>                             <li><input type="radio" id="reason2" name="reason"/><label for="reason2">敏感或淫秽色情信息</label></li>                             <li><input type="radio" id="reason3" name="reason"/><label for="reason3">人身攻击</label></li>                             <li><input type="radio" id="reason4" name="reason"/><label for="reason4">内容涉及抄袭及版权问题</label></li>                             <li class="block-report-reasons-o"><input type="radio" id="reason5" name="reason"/><label for="reason5">其他理由</label><input type="text" class="block-report-reasons-txt"/></li>                         </ul>                     </div>                     <div class="block-report-do">                         <a href="#" id="reportSure">提交</a><a href="#" id="reportCancel">取消</a>                     </div>',g={reportAdmin:function(a,b,c){$.post("/apis/censor/report.json",{url:a,reason:b},c)}};return h}),G.def("slide",function(){function b(a,b,c,d){c.hide(),c.eq(a).show(),d.removeClass(b),d.eq(a).addClass(b)}"use strict";var a="current";return function(c,d,e,f){function o(c){f&&f.showEffect?f.showEffect(c,a,k,m):b(c,a,k,m)}function p(){i=0}function q(){i=1}var g=d||0,h=e||5e3,i=1,j=c.children().eq(0),k=j.children(),l=c.children().eq(1),m=l.children(),n=m.length;return o(g),h!==-1&&setInterval(function(){i&&(g++,g%=n,o(g))},h),j.hover(p,q),m.mouseover(function(){p(),g=m.index(this),o(g)}).mouseout(q),{show:function(){return o(),this},stop:function(){return p(),this},start:function(){return q(),this}}}}),G.def("Basket",["Overlay","Select"],function(a,b){var c=function(c){var d={};return d={template:{newBasket:'<div class="new-basket-box">                                <label for="basketTitle">                                    标题<span class="new-basket-tip">（必填）</span>                                </label>                                <input id="basketTitle" />                                <label for="basketDescrip">描述</label>                                <textarea id="basketDescrip"></textarea>                                <label for="basketCategory">分类</label>                                <div id="basketCategory" class="gselect">                                    <div class="gselect-box">                                        <span class="gselected">选择类别</span>                                        <b class="gnarrow-down"></b>                                    </div>                                </div>                                <span class="basket-form-tip" id="basketCategoryTip"></span>                                <div class="gclear">                                    <a href="javascript:void 0;" class="gbtn gfr" id="createOkBtn">确定</a>                                </div>                            </div>',firstBasket:'<div class="first-basket-box"><a class="first-basket-tip" id="createFirstBlock"><span class="first-basket-add"><span class="first-basket-add-top"></span><span class="first-basket-add-mid"></span><span class="first-basket-add-btm"></span></span>创建一个果篮，把你喜欢的内容收集进来吧。</a><div class="first-basket-btns"><a href="javascript:void 0;" id="createFirstBtn" class="gfr gbtn">创建</a><a href="javascript:void 0;" class="blockClose gfr">取消</a></div></div>',basketList:'<div class="basket-box" id="basketBox"><ul class="baskets">{baskets}</ul><div class="basket-box-footer gclear"><a href="javascript:void 0;" id="createBasketBtn" class="gfl">创建新果篮</a><a href="javascript:void 0;" class="gfr gbtn blockClose">确定</a></div></div>',basketLi:'<li{adClas} data-basket_id="{basketId}"><span class="gfr">{operationTxt}</span><p class="gellipsis">{basketName}</p></li>',addedTag:'<span data-operation="delBasket">已添加</span>',addTag:'<a href="javascript:void 0;" data-operation="addBasket">+ 添加</a>',delTag:'<a href="javascript:void 0;" data-operation="delBasket">- 扔掉</a>'},apis:{basketApi:"/apis/favorite/basket.json",fruitApi:"/apis/favorite/link.json",categoryApi:"/apis/favorite/category.json"},ukey:ukey,fruitUrl:"",btitle:"",defaultOpts:{isCreateBasket:!1,createCallBack:function(a){},delLinkCallBack:function(a){a.parents("li").removeClass("added"),a.replaceWith(d.template.addTag)}},opt:function(){return $.extend({},this.defaultOpts,c)},add:function(a){var b=this,c=a;b.fruitUrl=c.attr("data-url"),b.btitle=c.attr("data-title"),b.getBasket()},del:function(a){var b=g_uid,c=this;$.ajax({url:c.apis.basketApi,type:"delete",data:{basket_id:a},success:function(a){window.location="/i/"+b+"/baskets/"},dataType:"json"})},getLinkInfo:function(a){var b=this;$.ajax({url:"/apis/favorite/link.json",type:"get",data:{ukey:b.ukey,url:b.fruitUrl,retrieve_type:"by_url"},success:function(c){var d=c.result;if(a){for(var e=0;e<d.baskets.length;e++){var f=d.baskets[e].id;for(var g=0;g<a.length;g++)if(a[g].id==f){a[g].contained_fruit=!0;break}}b.showBaskets(a)}},error:function(c){var d=$.parseJSON(c.responseText);d.error_code===200015&&b.showBaskets(a)},dataType:"json"})},getBasket:function(){var a=this;ukey&&$.ajax({url:a.apis.basketApi+"?t="+(new Date).getTime(),type:"get",data:{retrieve_type:"by_ukey",ukey:a.ukey,limit:100},success:function(b){var c=b.result;c.length==0?a.createFirstBasket():a.getLinkInfo(c)},dataType:"json"})},fruitAdd:function(a,b){var c=this;$.ajax({url:c.apis.fruitApi,type:"POST",data:{basket_id:a,url:c.fruitUrl,title:c.btitle},success:function(a){b.parents("li").addClass("added"),b.replaceWith(c.template.addedTag)},dataType:"json"})},fruitDel:function(a,b,c){var d=this,c=c||d.fruitUrl;$.ajax({url:d.apis.fruitApi,type:"delete",data:{basket_id:a,url:c},success:function(a){d.opt().delLinkCallBack(b)},dataType:"json"})},createFirstBasket:function(){var b=new a,c=this;b.open(c.template.firstBasket,null,function(){b.title("创建新果篮"),b.width(432),$(".first-basket-box").delegate("#createFirstBlock","click",function(){c.createBasket()}),$(".first-basket-box").delegate("#createFirstBtn","click",function(){c.createBasket()})})},basketSend:function(a,b,c,d){var e=this;$.ajax({url:e.apis.basketApi,type:"post",data:{title:a,introduction:b,category_id:c},success:function(a){var b=a;e.opt().isCreateBasket?(d.close(),e.opt().createCallBack(b)):e.getBasket()},error:function(a){var b=$.parseJSON(a.responseText);b.error_code===243043?alert("您已经创建过同名果篮"):b.error_code===243045&&alert("您已经超过了可创建果篮的最大限制")},dataType:"json"})},getCategory:function(){var a=this;$.ajax({url:a.apis.categoryApi,type:"GET",success:function(b){var c=b.result;c.unshift({id:"-1",name:"选择类别"}),a.createBasketBlock(c)},dataType:"json"})},createBasket:function(){var a=this;a.getCategory()},createBasketBlock:function(c){var d=new a,e=this;d.open(e.template.newBasket,null,function(){d.title("创建新果篮"),d.width(432);var a='<li><a href="javascript: void 0;" data-category="{optionId}">{optName}</a></li>',f=new b("basketCategory",a,c,function(){});$(".new-basket-box").delegate("#createOkBtn","click",function(){var a=$("#basketTitle").val(),b=$("#basketDescrip").val(),c=$("#basketCategory .options .select-act").data("category");if(a===""){$("#basketTitle").css("border-color","red");return}e.basketSend(a,b,c,d)})})},showBaskets:function(b){var c=new a,d=this,e="",f="",g=b,h=g.length,i,j="";for(var k=0;k<h;k++)i=g[k],adClas=i.contained_fruit?' class="added"':"",j=i.contained_fruit?d.template.addedTag:d.template.addTag,e+=d.template.basketLi.replace("{adClas}",adClas).replace("{basketId}",i.id).replace("{basketName}",i.title).replace("{operationTxt}",j);f=d.template.basketList.replace("{baskets}",e),c.open(f,null,function(){c.title("添加到果篮"),c.width(432),$("#basketBox").delegate(".added","mouseenter",function(){$(this).find(".gfr").html(d.template.delTag)}),$("#basketBox").delegate(".added","mouseleave",function(){$(this).find(".gfr").html(d.template.addedTag)}),$("#basketBox").delegate("[data-operation]","click",function(){var a=$(this),b=a.attr("data-operation"),c=a.parents("li").attr("data-basket_id");if(b=="addBasket")d.fruitAdd(c,a);else if(b=="delBasket")d.fruitDel(c,a);else return}),$("#basketBox").delegate("#createBasketBtn","click",function(){d.createBasket()})})}}};return c}),G.def("jquery/waypoints",function(){var a=jQuery,b="waypoint",c="waypoints";"$:nomunge";var d=a(window),e="waypoint.reached",f=function(a,c){a.element.trigger(e,c),a.options.triggerOnce&&a.element[b]("destroy")},g=function(a,b){var c=b.waypoints.length-1;while(c>=0&&b.waypoints[c].element[0]!==a[0])c-=1;return c},h=[],i=function(b){a.extend(this,{element:a(b),oldScroll:0,waypoints:[],didScroll:!1,didResize:!1,doScroll:a.proxy(function(){var b=this.element.scrollTop(),d=b>this.oldScroll,e=this,g=a.grep(this.waypoints,function(a,c){return d?a.offset>e.oldScroll&&a.offset<=b:a.offset<=e.oldScroll&&a.offset>b}),h=g.length;(!this.oldScroll||!b)&&a[c]("refresh"),this.oldScroll=b;if(!h)return;d||g.reverse(),a.each(g,function(a,b){(b.options.continuous||a===h-1)&&f(b,[d?"down":"up"])})},this)}),a(b).scroll(a.proxy(function(){this.didScroll||(this.didScroll=!0,window.setTimeout(a.proxy(function(){this.doScroll(),this.didScroll=!1},this),a[c].settings.scrollThrottle))},this)).resize(a.proxy(function(){this.didResize||(this.didResize=!0,window.setTimeout(a.proxy(function(){a[c]("refresh"),this.didResize=!1},this),a[c].settings.resizeThrottle))},this)),d.load(a.proxy(function(){this.doScroll()},this))},j=function(b){var c=null;return a.each(h,function(a,d){if(d.element[0]===b)return c=d,!1}),c},k={init:function(d,f){return this.each(function(){var k=a.fn[b].defaults.context,l,m=a(this);f&&f.context&&(k=f.context),a.isWindow(k)||(k=m.closest(k)[0]),l=j(k),l||(l=new i(k),h.push(l));var n=g(m,l),o=n<0?a.fn[b].defaults:l.waypoints[n].options,p=a.extend({},o,f);p.offset=p.offset==="bottom-in-view"?function(){var b=a.isWindow(k)?a[c]("viewportHeight"):a(k).height();return b-a(this).outerHeight()}:p.offset,n<0?l.waypoints.push({element:m,offset:null,options:p}):l.waypoints[n].options=p,d&&m.bind(e,d),f&&f.handler&&m.bind(e,f.handler)}),a[c]("refresh"),this},remove:function(){return this.each(function(b,c){var d=a(c);a.each(h,function(a,b){var c=g(d,b);c>=0&&b.waypoints.splice(c,1)})})},destroy:function(){return this.unbind(e)[b]("remove")}},l={refresh:function(){a.each(h,function(b,d){var e=a.isWindow(d.element[0]),g=e?0:d.element.offset().top,h=e?a[c]("viewportHeight"):d.element.height(),i=e?0:d.element.scrollTop();a.each(d.waypoints,function(a,b){if(!b)return;var c=b.options.offset,e=b.offset;if(typeof b.options.offset=="function")c=b.options.offset.apply(b.element);else if(typeof b.options.offset=="string"){var j=parseFloat(b.options.offset);c=b.options.offset.indexOf("%")?Math.ceil(h*(j/100)):j}b.offset=b.element.offset().top-g+i-c;if(b.options.onlyOnScroll)return;e!==null&&d.oldScroll>e&&d.oldScroll<=b.offset?f(b,["up"]):e!==null&&d.oldScroll<e&&d.oldScroll>=b.offset?f(b,["down"]):!e&&i>b.offset&&f(b,["down"])}),d.waypoints.sort(function(a,b){return a.offset-b.offset})})},viewportHeight:function(){return window.innerHeight?window.innerHeight:d.height()},aggregate:function(){var b=a();return a.each(h,function(c,d){a.each(d.waypoints,function(a,c){b=b.add(c.element)})}),b}};a.fn[b]=function(c){if(k[c])return k[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="function"||!c)return k.init.apply(this,arguments);if(typeof c=="object")return k.init.apply(this,[null,c]);a.error("Method "+c+" does not exist on jQuery "+b)},a.fn[b].defaults={continuous:!0,offset:0,triggerOnce:!1,context:window},a[c]=function(a){return l[a]?l[a].apply(this):l.aggregate()},a[c].settings={resizeThrottle:200,scrollThrottle:100},d.load(function(){a[c]("refresh")})}),G.def("./group/postContentPage",["../lib/bdShare","../lib/scrollTo","../lib/placeholder","../lib/Overlay","../lib/tmpl","../lib/AliasUtils","../lib/Recommend","../lib/draftNew","../lib/loginGuide","../censor/report","../lib/slide","./searchGroup","../lib/Basket","../lib/nameCard","../lib/toolBar","../lib/at","../lib/jquery/waypoints"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function D(){$(".gbbcode-content").delegate("img","mouseenter",function(){var a=$(this);if(a.data("previewPrepared")){a.trigger("previewShow");return}a.wrap('<span class="pic-wrap"></span>').data("previewPrepared",!0).parent().bind("previewShow",function(){var a=$(this),b=window.devicePixelRatio||1,c=a.find("img:first"),d=c.data("orig-width"),e=c.data("orig-height"),f=c.width();if(d/b>64&&e/b>64){a.width(f),c.after('<span id="picView" class="pic-view" href="javascript:void(0);" title="预览图片"></span>');var g=a.find(".pic-view");g.css({left:f-30,cursor:"pointer"}).bind("click",function(a){a.preventDefault();var b=c.data("hashkey"),d=c.data("orig-width"),e=c.data("orig-height");d>64&&e>64&&window.open("/post/"+g_obj_id+"/gallery/#"+b)})}}).mouseleave(function(){$(this).find(".pic-view").remove()}).trigger("previewShow")})}function E(a,b,c){a.doOnce(function(){this.delegate("a[data-operation]","click",function(a){a.preventDefault();var d=$(this);d.data("operation")===b?confirm("确定删除？")&&C.deleteComment(d.data("id"),function(){d.closest("li").fadeOut()}):d.data("operation")===c&&C.likeComment(d.data("id"),function(){var a=d.parent().find(".cmt-do-num");a.text(+a.text()+1),d.after("已顶").remove()})})})}function F(a,c){if(c){var d,e="",f=c.selection,g=a.parent();g.prev().find(">:not(blockquote)").each(function(){e+=$(this).text()+" ";if(e.length>100)return e=e.substring(0,100)+"...",!1}),d=f.getNode(),d.tagName==="P"&&d.innerHTML==="<br>"&&(d.innerHTML='<br data-mce-bogus="1">'),c.insertContent(["<blockquote>引用@",g.siblings(".cmtAuthor").text()," 的话：",tinymce.html.Entities.encodeRaw(e),"</blockquote>{$caret}<br>"].join("")),b($(x))}else b($(x))}function H(a){$.ajax({url:"/apis/group/post.json?retrieve_type=hot_post",success:function(b){if(b.ok&&b.result.length){var c=b.result.length>a?b.result.slice(0,a):b.result,d='<div class="side-title"><h2>全站热贴</h2></div><ul class="side-hotest">';$.each(c,function(a,b){d+='<li><a data-gaevent="post_recommend_weekly_hot:v1.1.1.1:post" target="_blank" href="'+b.url+'">'+b.title+'</a><p class="side-hotest-l">来自：<a href="'+b.group.url+'" target="_blank">'+b.group.name+"</a> 小组</p></li>"}),d+="</ul>",$(d).insertAfter($("#recommendHotPosts"))}},dataType:"json"})}function I(a,b){var c=$("#replyAlsoReco");a.submit(function(a){var c=this,d=$("#captcha");if(c.sign===!0)return!1;c.sign=!0;var e=b.getContent({format:"text"}),f=e.trim().length,g=b.getContent().trim().length,h,i;if(g===0)return alert("请填写内容"),c.sign=!1,!1;if(f>3e3)return alert("回应内容不能超过3000字"),c.sign=!1,!1;i=G.unique(e.match(y));if(i&&i.length>20)return alert("对不起，不能@超过20个人"),c.sign=!1,!1;if(d.length&&d.attr("type")==="text"&&!d.val())return alert("验证码不能为空"),c.sign=!1,!1})}"use strict";var r=g_obj_id,s=g_group_id,t="post",u=$("#comments"),v="#replyForm",w="reply",x="#commentsReplyer",y=/@[\u3400-\u4db5\u4e00-\u9fcba-zA-Z0-9\._\-]+/g,z=!1,A="",B,C={deleteComment:function(a,b){$.ajax({url:"/apis/group/post_reply.json",data:{reply_id:a,reason:""},type:"DELETE",success:function(a){a.ok&&b&&b()},dataType:"json"})},newRecommend:function(a,b,c,d,e){$.ajax({url:"/api/recommend/content/",type:"post",data:{obj_type:b,obj_id:c,content:a,share_sina:e&&e.xl?"on":"",share_renren:e&&e.rr?"on":""},success:d,dataType:"json"})},likeComment:function(a,b){$.ajax({url:"/apis/group/post_reply_liking.json",data:{reply_id:a},type:"POST",success:function(a){a.ok&&b&&b()},dataType:"json"})},deleteDiary:function(a,b){$.post("/api/content/delete/",{obj_type:"daily",obj_id:a},function(a){a==="OK"&&b&&b()})},deletePost:function(a){C.adminDeletePost("作者删除",a)},adminDeletePost:function(a,b){$.ajax({url:"/apis/group/post.json",data:{reason:a,post_id:g_obj_id},type:"DELETE",success:function(a){a.ok&&b&&b()},dataType:"json"})},adminOperation:function(a,b){for(var c in a)a[c]=a[c]?"yes":"no";a.post_id=g_obj_id,$.ajax({url:"/apis/group/post.json",data:a,type:"PUT",success:function(a){a.ok&&b&&b()},dataType:"json"})},adminDeleteReply:function(a,b,c){$.post("/api/group/post_reply.json",{reply_id:a,reason:b},function(a){a==="OK"&&c&&c()})}};return D(),{joinGroup:function(a,b){$.ajax({url:"/apis/group/member.json",data:{group_id:a},type:"POST",success:function(a){a.ok&&b&&b()},dataType:"json"})},htmlEditor:function(a,b){if(g_can_publish_anon_post)var c='<div class="anon-op"><input id="is_anon" type="checkbox" value="y" name="is_anon"><label for="is_anon">匿名发表</label></div>';else var c="";return'<h3 id="replyer">你的评论</h3>                        <form action="/post/'+a+'/#commentsReplyer" method="POST" id="replyForm">                            <input id="csrf_token" name="csrf_token" type="hidden" value="'+b+'">                            <textarea id="reply" name="body"></textarea>                            <input id="captcha" name="captcha" type="hidden" value="">                            <div class="cmts-submit-box gclear"><a href="javascript:void 0;" class="draft-btn" id="draftTip"></a><input type="submit" class="gnbtn-primary" value="发 布"><div class="cmts-share" id="checkAlias" style="position: relative; "></div>'+c+"</div>                        </form>"},initEditor:function(){function l(){$("#replyForm .gnbtn-primary")[0].click()}var a=$("#"+w),b=$(v),c,d,e,g=!0,i=$("#draftTip"),j=0,k;a.doOnce(function(){function a(a){A==="replyQuote"&&F(B,a),u.delegate("a[data-operation=quoteComment]","click",function(){F($(this),a)}),a.focus(!0),z=!0}function f(a,b){i.html('<i class="gicon-draft-save"></i>正在保存').css({visibility:"visible",cursor:"default"}),$.ajax({url:"/apis/community/draft.json",type:"post",data:a,success:function(a){a.ok&&b&&(e=a.result.id,j++,b())},error:function(){j=0,b&&b()},dataType:"json"})}function l(){j?(i.html('<i class="gicon-draft-save"></i>已保存').css({visibility:"visible",cursor:"pointer"}),j===1&&i.hover(function(){$(this).html('<i class="gicon-draft-del"></i>删除草稿').css("cursor","pointer")},function(){$(this).html('<i class="gicon-draft-save"></i>已保存')}).click(function(a){g&&confirm("确定要删除草稿并清空编辑框吗？")&&(g=!1,$.ajax({url:"/apis/community/draft.json",type:"delete",data:{ids:e},success:function(a){k.setContent(""),g=!0,j=0,i.unbind()},dataType:"json"}),$(this).css("visibility","hidden"))})):(i.html('<i class="gicon-draft-save"></i>正在保存').css({visibility:"visible",cursor:"default"}),i.unbind())}window.initEditor("#"+w,{width:648,content_css:tinymce_content_css,submit_form_selector:v,setup:function(e){k=e,k.on("init",function(){a(k),c={success:function(){l()},interval:2e4,$title:$("#articleTitle"),checkTitle:!1,prefix:"帖子"},d=h(k,f,c),I(b,k)})},atFunc:p})});var m=$("#checkAlias");m.html(f.makeShareTmpl()),f.checkAlias(m),$("#is_anon").doOnce(function(){$(".anon-op").delegate("#is_anon","click",function(){var a=$(this),b=a.attr("checked"),c=$("#shareAc");b?c.attr("disabled","true"):c.removeAttr("disabled"),c.removeAttr("checked")})})},login:function(a){var c=this.joinGroup,f=this.htmlEditor,h=this.initEditor,i=g_csrf_token,k=function(){b($(x))},l=function(){if(z)return;$(".reply-box").hide(),$(".cmts-do form").show(),h()};$(".cmts-do .joinBt").length?($("#comments").delegate("a[data-operation=quoteComment]","click",k),$(".cmts-do .reply-box").click(function(){A="joinGroup",c(s,function(){$("#commentsReplyer").html(f(r,i)),$("#comments").undelegate("a[data-operation=quoteComment]","click",k),l()})})):$("#replyer").length&&($(".cmts-do form textarea").text()!==""?(A="draft",l()):($(".reply-box, .gnbtn-primary").one("click",function(){A="reply",l()}),$("a[data-operation=quoteComment]").one("click",function(a){A="replyQuote",B=$(this),z||a.stopPropagation(),l()}))),$("#recommendBt").doOnce(function(){var a=$(this);a.click(function(){var b=new g;b.show(g_share_data,a.find(".recom-num"))})}),E(u,"deleteComment","likeComment");var n={deleteConfirm:"确认删除？"};$("#controlPanel").doOnce(function(){$('a[data-operation="delete"]',this).click(function(a){var b=$(this),c=g_obj_id;a.preventDefault(),confirm(n.deleteConfirm)&&C.deletePost(function(){window.location.href=b.data("goto")})})});if(g_is_admin){var o=new d,p=function(){var a=$("#delReasons").find(":checked").next(),b=a.next(),c=b.length?b.val():a.text();return c},q=function(a,b,c,d){function e(a){a.preventDefault();var b=p();if(!b){alert("请填写删除理由");return}if(b.length>140){alert("删除理由不能超过140个字");return}c(b,function(){o.close(),d()})}o.open(b,[{event:"click",selector:"#delSure",func:e},{event:"click",selector:"#delCancel",func:function(a){a.preventDefault(),o.close()}}]),o.title(a)},t=$("#commentsReplyer"),v="<h4>发表回应</h4><p>此帖子目前不允许回应</p>",w='<div class="block-del-content">                                                <% if (img) { %>                                                <img src="<%=img%>" width="48" height="48"/>                                                <% } %>                                                <div>                                                    <a href="<%=link%>" target="_blank"><%=name%>：</a>                                                    <p class="<%=contentClass%>"><%=content%></p>                                                </div>                                            </div>                                            <div class="block-del-reasons">                                                <h5>删除理由：</h5>                                                <ul id="delReasons">                                                    <li><input type="radio" id="reason1" name="reason" /><label for="reason1">广告、色情等违规内容</label></li>                                                    <li><input type="radio" id="reason2" name="reason"/><label for="reason2">与本组无关的内容</label></li>                                                    <li><input type="radio" id="reason3" name="reason"/><label for="reason3">不适当言论</label></li>                                                    <li><input type="radio" id="reason4" name="reason"/><label for="reason4">违反相关组规</label></li>                                                    <li class="block-del-reasons-o"><input type="radio" id="reason5" name="reason"/><label for="reason5">其他理由</label><input type="text" class="block-del-reasons-txt"/></li>                                                </ul>                                            </div>                                            <div class="block-del-do">                                                <a href="#" id="delSure">提交</a><a href="#" id="delCancel">取消</a>                                            </div>',y={adminDeleteReply:function(){var a=this,b=a.parent(),c=b.siblings(".cmtAuthor"),d=b.siblings(".cmtContent").text().replace("\n",""),f={name:c.text(),link:c.attr("href"),img:b.siblings(".cmtImg").find("img").attr("src"),content:d.length>60?d.slice(0,60)+"...":d,contentClass:""},g={deleteTitle:"删除回应"},h=e(w,f);q(g.deleteTitle,h,C.adminDeleteReply,function(){a.closest("li").slideUp("slow")})},adminDelete:function(){var a=this,b=$("#articleAuthor"),c={name:b.text(),link:b.attr("href"),img:$("#articleAuthorImg").attr("src"),content:$("#articleTitle").text(),contentClass:"block-del-post"},d={deleteTitle:"删除主贴"},f=e(w,c);q(d.deleteTitle,f,C.adminDeletePost,function(){var b=a.attr("data-goto");b?window.location=b:window.location=window.location.pathname+window.location.search})},adminDigestOn:function(){var a=this;C.adminOperation({is_digest:!0},function(){a.replaceWith('<a href="javascript:void(0);" data-operation="adminDigestOff">取消精华</a>')})},adminDigestOff:function(){var a=this;C.adminOperation({is_digest:!1},function(){a.replaceWith('<a href="javascript:void(0);" data-operation="adminDigestOn">加精华</a>')})},adminReplyOff:function(){var a=this;C.adminOperation({is_replyable:!1},function(){a.replaceWith('<a href="javascript:void(0);" data-operation="adminReplyOn">解除禁止回应</a>'),t.html(v),$(".cmtQuote").each(function(){var a=$(this).parent();a.html(a.html().replace(/[^&]*&nbsp;&nbsp;\|&nbsp;&nbsp;([^&]*)/,"$1"))})})},adminReplyOn:function(){var a=this;C.adminOperation({is_replyable:!0},function(){location.reload()})},adminStickOn:function(){var a=this;C.adminOperation({is_stick:!0},function(){a.replaceWith('<a href="javascript:void(0);" data-operation="adminStickOff">解除置顶</a>')})},adminStickOff:function(){var a=this;C.adminOperation({is_stick:!1},function(){a.replaceWith('<a href="javascript:void(0);" data-operation="adminStickOn">置顶</a>')})}};$("#controlPanel").delegate("a[data-operation]","click",function(a){var b=$(this),c=b.attr("data-operation"),d;c&&c in y&&(a.preventDefault(),d=y[c],d.call(b))}),$("#comments").delegate(".adminCmtDelete","click",function(a){a.preventDefault();var b=$(this),c=b.attr("data-operation"),d;d=y[c],d.call(b)})}$("#captchaImage").doOnce(function(){function e(b){b.preventDefault(),a.attr("src",c+"?v="+d++)}var a=$("#captchaImage"),b=$("#changeCaptchaImage"),c=a.attr("src"),d=1;b.click(e),a.click(e)}),$(".document-do").live("hover",function(){var a=$(this).find("a[data-report]");a.toggle(),a.next().toggle()}).delegate("a[data-report]","click",function(){j($(this))}),$("#comments ul.cmts-list >li").hover(function(){var a=$(this).find("a[data-report]");a.removeClass("ghide"),a.next().show()},function(){var a=$(this).find("a[data-report]");a.addClass("ghide"),a.next().hide()}),$("#comments").delegate("a[data-report]","click",function(){j($(this))}),$("#basketBtn").doOnce(function(){var a=new m,b=$("#basketBtn");b.click(function(){a.add(b)})})},unlogin:function(){function c(a){return a=a.split("?"),a[0]=a[0]+"iframe/",a.join("?")}$("#comments").delegate("a[data-operation=quoteComment]","click",function(){b($(x))}),i("post"),$(".reply-box").click(function(b){if(!ukey){b.preventDefault();var e=new d,f="yes",g=$(this).attr("data-redirect")!=undefined,h=f=="yes"?c(url_signin):a(f,g);e.showCover().open(h,null,function(){e.title("登录"),e.width(515),e.unpin(),$("#blockContent").height(226).find("iframe").css({overflow:"hidden",height:"100%"})})}});var a=function(a,b){var d=c(url_signin).split("?"),e=d[1]?d[1].split("&"):[],f=e.length,a=encodeURIComponent(a),g=!1;for(var h=0;h<f;h++)if(e[h].indexOf("success=")>-1){b?e[h]="success="+a:e[h]+=a,g=!0;break}return g||e.push("success="+a),d[1]=e.join("&"),d.join("?")}},all:function(){function q(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10},{ukey:e,nickname:f,triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}var b=["#recommendHotPosts",".post-recommend"];for(var c=0,d=b.length;c<d;c++){var f=$(b[c]).eq(0);f.doOnce(function(){var a=f.find("li"),b=f.attr("data-reckey");a.each(function(a,c){$(this).delegate("a","mouseup",function(){$(this).attr("href").indexOf("?_block")===-1&&($(this).attr("href",$(this).attr("href")+"?_block="+$(this).attr("data-gaevent").split(":")[0]+"&_pos="+a),b&&$(this).attr("href",$(this).attr("href")+"&rkey="+b))})})})}var g=function(a){function h(){clearTimeout(d),d=setTimeout(function(){var a=$(".gheader-wrap").height();$(window).scrollTop()+a+b.innerHeight()-b.height()>c?b.css("position","fixed"):b.css("position","static"),d=0},a)}var b=$("#rightFixedBlock"),c=0,d=0,e=$("#sideSlide");if(b.size())if(e.size())var f=setInterval(function(){$("#sideSlide").height()===160&&(c=b.position().top,clearInterval(f),h())},10);else c=b.position().top,h();else $(window).unbind("scroll",g);return h}(10);$(window).bind("scroll",g),$(".pt-txt, .post-txt").hover(function(){$(this).find(".focus-user").show()},function(){$(this).find(".focus-user").hide()});var h=$("#basketTip");$("#basketBtn").hover(function(){h.show()},function(){h.hide()});var i=$("#submitTip");$("#replyForm .gnbtn-primary").hover(function(){i.show()},function(){i.hide()});var j=$("#share");j.doOnce(function(){function b(){var a=$("#sharePic").attr("src")||$("#articleContent img:eq(0)").attr("src"),b=$("#articleTitle").text()||document.title,c={url:location.protocol+"//"+location.host+location.pathname,title:b,pic:a==null?"":a};window._bd_share_config={share:{tag:"shareMain",bdText:c.title,bdDesc:c.title,bdUrl:c.url,bdPic:c.pic,bdSign:"off",onBeforeClick:function(a,b){return a==="tsina"?b.bdText="这个有意思 →_→【"+b.bdText+"】 （分享自 @果壳网）":a==="tqq"?b.bdText="这个有意思 →_→【"+b.bdText+"】 （分享自 @果壳网）":b.bdDesc="这个有意思 →_→【"+b.bdText+"】 （来自 果壳网）",b},bdSnsKey:{tsina:"2727579136",tqq:"100246400"}}},G.loadScript("http://bdimg.share.baidu.com/static/api/js/share.js?v=86835285.js?cdnversion="+~(-(new Date)/36e5))}a("#share"),j.attr("data-tag","shareMain"),b()});var l=$("#sideSlide"),m=$("#sideSlideTmpl").html();$.get("/apis/flowingboard/flowingboard.json",{name:"post_sidepic"},function(a){if(a.result===null||a.result.length===0||a.result[0]===null)return;var b=a.result[0],c={items:[]},d=parseInt(l.css("width")),f=0;for(var g in b.items)b.items[g].url&&b.items[g].image&&(b.items[g].image=b.items[g].image.replace(/\/(image|thumbnail)(\/[\w-]{56})(_\d*x\d*)?\./,"/thumbnail$2_290x160."),c.items.push(b.items[g]));c.items.length>0&&(l.addClass("side-promote"),l.html(e(m,c)),f=parseInt($(".focus-tag").css("width")),$(".focus-tag").css("left",(d-f)/2),k(l,0,3e3,{showEffect:function(a,b,c,d){c.filter(":visible").stop().animate({opacity:0},500,function(){$(this).css("top","-160px")}),c.eq(a).css("top",0).stop().animate({opacity:1},1e3),d.removeClass(b),d.eq(a).addClass(b)}}))},"json"),$("#articleContent a,.cmts-list .cmt-content a").attr("target","_blank");var p=null;$(".gwrap").delegate('a[href*="/i/"][data-ukey]',"mouseenter",function(){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;p=window.setTimeout(q(a,b,c,n),500)}),$(".gwrap").delegate('a[href*="/i/"][data-ukey]',"mouseleave",function(){clearTimeout(p),p=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(p)},function(){$(this).remove(),window.nameCardShowOrder++})}),$(".gwrap").delegate('a[href*="/n/"]',"mouseenter",function(){if(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/.test($(this).attr("href"))){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;p=window.setTimeout(q(a,b,c,n),500)}}),$(".gwrap").delegate('a[href*="/n/"]',"mouseleave",function(){/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/.test($(this).attr("href"))&&(clearTimeout(p),p=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(p)},function(){$(this).remove(),window.nameCardShowOrder++}))}),o($(".gwrap"),{shareTitle:"分享给朋友",gotopTitle:"回到顶部 "},null,null)}}}),G.def("ajaxupload",function(){"use strict";var a={},b={};return function(c,d,e){function j(){var a=Math.random().toString(36).substring(2),i="hidden_iframe_"+a,j="hidden_form_"+a,k=d.parent(),l=d.next(),m,n=$('<iframe id="'+i+'" name="'+i+'" />').css("display","none").appendTo("body"),o=d.wrap("<form/>").parent().css({position:"absolute",top:"-1200px",left:"-1200px"}).attr({id:j,name:j,target:i,enctype:"multipart/form-data",encoding:"multipart/form-data",action:c,method:"POST"}).appendTo("body");b[f]=a,$.each(e.data,function(a,b){$('<input type="hidden"/>').attr("name",a).val(b).appendTo(o)}),n.bind("load",function(){var c;try{c=n.contents().text()}catch(d){}b[f]==a&&!g&&e.success&&c&&(h=!0,e.success.call(null,c))}),o.submit(),o.find("input:not(:file)").remove(),d.unwrap(),l.length?l.before(d):d.appendTo(k)}function k(a){e.data=$.extend(e.data,a),j()}var f=c+d[0].name,g=!1,h=!1,i;e=$.extend({timeout:0,data:{}},e),e.timeout&&e.timeoutCallback&&(i=setTimeout(function(){h||(g=!0,e.timeoutCallback.call(null))},e.timeout*1e3),c+d[0].name in a&&clearTimeout(a[f]),a[f]=i),e.asyncPrepare?e.asyncPrepare.call(null,k):j()}}),G.def("./group/settingsPage",["../lib/validate","../lib/ajaxupload","../lib/placeholder","./searchGroup"],function(a,b,c,d){return{login:function(){function h(){return $("#name").val()}c.init("#name"),c.init("#blackboard"),c.init("#reason");var d={name:"名称",blackboard:"介绍",serverError:"",globalError:'<div class="tip_box">{v}</div>',errors:{name:"呦，这个名称已经被人占用了"}},e=$('<img class="form-loading" width="16" height="16" src="/skin/imgs/loading.gif"/>'),f=function(a){$("#tipBox").html($(d.globalError.replace("{v}",a)))},g=$("#name").val();a("#newGroup",null,{msgPlace:function(a){return a.siblings(".tip")}}).rules({name:{_desc:d.name,required:1,maxlength:15,async:{url:"/apis/group/group.json?retrieve_type=is_available",type:"GET",param:"name",msg:d.errors.name,success:function(a){return g===h()?!0:a.result.is_available===!0},error:function(){f(d.serverError)},dataType:"json"}},blackboard:{_desc:d.blackboard,required:1,maxlength:1e4}}),$("#imgUpload").doOnce(function(a){var c=$("#trueFile"),e=$("#uploadMsg"),f=$("#groupIcon"),g=["jpeg","jpg","png","gif"],h;c.bind("change",function(a){a.preventDefault();if(c.val()==="")return alert("请选择一个图片文件"),!1;var i=c.val(),j=i.length,k=i.split(".");k.length>1?k=k[k.length-1].toLowerCase():k="";if($.inArray(k,g)===-1)return alert("不支持的文件格式"),!1;e.html("正在上传..."),b("/apis/image.json",c,{asyncPrepare:function(a){h=$("#accessToken").val(),a({access_token:h})},success:function(a){try{a=$.parseJSON(a)}catch(b){/too large/i.test(a)?a={errmsg:d.toolarge}:a={errmsg:d.unknown}}if(!a)return;if(a.ok){var c=48,g=48,h=a.result.hashkey;$.ajax({url:"/apis/image.json",type:"put",data:{width:c,height:g,hashkey:h,format:"JPEG"},success:function(a){f.attr("src",a.result.url),e.html("上传成功"),$("#imgHash").val(a.result.hashkey)},error:function(){}})}else a.ok||(e.length?e.attr("class","upload-msg error").text(""):alert(a.error))},timeout:30,timeoutCallback:function(){}})})}),$("#groupType").doOnce(function(){var a=$(this).find("input");a.click(function(a){$("#private-group").attr("checked")?($('#joinType input[value="free"]').attr("disabled","true").removeAttr("checked"),$('#joinType input[value="enlist"]').attr("checked","true")):$('#joinType input[value="free"]').removeAttr("disabled"),a.stopPropagation()})})}}}),G.def("./group/memberApi",function(){return{memberApi:function(a,b,c){$.ajax({type:a,url:"/apis/group/member.json",data:b,success:function(a){a.ok&&c&&c()},dataType:"json"})},blacklistApi:function(a,b,c){$.ajax({type:a,url:"/apis/group/blacklist.json",data:b,success:function(a){a.ok&&c&&c()},dataType:"json"})},memberApplyApi:function(a,b,c,d){$.ajax({type:"DELETE",url:"/apis/group/member_application.json",data:{ukey:a,group_id:b,operate:c},success:function(a){a.ok&&d&&d()},dataType:"json"})}}}),G.def("./group/membersPage",["../lib/placeholder","./memberApi","./searchGroup"],function(a,b,c){return{all:function(){var a=$("#memberSearch p"),b=$("#memberNick");a.length&&b.focus(function(){a.addClass("focus")}).blur(function(){a.removeClass("focus")})},login:function(){$(".gmain").parent().hasClass("gwrap-m")&&$(".members").doOnce(function(){this.find("dl").mouseenter(function(){var a=$(this);a.find("ul li").length>1&&a.addClass("members-cover").find("ul").show()}).mouseleave(function(){$(this).removeClass("members-cover").find("ul").hide()}),this.delegate("a[data-operation]","click",function(a){a.preventDefault();var c=$(this),d=c.text(),e=c.data("operation"),f=c.parents("ul").prev("a").attr("title"),g={group_id:g_group_id,ukey:c.data("ukey")},h=c.data("type");if(e==="edit_role"){g.role=c.data("role");if(g.role==="administrator"&&$(".groupMembers.admins").find("dl").length===5){alert("管理员人数最多为5人");return}}if(g.role==="founder"){if(!confirm("是否确定把组长权限转让给"+f+"，操作成功后您将失去组长权限，成为小组管理员"))return}else if(!confirm("确定要将"+f+d+"吗？"))return;var i=e!=="edit_blacklist"?"memberApi":"blacklistApi";b[i](h,g,function(){e!=="edit_role"||g.role!=="administrator"&&g.role!=="founder"?c.parents("dl").fadeOut():window.location.reload()})})}),$("#mainExplanationClose").click(function(){$(this).parent().fadeOut()}),$("#memberSearch").doOnce(function(){var b=$("#memberNick");a.init(b).submit(b,this,function(){var a=b.val();if(!a)return!1})})}}}),G.def("./group/searchMemberPage",["../lib/placeholder","./memberApi","./searchGroup"],function(a,b,c){return{login:function(){$(".gmain").parent().hasClass("gwrap-m")&&$(".members").doOnce(function(){this.find("dl").mouseover(function(){$(this).addClass("members-cover").find("ul").show()}).mouseout(function(){$(this).removeClass("members-cover").find("ul").hide()}),this.delegate("a[data-operation]","click",function(a){a.preventDefault();var c=$(this),d=c.text(),e=c.data("operation"),f=c.parents("ul").prev("a").text(),g={group_id:g_group_id,ukey:c.data("ukey")},h=c.data("type");if(e==="edit_role"){g.role=c.data("role");if(g.role==="administrator"&&$(".groupMembers.admins").find("dl").length===5){alert("管理员人数最多为5人");return}}if(!confirm("确定要将"+f+d+"吗？"))return;var i=e!=="edit_blacklist"?"memberApi":"blacklistApi";b[i](h,g,function(){e==="edit_role"&&g.role==="administrator"?window.location.reload():c.parents("dl").fadeOut()})})})},all:function(){var a=$("#memberSearch p"),b=$("#memberNick");a.length&&b.focus(function(){a.addClass("focus")}).blur(function(){a.removeClass("focus")})}}}),G.def("./group/blacklistPage",["./memberApi","./searchGroup"],function(a,b){return{login:function(){$("#mainExplanationClose").click(function(){$(this).parent().fadeOut()}),$("#blacklist").doOnce(function(){this.find("dl").mouseenter(function(){$(this).addClass("members-cover").find("ul").show()}).mouseleave(function(){$(this).removeClass("members-cover").find("ul").hide()}),this.delegate("a[data-operation]","click",function(b){b.preventDefault();var c=$(this),d=c.text(),e={ukey:c.data("ukey"),group_id:g_group_id},f=c.parents("ul").prev("a").text();if(!confirm("确定要将"+f+d+"吗？"))return;a.blacklistApi("DELETE",e,function(){c.parents("dl").fadeOut()})})})}}}),G.def("./group/applyPage",["../lib/validate","../lib/ajaxupload","../lib/placeholder","./searchGroup"],function(a,b,c,d){return{all:function(){},login:function(){c.init("#name"),c.init("#blackboard"),c.init("#reason");var d={name:"名称",blackboard:"介绍",reason:"理由",rule:"",serverError:"服务器正在休息，请刷新之后过一会再试！",globalError:'<div class="tip_box">{v}</div>',errors:{name:"哟，这个名称已经被人占用了！",rule:"一定要同意才能申请"}},e=$('<img class="form-loading" width="16" height="16" src="/skin/imgs/loading.gif"/>'),f=function(a){$("#tipBox").html($(d.globalError.replace("{v}",a)))};a("#newGroup",null,{msgPlace:function(a){return a.siblings(".tip")}}).method("rule",function(a){return!a||this.is(":checked")},d.errors.rule).rules({name:{_desc:d.name,required:1,maxlength:15,async:{url:"/apis/group/group.json?retrieve_type=is_available",type:"GET",param:"name",msg:d.errors.name,success:function(a){return a.result.is_available===!0},error:function(){f(d.serverError)},dataType:"json"}},blackboard:{_desc:d.blackboard,required:1,maxlength:1e4},reason:{_desc:d.reason,required:1,minlength:70,maxlength:1e3},rule:{_desc:d.rule,rule:1}}),$("#imgUpload").doOnce(function(a){var c=$("#trueFile"),e=$("#uploadMsg"),f=$("#groupIcon"),g=["jpeg","jpg","png","gif"],h;c.bind("change",function(a){a.preventDefault();if(c.val()==="")return alert("请选择一个文件"),!1;var i=c.val(),j=i.length,k=i.split(".");k.length>1?k=k[k.length-1].toLowerCase():k="";if($.inArray(k,g)===-1)return alert("不支持的图片格式"),!1;e.html("正在上传..."),b("/apis/image.json",c,{asyncPrepare:function(a){h=$("#accessToken").val(),a({access_token:h})},success:function(a){try{a=$.parseJSON(a)}catch(b){/too large/i.test(a)?a={errmsg:d.toolarge}:a={errmsg:d.unknown}}if(!a)return;if(a.ok){var c=48,g=48,h=a.result.hashkey;$.ajax({url:"/apis/image.json",type:"put",data:{width:c,height:g,hashkey:h,format:"JPEG"},success:function(a){f.attr("src",a.result.url),e.html("上传成功！"),$("#imgHash").val(a.result.hashkey)},error:function(){},dataType:"json"})}else a.ok||(e.length?e.attr("class","upload-msg error").text("上传失败！"):alert(a.error))},timeout:30,timeoutCallback:function(){}})})})}}}),G.def("./group/advancedSettingsPage",["./searchGroup"],function(a){return{all:function(){},login:function(){var a=$("#reply1"),b=$("#reply2");$("#apply1, #apply2").change(function(){$("#apply2").attr("checked")?(a.attr("disabled","disabled").parent().addClass("main-form-box-disabled"),b.attr("checked","checked")):a.removeAttr("disabled").parent().removeClass("main-form-box-disabled")}).change()}}}),G.def("./group/auditUserPage",["./memberApi","./searchGroup"],function(a,b){return{login:function(){this.checkAll("#selectAll1, #selectAll2","#applyForm input:checkbox"),this.checkItem("#applyForm","#selectAll1, #selectAll2"),$("#applyForm").delegate("a[data-operate]","click",function(b){b.preventDefault();var c=$(this),d=c.parents("li"),e=d.data("ukey"),f=c.data("operate");a.memberApplyApi(e,g_group_id,f,function(){d.fadeOut()})}),$(".formSubmit").delegate("a[data-operate]","click",function(a){a.preventDefault();var b=$(this).data("operate");if(!$("#applyForm").find("input:checked").length){alert("至少选中一项");return}$("#applyOp").val(b),$("#applyForm").submit()})},checkAll:function(a,b){a=$(a),b=$(b),a.each(function(){$(this).change(function(){$(this).attr("checked")?(b.attr("checked","checked"),a.attr("checked","checked")):(b.removeAttr("checked"),a.removeAttr("checked"))})})},checkItem:function(a,b){a=$(a),b=$(b),a.delegate("input:checkbox","change",function(c){var d=$(c.target);c.stopPropagation(),d.attr("checked")?a.find(":checkbox:not(:checked)").length||b.attr("checked","checked"):b.removeAttr("checked")})}}}),G.def("./group/searchGroupPage",["../lib/Count","../lib/toolTip","../lib/Overlay","../lib/placeholder","./searchGroup"],function(Count,toolTip,Overlay,placeholder,searchGroup){return{joinGroup:function(type,id,cb){$.ajax({url:"/apis/group/member.json",data:{group_id:id},type:type,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017&&alert("你是这个小组的管理员，不能退出")},dataType:"json"})},applyJoinGroup:function(a,b,c){$.ajax({url:"/apis/group/member_application.json",data:{group_id:b,annotation:a},type:"POST",success:function(a){a.ok&&c&&c()},dataType:"json"})},login:function(){var a={join:function(a,b){return'<a class="focus-btn follow-btn" href="javascript:void 0;" data-id="'+a+'" data-method="'+b+'" data-operation="quit"><span class="gnicon-tick"></span>已加入</a>'},quit:function(a,b,c,d){return'<a class="gnbtn-plat follow-btn" href="javascript:void 0;" data-id="'+a+'" data-operation="'+b+'" data-method="'+c+'"><span>+</span>'+d+"</a>"},applyBlock:'<div class="gui-block-apply">                                <textarea class="gttxt" placeholder="说点什么给管理员..." id="applyDetail"></textarea>                                <p class="fl error"></p>                                <p class="fr">                                    <a href="javascript: void 0;" class="gnbtn" id="applyBtn">提交</a>                                    <a href="javascript: void 0;" class="blockClose">取消</a>                                </p>                             </div>',applied:'<span class="focus-btn follow-btn"><span class="gnicon-tick"></span>已申请</span>'},b={applyTextTooLong:"申请理由不能超过250个字！",applyEmpty:"说点什么，让管理员了解你"},c={join:1,quit:-1},d={join:"POST",quit:"DELETE"},e=this.joinGroup,f=this.applyJoinGroup,g=new Overlay;$(".join-list").delegate("a.focus-btn","mouseenter",function(){var a=$(this);a.removeClass("focus-btn").addClass("gnbtn-frame").html('<span class="gnicon-cancel">-</span>退出')}),$(".join-list").delegate("a.gnbtn-frame","mouseleave",function(){var a=$(this);a.removeClass("gnbtn-frame").addClass("focus-btn").html('<span class="gnicon-tick"></span>已加入')}),$(".join-list").delegate("a[data-operation]","click",function(){var h=$(this),i=h.data("operation"),j=h.attr("data-method"),k=h.attr("data-id"),l=j==="apply"?"申请":"加入",m=new Count(h.parent().find(".join-list-desc span"));i==="quit"?e(d[i],k,function(){h.replaceWith(a.quit(k,j,j,l)),m.add(c[i])}):i==="join"?e(d[i],k,function(){h.replaceWith(a.join(k,j)),m.add(c[i])}):g.open(a.applyBlock,null,function(){return g.title("加入这个小组需要申请哦，说说你的理由吧"),placeholder.init("#applyDetail"),$("#applyBtn").click(function(c){c.preventDefault();var d=$("#applyDetail"),e=d.val();applyTip=$(this).parent().prev(),placeholder.support||e===d.attr("placeholder")&&(d.val(""),e="");if(e.length>250)return applyTip.text(b.applyTextTooLong),!1;if(!e.length)return applyTip.text(b.applyEmpty),!1;f(e,k,function(){g.close(),h.replaceWith(a.applied)})}),!0})})},unlogin:function(){},all:function(){var a=function(a,b){var c=$(a).find("ul"),d=c.length,e=0;b.click(function(){var a=c.eq(e),b;e++,e%=d,b=c.eq(e),a.hide(),b.show()})};$("#refreshHot").doOnce(function(){a("#hotGroups",$(this))}),$("#refreshNew").doOnce(function(){a("#newGroups",$(this))})}}}),G.def("./group/hotPage",["../lib/autoComplete","./searchGroup"],function(a,b){return{all:function(){function a(){var a='<div class="submit-tip-box icon-hot-tip"><div class="submit-tip">正在热烈讨论的帖子<b class="gnarrow-up"></b></div></div>',b='<div class="submit-tip-box icon-best-tip"><div class="submit-tip">被组长设为精华的帖子<b class="gnarrow-up"></b></div></div>';$(".gicon-hot").hover(function(){$(this).css("position","relative").html(a)},function(){$(this).css("position","static").html("")}),$(".gicon-best").hover(function(){$(this).css("position","relative").html(b)},function(){$(this).css("position","static").html("")})}$("#groupsRefresh").doOnce(function(){var a=$("#groups").find("ul"),b=a.length,c=0;$(this).click(function(){var d=a.eq(c),e;c++,c%=b,e=a.eq(c),d.hide(),e.show()})}),a()}}}),G.def("./group/joinedPage",["./searchGroup"],function(a){function f(a,b){$.ajax({url:"/apis/group/favorite.json",data:{group_id:a},type:"PUT",success:function(a){a.ok&&b&&b()},dataType:"json"})}function g(a,b){var c=a.parents(".settingTop");c.addClass("topAnimate"),!window.AnimationEvent&&$.browser.msie?(c.removeClass("topAnimate"),c.hide()):(d=!0,setTimeout(function(){d=!1,c.removeClass("topAnimate"),c.hide()},b*1e3))}function h(a,c){var d=-1,e,f,g=c.slice();if(!Array.indexOf)d=g.indexOf(a);else for(e=0,f=g.length;e<f;e++)if(g[e]===a){d=e;break}return d!==-1&&g.splice(d,1),g.unshift(a),g.length>12&&(g.length=12),b=d,g}function i(a,b){$(".page-title-tip").remove(),b!==-1&&$($(".group-of-setTop li")[b]).remove(),$(".group-of-setTop").prepend(a),$(".group-of-setTop li").length>12&&$($(".group-of-setTop li")[12]).remove(),$(".page-title-more")[0].innerHTML="（"+$(".group-of-setTop li").length+"）"}var b=-1,c=typeof window.groupIds=="undefined"?[]:window.groupIds,d=!1,e=c[0]||"";return{all:function(){$("#groupsRefresh").doOnce(function(){var a=$("#groups").find("ul"),b=a.length,c=0;$(this).click(function(){var d=a.eq(c),e;c++,c%=b,e=a.eq(c),d.hide(),e.show()})}),$(".group-of-joined li").mouseenter(function(){if(+$(this).attr("id")===e||d)return;$(this).find(".settingTop").show()}).mouseleave(function(){if(d)return;$(this).find(".settingTop").hide()}),$(".group-of-joined").delegate("a.group-top","click",function(a){var d=$(this),j=+$(this).parents("li").attr("id"),k=$(this).parents("li").clone();a.preventDefault(),k.find(".settingTop").remove(),c=h(j,c),f(c,function(){e=j,i(k,b),g(d,1)})})}}}),G.def("./group/minePage",["./searchGroup","../lib/nameCard","../lib/cookies"],function(searchGroup,nameCard,cookies){return{login:function(){function freshGroup(a,b){$("#"+a).doOnce(function(){var a=b,c=a.length,d=0;$(this).unbind("click"),$(this).click(function(){var b=a.eq(d),e;d++,d%=c,e=a.eq(d),b.hide(),e.show()})})}function showNameCard(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10,isGroup:!0},{triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}function showIconTip(){var a='<div class="submit-tip-box icon-hot-tip"><div class="submit-tip">正在热烈讨论的帖子<b class="gnarrow-up"></b></div></div>',b='<div class="submit-tip-box icon-best-tip"><div class="submit-tip">被组长设为精华的帖子<b class="gnarrow-up"></b></div></div>';$(".gicon-hot").hover(function(){$(this).css("position","relative").html(a)},function(){$(this).css("position","static").html("")}),$(".gicon-best").hover(function(){$(this).css("position","relative").html(b)},function(){$(this).css("position","static").html("")})}var isNewPostPage=!$(".gntabs .gtabs-curr").index();if(isNewPostPage)var joinedNum=g_joined_groups_count;freshGroup("groupsRefresh",$("#groups").find("ul"));if(isNewPostPage){freshGroup("freshRecomGroup",$("#groupRecom").find("ul"));function joinGroup(ids,list){$.ajax({url:"/apis/group/member.json",data:{group_id:ids},type:"POST",success:function(a){var a=a,b=a.result.length;joinedNum+=b,joinedNum>=20?$("#groupRecom").fadeOut():(list.parents("ul").remove(),$("#groupRecom ul").eq(0).fadeIn(),freshGroup("freshRecomGroup",$("#groupRecom").find("ul")),$("#groupRecom ul").length===1&&$("#freshRecomGroup").fadeOut())},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})}$("#groupRecom").doOnce(function(){$("#groupRecom").delegate("#joinAllGroup","click",function(a){var b=$("#groupRecom"),c=b.find("ul:visible li"),d=c.length,e=[];for(var f=0;f<d;f++){var g=c.eq(f).attr("data-id");e.push(g)}joinGroup(e,c)})})}var timeout=null;$(".gwrap").delegate("a[data-group_id]","mouseenter",function(){var a=$(this),b=this.getBoundingClientRect().top,c=this.getBoundingClientRect().right;timeout=window.setTimeout(showNameCard(a,b,c,nameCard),500)}),$(".gwrap").delegate("a[data-group_id]","mouseleave",function(){clearTimeout(timeout),timeout=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(timeout)},function(){$(this).remove(),window.nameCardShowOrder++})}),typeof g_replied_since!="undefined"&&function(){if(!$(".gtabs-curr").index()){var a=$(".gntabs").eq(0),b="newInfo"+g_replied_since,c=a.after("<a id="+b+' style="cursor:pointer;background:#f1fafd; display:block; width:100%;  border:1px solid #EDEDED;color:#0078b6; font:12px/2 Arial, Helvetica, sans-serif; text-align:center; margin:15px 0; display:none;">有0个新小组动态，点击刷新</a>'),d=$("#"+b);d.prev().css({border:"none"}).end().next().css({borderTop:"1px solid #EDEDED"}),d.click(function(){window.location.reload(!0)});var e="/apis/group/post_reply.json?retrieve_type=replies_count_by_replied_since&replied_since="+g_replied_since;function f(){$.ajax({url:e,type:"GET",success:function(a){a.ok?a.result&&d.html("有"+a.result+"个新小组动态，点击刷新").show().css({display:"block"}):d.hide()},dataType:"json"})}var g=6e4;setTimeout(function(){setInterval(function(){f()},2*g)},g)}}(),showIconTip()}}}),G.def("share",function(){function h(a,b){e===2?b():e===1?f.push(b):(f=f||[],f.push(b),e=1,window.bShareOpt={style:-1,pop:-1,uuid:a,lang:"zh",pophcol:2,mdiv:-1},G.loadScript(d,function(){e=2,bShare.init();for(var a=0,b=f.length;a<b;a++)f[a]&&f[a]()}))}"use strict";var a='分享到:                    <a data-type="sinaminiblog" class="gui-share-xl" href="#" title="分享到新浪微博">新浪微博</a>                    <a data-type="renren" class="gui-share-rr" href="#" title="分享到人人">人人</a>                    <a data-type="douban" class="gui-share-db" href="#" title="分享到豆瓣">豆瓣</a>                    <a data-type="qzone" class="gui-share-qq" href="#" title="分享到QQ空间">QQ空间</a>                    <a data-type="qqmb" class="gui-share-tqq" href="#" title="分享到腾讯微博">腾讯微博</a>',b='分享到：                            <a data-type="douban" class="gicon-share-db" href="#" title="分享到豆瓣">豆瓣</a>                            <a data-type="sinaminiblog" class="gicon-share-sina" href="#" title="分享到新浪微博">新浪微博</a>                            <a data-type="qzone" class="gicon-share-qzone" href="#" title="分享到QQ空间">QQ空间</a>                            <a data-type="weixin" class="gicon-share-weixin" href="#" title="分享到微信">微信</a>                            <a data-type="qqmb" class="gicon-share-qqmb" href="#" title="分享到腾讯微博">腾讯微博</a>                            <div class="counter"><b><s></s></b><span class="BSHARE_COUNT share_counter">0</span></div>',c="9dd5aa8d-bbe1-4a9e-ac82-6e6002ca17fa",d="http://static.bshare.cn/b/buttonLite.js",e=0,f,g;return function(c,d,e,f,i){h(e||"9dd5aa8d-bbe1-4a9e-ac82-6e6002ca17fa",function(){g=$(c);var e="";if(i)switch(i){case"contentShare":e=b}else e=f||a;g.html(e),g.delegate("a","click",function(a){a.preventDefault();var b=$("#share .BSHARE_COUNT");if(b.length){var c=b.html();setTimeout(function(){b.html(+c+1)},10)}var e=$(this),f=e.data("type"),g=G.isFun(d)?d(f):d,h=g;if(h===!1)return;G.isFun(h.pic)&&h.pic(function(a){h.pic=a}),bShare?(bShare.entries=[],bShare.addEntry(g),bShare.share(a,f)):G.log("bshare not loaded")})})}}),G.def("autoSizeImg",function(){function a(a,b,c,d,e,f){function g(){var a=$("#curPic"),g=a.width(),h=a.height(),i=e,j=f,k=$(window).width(),l=$(window).height()-45;$("#picWrap").css("height",l);if(e>k&&f>l){var m=l-c;h=m,g=m*i/j,a.height(h),a.width(g)}else if(e<k&&f>l){var n=f/e;if(n<3){var m=l-c;h=m,g=m*i/j,a.height(h),a.width(g)}else if(n>3||n==3)a.height(j),a.width(i)}else if(f<l&&e>k){var o=k-b;g=o,h=o*j/i,a.height(h),a.width(g)}if(f<l&&e<k){var m=l-c;h=f,g=e,a.height(h),a.width(g)}if(d)if(e<k&&f>l)a.css("margin-top","30px");else{var p=Math.abs((l-h)/2);a.css("margin-top",p+"px")}}this.curPic=$("#curPic"),this.offsetWidth=b||40,this.offsetHeight=c||40,this.autoMiddle=d||!0,this.default_pic_w=e,this.default_pic_h=f,g(),$(window).resize(function(){g()})}return function(b,c,d,e,f,g){return new a(b,c,d,e,f,g)}}),G.def("./group/picturePreviewPage",["../lib/share","../lib/autoSizeImg"],function(a,b){function r(a){for(var c=a;c<hashkeyList.length;c++){k=hashkeyList[c],l=k.hashkey,m=k.img_src,img_src_org=k.img_src_org,o=k.default_pic_w,p=k.default_pic_h,b(this.parentNode,40,40,!0,o,p);if(i==l){j=c,d.attr("src",m),$("#picOriginal").attr("href",img_src_org);break}if(c==hashkeyList.length-1){$.get("/apis/group/post/gallery.json",{post_id:h,hashkey:hashkeyList[hashkeyList.length-1].hashkey},function(a){var e=a.result;e.length!=0?(hashkeyList=hashkeyList.concat(e),r(c+1)):(j=0,alert("该图片走失了，正在重新定位"),o=hashkeyList[j].default_pic_w,p=hashkeyList[j].default_pic_h,b(this.parentNode,40,40,!0,o,p),location.href="#"+hashkeyList[j].hashkey,d.attr("src",hashkeyList[j].img_src))},"json");break}}}function s(){$.get("/apis/group/post/gallery.json",{post_id:h,hashkey:hashkeyList[hashkeyList.length-1].hashkey},function(a){var b=a.result;hashkeyList=hashkeyList.concat(b),j==hashkeyList.length-1?window.location.assign(next_url):j!==hashkeyList.length-1&&j!=-1&&z()},"json")}function w(a){var b=j;v.src==""?b==3||b>3?(v.src=a[b-1],v.src=a[b-2],v.src=a[b-3]):b==2?(v.src=a[b-1],v.src=a[b-2]):b==1&&(v.src=a[b-1]):v.src!==""&&(b==3||b>3)&&(v.src=a[b-3])}function x(a){var b=j;v.src==""?b==hashkeyList.length-4||b<hashkeyList.length-4?(v.src=a[b+1],v.src=a[b+2],v.src=a[b+3]):b==hashkeyList.length-3?(v.src=a[b+1],v.src=a[b+2]):b==hashkeyList.length-2&&(v.src=a[b+1]):v.src!==""&&(b==hashkeyList.length-4||b<hashkeyList.length-4)&&(v.src=a[b+3])}function y(){j-=1,location.href="#"+hashkeyList[j].hashkey,w(n),d.removeAttr("src"),d.attr("src",hashkeyList[j].img_src),o=hashkeyList[j].default_pic_w,p=hashkeyList[j].default_pic_h,b(this.parentNode,40,40,!0,o,p),$("#picOriginal").removeAttr("href"),$("#picOriginal").attr("href",hashkeyList[j].img_src)}function z(){j+=1,hashkeyList.length==1&&window.location.assign(next_url),location.href="#"+hashkeyList[j].hashkey,x(n),d.removeAttr("src"),d.attr("src",hashkeyList[j].img_src),o=hashkeyList[j].default_pic_w,p=hashkeyList[j].default_pic_h,b(this.parentNode,40,40,!0,o,p),$("#picOriginal").removeAttr("href"),$("#picOriginal").attr("href",hashkeyList[j].img_src)}var c=$("#picWrap"),d=$("#curPic"),e=$("#Prev, #Next, #picWrap"),f=c.width(),g=location.href,h=post_id,i,j,k,l,m,n=[],o,p,q=$("#guoupTitle").text();g.indexOf("gallery/#")==-1?i=hashkeyList[0].hashkey:i=g.substring(g.indexOf("/gallery/#")+10,g.length),r(0);for(var t=0;t<hashkeyList.length;t++){var u=hashkeyList[t];n.push(u.img_src)}var v=new Image;c.mousemove(function(a){var b=a.clientX;b<f/2?(c.removeClass("mouseright"),c.addClass("mouseleft")):b>f/2&&(c.removeClass("mouseleft"),c.addClass("mouseright"))}),e.bind("click",function(){j>0&&j<hashkeyList.length-1?c.hasClass("mouseleft")?y():c.hasClass("mouseright")&&z():j==0?c.hasClass("mouseleft")?window.location.assign(previous_url):c.hasClass("mouseright")&&z():j==hashkeyList.length-1&&(c.hasClass("mouseleft")?y():c.hasClass("mouseright")&&s())}),a($("#share"),function(){return{summary:"不错的图片 →_→【"+q+"】"+" ",pic:d.attr("src")}},null,'<span>分享到：</span><a class="gicon-share-qzone" title="分享到QQ空间" href="#" data-type="qzone">QQ空间</a> <a class="gicon-share-db" title="分享到豆瓣" href="#" data-type="douban">豆瓣</a><a class="gicon-share-sina" title="分享到新浪微博" href="#" data-type="sinaminiblog">新浪微博</a>')}),G.def("./group/basicPage",["./searchGroup"],function(a){return{all:function(){}}}),G.def("./group/rankPage",["../lib/Count","../lib/toolTip","../lib/Overlay","../lib/placeholder","./searchGroup","../lib/nameCard"],function(Count,toolTip,Overlay,placeholder,searchGroup,nameCard){return{joinGroup:function(type,id,cb){$.ajax({url:"/apis/group/member.json",data:{group_id:id},type:type,success:function(a){a.ok&&cb&&cb()},error:function(data){var json=eval("("+data.responseText+")");json.error_code==241001?alert("该小组不存在"):json.error_code==241016?alert("你不是这个小组的成员"):json.error_code==241017?alert("你是这个小组的管理员，不能退出"):json.error_code==241014&&alert("你在这个小组的黑名单里，不能加入")},dataType:"json"})},applyJoinGroup:function(a,b,c){$.ajax({url:"/apis/group/member_application.json",data:{group_id:b,annotation:a},type:"POST",success:function(a){a.ok&&c&&c()},dataType:"json"})},login:function(){var a={join:function(a,b){return'<a class="focus-btn follow-btn" href="javascript:void 0;" data-id="'+a+'" data-method="'+b+'" data-operation="quit"><span class="gnicon-tick"></span>已加入</a>'},quit:function(a,b,c,d){return'<a class="gnbtn-plat follow-btn" data-gaevent="group_join_button:group" href="javascript:void 0;" data-id="'+a+'" data-operation="'+b+'" data-method="'+c+'"><span>+</span>'+d+"</a>"},applyBlock:'<div class="gui-block-apply">                                <textarea class="gttxt" placeholder="说点什么给管理员..." id="applyDetail"></textarea>                                <p class="fl" style="color:red"></p>                                <p class="fr">                                    <a href="javascript: void 0;" class="gnbtn" id="applyBtn">提交</a>                                    <a href="javascript: void 0;" class="blockClose">取消</a>                                </p>                             </div>',applied:'<span class="focus-btn follow-btn"><span class="gnicon-tick"></span>已申请</span>'},b={applyTextTooLong:"申请理由不能超过250个字！",applyEmpty:"说点什么，让管理员了解你"},c={join:1,quit:-1},d={join:"POST",quit:"DELETE"},e=this.joinGroup,f=this.applyJoinGroup,g=new Overlay;$(".ranks").delegate("a.focus-btn","mouseenter",function(){var a=$(this);a.removeClass("focus-btn").addClass("gnbtn-frame").html('<span class="gnicon-cancel">-</span>退出')}),$(".ranks").delegate("a.gnbtn-frame","mouseleave",function(){var a=$(this);a.removeClass("gnbtn-frame").addClass("focus-btn").html('<span class="gnicon-tick"></span>已加入')}),$(".ranks").delegate("a[data-operation]","click",function(){var h=$(this),i=h.data("operation"),j=h.attr("data-method"),k=h.attr("data-id"),l=j==="apply"?"申请":"加入",m=new Count(h.parent().find(".group-members"));i==="quit"?e(d[i],k,function(){h.replaceWith(a.quit(k,j,j,l)),m.add(c[i])}):i==="join"?e(d[i],k,function(){h.replaceWith(a.join(k,j)),m.add(c[i])}):g.open(a.applyBlock,null,function(){return g.title("加入这个小组需要申请哦，说说你的理由吧"),placeholder.init("#applyDetail"),$("#applyBtn").click(function(c){c.preventDefault();var d=$("#applyDetail"),e=d.val();applyTip=$(this).parent().prev(),placeholder.support||e===d.attr("placeholder")&&(d.val(""),e="");if(e.length>250)return applyTip.text(b.applyTextTooLong),!1;if(!e.length)return applyTip.text(b.applyEmpty),!1;f(e,k,function(){g.close(),h.replaceWith(a.applied)})}),!0})})},unlogin:function(){},all:function(){function c(a,b,c,d){return function(){var e=a.attr("data-ukey")||"",f=a.attr("href").replace(/^(?:(?:http\:\/\/[a-z0-9\.]*)?guokr\.com(?:\:\d+)?)?\/n\/([^\/]*)\/$/,"$1")||"";window.nameCardShowOrder=window.nameCardShowOrder||0,d($(".container"),{offset:10,isGroup:!0},{triggerElem:a,triggerTopViewArea:b,triggerRightViewArea:c},g_page_name,window.nameCardShowOrder)}}var a=function(a,b){var c=$(a).find("ul"),d=c.length,e=0;b.click(function(){var a=c.eq(e),b;e++,e%=d,b=c.eq(e),a.hide(),b.show()})};$("#refreshHot").doOnce(function(){a("#hotGroups",$(this))}),$("#refreshNew").doOnce(function(){a("#newGroups",$(this))});var b=null;$(".gwrap").delegate("a[data-group_id]","mouseenter",function(){var a=$(this),d=this.getBoundingClientRect().top,e=this.getBoundingClientRect().right;b=window.setTimeout(c(a,d,e,nameCard),500)}),$(".gwrap").delegate("a[data-group_id]","mouseleave",function(){clearTimeout(b),b=setTimeout(function(){$(".name_card").remove(),window.nameCardShowOrder++},200),$(".name_card").hover(function(){clearTimeout(b)},function(){$(this).remove(),window.nameCardShowOrder++})})}}});if(typeof g_page_name!="undefined"){typeof ukey=="undefined"&&(ukey="");var moduleName=g_page_name.replace(/group/g,"");moduleName=moduleName.slice(0,1).toLowerCase()+moduleName.slice(1),G.req("./group/"+moduleName,function(a){"use strict";if(a==null)return;var b=ukey?"login":"unlogin";a[b]&&a[b](ukey),a.all&&a.all()})}